!function(){function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}var n=["p"];function e(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return r(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function a(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)}return e}function u(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?a(Object(e),!0).forEach(function(n){o(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function o(n,e,r){return(e=function(n){var e=function(n,e){if("object"!=t(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var a=r.call(n,e||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"==t(e)?e:e+""}(e))in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",a=e.toStringTag||"@@toStringTag";function u(e,r,a,u){var i=r&&r.prototype instanceof l?r:l,s=Object.create(i.prototype);return c(s,"_invoke",function(e,r,a){var u,i,c,l=0,s=a||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(n,e){return u=n,i=0,c=t,p.n=e,o}};function v(e,r){for(i=e,c=r,n=0;!f&&l&&!a&&n<s.length;n++){var a,u=s[n],v=p.p,g=u[2];e>3?(a=g===r)&&(c=u[(i=u[4])?5:(i=3,3)],u[4]=u[5]=t):u[0]<=v&&((a=e<2&&v<u[1])?(i=0,p.v=r,p.n=u[1]):v<g&&(a=e<3||u[0]>r||r>g)&&(u[4]=e,u[5]=r,p.n=g,i=0))}if(a||e>1)return o;throw f=!0,r}return function(a,s,g){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&v(s,g),i=s,c=g;(n=i<2?t:c)||!f;){u||(i?i<3?(i>1&&(p.n=-1),v(i,c)):p.n=c:p.v=c);try{if(l=2,u){if(i||(a="next"),n=u[a]){if(!(n=n.call(u,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=u.return)&&n.call(u),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);u=t}else if((n=(f=p.n<0)?c:e.call(r,p))!==o)break}catch(n){u=t,i=1,c=n}finally{l=1}}return{value:n,done:f}}}(e,a,u),!0),s}var o={};function l(){}function s(){}function f(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(c(n={},r,function(){return this}),n),v=f.prototype=l.prototype=Object.create(p);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,c(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t}return s.prototype=f,c(v,"constructor",f),c(f,"constructor",s),s.displayName="GeneratorFunction",c(f,a,"GeneratorFunction"),c(v),c(v,a,"Generator"),c(v,r,function(){return this}),c(v,"toString",function(){return"[object Generator]"}),(i=function(){return{w:u,m:g}})()}function c(t,n,e,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}c=function(t,n,e,r){function u(n,e){c(t,n,function(t){return this._invoke(n,e,t)})}n?a?a(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(u("next",0),u("throw",1),u("return",2))},c(t,n,e,r)}function l(t,n,e,r,a,u,o){try{var i=t[u](o),c=i.value}catch(t){return void e(t)}i.done?n(c):Promise.resolve(c).then(r,a)}function s(t){return function(){var n=this,e=arguments;return new Promise(function(r,a){var u=t.apply(n,e);function o(t){l(u,r,a,o,i,"next",t)}function i(t){l(u,r,a,o,i,"throw",t)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./index-legacy123.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./index-legacy116.js?v=1756369731","./useStore-legacy6.js?v=1756369731","./index-legacy103.js?v=1756369731","./column-legacy.js?v=1756369731","./useStore-legacy7.js?v=1756369731","./validator-legacy.js?v=1756369731"],function(t,r){"use strict";var a,c,l,f,p,v,g,m,d,y,h,b,w,S,k,L,P,T,x,O,_,q,F,j,C,D,E,A,M,R,I,N,V,B,H,W,G,J,z,K,U,Y,$,X,Z,Q,tt,nt,et,rt,at,ut,ot,it,ct,lt,st,ft,pt,vt,gt,mt,dt,yt,ht,bt,wt,St,kt,Lt,Pt,Tt,xt,Ot,_t,qt,Ft,jt,Ct,Dt,Et,At,Mt,Rt,It,Nt,Vt,Bt,Ht,Wt,Gt,Jt,zt,Kt,Ut,Yt,$t,Xt;return{setters:[function(t){a=t.K,c=t.M,l=t.at,f=t.aj,p=t.S,v=t.u,g=t.N,m=t.a3,d=t.o,y=t.J,h=t.e,b=t.$,w=t.aM,S=t.cX,k=t.cY,L=t.R,P=t.b,T=t.cZ,x=t.c_,O=t.v,_=t.l,q=t.k,F=t.c$,j=t.bv,C=t.L,D=t.d0,E=t.d1,A=t.d2},function(t){M=t._},function(t){R=t.j,I=t.s,N=t.r,V=t.U,B=t.g,H=t.k,W=t.c,G=t.w,J=t.q,z=t.v,K=t.y,U=t.M,Y=t.x,$=t.P,X=t.C,Z=t.K,Q=t.F,tt=t.a_,nt=t.e,et=t.A,rt=t.B,at=t.J,ut=t.L,ot=t.av,it=t.z,ct=t.p,lt=t.D,st=t.b6,ft=t.H,pt=t.G},function(t){vt=t._},function(t){gt=t.b,mt=t.d,dt=t.e,yt=t.f,ht=t.s,bt=t.h,wt=t.i,St=t.j,kt=t.k,Lt=t.l,Pt=t.m,Tt=t.n,xt=t.o,Ot=t.u,_t=t.L,qt=t.p,Ft=t.q,jt=t.t,Ct=t.v,Dt=t.w,Et=t.x,At=t.y,Mt=t.z,Rt=t.A,It=t.B,Nt=t.C,Vt=t.D,Bt=t.E,Ht=t.F,Wt=t.G,Gt=t.H,Jt=t.I},function(t){zt=t._},function(t){Kt=t.a,Ut=t.u,Yt=t.c},function(t){$t=t.L},function(t){Xt=t.e}],execute:function(){var Zt,Qt=function(t){return t.TamperProof="网站防篡改",t.Syssafe="宝塔系统加固",t.Security="堡塔防入侵",t.TamperProofRefactored="网站防篡改程序-重构版",t}(Qt||{}),tn=t("g",R("LOG-SOFT-STORE",function(){var t=N([]),n=N(""),e=N(),r=N([]),v=N(""),g=N(""),m=N(""),d=N("login"),y=N(""),h=function(){var e=s(i().m(function e(){var r,u;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,r=function(t){return t.map(function(t){return{name:t,id:t}})},e.n=1,a({loading:"正在获取日志菜单，请稍后...",request:gt(),data:[Array,r],success:function(e){var r;t.value=e,n.value=null===(r=e[0])||void 0===r?void 0:r.name}});case 1:return u=e.v,e.a(2,{data:u,status:!0});case 2:return e.p=2,e.v,e.a(2,{status:!1,data:[],msg:"获取日志菜单失败"})}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),b=function(){var t=s(i().m(function t(){var e,r,o,c,l=arguments;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=l.length>0&&void 0!==l[0]?l[0]:"",t.p=1,r="Php"===n.value,o=r?mt:dt,t.n=2,a({loading:"正在获取日志数据，请稍后...",request:o({data:JSON.stringify({name:n.value,search:e})})});case 2:return c=t.v,t.a(2,u({},c.data));case 3:return t.p=3,t.v,t.a(2,{status:!1,data:[],msg:"获取日志数据失败"})}},t,null,[[1,3]])}));return function(){return t.apply(this,arguments)}}(),w=function(){var t=s(i().m(function t(){var n;return i().w(function(t){for(;;)switch(t.n){case 0:return n={type:1,path:m.value},t.n=1,a({loading:"正在清空日志,请稍候...",request:yt(n),message:!0});case 1:return t.a(2,t.v)}},t)}));return function(){return t.apply(this,arguments)}}(),S=function(){var t=s(i().m(function t(){var n,e,r,a,u;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return n=c.load("正在获取FTP日志状态，请稍后..."),t.p=1,t.n=2,ht({exec_name:"getlog"});case 2:return e=t.v,r=e.status,a=e.msg,t.a(2,{status:r,data:a});case 3:return t.p=3,u=t.v,l(u),t.a(2,{status:!1,data:"获取FTP日志状态失败"});case 4:return t.p=4,n.close(),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(){return t.apply(this,arguments)}}(),k=function(){var t=s(i().m(function t(){var n,e,r,a,u;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return n=c.load("正在开启FTP服务，请稍后..."),t.p=1,t.n=2,ht({exec_name:"start"});case 2:return e=t.v,r=e.status,a=e.msg,t.a(2,{status:r,msg:a});case 3:return t.p=3,u=t.v,l(u),t.a(2,{status:!1,msg:"开启FTP服务失败"});case 4:return t.p=4,n.close(),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(){return t.apply(this,arguments)}}(),L=function(){var t=s(i().m(function t(n){var e,r;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取FTP日志,请稍后...",request:bt(n),data:{data:Array,page:String}});case 1:if(e=t.v,Array.isArray(null==e?void 0:e.data)){t.n=2;break}return t.a(2,{total:0,data:[],other:{}});case 2:return t.a(2,{data:e.data,total:f(e.page),other:{}});case 3:return t.p=3,r=t.v,l(r),t.a(2,{total:0,data:[],other:{}})}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}(),P=function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取FTP操作日志,请稍后...",request:wt(n),data:{data:Array,page:String}});case 1:if(e=t.v,Array.isArray(null==e?void 0:e.data)){t.n=2;break}return t.a(2,{total:0,data:[],other:{}});case 2:return t.a(2,{data:e.data,total:f(e.page),other:{}});case 3:return t.p=3,t.v,t.a(2,{total:0,data:[],other:{}})}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}(),T=function(){var t=s(i().m(function t(){var n,e,r;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取FTP用户名,请稍后...",request:St({p:1,limit:99999,search:"",table:"ftps"}),data:{data:Array}});case 1:return n=t.v,e=n.data,r=n.status,t.a(2,{data:e,status:r,msg:"获取用户成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,data:[],msg:"获取用户失败"})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();o(o(o(o({Nginx:["Nginx","logs"],Apache:["Apache","logs"]},Qt.TamperProof,"bt_security"),Qt.Syssafe,"syssafe"),Qt.Security,"security"),Qt.TamperProofRefactored,"bt_security");var x=function(){var t=s(i().m(function t(e){var r,u,o,c;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,r=null,"Docker"!==n.value){t.n=2;break}return t.n=1,a({request:kt(e)});case 1:u=t.v,o=u.data,(r=o).total=f(o.page),t.n=6;break;case 2:if(n.value!==Qt.Syssafe){t.n=4;break}return t.n=3,O(e);case 3:r=t.v,t.n=6;break;case 4:if(n.value!==Qt.Security){t.n=6;break}return t.n=5,_(e);case 5:r=t.v;case 6:return t.a(2,{data:r.data,total:r.total,other:{}});case 7:return t.p=7,c=t.v,l(c),t.a(2,{total:0,data:[],other:{}})}},t,null,[[0,7]])}));return function(n){return t.apply(this,arguments)}}(),O=function(){var t=s(i().m(function t(n){var e,r,u;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取日志数据，请稍后...",request:Lt({data:JSON.stringify({name:"syssafe",search:n.search,ROWS:n.ROWS})})});case 1:return e=t.v,r=e.data,t.a(2,{data:r.msg.data,total:r.total||f(r.msg.page),other:{}});case 2:return t.p=2,u=t.v,l(u),t.a(2,{total:0,data:[],other:{}})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),_=function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取日志数据，请稍后...",request:Pt({data:JSON.stringify({name:"bt_security",search:n.search,ROWS:n.ROWS})}),data:{"msg.data":[Array,function(t){return{data:t}}],"msg.page":p()}});case 1:return e=t.v,t.a(2,{data:e.data,total:e.total,other:{}});case 2:return t.p=2,t.v,t.a(2,{total:0,data:[],other:{}})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),q=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在删除日志,请稍候...",request:yt({type:0,id:n.id}),message:!0,success:e.value});case 1:return t.a(2,{status:!0,msg:"删除日志成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,data:[],msg:"删除日志失败"})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),F=N("mysqlSlow"),j=N([]),C=function(){var t=s(i().m(function t(n){var e,r;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Tt({data:JSON.stringify({limit:"5000",search:n})});case 1:return e=t.v,t.a(2,{data:e.data.msg,status:!0,msg:""});case 2:return t.p=2,r=t.v,l(r),t.a(2,{status:!1,data:"",msg:"获取日志数据失败"})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),D=function(){var t=s(i().m(function t(n,e){var r,a;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,xt({screening:j.value.length?j.value.join(","):"",keywords:n||""});case 1:return r=t.v,t.a(2,{data:r.data,status:!0,msg:""});case 2:return t.p=2,a=t.v,l(a),t.a(2,{status:!1,data:"",msg:"获取日志数据失败"})}},t,null,[[0,2]])}));return function(n,e){return t.apply(this,arguments)}}(),E=function(){var t=s(i().m(function t(){var n;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,n={type:2,assort:"mysqlSlow"===F.value?"slow":"error"},t.n=1,a({loading:"正在清空日志,请稍候...",request:yt(n),message:!0});case 1:return t.a(2,{status:!0,msg:"清空日志成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"清空日志失败"})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return{menuOptions:t,currentName:n,searchValue:y,phpData:r,phpChecked:v,logsMsg:g,logPath:m,getMenuList:h,getSoftLog:b,ftpType:d,getFtpMenu:T,getFtpLogStatus:S,startFtpLog:k,getFtpLogData:L,getFtpActionLog:P,renderSysSecurityLog:_,renderSysSafeLog:O,getPluginLogData:x,mysqlActive:F,checkList:j,getErrorMysqlData:D,getMysqlLogsData:C,handleMysqlTabClick:function(t){var n;return"mysqlSlow"===t||"mysqlSlow"===(null===(n=t.props)||void 0===n?void 0:n.name)?C():D()},delMysqlAllLogEvent:E,delAllLogDataEvent:w,delSoftLogEvent:q,refreshPlugin:e}})),nn=v().payment,en=(Zt=tn(),I(Zt)),rn=en.currentName,an=en.logsMsg,un=en.phpChecked,on=en.phpData,cn=en.mysqlActive,ln=(en.ftpType,en.logPath),sn=en.refreshPlugin,fn=tn(),pn=fn.getSoftLog,vn=fn.getFtpMenu,gn=fn.getFtpLogStatus,mn=fn.startFtpLog,dn=fn.getFtpActionLog,yn=fn.getFtpLogData,hn=fn.delMysqlAllLogEvent,bn=fn.delAllLogDataEvent,wn=fn.getMysqlLogsData,Sn=fn.getErrorMysqlData,kn=fn.delSoftLogEvent,Ln=t("w",["Docker","宝塔系统加固","堡塔防入侵"]),Pn=(t("p",{title:"FTP日志-功能介绍",ps:"记录FTP登录记录，FTP上传、下载、重命名和删除记录.",source:131,desc:["FTP登录记录","FTP上传记录","FTP重命名记录","FTP删除记录"],tabImgs:[{title:"FTP日志",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/logs/ftp-logs.png"}]}),t("i",N(!0)));V();var Tn=t("s",N("")),xn=t("b",N("")),On=t("f",N([])),_n=t("e",N(!1)),qn=(t("A",function(){var t=s(i().m(function t(n,e){var r,a;return i().w(function(t){for(;;)switch(t.n){case 0:if(r=Ot(),a=r.selectedItem,rn.value=n.name,a.value=n.name,Tn.value="",!Ln.includes(n.name)){t.n=1;break}return t.a(2,sn.value&&sn.value());case 1:if("Mysql"!==n.name){t.n=2;break}t.n=5;break;case 2:if("FTP"!==n.name){t.n=3;break}t.n=5;break;case 3:return t.n=4,qn(n);case 4:return t.a(2,t.v);case 5:return t.a(2)}},t)}));return function(n,e){return t.apply(this,arguments)}}()),t("q",function(){var t=s(i().m(function t(n,e){var r,a;return i().w(function(t){for(;;)switch(t.n){case 0:return rn.value=n.name,t.n=1,pn(e);case 1:return r=t.v,"Php"===rn.value?(g(r)?on.value=r:on.value=Object.values(r),on.value=on.value.filter(function(t){return t.status}),""===un.value&&(un.value=on.value[0].version),Fn(un.value)):m(r)&&(a=r,ln.value=(null==a?void 0:a.file)||"",an.value=(null==a?void 0:a.msg)||"暂无数据"),t.a(2,r)}},t)}));return function(n,e){return t.apply(this,arguments)}}())),Fn=(t("y",function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d({title:"清空日志【".concat(rn.value,"】"),icon:"warning-filled",type:"calc",content:"风险操作，清空该日志后，将无法查到以往的日志记录，此操作不可逆，是否继续清空？"});case 1:return t.n=2,bn();case 2:qn({name:rn.value});case 3:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),t("z",function(t){var n;null===(n=on.value)||void 0===n||n.forEach(function(n){n.version==t&&(an.value=n.msg,ln.value=n.file)})})),jn=(t("x",function(){return window.open("/download?filename="+ln.value,"_blank","noopener,noreferrer")}),function(){var t=s(i().m(function t(){var n,e,r;return i().w(function(t){for(;;)switch(t.n){case 0:if("ltd"===nn.value.authType){t.n=1;break}return t.a(2);case 1:return t.n=2,vn();case 2:e=t.v,r=e.data,On.value=r.map(function(t){return{label:t.name,value:t.name,key:t.id}}),xn.value=(null===(n=r[0])||void 0===n?void 0:n.name)||"";case 3:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}()),Cn=function(){var t=s(i().m(function t(){var n;return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,gn();case 1:if("stop"!==t.v.data){t.n=4;break}return t.n=2,d({title:"FTP服务",content:"FTP服务未启动，无法获取日志,是否立即开启FTP服务?"});case 2:return t.n=3,mn();case 3:return n=t.v,c.request(n),_n.value=!0,t.a(2,!1);case 4:return t.a(2,!0)}},t)}));return function(){return t.apply(this,arguments)}}(),Dn=(t("r",function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if("ltd"===nn.value.authType){t.n=1;break}return t.a(2,{data:[],total:0,other:{}});case 1:if(!Pn.value){t.n=3;break}return t.n=2,jn();case 2:Pn.value=!1;case 3:return t.p=3,t.n=4,Cn();case 4:if(t.v){t.n=5;break}return t.a(2,{data:[],total:0,other:{}});case 5:if((e=u({},n)).user_name=xn.value,delete e.ftpType,"login"!==n.ftpType){t.n=7;break}return t.n=6,yn(e);case 6:return t.a(2,t.v);case 7:if("action"!==n.ftpType){t.n=9;break}return t.n=8,dn(e);case 8:return t.a(2,t.v);case 9:t.n=11;break;case 10:return t.p=10,t.v,t.a(2,{data:[],total:0,other:{}});case 11:return t.a(2)}},t,null,[[3,10]])}));return function(n){return t.apply(this,arguments)}}()),function(t){return t.TamperProof="网站防篡改",t.Syssafe="宝塔系统加固",t.Security="堡塔防入侵",t.TamperProofRefactored="网站防篡改程序-重构版",t}(Dn||{}));o(o(o(o({Nginx:["Nginx","logs"],Apache:["Apache","logs"]},Dn.TamperProof,"bt_security"),Dn.Syssafe,"syssafe"),Dn.Security,"security"),Dn.TamperProofRefactored,"bt_security");var En,An=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d({title:"删除日志【".concat(rn.value,"】"),type:"calc",content:"风险操作，删除该日志后，将无法查到以往的日志记录，此操作不可逆，是否继续清空？"});case 1:kn(n);case 2:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}(),Mn=(t("j",[{label:"Mysql慢日志",value:"mysqlSlow"},{label:"Mysql错误日志",value:"mysqlError"}]),t("T",[{label:"删除",value:"delete",event:(En=s(i().m(function t(n,e){var r;return i().w(function(t){for(;;)switch(t.n){case 0:return r=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,yt({type:0,id:n.id});case 1:return t.a(2,t.v)}},t)}));return function(n){return t.apply(this,arguments)}}(),t.n=1,n({title:"批量删除",content:"即将删除所选中的日志，是否继续操作?",column:[{prop:"log",label:"日志内容"},Yt()],onConfirm:function(){var t=s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,e(r);case 1:return sn.value(),t.a(2,!1)}},t)}));return function(){return t.apply(this,arguments)}}()});case 1:return t.a(2)}},t)})),function(t,n){return En.apply(this,arguments)})}]),function(){return[Kt(),{label:"用户",prop:"username"},{label:"详情",prop:"log"},{label:"操作时间",prop:"addtime",align:"right"},Ut([{title:"删除",onClick:An}])]}),Rn=(t("o",B(function(){return"宝塔系统加固"===rn.value?function(){return Mn().slice(1)}:function(){return Mn()}})),t("m",N(""))),In=(t("l",[{label:"警告",value:"warning"},{label:"错误",value:"error"},{label:"记录",value:"note"}]),t("k",s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d({title:"清空日志【Mysql".concat("mysqlSlow"===cn.value?"慢日志":"错误日志","】"),icon:"warning-filled",content:"您真的要清空所有【Mysql".concat("mysqlSlow"===cn.value?"慢日志":"错误日志","】吗？")});case 1:return t.n=2,hn();case 2:In();case 3:return t.a(2)}},t)}))),t("h",function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.n){case 0:if(e=null,"mysqlSlow"!==cn.value){t.n=2;break}return t.n=1,wn(n);case 1:e=t.v;case 2:if("mysqlError"!==cn.value){t.n=4;break}return t.n=3,Sn(n);case 3:e=t.v;case 4:Rn.value=e.data||"暂无数据";case 5:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}())),Nn=(t("n",function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.n){case 0:e=n.props,cn.value=e.name,In("");case 1:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),["Mysql","FTP","Docker","宝塔系统加固","堡塔防入侵"]),Vn=(t("v",B(function(){return Nn.includes(rn.value)})),t("L",R("LOG-SITE-STORE",function(){var t=_t(),n=I(t).selectedWebSite,e=N(!1),r=N(!1),o=N(),p=N(!1),v=N(""),g=H({ipArea:!1,typeValue:"access",timeValue:"",searchValue:"",keywordSwitch:!1,keywordConfig:{}}),m=N(),d=H({give:"",keyword:"",cycle:""}),y=N(!1),h=N(!1),b=N(),w=N(),S=N(!1),k=H({site:[]}),L=N(!1),P=N(),T=N([]),x=H({ip:"",id:0,port:""}),O=function(){var t=s(i().m(function t(){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取网站列表，请稍后...",request:qt(),data:{msg:[Array,function(t){o.value=t,n.value=o.value[0]||""}]}});case 1:return e=t.v,t.a(2,{data:e.msg,status:!0});case 2:return t.p=2,t.v,t.a(2,{msg:"获取网站列表失败 ",status:!1})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),_=function(){var t=s(i().m(function t(e,r){var u;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在清理日志中，请稍后....",request:Ft({siteName:n.value,logType:r,time_search:JSON.stringify(e)}),message:!0});case 1:return u=t.v,t.a(2,{status:u.status,msg:u.msg});case 2:return t.p=2,t.v,t.a(2,{msg:"清理失败",status:!1})}},t,null,[[0,2]])}));return function(n,e){return t.apply(this,arguments)}}(),q=function(){var t=s(i().m(function t(e,r){var u;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在导出日志中，请稍后....",request:jt({siteName:n.value,logType:r,time_search:JSON.stringify(e)}),data:{msg:String,status:Boolean}});case 1:return(u=t.v).status&&window.open("/download?filename="+u.msg,"_blank","noopener,noreferrer"),t.a(2,{status:u.status,msg:"导出".concat(u.status?"成功":"失败"),data:u.msg});case 2:return t.p=2,t.v,t.a(2,{msg:"导出失败",status:!1})}},t,null,[[0,2]])}));return function(n,e){return t.apply(this,arguments)}}(),F=function(){var t=s(i().m(function t(e){var r,u;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.value){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,a({loading:p,request:"error"===g.typeValue?Ct(e):Dt(e),data:{msg:String}});case 2:return r=t.v,v.value=(null==r?void 0:r.msg)||"暂无数据",t.a(2,{data:r.msg||"暂无数据",status:!0});case 3:t.p=3,u=t.v,l(u,"getSiteLogsData");case 4:return t.a(2)}},t,null,[[1,3]])}));return function(n){return t.apply(this,arguments)}}(),j=function(){var t=s(i().m(function t(){var e,r,a,o,c;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Et({sitename:n.value});case 1:return a=t.v,o=a.data,g.keywordConfig=o.config,d.give=null===(e=g.keywordConfig.channel)||void 0===e?void 0:e.split(",").filter(function(t){return""!==t}),d.keyword=null===(r=g.keywordConfig.keys)||void 0===r?void 0:r.join(","),d.cycle=g.keywordConfig.cycle,g.keywordSwitch=o.status,t.a(2,{data:u({},d),status:!0});case 2:return t.p=2,c=t.v,l(c,"getKeywordAlarmData"),t.a(2,{msg:"获取关键字告警配置失败",status:!1})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),C=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在设置关键字告警...",request:At(n),message:!0});case 1:return t.a(2,{status:!0,msg:"设置关键字告警成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"设置关键字告警失败"})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),D=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在设置关键字告警配置，请稍后...",request:At(n),message:!0});case 1:return t.a(2,{status:!0,msg:"设置关键字告警成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"设置关键字告警失败"})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),E=function(){var t=s(i().m(function t(){var e,r;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取关键字告警配置，请稍后...",request:Et({sitename:n.value})});case 1:return e=t.v,r=e.data,d.cycle=r.config.cycle,d.keyword=r.config.keys.join(","),""!=r.config.channel&&(d.give=r.config.channel.split(",")),t.a(2,{data:d,status:!0});case 2:return t.p=2,t.v,t.a(2,{msg:"获取关键字告警配置失败",status:!1})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),A=function(){var t=s(i().m(function t(e){var r;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,n.value){t.n=1;break}return t.a(2);case 1:return e.search||(e.search=n.value),t.n=2,a({loading:y,request:Mt({data:JSON.stringify(e)}),data:{data:Array,page:String}});case 2:return r=t.v,t.a(2,{data:r.data,total:f(r.page),other:{}});case 3:return t.p=3,t.v,t.a(2,{data:[],total:0,other:{}})}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}(),M=function(){var t=s(i().m(function t(){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Rt({search:n.value});case 1:return e=t.v,window.open("/download?filename="+e.data.output_file,"_blank","noopener,noreferrer"),t.a(2,{status:!0,msg:"导出成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"导出失败"})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),R=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在删除日志源，请稍候...",request:It(n),message:!0,success:W});case 1:return t.a(2,{status:!0,msg:"删除成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"删除失败"})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),V=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在设置日志系统配置中...",request:n.server_id?Nt(n):Vt(n),message:!0});case 1:return t.a(2,{status:!0,msg:"设置成功"});case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"设置失败"})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),B=function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在设置日志源中...",request:Bt(n)});case 1:return e=t.v,c.request(e.data[0]),S.value=!1,t.a(2,e);case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"设置失败"})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}();N([]);var W=function(){var t=s(i().m(function t(){var n;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:y,request:Ht(),data:Array});case 1:return n=t.v,t.a(2,{data:n,total:n.length,other:{}});case 2:return t.p=2,t.v,t.a(2,{data:[],total:0,other:{}})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),G=function(){var t=s(i().m(function t(){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,a({loading:"正在获取日志服务系统配置中,请稍后...",request:Wt(),data:[Array,T]});case 1:return T.value.length>0&&(x.ip=T.value[0].ip,x.port=T.value[0].port,x.id=T.value[0].id),t.a(2,{data:T.value,status:!0});case 2:return t.p=2,t.v,t.a(2,{msg:"获取日志服务系统配置失败",status:!1})}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return{siteList:o,getSiteList:O,logParams:g,preLoading:p,logMsg:v,logScanForm:m,msgForm:d,getSiteLogsData:F,setKeyWordConfigEvent:C,clearWebLogEvent:_,outWebLogEvent:q,getKeywordAlarmData:j,getScanData:E,tableLoading:y,getOperateLog:A,outLogs:M,sForm:w,logSysForm:P,sendSource:S,logSystemDialog:L,logSystemForm:x,sourceForm:k,logSystemData:b,logSystemLoad:h,logSystemList:T,getLogSystemData:W,getLogSystemSite:G,logSystemConfirm:V,sendSourceConfirm:B,delLogSourceEvent:R,onConfirmKeyConfig:D,isRefreshLogSystem:r,isRefreshList:e}}))),Bn=(t("u",function(){return I(Vn())}),Ot().selectedItem),Hn=t("d",function(t){var n=[],e=new Date,r=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()/1e3,a=Math.floor((new Date).getTime()/1e3);switch(t){case"7":n=[r-604800,a];break;case"30":n=[r-2592e3,a];break;case"180":n=[r-15552e3,a]}return n}),Wn=(t("C",function(){var t=s(i().m(function t(n,e){var r,a;return i().w(function(t){for(;;)switch(t.n){case 0:a=n,t.n="ssh"===a?1:"login"===a?2:"crontab"===a?3:"website"===a?4:5;break;case 1:return $t().outLogs(e),t.a(3,5);case 2:return Gt().outLoginLogEvent(e),t.a(3,5);case 3:return Gt().outShellLogEvent(e),t.a(3,5);case 4:return r=Hn(e.day),Vn().outWebLogEvent(r,e.type),t.a(3,5);case 5:return t.a(2)}},t)}));return function(n,e){return t.apply(this,arguments)}}()),function(t,n){var e="crontab"===n?"id":"name";!function(t,n){switch(n){case"soft":qn(t);break;case"crontab":ze(t)}}(t.find(function(t){return String(t[e])===Bn.value}),n),c.success("刷新成功")}),Gn=t("a",function(t){return Xt(u({type:22,name:"日志",id:999},t))}),Jn={class:"flex items-start w-full"},zn=["onClick","tabindex"],Kn={key:2,class:"menu p-[20px] bg-[#f1f1f120]"},Un={class:"flex-1"},Yn={class:"log-view"},$n={class:"flex items-center"},Xn=W({__name:"index",props:{menuOptions:{default:function(){return[]}},logsType:{default:"pre"},width:{default:"24"},height:{default:"68"},logContent:{default:""}},emits:["tab-click","search"],setup:function(t,n){var r=n.emit,a=v().mainHeight,u=t,o=r,i=_t(),c=I(i),l=c.searchValue,s=(c.logLoading,c.selectedItem),f=B(function(){return"Mysql"===u.logsType?a.value-300:"crontab"===u.logsType?a.value-248:a.value-188}),p=B(function(){return"crontab"===u.logsType?"id":"name"});return G(function(){return u.menuOptions[0]},function(t){t&&(s.value=String(t[p.value]))},{once:!0}),function(t,n){var r=y,a=ot,u=vt;return J(),z("div",Jn,[K("div",{class:at("flex flex-col mr-[16px]"),style:Z("width:".concat(t.width,"rem;"))},["crontab"==t.logsType?(J(),U(r,{key:0,class:"mb-[8px] !w-[24rem]",modelValue:Y(l),"onUpdate:modelValue":n[0]||(n[0]=function(t){return $(l)?l.value=t:null}),onSearch:Y($e),placeholder:"请输入日志名称"},null,8,["modelValue","onSearch"])):X("",!0),t.menuOptions.length>0?(J(),z("div",{key:1,class:"menu",style:Z("height:".concat(Y(f)-("crontab"==t.logsType?56:-5),"px;min-height:400px"))},[(J(!0),z(Q,null,tt(t.menuOptions,function(n,e){return J(),z("span",{onClick:function(t){return o("tab-click",n)},tabindex:e,key:e,style:Z("width:".concat(t.width,"rem")),class:at("menu-hover ".concat(String(n[Y(p)])===Y(s)?"activeClass":""))},it(n.tabProps)+" "+it(n.name),15,zn)}),128))],4)):(J(),z("span",Kn,[nt(a,null,{image:et(function(){return e(n[2]||(n[2]=[K("i",{class:"svgtofont-empty !text-[4.8rem] text-#999"},null,-1)]))}),description:et(function(){return e(n[3]||(n[3]=[rt("暂无数据",-1)]))}),_:1})]))],4),ut(t.$slots,"LogView",{},function(){return[K("div",Un,[K("div",Yn,[K("div",$n,[ut(t.$slots,"LogLeft",{},void 0,!0),K("div",{class:"flex items-center",onClick:n[1]||(n[1]=function(t){return Y(Gn)()})},e(n[4]||(n[4]=[K("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),K("span",{class:"bt-link"},"需求反馈",-1)])))]),ut(t.$slots,"LogRight",{},void 0,!0)]),nt(u,{class:"w-full flex-1",content:t.logContent,isHtml:!0,autoScroll:!0,fullScreen:{title:"全屏查看-日志",onRefresh:function(){Y(Wn)(t.menuOptions,t.logsType)}},style:Z("height:"+Y(f)+"px;min-height:400px")},null,8,["content","fullScreen","style"])])]},!0)])}}}),Zn=t("B",h(Xn,[["__scopeId","data-v-3db3875f"]])),Qn={class:"flex items-center"},te={key:0,class:"flex items-center inline-block"},ne=W({__name:"crontab-log",setup:function(t){var n=v().mainHeight,r=Gt(),a=I(r),u=a.logsMsg,o=a.currentItem,c=a.crontabForm;return ct(s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,$e();case 1:return t.n=2,ze(Ce.value[0]);case 2:return t.a(2)}},t)}))),function(t,r){var a=lt,i=b,l=st,s=M;return J(),z("div",{class:"flex items-start",style:Z({height:Y(n)-195+"px",minHeight:"400px"})},[nt(Zn,{logsType:"crontab","menu-options":Y(Ce),logContent:Y(u),onTabClick:Y(ze),onSearch:Y($e)},{LogLeft:et(function(){return[nt(a,{class:"!mr-[12px]",onClick:r[0]||(r[0]=function(t){return Y(Ke)(Y(o))})},{default:et(function(){return e(r[7]||(r[7]=[rt(" 清理日志 ",-1)]))}),_:1}),Y(De)?(J(),U(a,{key:0,onClick:Y(Ye)},{default:et(function(){return e(r[8]||(r[8]=[rt(" 导出日志 ",-1)]))}),_:1},8,["onClick"])):X("",!0)]}),LogRight:et(function(){return[K("div",Qn,[Y(De)?(J(),z("div",te,[nt(i,{class:"mr-[12px]",type:"button",onChange:r[1]||(r[1]=function(t){return Y(ze)(Y(o))}),modelValue:Y(c).type,"onUpdate:modelValue":r[2]||(r[2]=function(t){return Y(c).type=t}),options:Y(Je)},null,8,["modelValue","options"]),nt(l,{modelValue:Y(c).time_search,"onUpdate:modelValue":r[3]||(r[3]=function(t){return Y(c).time_search=t}),format:"YYYY/MM/DD","value-format":"x",onChange:r[4]||(r[4]=function(t){return Y(ze)(Y(o))}),onClear:r[5]||(r[5]=function(t){return Y(ze)(Y(o))}),type:"daterange",placement:"bottom-end","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])):X("",!0),nt(s,{class:"ml-8px",onRefresh:r[6]||(r[6]=function(t){return Y(ze)(Y(o))})})])]}),_:1},8,["menu-options","logContent","onTabClick","onSearch"])],4)}}}),ee={class:"flex items-center"},re={class:"ml-1rem"},ae=W({__name:"login-log",setup:function(t){v();var r=Gt().getLoginLogsEvent,a=P(),o=function(){var t=s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d();case 1:a.success("刷新成功");case 2:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),c=w({options:[{label:"刷新日志",type:"button",onClick:o},{label:"导出日志",type:"button",onClick:function(){We(h.data)}},{label:"清空日志",type:"button",onClick:function(){He(d)}}]}).BtOperation,l=S({options:Ee,key:"login_type"}),f=k({request:function(t){var e=t.p,a=function(t,n){if(null==t)return{};var e,r,a=function(t,n){if(null==t)return{};var e={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==n.indexOf(r))continue;e[r]=t[r]}return e}(t,n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(r=0;r<u.length;r++)e=u[r],-1===n.indexOf(e)&&{}.propertyIsEnumerable.call(t,e)&&(a[e]=t[e])}return a}(t,n);return r(u({page:e},a))},columns:[{label:"IP地址（归属地）",prop:"remote_addr",minWidth:100,render:function(t){var n;return nt("span",null,[t.remote_addr,rt("("),(null==t||null===(n=t.area)||void 0===n?void 0:n.info)||"",rt(")")])}},{label:"用户代理",width:800,prop:"user_agent"},{label:"登录状态",render:function(t){return nt("span",{class:"text-".concat(t.login_type?"primary":"danger")},[rt("登录"),t.login_type?"成功":"失败"])}},{label:"时间",width:150,prop:"login_time",sortable:!0,align:"right",render:function(t){return L(t.login_time)}}],extension:[l]}),p=f.BtTable,g=f.BtSearch,m=f.BtPage,d=f.refresh,y=f.BtRadioButton,h=f.config;return function(t,n){var r=zt;return J(),U(r,null,{"header-left":et(function(){return[K("div",ee,[nt(Y(c)),K("div",{class:"flex items-center ml-1rem",onClick:n[0]||(n[0]=function(t){return Y(Gn)()})},e(n[1]||(n[1]=[K("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),K("span",{class:"bt-link"},"需求反馈",-1)])))])]}),"header-right":et(function(){return[nt(Y(y)),K("div",re,[nt(Y(g),{class:"w-[32rem]",placeholder:"请输入搜索关键字"})])]}),content:et(function(){return[nt(Y(p),{onSortChange:Y(Be)},null,8,["onSortChange"])]}),"footer-right":et(function(){return[nt(Y(m))]}),_:1})}}}),ue={class:"flex items-center"},oe=W({__name:"operate-log",setup:function(t){v();var n=P(),r=function(){var t=s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,m();case 1:n.success("刷新成功");case 2:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),a=w({options:[{type:"button",label:"刷新日志",onClick:r},{type:"button",label:"导出日志",onClick:function(){if(!h.data.length)return c.error("暂无数据导出");Me({search:y.value.search})}},{type:"button",label:"清空日志",onClick:function(){return Ie(m)}},{type:"button",label:"IP操作统计",onClick:Ve}]}).BtOperation,o=T({options:Ae,key:"log_type",other:{placeholder:"请选择分类",filterable:!0,class:"!w-16rem mr-1rem "}}),l=k({request:function(t){return Re(u(u({},t),{},{table:"logs"}))},columns:[{label:"用户",prop:"username",width:180},{label:"操作类型",prop:"type",width:100,sortable:!0},{label:"详情",render:function(t){var n=(new DOMParser).parseFromString(t.log,"text/html");return nt("span",{innerHTML:x(n.body.innerHTML)},null)}},{label:"操作时间",width:150,prop:"addtime",align:"right",sortable:!0}],extension:[o]}),f=l.BtTable,p=l.BtSearch,g=l.BtPage,m=l.refresh,d=l.BtTableSelect,y=l.param,h=l.config;return function(t,n){var r=zt;return J(),U(r,null,{"header-left":et(function(){return[K("div",ue,[nt(Y(a)),K("div",{class:"flex items-center ml-1rem",onClick:n[0]||(n[0]=function(t){return Y(Gn)()})},e(n[1]||(n[1]=[K("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),K("span",{class:"bt-link"},"需求反馈",-1)])))])]}),"header-right":et(function(){return[nt(Y(d)),nt(Y(p),{class:"!w-[28rem]",placeholder:"请输入搜索关键字"})]}),content:et(function(){return[nt(Y(f))]}),"footer-right":et(function(){return[nt(Y(g))]}),_:1})}}}),ie={class:"flex items-center justify-between mb-[12px]"},ce={class:"flex items-center"},le={class:"ml-[1.6rem]"},se={class:"inline-flex items-center"},fe=W({__name:"run-log",setup:function(t){var n=v().mainHeight,r=Gt(),a=I(r),u=a.search,o=a.logMsg,c=a.size,l=r.getRunDataEvent,f=P(),p=function(){var t=s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,l();case 1:f.success("刷新成功");case 2:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),g=w({options:[{label:"刷新日志",type:"button",onClick:p},{label:"清空日志",type:"button",onClick:function(){return Ge()}}]}).BtOperation;return ct(l),function(t,r){var a=y;return J(),z("div",null,[K("div",ie,[K("div",ce,[nt(Y(g)),K("span",le,"日志大小："+it(Y(O)(Y(c))),1),K("div",{class:"flex items-center ml-1rem",onClick:r[0]||(r[0]=function(t){return Y(Gn)()})},e(r[2]||(r[2]=[K("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),K("span",{class:"bt-link"},"需求反馈",-1)])))]),K("div",se,[nt(a,{modelValue:Y(u),"onUpdate:modelValue":r[1]||(r[1]=function(t){return $(u)?u.value=t:null}),onSearch:Y(l),placeholder:"请输入搜索关键字",class:"!w-[30rem]"},null,8,["modelValue","onSearch"])])]),nt(vt,{content:Y(o),isHtml:!0,autoScroll:!0,fullScreen:{title:"全屏查看-运行日志",onRefresh:Y(l)},style:Z("height:".concat(Y(n)-240,"px;min-height:40rem"))},null,8,["content","fullScreen","style"])])}}}),pe=Gt(),ve=pe.getLogsMenu,ge=pe.outWebSiteEvent,me=pe.getLogsInfoEvent,de=pe.clearRunLogsEvent,ye=pe.clearOpLogsEvent,he=pe.getLogsDataEvent,be=pe.clearShellLogEvent,we=(pe.outShellLogEvent,pe.getIpDataEvent),Se=(pe.outLoginLogEvent,pe.clearLoginLogEvent),ke=Ot(),Le=ke.clearDataForm,Pe=ke.outDataForm,Te=ke.configData,xe=ke.selectedItem,Oe=Jt(),_e=Oe.currentItem,qe=Oe.isRefreshList,Fe=Oe.crontabForm,je=_t(),Ce=N([]),De=N(!1),Ee=(t("t",[{label:"操作日志",name:"operateLog",render:function(){return nt(oe,null,null)}},{label:"登录日志",name:"loginLog",lazy:!0,render:function(){return nt(ae,null,null)}},{label:"运行日志",name:"runLog",lazy:!0,render:function(){return nt(fe,null,null)}},{label:"计划任务日志",name:"crontabLog",lazy:!0,render:function(){return nt(ne,null,null)}}]),[{label:"全部",value:""},{label:"登录成功",value:"1"},{label:"登录失败",value:"0"}]),Ae=[{label:"全部",value:"全部"},{label:"网站管理",value:"网站管理"},{label:"用户登录",value:"用户登录"},{label:"数据库管理",value:"数据库管理"},{label:"FTP管理",value:"FTP管理"},{label:"文件管理",value:"文件管理"},{label:"安装器",value:"安装器"},{label:"软件管理",value:"软件管理"},{label:"守护程序",value:"守护程序"},{label:"面板设置",value:"面板设置"},{label:"进程管理",value:"进程管理"},{label:"面板配置",value:"面板配置"},{label:"PHP配置",value:"PHP配置"},{label:"计划任务",value:"计划任务"},{label:"防火墙管理",value:"防火墙管理"}],Me=(t("c",function(t){}),function(){var t=s(i().m(function t(n,e){var r,a;return i().w(function(t){for(;;)switch(t.n){case 0:if(r=n.search,!r){t.n=1;break}return t.n=1,d({title:"导出日志",icon:"warning-filled",content:"是否导出关键字为【".concat(r,"】的面板操作日志？")});case 1:return t.n=2,ge(r);case 2:a=t.v,window.open("/download?filename="+a.data.output_file,"_blank","noopener,noreferrer");case 3:return t.a(2)}},t)}));return function(n,e){return t.apply(this,arguments)}}()),Re=function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,(e=n).search||delete e.search,"全部"===e.log_type&&(e.log_type=""),t.n=1,me(e);case 1:return t.a(2,t.v);case 2:return t.p=2,t.v,t.a(2,{data:[],total:0,other:{}})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),Ie=function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d({icon:"warning-filled",type:"input",title:"清空面板操作日志",input:{content:"清空日志"},content:"风险操作，清空该日志后，将无法查询面板以往的操作记录，是否继续操作？"});case 1:return t.n=2,ye();case 2:e=t.v,n&&n(e);case 3:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}(),Ne=[{label:"IP地址",prop:"ip"},{label:"IP属地",prop:"info"},{label:"操作次数",prop:"operation_num"}],Ve=function(){var t=s(i().m(function t(){var n,e;return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,we();case 1:n=t.v,(e=n.data).sort(function(t,n){return n.operation_num-t.operation_num}),_({title:"IP操作统计",area:60,component:function(){return nt("div",{class:"p-20px"},[ft(nt(q,{"max-height":"360",column:Ne,data:e},null),[[pt("bt-loading"),"ipLoading"],[pt("bt-loading"),"'正在加载表格数据,请稍后...'","title"]])])}});case 2:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),Be=function(t,n){t.column;var e=t.prop,r=t.order,a=F(function(t,n){return"ascending"===n?D(E(t)):A(E(t))}(e,r),n);return{data:a,total:a.length,other:{}}},He=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,d({icon:"warning-filled",type:"input",title:"清空面板登录日志",input:{content:"清空日志"},content:"风险操作，清空该日志后，将无法查到以往的日志记录，此操作不可逆，是否继续清空？"});case 1:return t.n=2,Se();case 2:qe.value=!0,n&&n(),t.n=4;break;case 3:t.p=3,t.v;case 4:return t.a(2)}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}(),We=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.n){case 0:if(0!==n.length){t.n=1;break}return t.a(2,c.error("暂无数据导出"));case 1:Pe.value.type=je.getType("login"),Te.value={type:"login"},_({title:"导出日志",area:44,component:function(){return C(function(){return r.import("./index-legacy278.js?v=1756369731")},void 0,r.meta.url)},showFooter:!0});case 2:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}(),Ge=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,d({icon:"warning-filled",title:"清空面板运行日志",type:"calc",content:"风险操作，清空该日志后，将无法查到以往的日志记录，此操作不可逆，是否继续清空？"});case 1:return t.n=2,de();case 2:return t.a(2,t.v)}},t)}));return function(n){return t.apply(this,arguments)}}(),Je=[{label:"全部",value:""},{label:"异常",value:"warring"}],ze=function(){var t=s(i().m(function t(n){var e,r,a,u,o,l,s,f,p;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,j(n,"object",!1,null,!0)){t.n=1;break}return t.a(2,c.error("当前未选定日志数据"));case 1:return _e.value=n,xe.value=String(n.id),De.value="webshell"===n.sType,e=Fe.value,r=e.type,a=e.time_search,u=[],g(o=a)&&o.length&&(u=[o[0]/1e3,o[1]/1e3]),l={type:r,id:n.id,time_search:JSON.stringify(u)},t.n=2,he(l);case 2:s=t.v,f=s.status,p=s.msg,f||c.error(p),t.n=4;break;case 3:return t.p=3,t.v,t.a(2,{data:"获取日志错误!",status:!1});case 4:return t.a(2)}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}(),Ke=function(){var t=s(i().m(function t(n){return i().w(function(t){for(;;)switch(t.n){case 0:_({title:"清理【"+n.name+"】日志",area:44,component:function(){return C(function(){return r.import("./index-legacy321.js?v=1756369731")},void 0,r.meta.url)},compData:{tips:"",type:"crontab",clearEvent:function(){return Ue()}},showFooter:!0});case 1:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}(),Ue=function(){var t=s(i().m(function t(n){var e,r;return i().w(function(t){for(;;)switch(t.n){case 0:return e=Le.value.day,t.n=1,d({icon:"warning-filled",type:"calc",title:"清空日志",content:"清空".concat("all"!==e?e+"天外":"","日志后，将无法查询").concat("all"!==e?e+"天外":"","日志记录，此操作不可逆，是否继续清理？")});case 1:return t.n=2,be({id:_e.value.id,day:"all"===e?"":e});case 2:return r=t.v,qe.value=!0,t.a(2,r)}},t)}));return function(n){return t.apply(this,arguments)}}(),Ye=function(){var t=s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:Pe.value.type=_t().getType("crontab"),Te.value={type:"crontab"},_({title:"导出日志",area:44,component:function(){return C(function(){return r.import("./index-legacy278.js?v=1756369731")},void 0,r.meta.url)},compData:{type:"crontab"},showFooter:!0});case 1:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),$e=function(){var t=s(i().m(function t(n){var e;return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ve(n);case 1:e=t.v,Ce.value=e.data;case 2:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()}}})}();
