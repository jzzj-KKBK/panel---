import{K as e,bv as t,R as r,k as a,gK as s,fU as l}from"./utils-lib.js?v=1756369731";import{_ as i}from"./index103.js?v=1756369731";import{c as o,r as n,p as d,q as m,v as c,y as u,F as v,a_ as f,x as p,e as b,M as x,A as y,n as g,B as h,av as _,J as k,z as w}from"./base-lib.js?v=1756369731";import{ac as j}from"./firewall.js?v=1756369731";import{i as S,m as A,o as L}from"./useMethod6.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./column.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore5.js?v=1756369731";import"./validator.js?v=1756369731";const E={class:"flex"},F={class:"w-[60%] mr-4"},R={class:"flex ml-[0.2rem] mb-[1.6rem]"},T={class:"flex items-center mb-[1.2rem] text-[#999]"},z={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem]"},C={key:0,class:"w-full h-[32rem] flex items-center justify-center"},M={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem] mt-[1.6rem]"},W={key:0,class:"w-full h-[32rem] flex items-center justify-center"},D={class:"flex-1 ml-4"},P={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem]"},q={key:0,class:"w-full h-[24rem]"},I={key:1,class:"w-full h-[24rem] flex items-center justify-center"},K={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem] mt-[1.6rem]"},N={class:"w-full h-[24rem]"},O={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem] mt-[1.6rem]"},B={key:0,class:"w-full h-[24rem]"},G={key:1,class:"w-full h-[24rem] flex items-center justify-center"},H=o({__name:"index",setup(o){const H=n(),J=n(),U=n(),Q=n(!1),V=n({}),X=n([]),Y=n([]),Z=n([]),$=n(),ee=n(),te=(e={})=>{let t=[],r=[],a=[];for(var s=0;s<e.length&&!(s>=5);s++){var i=e[s];r.push(i.site_name),t.push(i.end_time-i.start_time),a.push(i.scans)}return{legend:{left:"left",data:["耗时","检测页面"]},grid:{left:45,top:50,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e.length?"检测网站: "+e[0].name+(2===e.length?"</br>耗时: "+l(e[0].value)+"</br>检测页面数量: "+e[1].value:e[0].seriesIndex?"</br>检测页面数量: "+e[0].value:"</br>耗时: "+l(e[0].value)):""}},xAxis:{type:"category",data:r,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>6?e.substr(0,6)+"...":e}}},yAxis:{type:"value"},series:[{type:"bar",name:"耗时",barWidth:24,data:t,itemStyle:{color:"#fcc858"}},{type:"bar",name:"检测页面",barWidth:24,data:a,itemStyle:{color:"#8dcf6e"}}]}},re=(e={})=>{var t,a;return{grid:{left:45,right:15,top:50,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e[0].name+"</br>风险次数: "+Number(e[0].value||0)}},xAxis:{type:"category",boundaryGap:!1,data:null==(t=Object.keys(e))?void 0:t.map(e=>e).sort((e,t)=>new Date(e).getTime()<new Date(t).getTime()?-1:1),axisLabel:{fontSize:10,color:"#666",formatter:e=>r(new Date(e).getTime()/1e3,"MM-dd")}},axisLabel:{fontSize:10,color:"#666"},axisLine:{show:!1},axisTick:{show:!1},yAxis:{type:"value",splitNumber:5,name:"风险次数/次",min:0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{fontSize:10,color:"#666"}},series:[{type:"line",smooth:.6,data:null==(a=Object.values(e))?void 0:a.map(e=>e),areaStyle:{normal:{}},itemStyle:{normal:{color:"#FF8585",lineStyle:{color:"#FF8585",type:"solid"}}}}]}},ae=(e={})=>{for(var t=[],r=[],a=0;a<e.length&&!(a>=6);a++){var s=e[a];t.push(s.words),r.push(s.count)}return{grid:{top:10,left:60,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:e=>"敏感词: "+e[0].name+"</br>次数: "+e[0].value},xAxis:{type:"value"},yAxis:{type:"category",data:t,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>4?e.substr(0,4)+"...":e}}},series:[{type:"bar",data:r,barWidth:20,itemStyle:{color:function(e){return["#ffa688","#ffc87d","#98caa5","#acce9b","#cad48f"][e.dataIndex]}}}]}},se=[{label:"巡检时间",prop:"time",render:e=>{const a=t(e.time,"number",0);return b("span",null,[r(a)])}},{label:"检测域名",prop:"site_name"},{label:"检测方式",prop:"method",render:e=>A[e.method]},{label:"检测页面数",prop:"scans"},{label:"巡检结果",render:e=>[0===e.risks?b("span",{class:"text-[#20a53a]"},[h("无风险 ")]):b("span",{class:"bt-link !text-danger",onClick:()=>L(e)},[e.risks])]}],le=S();return d(async()=>{var r,a;const s=await e({loading:"正在获取数据，请稍后...",request:j()});V.value=s.data,Y.value=t(null==(r=null==s?void 0:s.data)?void 0:r.site_info,"array",[]),Z.value=t(null==(a=null==s?void 0:s.data)?void 0:a.risk_info,"array",[]),X.value=[{title:"监控网站",value:V.value.site_count},{title:"总风险次数",value:V.value.risk_count},{title:"今日风险次数",value:V.value.day_risk},{title:"今日巡检次数",value:V.value.today_count}],g(()=>{var e,t;$.value=null==s?void 0:s.data["7day_risk"],Q.value=!(null==(e=null==s?void 0:s.data)?void 0:e.sensitive_word.length),ee.value=null==(t=null==s?void 0:s.data)?void 0:t.sensitive_word})}),(e,t)=>{const r=_,l=a,o=i,n=s;return m(),c("div",E,[u("div",F,[u("div",R,[(m(!0),c(v,null,f(p(X),(e,t)=>(m(),c("div",{key:t,class:k("block-bg "+(t>0?"ml-[5rem]":""))},[u("div",T,[u("span",null,w(e.title),1)]),u("div",{class:k("font-bold text-[2rem] leading-none "+(0!==t&&3!==t&&e.value>0?"text-[#fe7d2e]":"text-[#666]"))},w(e.value),3)],2))),128))]),u("div",z,[t[0]||(t[0]=u("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"网站内容检测",-1)),0===p(Y).length?(m(),c("div",C,[b(r,{description:"网站内容检测为空"})])):(m(),x(o,{key:1},{content:y(()=>[b(l,{"max-height":"320",column:se,data:p(Y)},null,8,["data"])]),_:1}))]),u("div",M,[t[1]||(t[1]=u("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"风险动态",-1)),0===p(Z).length?(m(),c("div",W,[b(r,{description:"风险动态为空"})])):(m(),x(o,{key:1},{content:y(()=>[b(l,{"max-height":"320",column:p(le),data:p(Z)},null,8,["column","data"])]),_:1}))])]),u("div",D,[u("div",P,[t[2]||(t[2]=u("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"风险历史",-1)),p(Y).length?(m(),c("div",q,[b(n,{ref_key:"riskEchartRef",ref:H,options:te(p(Y))},null,8,["options"])])):(m(),c("div",I,[b(r,{description:"风险历史数据为空"})]))]),u("div",K,[t[3]||(t[3]=u("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"近7日巡检情况",-1)),u("div",N,[b(n,{ref_key:"dayRiskEchartRef",ref:J,options:re(p($))},null,8,["options"])])]),u("div",O,[t[4]||(t[4]=u("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"敏感词排行",-1)),p(Q)?(m(),c("div",G,[b(r,{description:"敏感词排行数据为空"})])):(m(),c("div",B,[b(n,{ref_key:"sensitiveWordEchartRef",ref:U,options:ae(p(ee))},null,8,["options"])]))])])])}}});export{H as default};
