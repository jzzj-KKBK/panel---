import{c as a,r as e,G as l,q as t,v as s,e as u,A as n,x as r,P as o,y as m,B as d,C as i,F as v,a_ as c,M as p,H as w,aA as f,T as h,ai as y,aj as b,D as x}from"./base-lib.js?v=1756369731";import{B as g}from"./index140.js?v=1756369731";import{u as V,K as _,al as j,b as C}from"./utils-lib.js?v=1756369731";import{getFileBody as B,getErrorConfig as S,setErrorConfig as k}from"./site.js?v=1756369731";import{S as q}from"./useStore4.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./ace.js?v=1756369731";const D={class:"flex flex-col"},G={class:"flex items-center justify-between mb-[8px]"},U={key:0},z={class:"h-[44rem] w-full"},F=a({__name:"default-page",setup(a,{expose:F}){const{saveFileEvent:H}=q(),A=C(),{plugin:E}=V(),{webserver:K}=E.value,I=e("/www/server/panel/data/defaultDoc.html"),M=e(""),N=e(),P=e("utf-8"),R=e(["utf-8","GBK","GB2312","BIG5"]),T=e(!1),J=e(!1),L=async()=>{try{J.value=!0;const{data:a}=await B({path:I.value});M.value=a.data,P.value=a.encoding||"utf-8",J.value=!1}catch(a){}},O=async a=>{try{J.value=!0,I.value=a,await L(),"/www/server/panel/data/404.html"===a&&Q(),J.value=!1}catch(e){}finally{J.value=!1}},Q=async()=>{const{status:a}=await _({request:S(),data:{status:String}});T.value=Boolean(Number(a))},W=a=>{_({loading:"正在设置，请稍后...",request:k({status:a?1:0}),message:!0})},X=async()=>{const a=await H({path:I.value,data:M.value,encoding:P.value});A.request(a)};return F({onRefresh:()=>{I.value="/www/server/panel/data/defaultDoc.html",L()}}),(a,e)=>{const V=f,_=j,C=h,B=y,S=b,k=g,q=x,F=l("bt-loading");return t(),s("div",D,[u(_,{type:"card",modelValue:r(I),"onUpdate:modelValue":e[0]||(e[0]=a=>o(I)?I.value=a:null),onChange:O},{default:n(()=>[u(V,{label:"新建网站默认页面",name:"/www/server/panel/data/defaultDoc.html"}),u(V,{label:"404错误页",name:"/www/server/panel/data/404.html",lazy:!0}),u(V,{label:"网站不存在页",name:"/www/server/"+r(K)+"/"+("nginx"===r(K)?"html":"htdocs")+"/index.html",lazy:!0},null,8,["name"]),u(V,{label:"网站停用后的提示页",name:"/www/server/stop/index.html",lazy:!0})]),_:1},8,["modelValue"]),m("div",G,["/www/server/panel/data/404.html"===r(I)?(t(),s("div",U,[u(C,{modelValue:r(T),"onUpdate:modelValue":e[1]||(e[1]=a=>o(T)?T.value=a:null),onChange:W},{default:n(()=>[...e[4]||(e[4]=[d("开启404错误页设置",-1)])]),_:1},8,["modelValue"])])):i("",!0),e[5]||(e[5]=d(" 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ",-1)),u(S,{class:"!w-[16rem]",modelValue:r(P),"onUpdate:modelValue":e[2]||(e[2]=a=>o(P)?P.value=a:null),onChange:X},{default:n(()=>[(t(!0),s(v,null,c(r(R),a=>(t(),p(B,{key:a,value:a,label:a},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),w((t(),s("div",z,[u(k,{ref_key:"aceEditor",ref:N,"file-path":r(I),modelValue:r(M),"onUpdate:modelValue":e[3]||(e[3]=a=>o(M)?M.value=a:null),onSave:X,class:"h-[40rem] w-full"},null,8,["file-path","modelValue"]),u(q,{class:"flex !mt-[12px]",type:"primary",onClick:X},{default:n(()=>[...e[6]||(e[6]=[d("保存",-1)])]),_:1})])),[[F,r(J)]])])}}});export{F as default};
