import{_ as e}from"./index130.js?v=1756369731";import{G as r,bg as a,j as t}from"./utils-lib.js?v=1756369731";import{c as s,g as l,e as u,T as i,B as m,D as o,q as p,v as n,x as d,F as v,M as c,A as b,z as y,C as g,y as x,J as f}from"./base-lib.js?v=1756369731";import{u as w,S as h}from"./useStore4.js?v=1756369731";import{i as _,h as j,p as V,a as k,o as C,m as E,b as I}from"./useController14.js?v=1756369731";const F={key:1,class:"bg-[#7F7F7F] flex items-center justify-center min-h-[60rem]"},q={class:"bg-white px-[48px] py-[16px] text-[#333] flex"},B=s({__name:"index",setup(s,{expose:B}){const{isBindExtranet:U,siteInfo:N}=w(),{jumpTabEvent:P}=h(),{BtForm:S,submit:T}=r({data:_,options:e=>l(()=>{var r;return[{type:"custom",render:()=>u(a,{label:"是否启用"},{default:()=>[u(i,{modelValue:e.value.value,"onUpdate:modelValue":r=>e.value.value=r,onChange:r=>j(r,e.value)},{default:()=>[m("启用流量控制")]})]})},{type:"select",label:"限制方案",key:"type",options:V.value,attrs:{style:"width: 24rem;",onChange:r=>{const{perserver:a,perip:t,limit_rate:s}=V.value[r].items;e.value.perserver=a,e.value.perip=t,e.value.limit_rate=s}}},{type:"custom",render:()=>u(a,{label:"并发限制",prop:"perserver"},{default:()=>[u(t,{modelValue:e.value.perserver,"onUpdate:modelValue":r=>e.value.perserver=r,type:"number",width:"24rem",class:"mr-1rem"},null),u("div",{class:"text-[#999] text-[1.2rem]"},[m("* 限制当前站点最大并发数")])]}),rules:{perserver:[{required:!0,message:"请输入并发限制",trigger:"blur"},{validator:(e,r,a)=>{r>65535&&a(new Error("不能大于65535")),Number.isInteger(1*r)?a():a(new Error("输入必须为整数"))}}]}},{type:"custom",render:()=>u(a,{label:"单IP限制",prop:"perip"},{default:()=>[u(t,{modelValue:e.value.perip,"onUpdate:modelValue":r=>e.value.perip=r,type:"number",width:"24rem",class:"mr-1rem"},null),u("span",{class:"text-[#999] text-[1.2rem]"},[m("* 限制单个IP访问最大并发数")])]}),rules:{perip:[{required:!0,message:"请输入单IP限制",trigger:"blur"},{validator:(e,r,a)=>{r>65535&&a(new Error("不能大于65535")),Number.isInteger(1*r)?a():a(new Error("输入必须为整数"))}}]}},{type:"custom",render:()=>u(a,{label:"流量限制",prop:"limit_rate"},{default:()=>[u(t,{modelValue:e.value.limit_rate,"onUpdate:modelValue":r=>e.value.limit_rate=r,type:"number",width:"24rem",class:"mr-1rem"},null),u("span",{class:"text-[#999] text-[1.2rem]"},[m("* 限制每个请求的流量上限（单位：KB）")])]}),rules:{limit_rate:[{required:!0,message:"请输入流量限制",trigger:"blur"},{validator:(e,r,a)=>{Number.isInteger(1*r)?a():a(new Error("输入必须为整数"))}}]}},...(null==(r=N.value)?void 0:r.id)&&!k.value?[{type:"custom",render:()=>u(a,{label:" "},{default:()=>[u(o,{type:"primary",onClick:T},{default:()=>[e.value.value?"保存":"保存并启用"]})]})}]:[]]}),submit:async(e,r)=>(await r(),await C(e.value))});return B({onConfirm:T}),(r,a)=>{const t=e;return p(),n("div",{class:f(["h-full",{"p-2rem":d(k)}])},[d(U)?(p(),n(v,{key:0},[d(E)?(p(),c(t,{key:0,width:"36rem"},{content:b(()=>[m(y(d(I)),1)]),_:1})):g("",!0),u(d(S))],64)):(p(),n("div",F,[x("div",q,[a[1]||(a[1]=m(" 请开启 ",-1)),x("span",{class:"mx-[.4rem] bt-link",onClick:a[0]||(a[0]=e=>d(P)("mapping"))}," 外网映射 "),a[2]||(a[2]=m(" 后查看流量限制 ",-1))])]))],2)}}});export{B as _};
