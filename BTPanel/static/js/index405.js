import{c as a,s as e,q as s,v as t,e as l,j as o,r as i,k as n,y as r,x as u,A as d,B as m,z as c,al as v,ba as p}from"./base-lib.js?v=1756369731";import{k as f,u as g,aq as _,K as h,a3 as y,e as b}from"./utils-lib.js?v=1756369731";import{u as w}from"./useController5.js?v=1756369731";import{F as x,G as j,H as k,I as L,J as C,K as q,L as I,M as T}from"./useMethod5.js?v=1756369731";import{p as B,k as E}from"./validator.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./site.js?v=1756369731";import"./column.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore4.js?v=1756369731";import"./useController6.js?v=1756369731";const N={class:"p-[2rem]"},P=a({__name:"basic-setting",setup:a=>(e(R()),(a,e)=>{const o=f;return s(),t("div",N,[l(o)])})}),R=o("WP-PROTECTION-STORE",()=>{const a=i(!1);return{file:n({status:!1,number:0,pid:-1}),fileLoad:i(!1),firewall:n({status:!1,number:0}),firewallLoad:i(!1),hotlink:i(!1),hotlinkLoad:i(!1),pid:i(-1),tabActive:i("basic"),tabComponent:[{name:"basic",label:"基本设置",component:P}],isRefreshBasicList:a}}),{file:z,fileLoad:A,firewall:O,firewallLoad:F,hotlink:H,hotlinkLoad:K,pid:M}=e(R()),{localRow:S}=e(w()),{payment:W}=g(),G=async a=>{try{if(A.value=!0,"ltd"!==W.value.authType)return void B({disablePro:!0,sourceId:334});const{data:e}=await _({sName:"tamper_core"});if(!e.setup)return E({type:"i",name:"tamper_core"});a?await h({request:x({paths:[{path:S.value.path,ps:S.value.ps}]}),loading:"正在开启文件保护...",message:!0}):await h({request:j({path_id:z.value.pid}),loading:"正在关闭文件保护...",message:!0}),U()}finally{A.value=!1}},J=async a=>{try{if(F.value=!0,"ltd"!==W.value.authType)return void B({disablePro:!0,sourceId:334});const{data:e}=await _({sName:"btwaf"});if(!e.setup)return E({type:"i",name:"btwaf"});a?await h({request:k({site_name:S.value.name}),loading:"正在开启防火墙设置...",message:!0}):await h({request:L({site_name:S.value.name}),loading:"正在关闭防火墙设置...",message:!0}),U()}finally{F.value=!1}},D=async a=>{try{K.value=!0;const{data:e}=await C({id:S.value.id,name:S.value.name});if(y(e)){const s={id:S.value.id,name:S.value.name,fix:e.fix,domains:e.domains,return_rule:e.return_rule,status:a,http_status:"true"===e.http_status};await q(s),H.value=!!a}}finally{K.value=!1}},Q=a=>{A.value=a,F.value=a,K.value=a},U=async()=>{try{Q(!0);const{data:{msg:a}}=await I({id:S.value.id,path:S.value.path,site_name:S.value.name});if(y(a)&&(z.value.status=1===a.file_status,z.value.number=a.file_count,O.value.status=1===a.firewall_status,O.value.number=a.firewall_count,H.value=1===a.hotlink_status,1===a.file_status)){const{data:{msg:a}}=await T({path:S.value.path});y(a)&&(z.value.pid=a.pid)}}finally{Q(!1)}},V={class:"p-[2rem]"},X={class:"tools-card"},Y={class:"tools-desc flex items-center"},Z={class:"tools-card"},$={class:"tools-desc"},aa={class:"tools-card"},ea=b(a({__name:"index",setup(a){const{file:o,fileLoad:i,firewall:n,firewallLoad:f,hotlink:g,hotlinkLoad:_}=e(R());return U(),(a,e)=>{const h=v,y=p;return s(),t("div",V,[r("div",X,[e[1]||(e[1]=r("div",{class:"tools-img"},[r("span",{class:"svgtofont-tamper-pro !text-[2rem]",style:{color:"#20a50a"}})],-1)),e[2]||(e[2]=r("div",{class:"tools-name"},"防篡改",-1)),l(h,{"model-value":u(o).status,loading:u(i),onChange:u(G)},null,8,["model-value","loading","onChange"]),e[3]||(e[3]=r("i",{class:"svgtofont-icon-ltd !text-[2rem] text-[#9B7E48]"},null,-1)),r("div",Y,[l(y,{type:"danger",size:"small",bordered:!1},{default:d(()=>[m(c(u(o).number),1)]),_:1}),e[0]||(e[0]=r("span",{class:"ml-[.5rem]"}," 今天的修改被阻止 ",-1))])]),r("div",Z,[e[5]||(e[5]=r("div",{class:"tools-img"},[r("span",{class:"svgtofont-left-waf !text-[2.4rem] text-primary"})],-1)),e[6]||(e[6]=r("div",{class:"tools-name"},"Nginx WAF",-1)),l(h,{"model-value":u(n).status,loading:u(f),onChange:u(J)},null,8,["model-value","loading","onChange"]),e[7]||(e[7]=r("i",{class:"svgtofont-icon-ltd !text-[2rem] text-[#9B7E48]"},null,-1)),r("div",$,[l(y,{type:"danger",size:"small",bordered:!1},{default:d(()=>[m(c(u(n).number),1)]),_:1}),e[4]||(e[4]=r("span",{class:"ml-[.5rem]"}," 恶意请求今天被阻止 ",-1))])]),r("div",aa,[e[8]||(e[8]=r("div",{class:"tools-img"},[r("span",{class:"svgtofont-el-link !text-[2.4rem]",style:{color:"#20a50a"}})],-1)),e[9]||(e[9]=r("div",{class:"tools-name"},"防盗链",-1)),l(h,{"model-value":u(g),loading:u(_),onChange:u(D)},null,8,["model-value","loading","onChange"])])])}}}),[["__scopeId","data-v-e5fa6708"]]);export{ea as default};
