import{_ as a}from"./index103.js?v=1756369731";import{K as e,o as s,k as t,b as i}from"./utils-lib.js?v=1756369731";import{c as r,U as o,k as l,p as n,G as p,q as m,v as d,e as c,A as h,x as u,B as f,H as b,D as _}from"./base-lib.js?v=1756369731";import{_ as g}from"./index101.js?v=1756369731";import{bh as j,bi as y,bj as v}from"./firewall.js?v=1756369731";import{u as w}from"./column.js?v=1756369731";import{f as x}from"./validator.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const k={class:"p-[2rem]"},q=r({__name:"index",setup(r){const q=i(),C=o([]),H=l({path:"",type:"dir"}),V=async()=>{e({request:j(),data:{"msg.scan_dir":[Array,a=>{C.value=a.map(a=>({path:a}))}]}})},A=async()=>{H.path?(await e({request:v({dir:H.path}),loading:"正在添加检测目录，请稍后...",message:!0}),V(),H.path=""):q.error("请填写检测目录")},U=[{label:"所在目录",prop:"path"},w([{onClick:async a=>{await s({icon:"question-filled",title:"删除检测目录",width:"34rem",content:"删除检测目录【"+a.path+"】，是否继续操作？"}),await e({request:y({path:JSON.stringify([a.path])}),loading:"正在删除检测目录，请稍后...",message:!0}),V()},title:"删除",isHide:a=>["/bin/","/sbin/","/usr/bin/","/usr/sbin/"].includes(a.path)}])];return n(()=>{V()}),(e,s)=>{const i=g,r=_,o=t,l=a,n=p("bt-loading");return m(),d("div",k,[c(l,null,{"header-left":h(()=>[c(i,{modelValue:u(H).path,"onUpdate:modelValue":s[0]||(s[0]=a=>u(H).path=a),name:"path",placeholder:"选择目录",icon:"icon-file_mode",onIconClick:s[1]||(s[1]=a=>{x({type:"dir",path:"/",change(a,e){a=a.replace(/\/\//g,"/"),H.path=a,H.type=e}})}),onChangePassive:s[2]||(s[2]=a=>{var e;H[e="path"]=H[e].replace(/\s+/g,"")}),width:"32rem"},null,8,["modelValue"]),c(r,{type:"primary",class:"!ml-[.8rem]",onClick:A},{default:h(()=>[...s[3]||(s[3]=[f(" 添加 ",-1)])]),_:1})]),content:h(()=>[b(c(o,{ref:"detecList",column:U,data:u(C),description:"检测列表为空"},null,8,["data"]),[[n,"正在加载检测列表，请稍后...","title"]])]),_:1})])}}});export{q as default};
