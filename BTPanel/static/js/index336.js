import{j as e,r as a,k as r,s as l,a5 as s,c as u,n as o,q as t,v as d,e as i,A as p,y as n,x as v,S as f,a9 as m,al as c,a7 as _}from"./base-lib.js?v=1756369731";import{iH as w,iI as y,b,ag as V}from"./utils-lib.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const g=e("MAIL_BCC_ADD",()=>{const e=(e,a,r)=>{if(!a)return r(new Error("邮箱不能为空"));if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(a))return r(new Error("请输入正确的邮箱格式"));r()};return{formRef:a(),form:r({user:"",forward_user:"",type:"sender",active:1}),propsData:a({}),typeOptions:[{label:"发送时抄送",value:"sender"},{label:"接收时抄送",value:"recipient"}],rules:{user:[{required:!0,validator:e,trigger:"blur"}],forward_user:[{required:!0,validator:e,trigger:"blur"}],type:[{required:!0,message:"请选择抄送类型",trigger:"change"}]}}}),{form:x,formRef:D,propsData:A}=l(g()),h=b(),j=async e=>{var a;let r;await(null==(a=D.value)?void 0:a.validate());const{isEdit:l,row:u,onRefresh:o}=A.value;r=l&&u?await w({user:u.user,type:u.type,forward_user:u.forward_user,type_new:x.value.type,forward_user_new:x.value.forward_user,active_new:x.value.active}):await y(s(x.value));const{data:t}=r;h.request(t),t.status&&(e(),o&&o())},q=e=>{const{row:a,isEdit:r}=e;A.value=e,x.value.user="",x.value.forward_user="",x.value.type="sender",x.value.active=1,r&&a&&(x.value.user=a.user,x.value.forward_user=a.forward_user,x.value.type=a.type,x.value.active=a.active)},E={class:"p-20px"},R={class:"w-300px"},U={class:"w-300px"},k={class:"w-300px"},z=u({__name:"index",props:{compData:{}},setup(e,{expose:a}){const{form:r,propsData:s,formRef:u}=l(g()),{rules:w,typeOptions:y}=g(),b=e;return o(()=>{q(b.compData)}),a({onConfirm:j}),(e,a)=>{const l=f,o=m,b=V,g=c,x=_;return t(),d("div",E,[i(x,{ref_key:"formRef",ref:u,model:v(r),rules:v(w)},{default:p(()=>[i(o,{label:"被抄送者",prop:"user"},{default:p(()=>[n("div",R,[i(l,{modelValue:v(r).user,"onUpdate:modelValue":a[0]||(a[0]=e=>v(r).user=e),disabled:v(s).isEdit,placeholder:"输入需要密抄用户的邮箱"},null,8,["modelValue","disabled"])])]),_:1}),i(o,{label:"抄送到",prop:"forward_user"},{default:p(()=>[n("div",U,[i(l,{modelValue:v(r).forward_user,"onUpdate:modelValue":a[1]||(a[1]=e=>v(r).forward_user=e),placeholder:"输入您需要收到密抄的邮箱"},null,8,["modelValue"])])]),_:1}),i(o,{label:"抄送类型",prop:"type"},{default:p(()=>[n("div",k,[i(b,{modelValue:v(r).type,"onUpdate:modelValue":a[2]||(a[2]=e=>v(r).type=e),options:v(y)},null,8,["modelValue","options"])])]),_:1}),i(o,{label:"开启","show-feedback":!1},{default:p(()=>[i(g,{modelValue:v(r).active,"onUpdate:modelValue":a[3]||(a[3]=e=>v(r).active=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])}}});export{z as default};
