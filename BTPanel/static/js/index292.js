import{u as a,K as e,M as s,l as t,L as o,k as l,W as r}from"./utils-lib.js?v=1756369731";import{_ as n}from"./index103.js?v=1756369731";import{u as i}from"./column.js?v=1756369731";import{c as p,ay as m,P as d,r as u,e as c,aB as _,al as f,w as g,G as b,q as w,v as x,A as y,H as j,x as h}from"./base-lib.js?v=1756369731";import{$ as q,a0 as v,Z as k}from"./firewall.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const A=p({__name:"index",setup(p){a();const A=m("infoData"),C=m("getIntrusionInfo",()=>{}),D=d(!1),I=u(),O=[{content:"开启防提权，系统会针对该用户操作命令进行限制，并记录跟踪"},{content:"不开启防提权，系统只针对该用户操作过的命令做记录跟踪"},{content:"目前防提权默认只针对www,redis,mysql操作引起的提权问题进行处理"},{class:"text-[#FF6500]",content:"消息推送需要更新至最新面板的版本(2020-06-17日之后安装的版本|或者2020-06-17日之后点击过修复面板)"}],T=[{label:"用户",prop:"0"},{label:"总次数",prop:"4",render:a=>c("span",{class:a[4].totla>0?"!text-danger":""},[a[4].totla])},{label:"当日次数",prop:"4",render:a=>c("span",{class:a[4].day_totla>0?"!text-danger":""},[a[4].day_totla])},{label:"防入侵",prop:"3",render:a=>_(f,{modelValue:a[3],size:"small",onChange:s=>(async(a,s)=>{await e({loading:"正在"+(s?"开启":"关闭")+"防入侵，请稍后...",request:q(!a[3],{user:a[0]}),message:!0}),C()})(a,s)})},{label:"日志状态",prop:"5",render:(a,s)=>_(f,{modelValue:a[5],size:"small",onChange:s=>(async(a,s,t)=>{await e({loading:"正在"+(t?"开启":"关闭")+"日志状态，请稍后...",request:v(!a[5],{uid:a[1]}),message:!0}),C()})(a,0,s)})},{label:"描述",prop:"6",showOverflowTooltip:!0},i([{onClick:async a=>{const l=await e({loading:"正在获取日志，请稍后...",request:k({user:a[0]}),data:Array});if(!l.length)return s.error("当前暂无日志");t({title:"命令日志",area:72,component:()=>o(()=>import("./index459.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{user:a[0],dateTime:l[0],dateOptions:l.map(a=>({title:a,key:a}))}})},title:"命令日志",width:70}])];return g(()=>A.value,a=>{a&&(I.value=a.system_user)},{immediate:!0,deep:!0}),(a,e)=>{const s=l,t=n,o=r,i=b("bt-loading");return w(),x("div",null,[c(t,null,{content:y(()=>[j(c(s,{ref:"table",column:T,data:h(I),description:"概览列表为空"},null,8,["data"]),[[i,h(D)],[i,"正在加载概览列表，请稍后...","title"]])]),popup:y(()=>[...e[0]||(e[0]=[])]),_:1}),c(o,{options:O,class:"mx-[1.6rem]"})])}}});export{A as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
