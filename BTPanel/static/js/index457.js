import{c as e,bI as a,k as s,r as l,p as t,q as n,v as c,e as r,A as o,x as u,B as m,y as d,al as i,a9 as p,a7 as f}from"./base-lib.js?v=1756369731";import{_ as y}from"./validator.js?v=1756369731";import{u as _,K as h,j as b,b as v,e as j}from"./utils-lib.js?v=1756369731";import{aV as V,aW as x}from"./firewall.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const w={class:"p-[2rem]"},k=j(e({__name:"index",emits:["close"],setup(e,{expose:j,emit:k}){const g=k,{payment:q}=_(),{authType:S}=q.value,U=a("alarmSelectRef"),C=v(),I=s({cycle:"0",channel:[],status:!1}),R=l(),T=l(!1),A=async(e=!1)=>{const{data:a}=await h({request:V()});I.cycle=a.cycle,I.channel=""===a.channel?[]:a.channel.split(","),I.status=!!a.status,e&&C.success("刷新成功")},B=()=>{var e;null==(e=U.value)||e.refresh(),A(!0)};return j({onConfirm:async()=>{if("ltd"!==S)return C.error("抱歉！该功能为企业版专享功能！");I.channel=I.channel.filter(e=>e);let e=I.channel.join(",");e||!I.status?(await R.value.validate(),h({loading:T,request:x({day:Number(I.cycle),channel:e,status:I.status?1:0}),message:!0,success:e=>{e.status&&(A(),g("close"))}})):C.error("请选择告警方式")}}),t(()=>{A()}),(e,a)=>{const s=i,l=p,t=b,_=y,h=f;return n(),c("div",w,[r(h,{model:u(I),ref_key:"safeScanForm",ref:R,disabled:u(T)},{default:o(()=>[r(l,{label:"自动扫描"},{default:o(()=>[r(s,{modelValue:u(I).status,"onUpdate:modelValue":a[0]||(a[0]=e=>u(I).status=e)},null,8,["modelValue"])]),_:1}),r(l,{label:"周期",prop:"cycle"},{default:o(()=>[r(t,{class:"!w-[14rem]",modelValue:u(I).cycle,"onUpdate:modelValue":a[1]||(a[1]=e=>u(I).cycle=e),min:0,type:"number",textType:"天"},{append:o(()=>[...a[3]||(a[3]=[m(" 天 ",-1)])]),_:1},8,["modelValue"])]),_:1}),r(l,{label:"告警方式",prop:"give"},{default:o(()=>[r(_,{ref_key:"alarmSelectRef",ref:U,class:"!w-[36rem]",modelValue:u(I).channel,"onUpdate:modelValue":a[2]||(a[2]=e=>u(I).channel=e),limit:["sms","wx_account"]},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),d("div",{class:"tip"},[d("ul",null,[d("li",null,[a[4]||(a[4]=m(" 点击配置后状态未更新，尝试点击【 ",-1)),d("span",{class:"text-[#20a53a] hover:text-[#1d9534] cursor-pointer",onClick:B},"手动刷新"),a[5]||(a[5]=m(" 】 ",-1))])])])])}}}),[["__scopeId","data-v-d424a63c"]]);export{k as default};
