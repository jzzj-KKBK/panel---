import{at as e,K as a,o as l,j as t,c as s,h as o,b as r,W as n,G as i,aM as u,l as p,L as m,k as c,a0 as d,a2 as _,e as v}from"./utils-lib.js?v=1756369731";import{c as h,r as f,k as g,w as y,p as b,aD as w,q as x,v as V,x as k,M as j,A as C,B as N,C as P,y as q,e as U,F as H,a_ as z,z as T,P as I,ai as O,aj as A,D as E,a9 as S,a$ as R,a7 as D,G as B,H as G,T as M,a4 as F,I as L,al as W,s as J,j as K,g as $,ax as Q,S as X,bq as Y,U as Z}from"./base-lib.js?v=1756369731";import{u as ee}from"./useStore4.js?v=1756369731";import{_ as ae}from"./index116.js?v=1756369731";import{_ as le}from"./index101.js?v=1756369731";import{_ as te}from"./index130.js?v=1756369731";import{f as se,k as oe}from"./validator.js?v=1756369731";import{getComposerVersion as re,updateComposer as ne,deleteComposerFile as ie,execComposer as ue,getComposerLine as pe,setTomcatSettings as me,getSitePhpVersion as ce,setPhpSiteGzip as de,removePhpSiteGzip as _e,getPhpSiteGzip as ve,setSecurityHeaders as he,getSecurityHeaders as fe,getCrossOriginAccess as ge,setCrossOriginAccess as ye,deleteCrossOriginAccess as be,getCrontabList as we,modifyCrontabStatus as xe,startTaskCrontab as Ve,removeCrontab as ke}from"./site.js?v=1756369731";import{_ as je}from"./index.vue_vue_type_script_setup_true_lang13.js?v=1756369731";import{h as Ce}from"./form-item.js?v=1756369731";import{_ as Ne}from"./index.vue_vue_type_script_setup_true_lang25.js?v=1756369731";import{_ as Pe}from"./index103.js?v=1756369731";import{a as qe,b as Ue,u as He,c as ze}from"./column.js?v=1756369731";import Te from"./index456.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";import"./index112.js?v=1756369731";import"./index123.js?v=1756369731";const Ie={class:"p-1rem"},Oe={class:"flex items-center"},Ae={key:0,class:"text-danger"},Ee={key:1,class:"text-danger text-[1.2rem]"},Se={class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},Re={key:0},De={class:"p-2rem h-50rem flex flex-col"},Be={class:"mb-1rem"},Ge={class:"flex-1 overflow-auto"},Me=h({__name:"index",setup(n,{expose:i}){var u;const{siteInfo:p}=ee(),m=null==(u=p.value)?void 0:u.project_type,c=r(),d=f(!1),_=f(!1),v=g({path:p.value.path,user:"phpasync"!==m?"www":"root",php:["静态","其它"].includes(p.value.php_version)?"auto":"PHP-"+p.value.php_version.replace(".",""),otherCommand:"",mirror:"https://mirrors.aliyun.com/composer/",command:"install",composerVersion:"install",version:"2.7.3",help_tips:"",comp_json:"",comp_lock:"",phpVersion:[],commandOptions:[{label:"install",value:"install"},{label:"update",value:"update"},{label:"require",value:"require"},{label:"create-project",value:"create-project"},{label:"自定义",value:""}]}),h=f("正在执行..."),B=f(!1),G=f(),M=f(!1);y(()=>p.value,e=>{v.php=["静态","其它"].includes(e.php_version)?"auto":"PHP-"+e.php_version.replace(".","")},{immediate:!0});const F=async a=>{d.value=!0;try{const e=await re({path:a||p.value.path});e.data.status?(_.value=!1,v.phpVersion=e.data.php_versions.filter(e=>"00"!==e.version),v.phpVersion.unshift({name:"自动选择",version:"auto"}),v.comp_json=!1,v.comp_lock=!1,"string"==typeof e.data.comp_json&&(v.comp_json=e.data.comp_json),"string"==typeof e.data.comp_lock&&(v.comp_lock=e.data.comp_lock)):(_.value=!0,c.request(e))}catch(l){e(l)}finally{d.value=!1}},L=()=>{se({type:"dir",path:v.path,change:e=>{v.path=e,F(v.path)}})},W=()=>{a({loading:"正在更新，请稍后...",request:ne(),message:!0,success:e=>{e.status&&F(v.path)}})},J=async()=>{a({loading:"正在删除，请稍后...",request:ie({path:v.path+"/composer.lock"}),message:!0,success:e=>{e.status&&F(v.path)}})},K=async()=>{var e;let t={php_version:null==(e=v.php)?void 0:e.replace("PHP-",""),composer_args:v.command,composer_cmd:v.otherCommand,repo:v.mirror,path:v.path,user:v.user,composer_version:v.version,siteName:p.value.name};await l({title:"执行composer命令",content:"即将执行设定的composer命令，继续吗？",icon:"warning-filled"}),a({loading:"正在执行，请稍后...",request:ue(t),message:!0,success:e=>{e.status&&(B.value=!0,(async()=>{G.value=setInterval(async()=>{try{$()}catch(e){clearInterval(G.value)}},2e3)})())}})},$=async(a=!1)=>{try{const e=await pe({filename:"/tmp/composer_".concat(p.value.name,".log"),num:100});h.value=e.data.msg,a&&c.success("刷新成功")}catch(l){e(l)}},Q=()=>{M.value=!0,$()},X=()=>{clearInterval(G.value),B.value=!1,M.value=!1,h.value=""};return b(F),i({init:F}),w(()=>{clearInterval(G.value)}),(e,a)=>{const l=te,r=O,n=A,i=E,u=S,p=t,c=le,d=s,f=R,g=D,y=ae,b=o;return x(),V("div",null,[k(_)?(x(),j(l,{key:0,width:"28rem",options:{name:"composer",title:"composer"}},{default:C(()=>[...a[11]||(a[11]=[N(" 没有找到可用的composer版本 ",-1)])]),_:1})):P("",!0),q("div",Ie,[U(g,{model:k(v)},{default:C(()=>[U(u,{label:"Composer版本"},{default:C(()=>[q("div",Oe,[U(n,{modelValue:k(v).version,"onUpdate:modelValue":a[0]||(a[0]=e=>k(v).version=e),class:"!w-[28rem]"},{default:C(()=>[U(r,{label:"2.7.3",value:"2.7.3"}),U(r,{label:"1.10.27",value:"1.10.27"})]),_:1},8,["modelValue"]),U(i,{type:"default",class:"!ml-1rem",onClick:W},{default:C(()=>[...a[12]||(a[12]=[N(" 升级Composer ",-1)])]),_:1})])]),_:1}),U(u,{label:"PHP版本"},{default:C(()=>["phpasync"!==k(m)?(x(),j(n,{key:0,class:"!w-[28rem]",modelValue:k(v).php,"onUpdate:modelValue":a[1]||(a[1]=e=>k(v).php=e)},{default:C(()=>[(x(!0),V(H,null,z(k(v).phpVersion,(e,a)=>(x(),j(r,{key:a,label:e.name,value:e.version},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(x(),j(p,{key:1,modelValue:k(v).php,"onUpdate:modelValue":a[2]||(a[2]=e=>k(v).php=e),disabled:""},null,8,["modelValue"]))]),_:1}),U(u,{label:"执行参数"},{default:C(()=>[U(n,{class:"!w-[28rem]","empty-values":[null,void 0],modelValue:k(v).command,"onUpdate:modelValue":a[3]||(a[3]=e=>k(v).command=e)},{default:C(()=>[(x(!0),V(H,null,z(k(v).commandOptions,(e,a)=>(x(),j(r,{key:a,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),U(u,{label:"补充命令"},{default:C(()=>[U(p,{modelValue:k(v).otherCommand,"onUpdate:modelValue":a[4]||(a[4]=e=>k(v).otherCommand=e),placeholder:"请输入补充命令",width:"28rem"},null,8,["modelValue"])]),_:1}),U(u,{label:"镜像源"},{default:C(()=>[U(n,{modelValue:k(v).mirror,"onUpdate:modelValue":a[5]||(a[5]=e=>k(v).mirror=e),filterable:"","allow-create":"","default-first-option":"",class:"!w-[28rem]"},{default:C(()=>[U(r,{label:"阿里云(mirrors.aliyun.com)",value:"https://mirrors.aliyun.com/composer/"}),U(r,{label:"官方源(packagist.org)",value:"repos.packagist"}),U(r,{label:"中国全量镜像(packagist.phpcomposer.com)",value:"https://packagist.phpcomposer.com"}),U(r,{label:"Packagist Mirror(packagist.mirrors.sjtug.sjtu.edu.cn)",value:"https://packagist.mirrors.sjtug.sjtu.edu.cn"}),U(r,{label:"腾讯源(mirrors.tencent.com)",value:"https://mirrors.tencent.com/composer/"}),U(r,{label:"华为云(mirrors.huaweicloud.com)",value:"https://mirrors.huaweicloud.com/repository/php/"})]),_:1},8,["modelValue"])]),_:1}),"phpasync"!==k(m)?(x(),j(u,{key:0,label:"执行用户",prop:"command"},{default:C(()=>[U(n,{modelValue:k(v).user,"onUpdate:modelValue":a[6]||(a[6]=e=>k(v).user=e),class:"!w-28rem"},{default:C(()=>[U(r,{label:"www(推荐)",value:"www"}),U(r,{label:"root(不推荐)",value:"root"})]),_:1},8,["modelValue"])]),_:1})):P("",!0),U(u,{label:"执行目录",prop:"composerVersion"},{default:C(()=>[U(c,{modelValue:k(v).path,"onUpdate:modelValue":a[7]||(a[7]=e=>k(v).path=e),icon:"el-folder-opened",onIconClick:L,width:"28rem"},null,8,["modelValue"])]),_:1}),U(u,{label:" ",prop:"composerVersion"},{default:C(()=>[q("div",null,[k(v).comp_lock?(x(),V("span",Ae,[N(T(k(v).comp_lock)+" ",1),U(d,{onClick:J},{default:C(()=>[...a[13]||(a[13]=[N("[点击删除]",-1)])]),_:1})])):P("",!0),k(v).comp_json?(x(),V("span",Ee,T(k(v).comp_json),1)):P("",!0)])]),_:1}),U(u,{label:" "},{default:C(()=>[U(i,{type:"primary",disabled:!!("boolean"!=typeof k(v).comp_json&&k(v).comp_json||"boolean"!=typeof k(v).comp_lock&&k(v).comp_lock),onClick:K},{default:C(()=>[...a[14]||(a[14]=[N(" 执行 ",-1)])]),_:1},8,["disabled"]),U(f,{direction:"vertical",class:"!h-1rem !mx-2rem"}),U(i,{onClick:Q},{default:C(()=>[...a[15]||(a[15]=[N("查看日志",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),q("ul",Se,[a[16]||(a[16]=q("li",null,"Composer是PHP主流依赖包管理器，若您的项目使用Composer管理依赖包，可在此处对依赖进行升级或安装",-1)),a[17]||(a[17]=q("li",null,"Composer版本：当前安装的Composer版本，可点击右侧的【升级Composer】将Composer升级到最新稳定版",-1)),a[18]||(a[18]=q("li",null,"PHP版本：用于执行composer的PHP版本，无特殊要求，默认即可，如安装出错，可尝试选择其它PHP版本",-1)),a[19]||(a[19]=q("li",null,"执行参数：按需选择执行参数,可配合补充命令使用",-1)),a[20]||(a[20]=q("li",null,"补充命令：若此处为空，则按composer.json中的配置执行，此处支持填写完整composer命令",-1)),a[21]||(a[21]=q("li",null,"镜像源：提供【阿里源】和【官方源】，建议国内服务器使用【阿里源】，海外服务器使用【官方源】",-1)),"phpasync"!==k(m)?(x(),V("li",Re,"执行用户：默认为www用户，除非您的网站以root权限运行，否则不建议使用root用户执行composer")):P("",!0),a[22]||(a[22]=q("li",null,"执行目录：默认为当前网站根目录",-1))])]),U(b,{title:"请执行完毕确认结果无误后关闭此窗口",onCancel:X,modelValue:k(B),"onUpdate:modelValue":a[8]||(a[8]=e=>I(B)?B.value=e:null),area:[50,42]},{default:C(()=>[U(y,{class:"h-full",title:"全屏查看composer执行日志",content:k(h),isHtml:!0,isRefreshBtn:!1,isAuto:!0},null,8,["content"])]),_:1},8,["modelValue"]),U(b,{title:"composer执行日志",onCancel:X,modelValue:k(M),"onUpdate:modelValue":a[10]||(a[10]=e=>I(M)?M.value=e:null),area:60},{default:C(()=>[q("div",De,[q("div",Be,[U(i,{type:"primary",onClick:a[9]||(a[9]=e=>$(!0))},{default:C(()=>[...a[23]||(a[23]=[N(" 刷新日志 ",-1)])]),_:1})]),q("div",Ge,[U(y,{class:"h-full",title:"全屏查看composer执行日志",content:k(h),isHtml:!0,isRefreshBtn:!1},null,8,["content"])])])]),_:1},8,["modelValue"])])}}}),Fe={class:"p-1rem relative"},Le={class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},We={key:0},Je=h({__name:"index",setup(e,{expose:l}){const{siteInfo:t}=ee(),o=f(!1),r=f(!1),n=g({tomcat:!1}),i=f(""),u=()=>{a({loading:"正在设置，请稍后...",request:me({siteName:t.value.name}),message:!0,success:e=>{e.status&&p()}})},p=async()=>{a({loading:o,request:ce({siteName:t.value.name}),success:e=>{n.tomcat=e.data.tomcat>0,r.value=!e.data.tomcatversion,i.value=e.data.tomcatversion}})},m=()=>{oe({name:"tomcat",type:"i"})};return b(p),l({init:p}),(e,a)=>{const l=s,t=te,p=M,c=B("bt-loading");return G((x(),V("div",null,[k(r)?(x(),j(t,{key:0,width:"28rem"},{content:C(()=>[a[2]||(a[2]=N(" 请先安装tomcat， ",-1)),U(l,{onClick:m,class:"!text-[1.2rem]"},{default:C(()=>[...a[1]||(a[1]=[N(" 立即安装 ",-1)])]),_:1})]),_:1})):P("",!0),q("div",Fe,[U(p,{modelValue:k(n).tomcat,"onUpdate:modelValue":a[0]||(a[0]=e=>k(n).tomcat=e),onChange:u},{default:C(()=>[...a[3]||(a[3]=[N(" 启用Tomcat ",-1)])]),_:1},8,["modelValue"]),q("ul",Le,[k(i)?(x(),V("li",We,"当前版本为Tomcat"+T(k(i))+" ,若您需要其它版本,请到软件商店- 所有软件 中切换；",1)):P("",!0),a[4]||(a[4]=q("li",null,"部署顺序: 安装Tomcat >> 创建站点 >> 上传并配置项目 >> 启用Tomcat",-1)),a[5]||(a[5]=q("li",null,"若您的tomcat应用中有php脚本,访问时请添加.php扩展名",-1)),a[6]||(a[6]=q("li",null,"开启成功后,大概需要1-5分钟时间生效!",-1))])])])),[[c,k(o)]])}}}),{siteInfo:Ke}=ee(),$e=f(),Qe=f(!1),Xe=f(!1),Ye=f(!0),Ze=g({status:!1,gzip_types:"",comp_level:1,min_length:1,unit:"k"}),ea=[{label:"k",value:"k"},{label:"m",value:"m"}],aa=[{content:"用于对 HTTP 响应的内容进行压缩，以减少数据传输量，提高网站性能和加载速度"},{content:"压缩级别1-9，越高压缩率越高，但也更消耗CPU"},{content:"如果开启gzip后影响网站正常访问，请关闭此功能 和请求参数组成"}],la={gzip_types:[{required:!0,message:"请输入压缩类型",trigger:["blur","change"]}],min_length:[{required:!0,message:"请输入正确的压缩最小长度",trigger:"blur",validator:(e,a,l)=>{a?isNaN(Number(a))?l(new Error("请输入数字")):Number(a)<1?l(new Error("请输入正确数字")):l():l(new Error("压缩最小长度不能为空"))}},{}]},ta=async()=>{await $e.value.validate();const{gzip_types:e,comp_level:l,min_length:t,unit:s}=Ze,o={site_name:Ke.value.name,gzip_types:e,comp_level:l,min_length:"".concat(t).concat(s)};await a({loading:Xe,request:de(o),message:!0})},sa=async()=>{if(!Ze.status)return await a({loading:Xe,request:_e({site_name:Ke.value.name})});oa()},oa=async()=>{await a({loading:Xe,request:ve({site_name:Ke.value.name}),success:e=>{const{gzip_types:a,comp_level:l,min_length:t}=e.data;Object.assign(Ze,{gzip_types:a,comp_level:l,min_length:t.slice(0,-1),unit:t.slice(-1)}),Ye.value&&(Ze.status=e.data.status,Ye.value=!1)}})},ra={class:"p-[20px]"},na={class:"mt-[1.6rem]"},ia={class:"flex items-center"},ua={class:"ml-[20px]"},pa=h({__name:"index",setup:e=>(b(()=>{oa()}),F(()=>{Ye.value=!0}),(e,a)=>{const l=W,s=S,o=t,r=O,i=A,u=E,p=D,m=n,c=B("bt-loading");return x(),V("div",ra,[G((x(),j(p,{ref_key:"compressFormRef",ref:$e,class:"h-[38rem]",model:k(Ze),rules:k(la),"label-width":"100px",disabled:k(Xe)},{default:C(()=>[U(s,{label:"内容压缩",prop:"status"},{default:C(()=>[U(l,{modelValue:k(Ze).status,"onUpdate:modelValue":a[0]||(a[0]=e=>k(Ze).status=e),onChange:k(sa)},null,8,["modelValue","onChange"])]),_:1}),G(q("div",na,[U(s,{label:"压缩类型",prop:"gzip_types"},{default:C(()=>[U(o,{modelValue:k(Ze).gzip_types,"onUpdate:modelValue":a[1]||(a[1]=e=>k(Ze).gzip_types=e),type:"textarea",width:"42rem",rows:6,resize:"none"},null,8,["modelValue"])]),_:1}),U(s,{label:"压缩级别",prop:"comp_level"},{default:C(()=>[U(i,{class:"!w-[42rem]",modelValue:k(Ze).comp_level,"onUpdate:modelValue":a[2]||(a[2]=e=>k(Ze).comp_level=e)},{default:C(()=>[(x(),V(H,null,z(9,e=>U(r,{key:e,label:e,value:String(e)},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),U(s,{label:"压缩最小长度",prop:"min_length"},{default:C(()=>[q("div",ia,[U(o,{modelValue:k(Ze).min_length,"onUpdate:modelValue":a[3]||(a[3]=e=>k(Ze).min_length=e)},null,8,["modelValue"]),U(s,{prop:"unit"},{default:C(()=>[U(i,{class:"ml-[1rem] !w-[8rem]",modelValue:k(Ze).unit,"onUpdate:modelValue":a[4]||(a[4]=e=>k(Ze).unit=e),placeholder:"请选择"},{default:C(()=>[(x(!0),V(H,null,z(k(ea),e=>(x(),j(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1})],512),[[L,k(Ze).status]]),G(U(s,{label:" ",class:"mt-[1.6rem]"},{default:C(()=>[U(u,{type:"primary",onClick:k(ta)},{default:C(()=>[...a[5]||(a[5]=[N("保存",-1)])]),_:1},8,["onClick"])]),_:1},512),[[L,k(Ze).status]])]),_:1},8,["model","rules","disabled"])),[[c,k(Qe)]]),q("div",ua,[U(m,{options:k(aa)},null,8,["options"])])])})}),ma={class:"px-2rem"},ca={class:"ml-[8px]"},da=h({__name:"index",setup(e,{expose:l}){const{siteInfo:t}=ee(),s=f(!1),o=f([{help:"阻止浏览器上下文中执行恶意JavaScript代码",value:!1,field:"x_xss_protection"},{help:"阻止浏览器的内容嗅探",value:!1,field:"x_content_type_options"},{help:"让浏览器跳转时不携带referrer",value:!1,field:"referrer_policy"},{help:"让浏览器加载内容时只加载自己网站的内容",value:!1,field:"content_security_policy"},{help:"防止浏览器进行用户行为跟踪",value:!1,field:"permissions_policy"}]),r=()=>{let e={};o.value.forEach(a=>{e[a.field]=a.value});const l={site_name:t.value.name,security_info:JSON.stringify(e)};a({loading:"正在设置，请稍后...",request:he(l),message:!0,success:e=>{e.status&&n()}})},n=()=>{a({loading:s,request:fe({site_name:t.value.name}),success:e=>{o.value.forEach(a=>{e.data[a.field]&&(a.value=e.data[a.field])})}})};return b(n),l({init:n}),(e,a)=>{const l=W,t=B("bt-loading");return G((x(),V("div",ma,[(x(!0),V(H,null,z(k(o),(e,a)=>(x(),V("div",{key:a,class:"flex items-center mb-[12px]"},[U(l,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,onChange:r},null,8,["modelValue","onUpdate:modelValue"]),q("span",ca,T(e.help),1)]))),128))])),[[t,k(s)]])}}}),_a=K("CROSS-ORIGIN-ACCESS-STORE",()=>{const e=f({status:!1,siteName:null,project_type:null,allowed_origin:null,allowed_methods:null,allowed_headers:null,exposed_headers:null,allow_credentials:!1});return{formData:e,reset:()=>{e.value.status=!1,e.value.siteName=null,e.value.project_type=null,e.value.allowed_origin=null,e.value.allowed_methods=null,e.value.allowed_headers=null,e.value.exposed_headers=null,e.value.allow_credentials=!1}}}),va=()=>J(_a()),{formData:ha}=va(),fa=async e=>{a({request:ge({siteName:e.siteName,project_type:e.project_type}),loading:"正在获取跨域访问配置...",success:({data:a})=>{ha.value.siteName=e.siteName,ha.value.project_type=e.project_type,ha.value.status=a.status,ha.value.allowed_origin=a.allowed_origins,ha.value.allowed_methods=a.allow_methods,ha.value.allowed_headers=a.allow_headers,ha.value.exposed_headers=a.expose_headers,ha.value.allow_credentials=a.allow_credentials}})},ga=async e=>{ha.value.status?(async e=>{a({request:ye(e),loading:"正在设置跨域访问配置...",message:!0,success:a=>{a.status&&fa({siteName:e.siteName,project_type:e.project_type})}})})(e):(async e=>{a({request:be({siteName:e.siteName,project_type:e.project_type}),loading:"正在删除跨域访问配置...",message:!0,success:a=>{a.status&&fa({siteName:e.siteName,project_type:e.project_type})}})})(e)},ya={class:"w-full"},ba=h({__name:"index",setup(e){const{siteInfo:a}=ee(),{formData:l}=va(),t=f(!1),{reset:s}=_a(),{BtForm:o,submit:r,param:n,ref:u}=i({data:()=>l.value,options:e=>$(()=>[Ce("状态",()=>U("div",{class:"flex items-center"},[U(W,{modelValue:e.value.status,"onUpdate:modelValue":a=>e.value.status=a,onChange:e=>{var a;e||null==(a=u.value)||a.clearValidate(["allowed_origin"])}},null),(null==e?void 0:e.value.status)?U("span",{class:"ml-[2rem] text-[12px] text-[#606266]"},[N("当允许行跨域访问")]):null]),"status",{labelWidth:"140px"}),...(null==e?void 0:e.value.status)?[Ce("允许访问的域名",()=>U("div",{class:"flex items-center w-full"},[U("div",null,[U(Q,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{default:()=>U("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[N("使用*代表所有域名都可以跨域访问"),U("br",null,null),N("多个域名用 , 分隔")]),reference:()=>U(X,{type:"textarea",rows:4,class:"!w-[32rem]",placeholder:"使用*代表所有域名都可以跨域访问，多个域名用,分隔",modelValue:e.value.allowed_origin,"onUpdate:modelValue":a=>e.value.allowed_origin=a},null)})])]),"allowed_origin",{rules:[{required:!0,message:"请输入允许访问的域名",trigger:"blur",validator:(a,l,t)=>{var s;(null==(s=null==e?void 0:e.value)?void 0:s.status)?l?t():t(new Error("请输入允许访问的域名")):t()}}],labelWidth:"140px"}),{type:"slots",key:"custom"}]:[],Ce(" ",()=>U("div",{class:"flex items-center w-full ml-[6rem]"},[U(E,{type:"primary",onClick:()=>r()},{default:()=>[N("保存")]})]))]),submit:async(e,a)=>{try{return await a(),ga(e.value),!0}catch(l){return!1}}});return b(async()=>{s(),t.value=!0,await fa({siteName:a.value.name,project_type:a.value.project_type}),t.value=!1}),(e,a)=>{const l=W,s=Q,r=S,i=X,u=je,p=Y;return G((x(),V("div",ya,[U(k(o),null,{custom:C(()=>[U(u,null,{config:C(()=>[U(r,{"label-width":"140px",label:"允许跨域携带cookie",prop:"allow_credentials"},{default:C(()=>[U(l,{modelValue:k(n).allow_credentials,"onUpdate:modelValue":a[0]||(a[0]=e=>k(n).allow_credentials=e)},null,8,["modelValue"]),U(s,{placement:"top-start",width:"auto",trigger:"hover","popper-class":"green-tips-popover !p-0 !border-none"},{reference:C(()=>[...a[4]||(a[4]=[q("span",{class:"ml-[8px] bt-ico-ask"},"?",-1)])]),default:C(()=>[a[5]||(a[5]=q("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[N(" Access-Control-Allow-Credentials 允许/拒绝浏览器发送凭据（如Cookie）。 "),q("br"),N(" 设为 true 时，请求携带的凭据将被服务器接受，但需同时指定具体源（不能使用 *）。 ")],-1))]),_:1})]),_:1}),U(r,{"label-width":"140px",label:"允许跨域的请求方法",prop:"allowed_methods"},{default:C(()=>[U(s,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{reference:C(()=>[U(i,{type:"textarea",rows:4,class:"!w-[32rem]",modelValue:k(n).allowed_methods,"onUpdate:modelValue":a[1]||(a[1]=e=>k(n).allowed_methods=e),placeholder:"允许跨域的请求方法，例如: GET, POST"},null,8,["modelValue"])]),default:C(()=>[a[6]||(a[6]=q("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[N(" Access-Control-Allow-Methods 指定允许的HTTP方法（如 GET, POST, OPTIONS）， "),q("br"),N(" 用于预检请求（OPTIONS）时告知客户端可支持的方法列表。 ")],-1))]),_:1})]),_:1}),U(r,{"label-width":"140px",label:"允许跨域携带的请求头",prop:"allowed_headers"},{default:C(()=>[U(s,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{reference:C(()=>[U(i,{type:"textarea",rows:4,class:"!w-[32rem]",modelValue:k(n).allowed_headers,"onUpdate:modelValue":a[2]||(a[2]=e=>k(n).allowed_headers=e),placeholder:"允许跨域携带的请求头"},null,8,["modelValue"])]),default:C(()=>[a[7]||(a[7]=q("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[N(" Access-Control-Allow-Headers 在预检请求中定义允许携带的自定义请求头（如 Content-Type）， "),q("br"),N(" 告知客户端哪些头可安全用于实际请求。 ")],-1))]),_:1})]),_:1}),U(r,{"label-width":"140px",label:"允许浏览器访问的响应头",prop:"exposed_headers"},{default:C(()=>[U(s,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{reference:C(()=>[U(i,{type:"textarea",rows:4,class:"!w-[32rem]",modelValue:k(n).exposed_headers,"onUpdate:modelValue":a[3]||(a[3]=e=>k(n).exposed_headers=e),placeholder:"允许跨域浏览器访问的响应头"},null,8,["modelValue"])]),default:C(()=>[a[8]||(a[8]=q("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[N(" Access-Control-Expose-Headers 暴露给浏览器脚本的响应头列表， "),q("br"),N(" 客户端只能访问在此列表中声明的头（如 Content-Range）。 ")],-1))]),_:1})]),_:1})]),_:1})]),_:1})])),[[p,k(t)]])}}}),wa=h({__name:"index",setup(e,{expose:t}){const{siteInfo:s}=ee(),o=f(),r=f([]),n=f(!1),{BtOperation:i}=u({options:[{label:"添加计划任务",type:"button",active:!0,onClick:()=>h()}]}),_=async(e,a,l,t)=>{const{label:s,value:o}=t,r=new Map([["stark","即将批量执行选中的计划任务"],["start","即将批量开启选中任务"],["stop","即将批量停止选中任务"],["delete","即将批量删除选中任务"]]),n=async(e,a)=>{const l=new Map([["stark",Ve],["start",xe],["stop",xe],["delete",ke]]),{id:t}=e,s=l.get(o);switch(o){case"stark":case"delete":if(s)return s({id:t});break;case"start":case"stop":if(s)return s({id:t,status:"start"===o?1:0})}};await e({title:"批量".concat(s),content:"".concat(r.get(o),"，是否继续操作？"),column:[{label:"项目名称",prop:"name"},ze()],onConfirm:async()=>(await a(n),V(),!1)})},v=async e=>{await l({title:e.status?"停用计划任务":"启用计划任务",content:e.status?"计划任务暂停后将无法继续运行，您真的要停用这个计划任务吗？":"该计划任务已停用，是否要启用这个计划任务？",icon:"question-filled"}),await a({loading:"正在设置计划任务状态，请稍候...",request:xe({id:e.id}),message:!0,success:V})},h=e=>{p({isAsync:!0,title:"".concat(e?"编辑":"添加","计划任务").concat(e?"【"+e.name+"】":""),area:74,component:()=>m(()=>import("./add-crontab.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{row:e||!1,sitename:s.value.name,refreshEvent:V},showFooter:!0})},g=e=>{p({isAsync:!0,title:"查看【"+(e.rname||e.name)+"】日志",area:80,compData:{id:e.id},component:()=>m(()=>import("./log-detail2.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},y=async e=>{a({loading:"正在执行计划任务，请稍后...",request:Ve({id:e.id}),message:!0,success:()=>{g(e)}})},w=async({id:e,name:t})=>{await l({title:"删除计划任务",content:"您确定要删除计划任务【".concat(t,"】，是否继续？"),icon:"warning-filled"}),a({loading:"正在删除计划任务，请稍后...",request:ke({id:e}),message:!0,success:V})},V=async()=>{a({loading:n,request:we({sitename:s.value.name}),data:{data:[Array,r]}})},N=Z([qe(),{label:"计划任务",prop:"rname",render:e=>e.rname||e.name},Ue({event:e=>{v(e)},data:["停用","正常"]}),{label:"执行周期",prop:"cycle"},{label:"上次执行时间",prop:"addtime"},He([{onClick:y,title:"执行"},{onClick:e=>{h(e)},title:"编辑"},{onClick:e=>{g(e)},title:"日志"},{onClick:w,title:"删除"}])]),P=[{label:"执行任务",value:"stark",event:_},{label:"启动任务",value:"start",event:_},{label:"停止任务",value:"stop",event:_},{label:"删除任务",value:"delete",event:_}];return b(V),t({init:V}),(e,a)=>{const l=c,t=d,s=Pe,u=B("bt-loading");return x(),j(s,null,{"header-left":C(()=>[U(k(i))]),"header-right":C(()=>[...a[0]||(a[0]=[])]),content:C(()=>[G(U(l,{ref_key:"cronTableRef",ref:o,"max-height":560,column:k(N),data:k(r)},null,8,["column","data"]),[[u,"正在加载计划任务列表，请稍后...","title"],[u,k(n)]])]),"footer-left":C(()=>[U(t,{"table-ref":k(o),options:k(P)},null,8,["table-ref","options"])]),_:1})}}}),xa=v(h({__name:"index",setup(e,{expose:a}){var l,t,s;const{siteInfo:o}=ee(),r=null==(l=o.value)?void 0:l.project_type,n=f((null==(t=o.value)?void 0:t.otherName)?null==(s=o.value)?void 0:s.otherName:"phpasync"!==r?"composer":"nginx"),i="phpasync"===r,u=f([{label:"Composer",name:"composer",lazy:!0,isHide:i,render:Me},{label:"Tomcat",name:"tomcat",lazy:!0,isHide:i,render:Je},{label:"Gzip压缩",name:"gzip",lazy:!0,isHide:i,render:pa},{label:"Nginx安全请求头",name:"nginx",lazy:!0,render:da},{label:"跨域访问CORS配置",name:"cors",isHide:i,lazy:!0,render:ba},{label:"默认文档",name:"defalut",isHide:!i,lazy:!0,render:Ne},{label:"计划任务",name:"crontab",isHide:!i,lazy:!0,render:wa},{label:"网站告警",name:"siteAlarm",isHide:!i,lazy:!0,render:Te}]),{BtTabs:p}=_({type:"card",value:n,options:u}),m=()=>{u.value=u.value.filter(e=>!0!==e.isHide)};return b(m),a({init:m}),(e,a)=>(x(),j(k(p)))}}),[["__scopeId","data-v-2e6c9bcf"]]);export{xa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
