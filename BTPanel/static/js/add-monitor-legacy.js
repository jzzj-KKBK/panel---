!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},l=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function u(t,r,l,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return a(s,"_invoke",function(t,r,a){var l,o,u,c=0,s=a||[],m=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(n,t){return l=n,o=0,u=e,f.n=t,i}};function d(t,r){for(o=t,u=r,n=0;!m&&c&&!a&&n<s.length;n++){var a,l=s[n],d=f.p,p=l[2];t>3?(a=p===r)&&(u=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=d&&((a=t<2&&d<l[1])?(o=0,f.v=r,f.n=l[1]):d<p&&(a=t<3||l[0]>r||r>p)&&(l[4]=t,l[5]=r,f.n=p,o=0))}if(a||t>1)return i;throw m=!0,r}return function(a,s,p){if(c>1)throw TypeError("Generator is already running");for(m&&1===s&&d(s,p),o=s,u=p;(n=o<2?e:u)||!m;){l||(o?o<3?(o>1&&(f.n=-1),d(o,u)):f.n=u:f.v=u);try{if(c=2,l){if(o||(a="next"),n=l[a]){if(!(n=n.call(l,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,o<2&&(o=0)}else 1===o&&(n=l.return)&&n.call(l),o<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((n=(m=f.n<0)?u:t.call(r,f))!==i)break}catch(n){l=e,o=1,u=n}finally{c=1}}return{value:n,done:m}}}(t,l,o),!0),s}var i={};function c(){}function s(){}function m(){}n=Object.getPrototypeOf;var f=[][l]?n(n([][l]())):(a(n={},l,function(){return this}),n),d=m.prototype=c.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,a(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=m,a(d,"constructor",m),a(m,"constructor",s),s.displayName="GeneratorFunction",a(m,o,"GeneratorFunction"),a(d),a(d,o,"Generator"),a(d,l,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(r=function(){return{w:u,m:p}})()}function a(e,n,t,r){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}a=function(e,n,t,r){function o(n,t){a(e,n,function(e){return this._invoke(n,t,e)})}n?l?l(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},a(e,n,t,r)}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach(function(n){u(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function u(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var a=r.call(n,t||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function i(e,n,t,r,a,l,o){try{var u=e[l](o),i=u.value}catch(e){return void t(e)}u.done?n(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var l=e.apply(n,t);function o(e){i(l,r,a,o,u,"next",e)}function u(e){i(l,r,a,o,u,"throw",e)}o(void 0)})}}System.register(["./base-lib-legacy.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./validator-legacy.js?v=1756369731","./firewall-legacy.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./column-legacy.js?v=1756369731"],function(e,t){"use strict";var a,l,u,i,s,m,f,d,p,v,_,y,b,h,g,w,V,j,O,U,S,k,P,x,D,E,T,A,G,q,C,F,I,R;return{setters:[function(e){a=e.c,l=e.r,u=e.U,i=e.w,s=e.p,m=e.q,f=e.M,d=e.A,p=e.e,v=e.x,_=e.y,y=e.v,b=e.a_,h=e.F,g=e.C,w=e.B,V=e.z,j=e.a9,O=e.ai,U=e.aj,S=e.al,k=e.ag,P=e.af,x=e.a7},function(e){D=e.aH,E=e.K,T=e.j,A=e.ag,G=e.$,q=e.W},function(e){C=e._},function(e){F=e.bt,I=e.bu},function(e){R=e._},null,null,null],execute:function(){var t={class:"flex"},H={class:"flex"},L={class:"flex min-h-[3.2rem] items-start"},N={class:"items-center h-[3.2rem]"};e("default",a({__name:"add-monitor",props:{compData:{default:function(){}}},setup:function(e,a){var M=a.expose,z=l(null),B=e,J=l({name:"",method:2,site_name:"",site_url:"",access:"http",send_msg:!1,send_type:[],type:"day",week:1,where1:1,hour:1,minute:19,switch_config:!1,scan_config:{thesaurus:1,scan_args:!1,title_hash:!1,tail_hash:!1,keywords:!1,descriptions:!1,title:!1,search_monitor:!1,scan_ua:"Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"},id:""}),$=u([]),K=["周一","周二","周三","周四","周五","周六","周日"],W=l(!!B.compData.id),Q=[{content:"如果是本机端口转发，目标IP为：127.0.0.1"},{content:"如果目标IP不填写，默认则为本机端口转发!"}],X=[{label:"全站扫描",value:1},{label:"快速扫描",value:2},{label:"单URL",value:3}],Y=[{label:"HTTPS",value:"https"},{label:"HTTP",value:"http"}],Z=[{label:"每天",value:"day"},{label:"N天",value:"day-n"},{label:"每星期",value:"week"},{label:"每月",value:"month"}],ee={name:[{required:!0,trigger:["blur","change"],message:"请输入监控名"}],site_name:[{validator:function(e,n,t){if("auto"!==n)t();else{if(J.value.site_url||t(new Error("请输入网站域名")),3!==J.value.method&&!D(J.value.site_url))return t(new Error("检测网站域名格式不正确"));t()}},trigger:["blur","change"]}],send_type:[{required:!0,message:"请选择通知方式",trigger:["blur","change"]}],type:[{validator:function(e,n,t){return"day-n"!==n&&"month"!==n||!(J.value.where1<0||J.value.where1>31)?J.value.hour<0||J.value.hour>23?t(new Error("请输入正确小时范围[0-23]")):J.value.minute<0||J.value.minute>59?t(new Error("请输入正确分钟范围[0-59]")):void t():t(new Error("请输入正确天数范围[0-31]"))},trigger:["blur","change"]}]},ne=function(){var e=c(r().m(function e(n){var t,a,l;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,z.value.validate();case 1:return t="auto"===J.value.site_name?J.value.site_url:J.value.site_name,a=o(o({},J.value),{},{site_name:t,url:J.value.access+"://"+t,send_msg:Number(J.value.send_msg)}),"week"===(l=J.value).type&&(a.week=l.week),W.value&&(a.id=l.id),e.n=2,E({loading:"正在提交，请稍后...",request:F(W.value,a),message:!0});case 2:B.compData.refreshEvent&&B.compData.refreshEvent(),n();case 3:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),te=function(){var e=c(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,E({loading:"正在获取网站列表，请稍后...",request:I({type:"sites"}),data:{data:[Array,$]}});case 1:J.value.site_name=W.value?B.compData.site_name:$.value[0].name,B.compData.isSite&&(J.value.site_name=B.compData.name);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),re=function(e){},ae=function(e){var n;(J.value.method=e,3===e)?J.value.site_name="auto":B.compData.isSite&&(J.value.site_name=(null===(n=B.compData)||void 0===n?void 0:n.site_name)||B.compData.name||"")};return i(function(){return J.value.site_name},function(){var e=X.find(function(e){return e.value===J.value.method}).label;J.value.name=(("auto"===J.value.site_name?J.value.site_url:J.value.site_name)||"")+e}),M({onConfirm:ne}),s(function(){te(),W.value&&function(){var e,n,t,r,a,l=B.compData;J.value=o(o(o(o({},l),l.crontab_info),l.scan_config),{},{access:null===(e=l.url)||void 0===e?void 0:e.split("://")[0],where1:(null===(n=l.crontab_info)||void 0===n?void 0:n.where1)||1,hour:(null===(t=l.crontab_info)||void 0===t?void 0:t.where_hour)||1,minute:(null===(r=l.crontab_info)||void 0===r?void 0:r.where_minute)||30,send_msg:!!l.send_msg,id:l.id});var u=null===(a=B.compData.crontab_info)||void 0===a?void 0:a.type;J.value.type="每星期"===u?"week":"每月"===u?"month":"每天"===u?"day":"day-n"}()}),function(e,r){var a=T,l=j,o=A,u=O,i=U,c=G,s=S,D=C,E=k,F=P,I=q,M=x;return m(),f(M,{ref_key:"monitorFormRef",ref:z,rules:ee,model:v(J),class:"p-[2rem] addfrom overflow-auto max-h-[60rem]","label-width":"10rem"},{default:d(function(){return[p(l,{label:"监控名",prop:"name"},{default:d(function(){return[p(a,{modelValue:v(J).name,"onUpdate:modelValue":r[0]||(r[0]=function(e){return v(J).name=e}),width:"26rem",placeholder:"请输入监控名",clearable:""},null,8,["modelValue"])]}),_:1}),p(l,{label:"检测方式"},{default:d(function(){return[p(o,{modelValue:v(J).method,"onUpdate:modelValue":r[1]||(r[1]=function(e){return v(J).method=e}),options:X,onChange:ae,class:"!w-[26rem]"},null,8,["modelValue"])]}),_:1}),p(l,{label:"检测网站",prop:"site_name"},{default:d(function(){return[_("div",t,[p(i,{modelValue:v(J).site_name,"onUpdate:modelValue":r[2]||(r[2]=function(e){return v(J).site_name=e}),class:"!w-[20rem] mr-4",disabled:!(3!==v(J).method&&!e.compData.isSite)},{default:d(function(){return[(m(!0),y(h,null,b(v($),function(e,n){return m(),f(u,{key:n,value:e.name,label:"".concat(e.name,"[").concat(e.ps,"]")},null,8,["value","label"])}),128)),p(u,{label:"自定义网站",value:"auto"})]}),_:1},8,["modelValue","disabled"]),"auto"===v(J).site_name?(m(),f(a,{key:0,modelValue:v(J).site_url,"onUpdate:modelValue":r[3]||(r[3]=function(e){return v(J).site_url=e}),width:"20rem",placeholder:"请输入网站域名",clearable:""},null,8,["modelValue"])):g("",!0)])]}),_:1}),p(l,{label:"访问网站方式"},{default:d(function(){return[p(c,{modelValue:v(J).access,"onUpdate:modelValue":r[4]||(r[4]=function(e){return v(J).access=e}),options:Y},null,8,["modelValue"])]}),_:1}),p(l,{label:"发送告警"},{default:d(function(){return[p(s,{modelValue:v(J).send_msg,"onUpdate:modelValue":r[5]||(r[5]=function(e){return v(J).send_msg=e})},null,8,["modelValue"])]}),_:1}),!v(J).send_msg?g("",!0):(m(),f(l,{key:0,label:"通知方式",prop:"send_type"},{default:d(function(){return[p(D,{modelValue:v(J).send_type,"onUpdate:modelValue":r[6]||(r[6]=function(e){return v(J).send_type=e}),limit:["sms","wx_account"],onChange:re,multiple:!1,class:"!w-[26rem]"},null,8,["modelValue"])]}),_:1})),p(l,{label:"检测频率",prop:"type"},{default:d(function(){return[_("div",H,[p(o,{class:"!w-[8rem] mr-4",modelValue:v(J).type,"onUpdate:modelValue":r[7]||(r[7]=function(e){return v(J).type=e}),options:Z},null,8,["modelValue"]),"week"===v(J).type?(m(),f(i,{key:0,class:"!w-[8rem] mr-4",modelValue:v(J).week,"onUpdate:modelValue":r[8]||(r[8]=function(e){return v(J).week=e})},{default:d(function(){return[(m(),y(h,null,b(K,function(e,n){return p(u,{key:n,label:e,value:n+1},null,8,["label","value"])}),64))]}),_:1},8,["modelValue"])):g("",!0),"day-n"===v(J).type||"month"===v(J).type?(m(),f(a,{key:1,type:"number",class:"!w-[13rem] mr-4",min:"0",max:"31",modelValue:v(J).where1,"onUpdate:modelValue":r[9]||(r[9]=function(e){return v(J).where1=e})},{append:d(function(){return[w(V("day-n"===v(J).type?"天":"日"),1)]}),_:1},8,["modelValue"])):g("",!0),p(a,{type:"number",class:"!w-[13rem] mr-4",min:"0",max:"23",modelValue:v(J).hour,"onUpdate:modelValue":r[10]||(r[10]=function(e){return v(J).hour=e})},{append:d(function(){return n(r[21]||(r[21]=[w("时",-1)]))}),_:1},8,["modelValue"]),p(a,{type:"number",class:"!w-[13rem]",min:"0",max:"59",modelValue:v(J).minute,"onUpdate:modelValue":r[11]||(r[11]=function(e){return v(J).minute=e})},{append:d(function(){return n(r[22]||(r[22]=[w("分",-1)]))}),_:1},8,["modelValue"])])]}),_:1}),p(R,{"is-show-divider":!0},{config:d(function(){return[p(l,{label:"敏感词库"},{default:d(function(){return[p(F,{modelValue:v(J).scan_config.thesaurus,"onUpdate:modelValue":r[12]||(r[12]=function(e){return v(J).scan_config.thesaurus=e}),class:"border-[#ccc] border-1 !w-[26rem] rounded-[.2rem] px-[1rem] py-[.5rem] flex flex-col !items-start"},{default:d(function(){return[p(E,{value:1},{default:d(function(){return n(r[23]||(r[23]=[w("全选",-1)]))}),_:1}),p(E,{value:2},{default:d(function(){return n(r[24]||(r[24]=[w("自定义词库",-1)]))}),_:1}),p(E,{value:3},{default:d(function(){return n(r[25]||(r[25]=[w("默认词库",-1)]))}),_:1})]}),_:1},8,["modelValue"])]}),_:1}),p(l,{label:"检测带参数的URL"},{default:d(function(){return[_("div",L,[_("div",N,[p(s,{modelValue:v(J).scan_config.scan_args,"onUpdate:modelValue":r[13]||(r[13]=function(e){return v(J).scan_config.scan_args=e})},null,8,["modelValue"])]),r[26]||(r[26]=_("div",{class:"unit"},[_("p",null,"扫描时检测带参数的URL，如URL: https://bt.cn?a=b"),_("p",null,[w(" 开启前 "),_("span",{class:"ml-[2rem]"},"不检测")]),_("p",null,[w(" 开启后 "),_("span",{class:"ml-[2rem]"},"检测")]),_("p",null,"注意，开启后检测页面将成倍增长，可能会导致检测时间大量增加")],-1))])]}),_:1}),p(l,{label:"头部JS检测"},{default:d(function(){return[p(s,{modelValue:v(J).scan_config.title_hash,"onUpdate:modelValue":r[14]||(r[14]=function(e){return v(J).scan_config.title_hash=e})},null,8,["modelValue"]),r[27]||(r[27]=_("span",{class:"unit"},"监控页面源码中的title_hash标签是否有修改",-1))]}),_:1}),p(l,{label:"尾部JS检测"},{default:d(function(){return[p(s,{modelValue:v(J).scan_config.tail_hash,"onUpdate:modelValue":r[15]||(r[15]=function(e){return v(J).scan_config.tail_hash=e})},null,8,["modelValue"]),r[28]||(r[28]=_("span",{class:"unit"},"监控页面源码中的tail_hash标签是否有修改",-1))]}),_:1}),p(l,{label:"关键词检测"},{default:d(function(){return[p(s,{modelValue:v(J).scan_config.keywords,"onUpdate:modelValue":r[16]||(r[16]=function(e){return v(J).scan_config.keywords=e})},null,8,["modelValue"]),r[29]||(r[29]=_("span",{class:"unit"},"监控页面源码中的keywords标签是否有修改",-1))]}),_:1}),p(l,{label:"描述检测"},{default:d(function(){return[p(s,{modelValue:v(J).scan_config.descriptions,"onUpdate:modelValue":r[17]||(r[17]=function(e){return v(J).scan_config.descriptions=e})},null,8,["modelValue"]),r[30]||(r[30]=_("span",{class:"unit"},"监控页面源码中的descriptions标签是否有修改",-1))]}),_:1}),p(l,{label:"标题检测"},{default:d(function(){return[p(s,{modelValue:v(J).scan_config.title,"onUpdate:modelValue":r[18]||(r[18]=function(e){return v(J).scan_config.title=e})},null,8,["modelValue"]),r[31]||(r[31]=_("span",{class:"unit"},"监控页面源码中的title标签是否有修改",-1))]}),_:1}),p(l,{label:"搜索引擎收录监控"},{default:d(function(){return[p(s,{modelValue:v(J).scan_config.search_monitor,"onUpdate:modelValue":r[19]||(r[19]=function(e){return v(J).scan_config.search_monitor=e})},null,8,["modelValue"]),r[32]||(r[32]=_("span",{class:"unit"},"监控搜索引擎是否存在风险关键词",-1))]}),_:1}),p(l,{label:"自定义访问UA"},{default:d(function(){return[p(a,{type:"textarea",modelValue:v(J).scan_config.scan_ua,"onUpdate:modelValue":r[20]||(r[20]=function(e){return v(J).scan_config.scan_ua=e}),width:"36rem",height:"10rem",placeholder:"请输入自定义访问UA",clearable:""},null,8,["modelValue"])]}),_:1})]}),_:1}),p(I,{options:Q,class:"pl-[3.6rem] mt-[2rem]"})]}),_:1},8,["model"])}}}))}}})}();
