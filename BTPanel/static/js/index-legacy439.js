!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",a=l.toStringTag||"@@toStringTag";function o(n,l,u,a){var o=l&&l.prototype instanceof c?l:c,s=Object.create(o.prototype);return r(s,"_invoke",function(n,r,l){var u,a,o,c=0,s=l||[],f=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return u=t,a=0,o=e,m.n=n,i}};function d(n,r){for(a=n,o=r,t=0;!f&&c&&!l&&t<s.length;t++){var l,u=s[t],d=m.p,p=u[2];n>3?(l=p===r)&&(o=u[(a=u[4])?5:(a=3,3)],u[4]=u[5]=e):u[0]<=d&&((l=n<2&&d<u[1])?(a=0,m.v=r,m.n=u[1]):d<p&&(l=n<3||u[0]>r||r>p)&&(u[4]=n,u[5]=r,m.n=p,a=0))}if(l||n>1)return i;throw f=!0,r}return function(l,s,p){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,p),a=s,o=p;(t=a<2?e:o)||!f;){u||(a?a<3?(a>1&&(m.n=-1),d(a,o)):m.n=o:m.v=o);try{if(c=2,u){if(a||(l="next"),t=u[l]){if(!(t=t.call(u,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,a<2&&(a=0)}else 1===a&&(t=u.return)&&t.call(u),a<2&&(o=TypeError("The iterator does not provide a '"+l+"' method"),a=1);u=e}else if((t=(f=m.n<0)?o:n.call(r,m))!==i)break}catch(t){u=e,a=1,o=t}finally{c=1}}return{value:t,done:f}}}(n,u,a),!0),s}var i={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var m=[][u]?t(t([][u]())):(r(t={},u,function(){return this}),t),d=f.prototype=c.prototype=Object.create(m);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=f,r(d,"constructor",f),r(f,"constructor",s),s.displayName="GeneratorFunction",r(f,a,"GeneratorFunction"),r(d),r(d,a,"Generator"),r(d,u,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(n=function(){return{w:o,m:p}})()}function r(e,t,n,l){var u=Object.defineProperty;try{u({},"",{})}catch(e){u=0}r=function(e,t,n,l){function a(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?u?u(e,t,{value:n,enumerable:!l,configurable:!l,writable:!l}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},r(e,t,n,l)}function l(e,t,n,r,l,u,a){try{var o=e[u](a),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,l)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,u){var a=e.apply(t,n);function o(e){l(a,r,u,o,i,"next",e)}function i(e){l(a,r,u,o,i,"throw",e)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1756369731","./index-legacy103.js?v=1756369731","./index-legacy130.js?v=1756369731","./column-legacy.js?v=1756369731","./validator-legacy.js?v=1756369731","./useController-legacy14.js?v=1756369731","./index-legacy398.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang-legacy.js?v=1756369731","./useController-legacy6.js?v=1756369731","./config-legacy.js?v=1756369731"],function(t,r){"use strict";var l,a,o,i,c,s,f,m,d,p,v,y,b,g,_,x,h,w,j,V,q,k,C,U,A,S,O,F,G,T,P,B,I,E,M,W,z,N,H,L,$,D,Q,R,X,J,K,Y,Z,ee,te,ne,re,le,ue,ae,oe,ie;return{setters:[function(e){l=e.u,a=e.fj,o=e.a7,i=e.G,c=e.j,s=e.ag,f=e.bg,m=e.l,d=e.R,p=e._,v=e.c,y=e.W,b=e.al},function(e){g=e.c,_=e.t,x=e.p,h=e.G,w=e.q,j=e.v,V=e.x,q=e.M,k=e.A,C=e.y,U=e.e,A=e.B,S=e.C,O=e.H,F=e.z,G=e.D,T=e.g,P=e.aW,B=e.a$,I=e.r,E=e.P,M=e.aA},function(e){W=e.u},function(e){z=e._},function(e){N=e._},function(e){H=e._},function(e){L=e.b,$=e.u},function(e){D=e.aI},function(e){Q=e.g,R=e.c,X=e.d,J=e.e,K=e.f,Y=e.v,Z=e.j,ee=e.k,te=e.l,ne=e.n,re=e.r,le=e.q,ue=e.s,ae=e.t,oe=e.u},function(e){ie=e.B},null,null,null,null,null,null],execute:function(){var r={class:"flex items-center"},ce={class:"whitespace-normal leading-1.8rem ml-[4px]"},se={key:0,class:"flex items-center"},fe={class:"bg-[#FAFAFA] mb-[12px] flex items-center border border-[#ddd] justify-evenly p-[8px] py-[12px]"},me={class:"flex flex-col justify-center items-center"},de={class:"flex flex-col justify-center items-center"},pe=g({__name:"index",setup:function(t){var b=l().payment;_(b.value);var g=a({request:Q,columns:[{label:"类型",width:80,render:function(e){return{monitor_traffic_attack:"动态检查",monitor_traffic_total:"累计限制",monitor_http_flood:"动态检查"}[e.source]}},{label:"描述",prop:"view_msg"},L({minWidth:100,event:ee,data:["停用","正常"]}),$([{title:"删除",onClick:te}])],extension:[o(ae)]}).BtTable,I=function(){var e,t=i({data:{cycle:5,cycle_unit:"m",traffic:1,traffic_unit:"mb",request:10,request_unit:"kc",type:"total",sender:[],total:3},options:function(e){return T(function(){return[{type:"custom",render:function(){return U(P,{title:"实时检查近一段时间内的资源消耗情况，当出现超过阀值的高资源占用时，发出告警信息",type:"warning",closable:!1,"show-icon":!0,class:"!mb-[12px]"},null)}},{type:"custom",render:function(){return U(f,{label:"周期",prop:"cycle"},{default:function(){return[U("div",{class:"flex items-center"},[U(c,{width:"7rem",type:"number",min:"1",modelValue:e.value.cycle,"onUpdate:modelValue":function(t){return e.value.cycle=t}},null),U(s,{class:"!w-[7rem] !ml-[.4rem] !mt-[2px]",modelValue:e.value.cycle_unit,"onUpdate:modelValue":function(t){return e.value.cycle_unit=t},options:[{label:"分钟",value:"m"},{label:"小时",value:"h"}]},null)])]}})}},{type:"custom",render:function(){return U(f,{label:"阈值信息",prop:"total"===e.value.type?"traffic":"request"},{default:function(){var t,n;return[U("div",{class:"flex items-center"},[U(s,{class:"!w-[10rem] !mr-[.4rem] !mt-[2px]",modelValue:e.value.type,"onUpdate:modelValue":function(t){return e.value.type=t},options:[{value:"total",label:"流量"},{value:"request",label:"请求数"}],onChange:function(t){"total"===t?(e.value.cycle_unit="m",e.value.traffic=1,e.value.traffic_unit="mb"):(e.value.cycle_unit="h",e.value.request=10,e.value.request_unit="kc")}},null),"total"===e.value.type?U("div",{class:"flex items-center"},[U(c,{width:"12rem",type:"number",min:"1",modelValue:e.value.traffic,"onUpdate:modelValue":function(t){return e.value.traffic=t}},null),U(s,{class:"!w-[8rem] !ml-[.4rem] !mt-[2px]",modelValue:e.value.traffic_unit,"onUpdate:modelValue":function(t){return e.value.traffic_unit=t},options:ne},null)]):U("div",{class:"flex items-center"},[U(c,{width:"12rem",type:"number",min:"1",modelValue:e.value.request,"onUpdate:modelValue":function(t){return e.value.request=t}},null),U(s,{class:"!w-[8rem] !ml-[.4rem] !mt-[2px]",modelValue:e.value.request_unit,"onUpdate:modelValue":function(t){return e.value.request_unit=t},options:re},null)])]),U("span",{class:"text-[1.2rem] text-[#666]"},["近".concat(e.value.cycle).concat("m"===e.value.cycle_unit?"分钟":"小时","内的").concat("total"===e.value.type?"流量":"请求数","超过").concat("total"===e.value.type?e.value.traffic:e.value.request).concat("total"===e.value.type?null===(t=ne.find(function(t){return t.value===e.value.traffic_unit}))||void 0===t?void 0:t.label:null===(n=re.find(function(t){return t.value===e.value.request_unit}))||void 0===n?void 0:n.label,"就触发告警")])]}})},rules:{traffic:[{required:!0,message:"请输入流量阈值",trigger:"blur"}],request:[{required:!0,message:"请输入请求数阈值",trigger:"blur"}]}},D("告警方式","sender",{attrs:{class:"!w-24rem",limit:["sms"]},rules:{sender:[{required:!0,message:"请选择告警方式",trigger:"blur"}]}}),{type:"custom",render:function(){return U(f,{label:"发送次数",prop:"total"},{default:function(){return[U("div",{class:"flex items-center"},[U(c,{width:"12rem",type:"number",min:"0",modelValue:e.value.total,"onUpdate:modelValue":function(t){return e.value.total=t}},{append:"次"}),U("span",{class:"text-[1.2rem] text-[#666] ml-[12px]"},[A("后将不再发送告警信息，无需限制次数可填0次表示不限制")])])]}})},rules:{total:[{required:!0,message:"请输入发送次数",trigger:"blur"}]}}]})},submit:(e=u(n().m(function e(t,r){return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:return e.n=2,le(t.value);case 2:return e.a(2,e.v)}},e)})),function(t,n){return e.apply(this,arguments)})}),r=t.BtForm,l=t.submit;t.param;m({title:"添加动态异常告警",area:60,component:function(){return U("div",{class:"p-[2rem]"},[U(r,null,null)])},showFooter:!0,onConfirm:l})},E=function(){var e,t=100,r=i({data:{cycle:0,traffic:1,traffic_unit:"mb",sender:[],total:3},options:function(e){return T(function(){return[{type:"custom",render:function(){return U(P,{title:"监控某段时间内的流量累计使用情况，当使用量超过当前规则设置的阀值，则发出告警信息",type:"warning",closable:!1,"show-icon":!0,class:"!mb-[12px]"},null)}},{type:"custom",render:function(){return U(f,{label:"时间段",prop:"cycle","label-width":t},{default:function(){return[U("div",null,[U(ie,{modelValue:e.value.cycle,"onUpdate:modelValue":function(t){return e.value.cycle=t},"value-format":"X",class:"date",type:"date",placeholder:0===e.value.cycle?"每个自然月":"请选择时间",onChange:function(t){return e.value.cycle=Number(t)}},null),U(G,{type:"default",class:"!ml-[.4rem]",onClick:function(){return e.value.cycle=0}},{default:function(){return[A("设为每个自然月")]}}),0!==e.value.cycle&&U("span",{class:"block text-[1.2rem] text-[#666]"},[A("自"),d(e.value.cycle,"yyyy-MM-dd"),A("日起(包含该日)")])])]}})}},{type:"custom",render:function(){return U(f,{label:"流量使用量阈值",prop:"traffic","label-width":t},{default:function(){var t;return[U("div",{class:"flex items-center"},[U(c,{width:"12rem",type:"number",min:"1",modelValue:e.value.traffic,"onUpdate:modelValue":function(t){return e.value.traffic=t}},null),U(s,{class:"!w-[8rem] !ml-[.4rem] !mt-[2px] !mr-[12px]",modelValue:e.value.traffic_unit,"onUpdate:modelValue":function(t){return e.value.traffic_unit=t},options:ne},null)]),U("span",{class:"block text-[1.2rem] text-[#666]"},["每个自然月的流量累计超过".concat(e.value.traffic).concat(null===(t=ne.find(function(t){return t.value===e.value.traffic_unit}))||void 0===t?void 0:t.label,"就触发告警")])]}})},rules:{traffic:[{required:!0,message:"请输入流量阈值",trigger:"blur"}]}},D("告警方式","sender",{attrs:{class:"!w-24rem",limit:["sms"],labelWidth:t},rules:{sender:[{required:!0,message:"请选择告警方式",trigger:"blur"}]}}),{type:"custom",render:function(){return U(f,{label:"发送次数",prop:"total","label-width":t},{default:function(){return[U("div",{class:"flex items-center"},[U(c,{width:"12rem",type:"number",min:"0",modelValue:e.value.total,"onUpdate:modelValue":function(t){return e.value.total=t}},{append:"次"}),U("span",{class:"text-[1.2rem] text-[#666] ml-[12px]"},[A("后将不再发送告警信息，无需限制次数可填0次表示不限制")])])]}})},rules:{total:[{required:!0,message:"请输入发送次数",trigger:"blur"}]}}]})},submit:(e=u(n().m(function e(t,r){return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:return e.n=2,ue(t.value);case 2:return e.a(2,e.v)}},e)})),function(t,n){return e.apply(this,arguments)})}),l=r.BtForm,a=r.submit;r.param;m({title:"添加流量使用提醒",area:60,component:function(){return U("div",{class:"p-[2rem]"},[U(l,null,null)])},showFooter:!0,onConfirm:a})};return x(function(){R()}),function(t,n){var l=p,u=v,a=H,o=B,i=N,c=y,s=h("bt-loading");return w(),j("div",null,[V(X)?(w(),q(a,{key:0,showConfig:{width:"44rem"}},{content:k(function(){return[C("div",r,[U(l,{icon:"el-warning",color:"#fc6d26",size:18}),C("div",ce,[V(J).total_status?S("",!0):(w(),j("span",se,[n[2]||(n[2]=A(" 当前尚未安装监控报表插件 ",-1)),U(u,{onClick:n[0]||(n[0]=function(e){return V(K)("install")}),class:"!text-[1.2rem] ml-4px"},{default:k(function(){return e(n[1]||(n[1]=[A("点击安装",-1)]))}),_:1})]))])])]}),_:1})):S("",!0),C("div",null,[O((w(),j("div",fe,[C("div",me,[n[3]||(n[3]=C("span",null,"当前流量",-1)),C("span",null,F(V(Z).traffic),1)]),U(o,{direction:"vertical"}),C("div",de,[n[4]||(n[4]=C("span",null,"当前请求数",-1)),C("span",null,F(V(Z).request),1)])])),[[s,V(Y)]]),U(i,null,{"header-left":k(function(){return[U(V(G),{type:"primary",onClick:I},{default:k(function(){return e(n[5]||(n[5]=[A("添加动态检查告警",-1)]))}),_:1}),U(V(G),{onClick:E},{default:k(function(){return e(n[6]||(n[6]=[A("添加流量使用提醒",-1)]))}),_:1})]}),content:k(function(){return[U(V(g),{"max-height":400})]}),_:1}),U(c,{options:[{content:"流量限额可设置多条规则，统计周期产生的流量/请求超过限额会告警"}]})])])}}});t("default",g({__name:"index",setup:function(e){var t,n=W().siteInfo,r=I((null===(t=n.value)||void 0===t?void 0:t.tabName)||"flowLimit");return x(function(){oe()}),function(e,t){var n=M,l=b;return w(),q(l,{type:"card",modelValue:V(r),"onUpdate:modelValue":t[0]||(t[0]=function(e){return E(r)?r.value=e:null})},{default:k(function(){return[U(n,{label:"流量限制",name:"flowLimit"},{default:k(function(){return[U(z)]}),_:1}),U(n,{label:"流量限额",name:"flowQuota",lazy:!0},{default:k(function(){return[U(pe)]}),_:1})]}),_:1},8,["modelValue"])}}}))}}})}();
