!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,r,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function o(e,a,u,l){var o=a&&a.prototype instanceof s?a:s,c=Object.create(o.prototype);return n(c,"_invoke",function(e,n,a){var u,l,o,s=0,c=a||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return u=e,l=0,o=t,p.n=n,i}};function v(e,n){for(l=e,o=n,r=0;!f&&s&&!a&&r<c.length;r++){var a,u=c[r],v=p.p,m=u[2];e>3?(a=m===n)&&(o=u[(l=u[4])?5:(l=3,3)],u[4]=u[5]=t):u[0]<=v&&((a=e<2&&v<u[1])?(l=0,p.v=n,p.n=u[1]):v<m&&(a=e<3||u[0]>n||n>m)&&(u[4]=e,u[5]=n,p.n=m,l=0))}if(a||e>1)return i;throw f=!0,n}return function(a,c,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===c&&v(c,m),l=c,o=m;(r=l<2?t:o)||!f;){u||(l?l<3?(l>1&&(p.n=-1),v(l,o)):p.n=o:p.v=o);try{if(s=2,u){if(l||(a="next"),r=u[a]){if(!(r=r.call(u,o)))throw TypeError("iterator result is not an object");if(!r.done)return r;o=r.value,l<2&&(l=0)}else 1===l&&(r=u.return)&&r.call(u),l<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),l=1);u=t}else if((r=(f=p.n<0)?o:e.call(n,p))!==i)break}catch(r){u=t,l=1,o=r}finally{s=1}}return{value:r,done:f}}}(e,u,l),!0),c}var i={};function s(){}function c(){}function f(){}r=Object.getPrototypeOf;var p=[][u]?r(r([][u]())):(n(r={},u,function(){return this}),r),v=f.prototype=s.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,n(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e}return c.prototype=f,n(v,"constructor",f),n(f,"constructor",c),c.displayName="GeneratorFunction",n(f,l,"GeneratorFunction"),n(v),n(v,l,"Generator"),n(v,u,function(){return this}),n(v,"toString",function(){return"[object Generator]"}),(e=function(){return{w:o,m:m}})()}function n(e,t,r,a){var u=Object.defineProperty;try{u({},"",{})}catch(e){u=0}n=function(e,t,r,a){function l(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?u?u(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(l("next",0),l("throw",1),l("return",2))},n(e,t,r,a)}function t(e,n,t,r,a,u,l){try{var o=e[u](l),i=o.value}catch(e){return void t(e)}o.done?n(i):Promise.resolve(i).then(r,a)}function r(e){return function(){var n=this,r=arguments;return new Promise(function(a,u){var l=e.apply(n,r);function o(e){t(l,a,u,o,i,"next",e)}function i(e){t(l,a,u,o,i,"throw",e)}o(void 0)})}}function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return u(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./validator-legacy.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy20.js?v=1756369731","./index-legacy116.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./index-legacy101.js?v=1756369731","./useController-legacy5.js?v=1756369731","./index-legacy323.js?v=1756369731","./site-legacy.js?v=1756369731"],function(n,t){"use strict";var u,l,o,i,s,c,f,p,v,m,g,d,y,h,b,x,w,_,k,j,S,E,L,C,I,V,P,T,z,F,O,B,A,U,G,N,R,q,H,M,D,K,$,J,Q,W,X,Y,Z,ee,ne,te,re,ae,ue,le,oe,ie,se,ce;return{setters:[function(e){u=e.c,l=e.u,o=e._,i=e.j,s=e.h,c=e.ag,f=e.K,p=e.M,v=e.at,m=e.o,g=e.ai},function(e){d=e.c,y=e.p,h=e.G,b=e.H,x=e.x,w=e.q,_=e.v,k=e.F,j=e.z,S=e.C,E=e.y,L=e.e,C=e.B,I=e.A,V=e.t,P=e.M,T=e.P,z=e.K,F=e.al,O=e.a$,B=e.T,A=e.D,U=e.ax,G=e.a9,N=e.a7,R=e.j,q=e.r,H=e.k,M=e.g,D=e.n},function(e){K=e._,$=e.f,J=e.p},function(e){Q=e._},function(e){W=e._},function(e){X=e.u,Y=e.S},function(e){Z=e._},function(e){ee=e.p},function(e){ne=e.A},function(e){te=e.getSiteErrorLogs,re=e.getSpringBootLogList,ae=e.getSpringBootLog,ue=e.changeSiteLogPath,le=e.setPushTask,oe=e.getSiteLogPushStatus,ie=e.getIpArea,se=e.getSiteLogs,ce=e.getSiteLogFile}],execute:function(){var t={class:"h-full"},fe={key:0,class:"mb-[16px]"},pe={class:"flex"},ve={key:1,class:"bg-[#7F7F7F] flex items-center justify-center h-full",style:{"min-height":"500px"}},me={class:"bg-white px-[48px] py-[16px] text-[#333] flex items-center"},ge=n("b",d({__name:"error-log",setup:function(e,n){var r=n.expose,l=X(),o=l.isBindExtranet,i=l.siteType,s=Y().jumpTabEvent;return y(on),r({init:on}),function(e,n){var r=u,l=h("bt-loading");return b((w(),_("div",t,[x(o)?(w(),_(k,{key:0},["proxy"===x(i)?(w(),_("div",fe,"日志大小："+j(x(en).size),1)):S("",!0),E("div",pe,[L(W,{content:x(en).logs,isHtml:!0,fullScreen:{title:"全屏查看[错误]日志",onRefresh:x(on)},style:{height:"56rem",width:"99.5%"}},null,8,["content","fullScreen"])])],64)):(w(),_("div",ve,[E("div",me,[n[2]||(n[2]=C(" 请开启 ",-1)),L(r,{class:"mx-[.4rem]",onClick:n[0]||(n[0]=function(e){return x(s)("mapping")})},{default:I(function(){return a(n[1]||(n[1]=[C(" 外网映射 ",-1)]))}),_:1}),n[3]||(n[3]=C(" 后查看 ",-1))])]))])),[[l,x(Ze)]])}}})),de={class:"h-full"},ye={key:0,class:"flex items-center justify-between pb-1.6rem"},he={class:"flex items-center"},be={class:"ml-[8px]"},xe={class:"flex items-center"},we={class:"flex items-center p-[12px]"},_e={key:1,class:"mb-[16px]"},ke={key:2,class:"mt-1rem"},je={key:1,class:"bg-[#7F7F7F] flex items-center justify-center h-full",style:{"min-height":"500px"}},Se={class:"bg-white px-[48px] py-[16px] text-[#333] flex items-center"},Ee={class:"p-[20px]"},Le=n("_",d({__name:"response-log",setup:function(e,n){var t=n.expose,r=l(),c=r.plugin,f=r.enterpriseRec,p=V(c.value).webserver,v=X(),m=v.isBindExtranet,g=v.siteType,d=Y().jumpTabEvent;return y(Fn),t({init:Fn}),function(e,n){var t=F,r=O,l=o,c=B,v=Z,y=A,V=U,R=u,q=i,H=G,M=N,D=s,$=h("bt-loading");return w(),_("div",de,[x(m)?(w(),_(k,{key:0},["proxy"!==x(g)?(w(),_("div",ye,[b((w(),_("div",he,["python"!==x(g)?(w(),_(k,{key:0},[L(t,{onChange:x(En),modelValue:x(yn).alert,"onUpdate:modelValue":n[0]||(n[0]=function(e){return x(yn).alert=e})},null,8,["onChange","modelValue"]),E("span",be,[n[14]||(n[14]=C(" 关键字告警 ",-1)),E("span",{class:"!inline-block bt-link",onClick:n[1]||(n[1]=function(){return x(Vn)&&x(Vn).apply(void 0,arguments)})}," [配置] ")]),L(r,{direction:"vertical",class:"!h-2rem !mx-1.6rem"})],64)):S("",!0),x(f)?(w(),P(c,{key:1,onChange:x(Sn),modelValue:x(yn).showIp,"onUpdate:modelValue":n[2]||(n[2]=function(e){return x(yn).showIp=e})},{default:I(function(){return[E("div",xe,[n[15]||(n[15]=C(" 显示IP归属地信息 ",-1)),L(l,{icon:"icon-ltd",size:16,color:"#9B7E48",class:"ml-[4px]"})])]}),_:1},8,["onChange","modelValue"])):S("",!0),"php"===x(g)?(w(),_(k,{key:2},[L(r,{direction:"vertical",class:"!h-2rem !mx-1.6rem"}),L(V,{trigger:"click",placement:"bottom","popper-class":"white-tips-popover",width:"400",visible:x(dn),"onUpdate:visible":n[5]||(n[5]=function(e){return T(dn)?dn.value=e:null})},{reference:I(function(){return[L(y,{type:"default"},{default:I(function(){return a(n[17]||(n[17]=[C("更改日志路径",-1)]))}),_:1})]}),default:I(function(){return[E("div",we,[L(v,{placeholder:"请输入日志路径",modelValue:x(gn),"onUpdate:modelValue":n[3]||(n[3]=function(e){return T(gn)?gn.value=e:null}),onIconClick:x(kn),icon:"el-folder-opened"},null,8,["modelValue","onIconClick"]),L(y,{type:"primary",class:"!ml-[8px]",onClick:n[4]||(n[4]=function(e){return x(jn)()})},{default:I(function(){return a(n[16]||(n[16]=[C(" 保存 ",-1)]))}),_:1})])]}),_:1},8,["visible"])],64)):S("",!0)])),[[$,x(Ze)]]),L(y,{type:"primary",onClick:n[6]||(n[6]=function(){return x(Tn)()})},{default:I(function(){return a(n[18]||(n[18]=[C("刷新日志",-1)]))}),_:1})])):S("",!0),"proxy"===x(g)?(w(),_("div",_e,"日志大小："+j(x(yn).size),1)):S("",!0),b(L(W,{content:x(yn).logs,isHtml:!0,fullScreen:{title:"全屏查看[响应]日志",onRefresh:x(Tn)},style:z({height:"php"===x(g)?"52rem":"56rem",width:"99.5%"})},null,8,["content","fullScreen","style"]),[[$,x(Ze)]]),"nginx"===x(p)&&"php"===x(g)?(w(),_("div",ke,[n[19]||(n[19]=C(" * 若网站开启cdn导致日志",-1)),n[20]||(n[20]=E("span",{class:"text-danger"},"来源IP",-1)),n[21]||(n[21]=C("解析错误，可前往[ ",-1)),E("span",{class:"cursor-pointer bt-link",onClick:n[7]||(n[7]=function(e){return x(ee)("globalSetting")})},"全局设置"),n[22]||(n[22]=C(" ]打开cdn来源IP解析 ",-1))])):S("",!0)],64)):(w(),_("div",je,[E("div",Se,[n[24]||(n[24]=C(" 请开启 ",-1)),L(R,{class:"mx-[.4rem]",onClick:n[8]||(n[8]=function(e){return x(d)("mapping")})},{default:I(function(){return a(n[23]||(n[23]=[C(" 外网映射 ",-1)]))}),_:1}),n[25]||(n[25]=C(" 后查看 ",-1))])])),L(D,{title:"关键字告警配置",onConfirm:n[12]||(n[12]=function(e){return x(Cn)(x(wn),"confirm")}),onCancel:x(Ln),modelValue:x(bn),"onUpdate:modelValue":n[13]||(n[13]=function(e){return T(bn)?bn.value=e:null}),area:46,showFooter:""},{default:I(function(){return[E("div",Ee,[L(M,{"label-position":"right",model:x(wn),rules:x(_n),ref_key:"alertSetFormRef",ref:xn},{default:I(function(){return[L(H,{label:"周期",prop:"cycle"},{default:I(function(){return[L(q,{modelValue:x(wn).cycle,"onUpdate:modelValue":n[9]||(n[9]=function(e){return x(wn).cycle=e}),type:"number",min:1,width:"24rem","text-type":"分钟"},null,8,["modelValue"])]}),_:1}),L(H,{label:"关键字",prop:"keys"},{default:I(function(){return[L(q,{modelValue:x(wn).keys,"onUpdate:modelValue":n[10]||(n[10]=function(e){return x(wn).keys=e}),type:"textarea",resize:"none",row:6,width:"24rem"},null,8,["modelValue"])]}),_:1}),L(H,{label:"告警方式",prop:"channel"},{default:I(function(){return[L(K,{modelValue:x(wn).channel,"onUpdate:modelValue":n[11]||(n[11]=function(e){return x(wn).channel=e}),multiple:!0,limit:["sms"],class:"!w-[24rem]"},null,8,["modelValue"])]}),_:1})]}),_:1},8,["model","rules"]),n[26]||(n[26]=E("ul",{class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},[E("li",null,"检查时只检查间隔时间内的日志内容"),E("li",null,"周期时间请勿设置太小，建议10分钟以上以免导致服务器资源异常")],-1))])]}),_:1},8,["onCancel","modelValue"])])}}})),Ce={key:1,class:"bg-[#7F7F7F] flex items-center justify-center h-full",style:{"min-height":"500px"}},Ie={class:"bg-white px-[48px] py-[16px] text-[#333] flex items-center"},Ve=d({__name:"safe-analysis",setup:function(e){var n=X(),t=n.isBindExtranet,r=n.siteInfo,l=Y().jumpTabEvent;return function(e,n){var o=u;return w(),_("div",null,[x(t)?(w(),P(ne,{key:0,type:"site",name:x(r).name},null,8,["name"])):(w(),_("div",Ce,[E("div",Ie,[n[2]||(n[2]=C(" 请开启 ",-1)),L(o,{class:"mx-[.4rem]",onClick:n[0]||(n[0]=function(e){return x(l)("mapping")})},{default:I(function(){return a(n[1]||(n[1]=[C(" 外网映射 ",-1)]))}),_:1}),n[3]||(n[3]=C(" 后查看 ",-1))])]))])}}}),Pe={class:"flex flex-col"},Te={class:"flex items-center"},ze={class:"mt-[16px]"},Fe={class:"p-[12px] w-full flex items-start overflow-y-auto h-full"},Oe=["innerHTML"],Be=d({__name:"spring-boot-logs",setup:function(e,n){var t=n.expose,r=l().mainHeight;return y(mn),t({init:mn}),function(e,n){var t=c,u=A,l=s,o=h("bt-loading");return b((w(),_("div",Pe,[E("div",Te,[n[2]||(n[2]=E("span",null,"日志路径",-1)),L(t,{modelValue:x(un).path,"onUpdate:modelValue":n[0]||(n[0]=function(e){return x(un).path=e}),options:x(nn),onChange:x(cn),placeholder:"请选择",class:"!w-[38rem] !mx-[.8rem]"},null,8,["modelValue","options","onChange"])]),E("div",ze,[E("div",null,[L(u,{type:"primary",onClick:x(sn)},{default:I(function(){return a(n[3]||(n[3]=[C("刷新日志",-1)]))}),_:1},8,["onClick"]),L(u,{type:"default",onClick:x(pn)},{default:I(function(){return a(n[4]||(n[4]=[C("实时日志",-1)]))}),_:1},8,["onClick"])]),L(W,{title:"全屏查看【项目】日志",content:x(un).logs,isHtml:!0,fullScreen:{title:"全屏查看【项目】日志",onRefresh:x(sn)},class:"mt-[16px]",style:z({height:"java"===x(tn)?"48rem":"64rem",width:"99.5%"})},null,8,["content","fullScreen","style"])]),L(l,{title:"查看日志",onCancel:x(vn),modelValue:x(rn),"onUpdate:modelValue":n[1]||(n[1]=function(e){return T(rn)?rn.value=e:null}),area:["100%","100%"],"close-btn":1},{default:I(function(){return[E("div",{ref_key:"logPopupCon",ref:an,class:"bg-[#333] text-white w-full h-full",style:z("height: ".concat(x(r),"px;"))},[E("pre",Fe,[n[5]||(n[5]=C("\t\t\t\t\t",-1)),E("code",{class:"flex-1 w-full p-0 bg-none whitespace-pre-line text-i text-[#ececec]",innerHTML:x(un).logs},null,8,Oe),n[6]||(n[6]=C("\n\t\t\t\t",-1))])],4)]}),_:1},8,["onCancel","modelValue"])])),[[o,x(Ze)]])}}}),Ae=R("SITE-LOGS-STORE",function(){var n=X(),t=n.siteType,a=n.siteInfo,u=function(){var n=r(e().m(function n(r){var a,u;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,te(r,t.value);case 1:return a=e.v,u=a.data,e.a(2,{data:u,status:!0});case 2:return e.p=2,e.v,e.a(2,{msg:"获取错误日志失败",status:!1})}},n,null,[[0,2]])}));return function(e){return n.apply(this,arguments)}}(),l=function(){var n=r(e().m(function n(t){var r,a;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,re(t);case 1:return r=e.v,a=r.data,e.a(2,{data:a.data,status:a.status});case 2:return e.p=2,e.v,e.a(2,{msg:"获取日志失败",status:!1})}},n,null,[[0,2]])}));return function(e){return n.apply(this,arguments)}}(),o=function(){var n=r(e().m(function n(t){var r,a;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,ae(t);case 1:return r=e.v,a=r.data,e.a(2,{status:a.status,msg:a.data});case 2:return e.p=2,e.v,e.a(2,{msg:"保存路径失败",status:!1})}},n,null,[[0,2]])}));return function(e){return n.apply(this,arguments)}}(),i=function(){var n=r(e().m(function n(t){var r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f({loading:"正在保存日志路径，请稍后...",request:ue(t),message:!0});case 1:return r=e.v,e.a(2,{status:r.status,msg:r.msg});case 2:return e.p=2,e.v,e.a(2,{msg:"保存路径失败",status:!1})}},n,null,[[0,2]])}));return function(e){return n.apply(this,arguments)}}(),s=function(){var n=r(e().m(function n(t){var r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f({loading:"正则处理中，请稍后...",request:le(t),message:!0});case 1:return r=e.v,e.a(2,{status:r.status,msg:r.msg});case 2:return e.p=2,e.v,e.a(2,{status:!1,msg:"推送失败"})}},n,null,[[0,2]])}));return function(e){return n.apply(this,arguments)}}(),c=function(){var n=r(e().m(function n(){var t;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f({request:oe({sitename:a.value.name}),data:{status:Boolean,"config.cycle":[Number,"cycle"],"config.keys":[Array,"keys"],"config.channel":[String,"channel"]}});case 1:return t=e.v,e.a(2,{data:t,status:!0});case 2:return e.p=2,e.v,e.a(2,{msg:"获取推送配置失败",status:!1})}},n,null,[[0,2]])}));return function(){return n.apply(this,arguments)}}(),p=function(){var n=r(e().m(function n(){var t;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f({request:ie(),data:{msg:[Number,"msg"]}});case 1:return t=e.v,e.a(2,{data:t.msg,status:!0});case 2:return e.p=2,e.v,e.a(2,{msg:"获取IP归属地失败",status:!1})}},n,null,[[0,2]])}));return function(){return n.apply(this,arguments)}}(),v=function(){var n=r(e().m(function n(r){var a;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,se(r,t.value);case 1:return a=e.v,e.a(2,{data:a.data,status:a.status});case 2:return e.p=2,e.v,e.a(2,{msg:"获取日志失败",status:!1})}},n,null,[[0,2]])}));return function(e){return n.apply(this,arguments)}}();return{getErrorLogsEvent:u,getSpringLogEvent:l,setSpringPathEvent:o,saveResLogPathEvent:i,setPushTaskEvent:s,getLogPushEvent:c,getIpStatusEvent:p,getResLogEvent:v}}),Ue=l().payment,Ge=V(Ue.value).authType,Ne=Ae(),Re=Ne.getErrorLogsEvent,qe=Ne.getSpringLogEvent,He=Ne.setSpringPathEvent,Me=Ne.saveResLogPathEvent,De=Ne.setPushTaskEvent,Ke=Ne.getLogPushEvent,$e=Ne.getIpStatusEvent,Je=Ne.getResLogEvent,Qe=X(),We=Qe.siteType,Xe=Qe.siteInfo,Ye=Qe.isBindExtranet,Ze=q(!1),en=q({logs:"",size:"0 b"}),nn=q([]),tn=q(""),rn=q(!1),an=q(null),un=H({path:"",logs:"",type:"",size:"",isNew:!1,isGunicorn:!1}),ln=(n("t",M(function(){var e;return(null===(e=Xe.value)||void 0===e?void 0:e.tabName)||("java"===We.value?"projectLog":"response")})),n("a",q([{label:"响应日志",name:"response",lazy:!0,render:function(){return L(Le,null,null)}},{label:"错误日志",name:"error",lazy:!0,render:function(){return L(ge,null,null)}},{label:"日志安全分析",name:"safe",lazy:!0,render:function(){return L(Ve,null,null)}}]))),on=(n("o",function(e){}),n("i",function(){var e,n;"java"===We.value?(ln.value.some(function(e){return"projectLog"===e.name})||ln.value.unshift({label:"项目日志",name:"projectLog",lazy:!0,render:function(){return L(Q,null,null)}}),"springboot"===(null===(n=Xe.value)||void 0===n||null===(n=n.project_config)||void 0===n?void 0:n.java_type)?ln.value.some(function(e){return"springbootLog"===e.name})||ln.value.push({label:"springBoot日志",name:"springbootLog",lazy:!0,render:function(){return L(Be,null,null)}}):ln.value=ln.value.filter(function(e){return"springbootLog"!==e.name})):ln.value=ln.value.filter(function(e){return"projectLog"!==e.name&&"springbootLog"!==e.name});["php","proxy","html"].includes(We.value)?Ye.value=!0:Ye.value=!(null===(e=Xe.value)||void 0===e||null===(e=e.project_config)||void 0===e||!e.bind_extranet)}),function(){var n=r(e().m(function n(){var t,r,a,u,l,o,i;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Ye.value){e.n=1;break}return e.a(2);case 1:return t=Xe.value.name,r=We.value,a={proxy:{site_name:t,type:"error"},default:{siteName:t}},e.p=2,Ze.value=!0,e.n=3,Re(a[r]||a.default);case 3:return o=e.v,"proxy"===r&&(en.value.size=o.data.size||"0 b"),en.value.logs=(null===(u=o.data)||void 0===u?void 0:u.logs)||(null===(l=o.data)||void 0===l?void 0:l.msg)||"暂无日志信息",e.a(2,o);case 4:return e.p=4,i=e.v,v(i),e.a(2,{msg:"获取错误日志失败",status:!1});case 5:return e.p=5,Ze.value=!1,e.f(5);case 6:return e.a(2)}},n,null,[[2,4,5,6]])}));return function(){return n.apply(this,arguments)}}()),sn=function(){var n=r(e().m(function n(){var t,r,a;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return Ze.value=!0,e.p=1,t={project_name:Xe.value.name},e.n=2,qe(t);case 2:r=e.v,a=r.data,r.status&&(nn.value=a.map(function(e){return{label:e,value:e}}),un.logs="正在获取日志",un.path=(null==a?void 0:a[0])||"",cn()),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,Ze.value=!1,e.f(4);case 5:return e.a(2)}},n,null,[[1,3,4,5]])}));return function(){return n.apply(this,arguments)}}(),cn=function(){var n=r(e().m(function n(t){var r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,un.path){e.n=1;break}return un.logs="暂未在SpringBoot框架中查找到日志配置信息",e.a(2,!1);case 1:return e.n=2,He({log_file:un.path});case 2:return(r=e.v).status||p.error(r.msg),un.logs=r.msg||"获取日志失败",e.a(2,r);case 3:return e.p=3,e.v,e.a(2,{msg:"保存路径失败",status:!1})}},n,null,[[0,3]])}));return function(e){return n.apply(this,arguments)}}(),fn=null,pn=function(){rn.value=!0,D(function(){an.value&&(an.value.scrollTop=an.value.scrollHeight)}),fn&&clearInterval(fn),fn=setInterval(function(){sn()},2e3)},vn=function(){rn.value=!1,clearInterval(fn),fn=null},mn=function(){var e,n;tn.value="java",un.type=(null===(e=Xe.value.project_config)||void 0===e?void 0:e.loglevel)||"",un.isGunicorn="gunicorn"===(null===(n=Xe.value.project_config)||void 0===n?void 0:n.stype),sn()},gn=q(""),dn=q(!1),yn=H({alert:!1,showIp:!1,ipData:0,logs:"",size:"0 b"}),hn=q(!1),bn=q(!1),xn=q(),wn=H({cycle:0,keys:"",channel:[]}),_n=H({cycle:[{required:!0,message:"请输入周期",trigger:"blur"}],keys:[{required:!0,message:"请输入关键字",trigger:"blur"}],channel:[{required:!0,message:"请选择告警方式",trigger:"blur"}]}),kn=function(){$({type:"dir",path:gn.value,change:function(e){gn.value=e,setTimeout(function(){dn.value=!0},0)}})},jn=function(){var n=r(e().m(function n(){var t=arguments;return e().w(function(e){for(;;)switch(e.n){case 0:return t.length>0&&void 0!==t[0]?t[0]:{site_name:Xe.value.name,log_path:gn.value},e.n=1,m({title:"保存日志路径",content:"是否保存日志路径[".concat(gn.value,"]")});case 1:return e.n=2,Me({site_name:Xe.value.name,log_path:gn.value});case 2:e.v.status&&(Tn(),zn(),dn.value=!1);case 3:return e.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),Sn=function(){var n=r(e().m(function n(){return e().w(function(e){for(;;)switch(e.n){case 0:"ltd"!==Ge.value?(yn.showIp=!1,J({disablePro:!0,sourceId:184})):Tn();case 1:return e.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),En=function(){var n=r(e().m(function n(t){return e().w(function(e){for(;;)switch(e.n){case 0:hn.value=!0,t?bn.value=!0:Cn({},"switch");case 1:return e.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}(),Ln=function(){hn.value&&(yn.alert=!yn.alert,hn.value=!1)},Cn=function(){var n=r(e().m(function n(t,r){var a,u;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!bn.value){e.n=1;break}return e.n=1,xn.value.validate();case 1:return a={sitename:Xe.value.name},"switch"!==r&&(hn.value||delete a.sitename,a.channel=t.channel.filter(function(e){return""!==e}).join(","),a.cycle=t.cycle,a.keys=JSON.stringify(g(t.keys)?t.keys.split(","):t.keys)),e.n=2,De(a);case 2:return(u=e.v).status&&In(),e.a(2,u.status);case 3:return e.p=3,e.v,e.a(2,!1)}},n,null,[[0,3]])}));return function(e,t){return n.apply(this,arguments)}}(),In=function(){var n=r(e().m(function n(){var t,r,a,u,l,o;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Ke();case 1:return t=e.v,r={},t.status?(yn.alert=t.data.status,a=t.data,u=a.cycle,l=a.keys,o=a.channel,r={cycle:u,keys:l,channel:o.split(","),status:t.status}):yn.alert=!1,Object.assign(wn,r),e.a(2,{data:r,status:t.status});case 2:return e.p=2,e.v,e.a(2,{msg:"获取告警配置失败",status:!1})}},n,null,[[0,2]])}));return function(){return n.apply(this,arguments)}}(),Vn=function(){bn.value=!0,In()},Pn=function(){var n=r(e().m(function n(){var t;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,$e();case 1:t=e.v,yn.showIp=1===t.data,e.n=3;break;case 2:return e.p=2,e.v,e.a(2,{msg:"获取IP归属地失败",status:!1});case 3:return e.a(2)}},n,null,[[0,2]])}));return function(){return n.apply(this,arguments)}}(),Tn=function(){var n=r(e().m(function n(){var t,r,a,u,l,o=arguments;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:Xe.value.name,r=o.length>1&&void 0!==o[1]?o[1]:We.value,"ltd"!==Ge.value&&(yn.showIp=!1),a={proxy:{site_name:t,type:"access"},default:{siteName:t,ip_area:Number(yn.showIp)}},e.p=1,Ze.value=!0,e.n=2,Je(a[r]||a.default);case 2:return u=e.v,"proxy"===r?(yn.logs=u.data.msg||"暂无日志信息",yn.size=u.data.size||"0 b"):yn.logs=u.data.msg||"暂无日志信息",e.a(2,u);case 3:return e.p=3,l=e.v,v(l),e.a(2,{msg:"获取日志失败",status:!1});case 4:return e.p=4,Ze.value=!1,e.f(4);case 5:return e.a(2)}},n,null,[[1,3,4,5]])}));return function(){return n.apply(this,arguments)}}(),zn=function(){f({request:ce({siteName:Xe.value.name}),data:{log_file:String,status:Boolean,msg:String},success:function(e){gn.value=e.log_file,e.status||p.error(e.msg)}})},Fn=function(){var n=r(e().m(function n(){return e().w(function(e){for(;;)switch(e.n){case 0:if(Ye.value){e.n=1;break}return e.a(2);case 1:return e.n=2,Pn();case 2:if("python"===We.value){e.n=3;break}return e.n=3,In();case 3:return e.n=4,Tn();case 4:zn();case 5:return e.a(2)}},n)}));return function(){return n.apply(this,arguments)}}()}}})}();
