import{_ as t}from"./index103.js?v=1756369731";import{_ as e}from"./index112.js?v=1756369731";import{bv as s,R as r,K as a,S as o,k as i}from"./utils-lib.js?v=1756369731";import{N as n}from"./firewall.js?v=1756369731";import{c as l,r as p,e as m,k as d,w as c,p as _,q as u,M as j,A as w,x as f}from"./base-lib.js?v=1756369731";import{k as h}from"./useController12.js?v=1756369731";import{u as k}from"./column.js?v=1756369731";import{aT as b}from"./store.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore4.js?v=1756369731";import"./site.js?v=1756369731";import"./useController6.js?v=1756369731";import"./files.js?v=1756369731";import"./store2.js?v=1756369731";import"./index101.js?v=1756369731";const g=l({__name:"risk-detail",props:{compData:{default:()=>{}}},setup(l){const g=l,x=p([]),y=p(0),C=(t,e)=>{b({path:t})},v=p([{label:"巡检时间",width:"150px",render:t=>{const e=s(t.time,"number",0);return m("span",null,[r(e)])}},{label:"URL",render:t=>m("span",{class:"bt-link",title:t.url,onClick:()=>window.open(t.url,"_blank","noopener,noreferrer")},[t.url])},{label:"关键词",prop:"content",width:"200px"},{label:"类型",prop:"risk_content",width:"200px"},{label:"风险位置",width:"150px",render:t=>h[t.risk_type]},k([{onClick:t=>{let e="/www/server/panel/class/projectModel/content/source/",s=e+t.source_file;t.risk_type.indexOf("_update")>-1?((t,e)=>{"title_hash_update"!==t.risk_type&&"tail_hash_update"!==t.risk_type||(e="/www/server/panel/class/projectModel/content/hash/"+t.site_name+"/"),t.source_content_file;let s=e+t.new_content_file;C(s)})(t,e):C(s,t.content)},title:"详情"}])]),D=d({p:1,limit:10,testing_id:g.compData.testing_id}),M=async(t=1)=>{await a({loading:"正在获取IP规则列表，请稍后...",request:n(D),data:{data:[Array,x],page:o(y)}})};return c(()=>g.compData,t=>{D.testing_id=t.testing_id}),_(()=>M()),(s,r)=>{const a=i,o=e,n=t;return u(),j(n,{class:"p-[2rem]"},{content:w(()=>[m(a,{column:f(v),data:f(x)},null,8,["column","data"])]),"footer-right":w(()=>[m(o,{total:f(y),page:f(D).p,"onUpdate:page":r[0]||(r[0]=t=>f(D).p=t),row:f(D).limit,"onUpdate:row":r[1]||(r[1]=t=>f(D).limit=t),onChange:M},null,8,["total","page","row"])]),_:1})}}});export{g as default};
