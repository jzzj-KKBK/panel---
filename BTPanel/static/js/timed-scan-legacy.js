!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,l){if(e){if("string"==typeof e)return n(e,l);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n(e,l):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var l=0,t=Array(n);l<n;l++)t[l]=e[l];return t}System.register(["./base-lib-legacy.js?v=1756369731","./validator-legacy.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./index-legacy306.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./column-legacy.js?v=1756369731","./useStore-legacy8.js?v=1756369731"],function(n,l){"use strict";var t,o,u,r,a,i,d,s,c,f,m,p,y,_,v,g,b,V,h,k,j,U,A,x,S,w,C,I,F,L,D,M,T,z,H,O,$,q;return{setters:[function(e){t=e.c,o=e.p,u=e.G,r=e.q,a=e.v,i=e.H,d=e.x,s=e.M,c=e.A,f=e.e,m=e.C,p=e.y,y=e.T,_=e.ba,v=e.B,g=e.z,b=e.F,V=e.I,h=e.Q,k=e.al,j=e.a9,U=e.b8,A=e.b9,x=e.S,S=e.a7},function(e){w=e._},function(e){C=e.$,I=e.j,F=e.ag,L=e.e},function(e){D=e.u,M=e.b,T=e.c,z=e.d,H=e.f,O=e.h,$=e.j,q=e.t},null,null,null,null],execute:function(){var l={class:"px-[2rem] py-[2.4rem]"},B={class:"condition-risk"},E={class:"flex items-center"},G={class:"tip"},P={key:0},Q=t({__name:"timed-scan",setup:function(n,t){var L=t.expose,Q=D(),J=Q.isAutoScan,K=Q.ruleForm,N=Q.userOptions,R=Q.isLoading,W=Q.addFtpInfo;return o(M),L({onConfirm:T}),function(n,t){var o=k,L=j,D=C,M=I,T=F,Q=U,X=A,Y=x,Z=w,ee=S,ne=u("bt-loading");return r(),a("div",l,[i((r(),s(ee,{ref_key:"addFtpInfo",ref:W,model:d(K),class:"btCustomForm p-0","label-width":"4rem",rules:d(q),onSubmit:t[13]||(t[13]=h(function(){},["prevent"]))},{default:c(function(){return[d(J)?(r(),s(L,{key:0,label:"告警状态"},{default:c(function(){return[f(o,{modelValue:d(K).status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return d(K).status=e}),"active-color":"#20A53A","inactive-color":"#cdcdcd"},null,8,["modelValue"])]}),_:1})):m("",!0),f(L,{label:"安全风险项",prop:"risk"},{default:c(function(){return[p("div",B,[f(d(y),{modelValue:d(K).login_error,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d(K).login_error=e})},{default:c(function(){return[t[14]||(t[14]=p("span",null,"多次登录失败",-1)),f(d(_),{type:"info",class:"risk-tag",title:d(K).config.login_error_des},{default:c(function(){return[v(g(d(K).config.login_error_des),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),f(d(y),{modelValue:d(K).time,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d(K).time=e})},{default:c(function(){var e;return[t[15]||(t[15]=p("span",null,"登录时间异常",-1)),f(d(_),{type:"info",class:"risk-tag",title:null===(e=d(K).config)||void 0===e?void 0:e.time_des},{default:c(function(){var e;return[v(g(null===(e=d(K).config)||void 0===e?void 0:e.time_des),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),f(d(y),{modelValue:d(K).area,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d(K).area=e})},{default:c(function(){var e;return[t[16]||(t[16]=p("span",null,"登录地区异常",-1)),f(d(_),{type:"info",class:"risk-tag",title:null===(e=d(K).config)||void 0===e?void 0:e.area_des},{default:c(function(){var e,n;return[v(g(null!==(e=d(K).config)&&void 0!==e&&null!==(e=e.area)&&void 0!==e&&e.country.length?null===(n=d(K).config)||void 0===n?void 0:n.area_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),f(d(y),{modelValue:d(K).anonymous,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d(K).anonymous=e}),disabled:"other"===d(K).user&&!d(J)},{default:c(function(){return e(t[17]||(t[17]=[p("span",null,"匿名用户登录",-1)]))}),_:1},8,["modelValue","disabled"]),f(d(y),{modelValue:d(K).upload_shell,"onUpdate:modelValue":t[5]||(t[5]=function(e){return d(K).upload_shell=e})},{default:c(function(){var e;return[t[18]||(t[18]=p("span",null,"上传脚本文件",-1)),f(d(_),{type:"info",class:"risk-tag",title:null===(e=d(K).config)||void 0===e?void 0:e.upload_shell_des},{default:c(function(){var e,n;return[v(g(null!==(e=d(K).config)&&void 0!==e&&null!==(e=e.upload_shell)&&void 0!==e&&e.length?null===(n=d(K).config)||void 0===n?void 0:n.upload_shell_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),p("span",{class:"bt-link",onClick:t[6]||(t[6]=function(){return d(z)&&d(z).apply(void 0,arguments)})}," 【设置扫描触发条件】 ")])]}),_:1}),d(J)?(r(),a(b,{key:2},[i(f(L,{label:"周期",prop:"cycle"},{default:c(function(){return[f(Y,{class:"max-w-[16rem]",modelValue:d(K).cycle,"onUpdate:modelValue":t[11]||(t[11]=function(e){return d(K).cycle=e}),min:1,type:"number"},{append:c(function(){return[f(X,{type:"flex"},{default:c(function(){return[f(Q,null,{default:c(function(){return e(t[19]||(t[19]=[p("span",null,"天",-1)]))}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]}),_:1},512),[[V,!1]]),f(L,{label:"告警方式",prop:"channel"},{default:c(function(){return[f(Z,{modelValue:d(K).channel,"onUpdate:modelValue":t[12]||(t[12]=function(e){return d(K).channel=e}),multiple:!0,class:"!w-30rem",limit:["wx_account","sms"]},null,8,["modelValue"])]}),_:1})],64)):(r(),a(b,{key:1},[f(L,{label:"扫描日志天数",prop:"otherDay"},{default:c(function(){return[f(D,{type:"button",size:"small",modelValue:d(K).day,"onUpdate:modelValue":t[7]||(t[7]=function(e){return d(K).day=e}),options:d(H)},null,8,["modelValue","options"]),"other"===d(K).day?(r(),s(M,{key:0,type:"number",modelValue:d(K).otherDay,"onUpdate:modelValue":t[8]||(t[8]=function(e){return d(K).otherDay=e}),modelModifiers:{number:!0},class:"!inline-block ml-[1rem]"},null,8,["modelValue"])):m("",!0)]}),_:1}),f(L,{label:"FTP用户",prop:"userList"},{default:c(function(){return[p("div",E,[f(T,{class:"!w-[16rem]",modelValue:d(K).user,"onUpdate:modelValue":t[9]||(t[9]=function(e){return d(K).user=e}),options:d(O),onChange:d($)},null,8,["modelValue","options","onChange"]),"other"===d(K).user?(r(),s(T,{key:0,class:"ml-[1rem]",multiple:"","collapse-tags":"",filterable:"",modelValue:d(K).userList,"onUpdate:modelValue":t[10]||(t[10]=function(e){return d(K).userList=e}),options:d(N)},null,8,["modelValue","options"])):m("",!0)])]}),_:1})],64))]}),_:1},8,["model","rules"])),[[ne,d(R)]]),p("div",G,[p("ul",null,[d(J)?(r(),a("li",P,"默认扫描全部用户30天的日志")):m("",!0),t[20]||(t[20]=p("li",null,"【多次登录失败】检测时间为：5分钟",-1))])])])}}});n("default",L(Q,[["__scopeId","data-v-0fb4045b"]]))}}})}();
