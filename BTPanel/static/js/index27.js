import{_ as e}from"./index103.js?v=1756369731";import{u as t,aq as s,aL as a,c as l,b as i,ay as n,aM as o,a6 as r,a7 as c,a8 as m,e as p}from"./utils-lib.js?v=1756369731";import{u}from"./index141.js?v=1756369731";import{c as d,r as f,k,p as y,aD as v,x as h,q as x,M as b,A as g,v as _,y as j,e as w,B as C,C as B,s as S,aB as D,an as I,ap as q,ao as L,a4 as P,i as R}from"./base-lib.js?v=1756369731";import{k as T}from"./validator.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";import{a as A,o as H,g as M,u as O}from"./column.js?v=1756369731";import{D as F,u as N,a as W,b as E,c as G,g as J,d as K,o as V,e as z,f as Q,s as U,h as X,i as Y,j as Z}from"./useController4.js?v=1756369731";import{N as $}from"./useMethods.js?v=1756369731";import{B as ee}from"./index131.js?v=1756369731";import{_ as te}from"./index130.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index124.js?v=1756369731";import"./index104.js?v=1756369731";import"./useController5.js?v=1756369731";import"./site.js?v=1756369731";import"./useStore4.js?v=1756369731";import"./useController6.js?v=1756369731";import"./useMethod5.js?v=1756369731";const se={key:0,class:"flex items-center"},ae={key:1,class:"flex items-center"},le=d({__name:"index",emits:["init"],setup(e,{expose:n,emit:o}){const r=i(),c=o,{plugin:m}=t(),p=f(m.value.webserver),u=f(!1),d=f(!1),S=k({title:"",name:"",status:!0,version:"",admin:!1,s_version:"",setup:!1});let D=!1;const I=async(e=!1)=>{try{if(D)return;const{data:t}=await a({name:"web"});t.status||e||setTimeout(()=>{I()},3e3),t.status&&!e&&c("init"),u.value=!t.status,Object.assign(S,t),"nginx"!==t.name&&(u.value=!0,d.value=t.status)}catch(t){e||setTimeout(()=>{I()},3e3)}};return y(()=>{I(!0)}),v(()=>{D=!0}),n({checkInstallStatus:I,pluginInfo:S,maskLayer:u,webServerType:p}),(e,t)=>{const a=l,i=te;return h(u)?(x(),b(i,{key:0,width:"38rem"},{content:g(()=>[h(d)?(x(),_("div",ae,[...t[3]||(t[3]=[j("span",null,"Docker项目只支持nginx环境",-1)])])):(x(),_("div",se,[t[2]||(t[2]=j("span",null,"未安装运行环境，",-1)),w(a,{onClick:t[0]||(t[0]=e=>(async e=>{const{data:t}=await s({sName:e.name});if("-1"===t.task)return r.error("当前插件正在安装，不可重复安装");T({name:null==t?void 0:t.name,type:"i",pluginInfo:t}),I()})({name:"nginx"})),class:"!font-bold !text-[1.4rem]"},{default:g(()=>[...t[1]||(t[1]=[C("安装Nginx",-1)])]),_:1})]))]),_:1})):B("",!0)}}}),ie={class:""},ne={class:"flex items-center ml-1rem"};const oe=p(d({__name:"index",setup(s){const{mainHeight:a}=t(),{getDockerSiteList:i,setDockerSiteStatus:p,setDockerSiteRemark:d,delDockerSite:f,resetData:k}=F(),{refs:{isRefreshSiteList:v}}=n(),{pluginInfo:b,classList:B,statusFilterKey:T}=S(F()),{BtOperation:te}=o({options:[{type:"button",label:"创建",active:!0,onClick:()=>Q()},{type:"button",label:"运行环境",onClick:()=>U()},{type:"button",label:"常用设置",onClick:()=>X()},{type:"custom",render:()=>w(ee,{style:"margin-left:1.2rem;",isRequest:!1,pluginInfo:b.value},null)}]}),se=m([Y({callback:()=>{},classList:B}),{label:"删除项目",value:"delete",event:Z}]),ae=u({key:"classify",name:"Docker分类",options:()=>[{label:"全部分类",value:"all"}],event:K,ignore:["0","-2"],field:"name"}),{BtTable:oe,BtPage:re,BtRefresh:ce,BtSearch:me,BtColumn:pe,BtBatch:ue,BtTableCategory:de,refresh:fe}=r({request:e=>i({p:e.p||1,row:e.limit||20,query:e.search||"",...e.classify&&"all"!==e.classify?{classify:e.classify}:{},..."all"!==T.value?{type:T.value}:{}}),columns:[A(),N({onClick:V,openPlugin:z}),{label:"类型",prop:"type",minWidth:90,renderHeader(){const e=[{title:"全部",key:"all"},{title:"JAVA",key:"java"},{title:"Go",key:"go"},{title:"PHP",key:"php"},{title:"Python",key:"python"},{title:"反向代理",key:"proxy"},{title:"Docker应用",key:"app"}];return D("div",{class:"flex items-center flex-nowrap"},["",D(I,{onCommand:e=>{T.value=e,fe()}},{default:()=>D("span",{class:"text-[1.2rem] flex items-center"},[[w("span",{class:"status-header-text leading-[1.5] whitespace-nowrap"},[C("类型"),"all"===T.value?"":"(".concat(e.find(e=>e.key===T.value).title,")")])],D("i",{class:"svgtofont-el-arrow-down "})]),dropdown:()=>{let t;return w(L,null,"function"==typeof(s=t=e.map(e=>w(q,{command:e.key},{default:()=>[e.title]})))||"[object Object]"===Object.prototype.toString.call(s)&&!R(s)?t:{default:()=>[t]});var s}})])}},W({prop:"status",onClick:e=>{const t="1"===e.status?0:1;p({status:t,id:e.id,site_name:e.name,edate:e.edate})},onFilterEvent:e=>{T.value=e,fe()}}),{label:"根目录",prop:"path",minWidth:200,isCustom:!0,render:e=>w("div",null,[w("span",{class:"w-full whitespace-pre-line inline-block bt-link leading-[16px]",onClick:()=>H(e,"path"),title:"点击打开目录"},[e.path])])},E(),M({request:(e,t)=>{d({remark:t,id:e.id,site_name:e.name})},prop:"remark",width:200}),G({onClick:e=>V(e,"ssl")}),O([{onClick:e=>{z(e,"monitor-setting")},title:"统计"},{onClick:e=>{z(e,"bt_waf")},title:"WAF"},{title:"设置",onClick:V},{title:"删除",onClick:e=>{f(e)}}])],extension:[ae,se,c(v)]});return y(()=>{J()}),P(()=>{k()}),(t,s)=>{const i=l,n=e;return x(),_("div",ie,[w(le,{ref:"envRef",onInit:h(fe)},null,8,["onInit"]),w(n,null,{"header-left":g(()=>[w(h(te)),j("div",ne,[j("div",{class:"flex items-center",onClick:s[0]||(s[0]=(...e)=>h($)&&h($)(...e))},[...s[1]||(s[1]=[j("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),j("span",{class:"bt-link"},"需求反馈",-1)])]),w(i,{href:"https://www.bt.cn/bbs/thread-140664-1-1.html",class:"ml-10px"},{default:g(()=>[...s[2]||(s[2]=[C(">>使用帮助",-1)])]),_:1})])]),"header-right":g(()=>[w(h(de),{class:"!w-[160px] mr-[10px]"}),w(h(me),{class:"mr-[10px] !w-[26rem]",placeholder:"请输入项目名称或备注"}),w(h(ce),{class:"mr-[10px]"}),w(h(pe))]),content:g(()=>[w(h(oe),{"max-height":h(a)},null,8,["max-height"])]),"footer-left":g(()=>[w(h(ue))]),"footer-right":g(()=>[w(h(re))]),_:1})])}}}),[["__scopeId","data-v-645f426d"]]);export{oe as default};
