import{l as e,L as a,o as t,K as s,k as n,a0 as l,e as o}from"./utils-lib.js?v=1756369731";import{_ as r}from"./index103.js?v=1756369731";import{c as i,r as p,U as c,w as u,e as m,p as d,G as _,q as f,v as h,A as v,y as b,J as g,x,z as y,P as w,H as j,D as O,al as q}from"./base-lib.js?v=1756369731";import{_ as D}from"./index145.js?v=1756369731";import{a2 as k,a3 as E,a4 as V,a5 as A,a6 as C,a7 as I,a8 as L}from"./firewall.js?v=1756369731";import{a as P,b as R,u as T,c as F}from"./column.js?v=1756369731";import{g as S}from"./useStore5.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const J={class:"flex items-center"},M=o(i({__name:"index",setup(o){const{refs:{isRefreshSpywares:i}}=S(),M=p(0),N=p(),B=p(!1),H=c([]),U=p(!1),z=[{active:!0,content:"添加目录",event:()=>e({title:"添加安全检测目录",area:50,component:()=>a(()=>import("./index460.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!0})},{content:"白名单",event:()=>e({title:"白名单",area:[70,55],component:()=>a(()=>import("./index461.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!1})}],G=async(e,a,t,s)=>{const{value:n}=s;let l=[];switch(n){case"startOpen":l=["开启监听","开启后目录将会对自动的进行木马查杀并进行隔离"];break;case"stopOpen":l=["关闭监听","关闭后目录将不会对自动的进行木马查杀并进行隔离"];break;case"deleteMonitorDir":l=["删除监听","该目录将不在自动进行木马查杀和病毒文件隔离"]}const o=async(e,a)=>{const{path:t}=e;switch(n){case"startOpen":case"stopOpen":return await A("startOpen"!==n,{data:JSON.stringify({path:t})});case"deleteMonitorDir":return await k({path:t})}};await e({title:"批量".concat(l[0],"目录"),content:"批量".concat(l[0],"目录，").concat(l[1],"，是否继续操作！"),column:[{label:"目录",prop:"path"},F()],onConfirm:async()=>(await a(o),Y(),!1)})},K=[{label:"开启监听目录",value:"startOpen",event:G},{label:"关闭监听目录",value:"stopOpen",event:G},{label:"删除监听目录",value:"deleteMonitorDir",event:G}];u(()=>i.value,e=>{e&&Y()});const W=async e=>{s({request:V(!e),message:!0,loading:"正在"+(e?"开启":"关闭")+"动态查杀开关，请稍后..."})},Q=()=>e({title:"隔离文件",area:70,component:()=>a(()=>import("./index463.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),X=[P({key:"path"}),{label:"目录",prop:"path"},R({prop:"open",event:async e=>{s({request:A(e.open,{data:JSON.stringify({path:e.path})}),message:!0,loading:"正在切换监控状态，请稍后...",success:Y})},data:["已停止","运行中"]}),{label:"备注",prop:"ps",minWidth:200,isCustom:!0,render:e=>{var a;const t={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e.ps=null==(a=e.ps)?void 0:a.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(e,a){return t[a]}),m("input",{type:"text",value:e.ps,class:"bt-table-input w-full",placeholder:"点击编辑备注",onBlur:a=>{if(e.ps===a.target.value)return!1;e.ps=a.target.value,(async e=>{s({request:E({path:e.path,ps:e.ps}),message:!0,loading:"正在设置监控状态，请稍后..."})})(e)}},null)}},T([{onClick:async t=>e({title:"木马扫描【".concat(t.path,"】"),area:[84,60],compData:{row:t},component:()=>a(()=>import("./index462.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),title:"扫描"},{onClick:async e=>{await t({icon:"question-filled",title:"删除监控【"+e.path+"】",width:"34rem",content:"删除后无法继续监控该网站，是否继续？"}),s({request:k({path:e.path}),message:!0,loading:"正在删除监控，请稍后...",success:Y})},title:"删除"}])],Y=async()=>{i.value=!1,s({request:I(),data:[Array,H],loading:U})};return d(()=>{Y(),(async()=>{s({request:L(),data:[Number,M]})})(),(async()=>{s({request:C(),data:{status:[Boolean,B]}})})()}),(e,a)=>{const t=D,s=O,o=q,i=n,p=l,c=r,u=_("bt-loading");return f(),h("div",null,[m(c,null,{"header-left":v(()=>[b("div",J,[m(t,{options:z}),m(s,{type:"default",class:"!ml-[1.2rem]",onClick:Q},{default:v(()=>[a[1]||(a[1]=b("span",null,"隔离文件",-1)),b("span",{class:g((x(M)>0?"bg-[red]":"bg-[#f0ad4e]")+" ml-[.4rem] py-[.1rem] px-[.4rem] text-white text-center font-bold")},y(x(M)),3)]),_:1}),a[2]||(a[2]=b("div",{class:"bg-[#ccc] w-[1px] h-2rem mx-8"},null,-1)),a[3]||(a[3]=b("div",{class:"mr-4"},"动态查杀开关",-1)),b("div",null,[m(o,{modelValue:x(B),"onUpdate:modelValue":a[0]||(a[0]=e=>w(B)?B.value=e:null),width:36,onChange:W},null,8,["modelValue"])])])]),content:v(()=>[j(m(i,{ref_key:"portTable",ref:N,column:X,data:x(H),description:"木马查杀列表为空"},null,8,["data"]),[[u,x(U)],[u,"正在加载木马查杀列表，请稍后...","title"]])]),"footer-left":v(()=>[m(p,{"table-ref":x(N),options:K},null,8,["table-ref"])]),_:1}),a[4]||(a[4]=b("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[b("li",null,"注意：隔离文件后的数字表示隔离文件总数"),b("li",{class:"text-[#FF6500]"},"动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离")],-1))])}}}),[["__scopeId","data-v-21092971"]]);export{M as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
