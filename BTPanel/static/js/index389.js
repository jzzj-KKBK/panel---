import{c as e,s as a,r as s,p as t,q as l,v as r,e as i,A as c,x as u,F as o,a_ as m,M as p,ai as f,aj as n,a9 as v,a7 as d}from"./base-lib.js?v=1756369731";import{b as y}from"./utils-lib.js?v=1756369731";import{g as _}from"./useStore10.js?v=1756369731";import{J as b,K as h}from"./ssl.js?v=1756369731";import{u as j}from"./useStore11.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const V={class:"p-[2rem] flex justify-center flex-col"},g=e({__name:"index",props:{compData:{type:Object,default:()=>{}}},emits:["close"],setup(e,{expose:g,emit:D}){const w=y(),{activeTabs:x,sslIsRefresh:R,testIsRefresh:I,encryptIsRefresh:L,otherIsRefresh:S}=a(j()),{refs:{isRefreshDomainList:k,typeList:q}}=_(),J=e,O=D,N=s(),A=s({selectValue:""}),C={selectValue:[{required:!0,message:"请选择".concat("certificate"===J.compData.type?"证书分组":"域名分类"),trigger:"change"}]},F=s([]),H=s([]),K=async e=>{var a;let s;try{switch(e){case"certificate":if(H.value=J.compData.itemList.map(e=>({id:e.id,type:e.type})),s=await h({ids:JSON.stringify(H.value),group_id:A.value.selectValue}),s.status){const e={ssl:()=>R.value=!0,test:()=>I.value=!0,encrypt:()=>L.value=!0,other:()=>S.value=!0};null==(a=e[x.value])||a.call(e)}break;case"domain":H.value=J.compData.itemList.map(e=>e.id),s=await b({ids:JSON.stringify(H.value),type_id:A.value.selectValue}),s.status&&(k.value=!0)}}catch(t){}return s};return g({onConfirm:async()=>{if(N.value)try{await N.value.validate();const e=w.load("正在".concat("certificate"===J.compData.type?"设置证书分组":"设置域名分类","，请稍候..."));try{const e=await K(J.compData.type);w.request(e),e.status&&O("close")}finally{e.close()}}catch(e){return!1}}}),t(()=>{F.value=q.value.filter(e=>"all"!==e.value)}),(a,s)=>{const t=f,y=n,_=v,b=d;return l(),r("div",V,[i(b,{ref_key:"formRef",ref:N,model:u(A),rules:C},{default:c(()=>[i(_,{label:"certificate"===e.compData.type?"证书分组":"域名分类",prop:"selectValue"},{default:c(()=>[i(y,{modelValue:u(A).selectValue,"onUpdate:modelValue":s[0]||(s[0]=e=>u(A).selectValue=e),class:"!w-[31rem]"},{default:c(()=>[(l(!0),r(o,null,m(u(F),e=>(l(),p(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])])}}});export{g as default};
