import{K as a,o as e,M as t,j as s,c as l}from"./utils-lib.js?v=1756369731";import{c as i,k as d,r,p as n,aM as m,G as o,H as u,x as c,q as p,v as _,e as f,A as g,y,B as w,al as b,a9 as x,D as I,a7 as h}from"./base-lib.js?v=1756369731";import{r as P,ac as k}from"./config.js?v=1756369731";import{g as v}from"./useStore.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const V={class:"p-[2rem]"},j={class:"w-[32rem]"},A={class:"w-[32rem]"},q={class:"text-medium h-[2.4rem]"},C=i({__name:"api-config",setup(i){const{refs:{panelConfig:C}}=v(),z=d({token:"",limit_addr:""}),H=r(!1),S=r("正在获取API配置，请稍候..."),U=async()=>{await a({loading:H,request:P({t_type:2}),message:!0})},M=async()=>{try{await e({icon:"warning-filled",title:"重置密钥",isHtml:!0,content:'\n\t\t\t<p>您确定要重置当前密钥吗？</p>\n\t\t\t<p class="text-danger">\t重置密钥后，已关联密钥产品，将失效，请重新添加新密钥至产品。</p>'}),S.value="正在重置密钥，请稍候...",await a({loading:H,request:P({t_type:1}),message:!1,success:a=>{a.status?z.token=a.msg:t.error(a.msg)}})}catch(s){}},R=async()=>{S.value="正在设置API配置，请稍候...",await a({loading:H,request:P({t_type:3,limit_addr:z.limit_addr}),message:!0})};return n(()=>{(async()=>{const e=await a({loading:H,request:k(),data:{limit_addr:String,token:String}});z.token=e.token,z.limit_addr=e.limit_addr})()}),(a,e)=>{const t=b,i=x,d=I,r=s,n=h,P=l,k=m("bt-tips"),v=o("bt-loading");return u((p(),_("div",V,[f(n,null,{default:g(()=>[f(i,{label:"API接口"},{default:g(()=>[f(t,{modelValue:c(C).apiInterface,"onUpdate:modelValue":e[0]||(e[0]=a=>c(C).apiInterface=a),onChange:U},null,8,["modelValue"])]),_:1}),f(i,{label:"接口密钥"},{default:g(()=>[y("div",j,[f(r,{modelValue:c(z).token,"onUpdate:modelValue":e[1]||(e[1]=a=>c(z).token=a),type:"text",readonly:""},{suffix:g(()=>[f(d,{type:"primary",size:"small",onClick:M},{default:g(()=>[...e[3]||(e[3]=[w(" 重置 ",-1)])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),f(i,null,{label:g(()=>[...e[4]||(e[4]=[y("div",{class:"py-8px leading-[1.4]"},[y("div",{class:"pr-6px"},"IP白名单"),y("div",null,"(每行一个)")],-1)])]),default:g(()=>[y("div",A,[f(r,{modelValue:c(z).limit_addr,"onUpdate:modelValue":e[2]||(e[2]=a=>c(z).limit_addr=a),type:"textarea",resize:"none",autosize:{minRows:4,maxRows:4}},null,8,["modelValue"])])]),_:1}),f(i,{label:" "},{default:g(()=>[f(d,{type:"primary",onClick:R},{default:g(()=>[...e[5]||(e[5]=[w("保存",-1)])]),_:1})]),_:1})]),_:1}),f(k,{class:"my-20px"},{default:g(()=>[e[8]||(e[8]=y("li",{class:"text-medium h-[2.4rem]"},"IP白名单支持格式：",-1)),e[9]||(e[9]=y("li",{class:"text-medium h-[2.4rem]"},"单IP：（192.168.1.1），IP段：（192.168.1.1-192.168.1.255），所有IP：（*）",-1)),e[10]||(e[10]=y("li",{class:"text-medium h-[2.4rem]"},"开启API后，必需在IP白名单列表中的IP才能访问面板API接口",-1)),e[11]||(e[11]=y("li",{class:"text-danger h-[2.4rem]"},"请不要在生产环境开启，这可能增加服务器安全风险；",-1)),y("li",q,[e[7]||(e[7]=w(" API接口文档在这里： ",-1)),f(P,{href:"https://www.bt.cn/bbs/thread-20376-1-1.html"},{default:g(()=>[...e[6]||(e[6]=[w(" https://www.bt.cn/bbs/thread-20376-1-1.html ",-1)])]),_:1})])]),_:1})])),[[v,c(H)],[v,c(S),"title"]])}}});export{C as default};
