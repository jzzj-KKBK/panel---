!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}System.register(["./base-lib-legacy.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731"],function(e,n){"use strict";var r,a,o,u,i,l,s,c,f,p,m,d,v,y,_,h,b,w,g,k,x,D,j,z,A,E,S,q;return{setters:[function(t){r=t.c,a=t.ay,o=t.r,u=t.g,i=t.U,l=t.k,s=t.w,c=t.q,f=t.v,p=t.e,m=t.A,d=t.B,v=t.x,y=t.y,_=t.z,h=t.F,b=t.M,w=t.H,g=t.I,k=t.D,x=t.b0,D=t.au,j=t.b3,z=t.av,A=t.aw},function(t){E=t.Y,S=t.v,q=t.b},null],execute:function(){var n={class:"p-[2rem]"},I={class:"h-[40rem] border border-[#EBEEF5] mt-[1rem]"},C={class:"ml-[0.5rem]"},O={class:"mt-8px leading-8 text-[1.2rem] list-disc ml-2rem"};e("default",r({__name:"upload",props:{compData:{default:function(){return{path:"",size:100,uploadData:function(){return{multiple:!0,limit:1e3}},refreshEvent:function(){}}}}},setup:function(e,r){var F=r.expose,M=q(),B=e,H=a("popupSetFooter"),T=a("buttonText"),U=a("popupClose"),Y=!0,$=o(),G=o([]),J=u(function(){return B.compData.uploadData.accept||i([".json"].join(","))}),K=u(function(){return B.compData.uploadData.multiple}),L=u(function(){return B.compData.uploadData.limit}),N={"x-http-token":window.vite_public_request_token},P=E(),Q=window.location.protocol+"//"+window.location.host+"/files?action=upload",R=l({f_size:0,f_path:B.compData.path,f_name:"",f_start:0,request_time:P.request_time,request_token:P.request_token}),V=function(){M.success("导入成功"),B.compData.refreshEvent&&B.compData.refreshEvent(G.value,U)},W=function(t,e,n){n.push(e),M.error("导入失败")},X=function(t){R.f_size=t.size,R.f_name=t.name,R.f_start=0},Z=function(t,e){var n=t.name.substring(t.name.lastIndexOf(".")+1),r=J.value;if(-1===r.indexOf(n))return!1;G.value=e.filter(function(t){var e=t.name.substring(t.name.lastIndexOf(".")+1);return-1!==r.indexOf(e)})||[]},tt=function(t,e,n){R.f_start=t.percent,G.value=n.map(function(n){return n.uid===e.uid&&(n.percentage=t.percent),n})};return s(function(){return G.value.length},function(t){if(0!==t){for(var e=["success","fail","ready"],n=0;n<G.value.length;n++)if(!e.includes(G.value[n].status))return void H(!1);G.value.some(function(t){return"success"!==t.status})&&(T.value=Y?"开始上传":"重新上传",H(!0))}else H(!1)}),F({onConfirm:function(){G.value.map(function(t){"success"!==t.status&&(t.status="ready")}),Y=!1,$.value.submit(),H(!1)}}),function(e,r){var a=k,o=x,u=D,i=j,l=z,s=A;return c(),f("div",n,[p(o,{class:"upload-demo",ref_key:"upload",ref:$,name:"blob",data:v(R),action:Q,headers:N,accept:v(J),limit:v(L),multiple:v(K),"show-file-list":!1,"auto-upload":!1,"file-list":v(G),"on-error":W,"on-success":V,"on-progress":tt,"on-change":Z,"before-upload":X},{default:m(function(){return[p(a,{type:"primary"},{default:m(function(){return t(r[0]||(r[0]=[d("选择文件",-1)]))}),_:1})]}),_:1},8,["data","accept","limit","multiple","file-list"]),y("div",I,[p(s,{height:"400",data:v(G)},{empty:m(function(){return[p(l,{description:"只支持'".concat(v(J),"'文件格式导入")},null,8,["description"])]}),default:m(function(){return[p(u,{prop:"name","show-overflow-tooltip":!0,label:"名称"},{default:m(function(t){return[r[1]||(r[1]=y("i",{style:{color:"#409eff"},class:"svgtofont-el-document"},null,-1)),y("span",C,_(t.row.name),1)]}),_:1}),p(u,{prop:"name",label:"是否成功",width:"300"},{default:m(function(t){return["success"===t.row.status?(c(),f(h,{key:0},[d("上传成功！")],64)):"fail"===t.row.status?(c(),f(h,{key:1},[d("上传失败!")],64)):"ready"===t.row.status?(c(),f(h,{key:2},[d("等待上传")],64)):(c(),b(i,{key:3,percentage:Math.floor(t.row.percentage)},null,8,["percentage"]))]}),_:1}),p(u,{width:"120",prop:"size",label:"大小"},{default:m(function(t){return[d(_(v(S)(t.row.size)),1)]}),_:1}),p(u,{prop:"name",width:"180",align:"right","show-overflow-tooltip":!0,label:"操作"},{default:m(function(e){return[w(p(a,{type:"text",size:"small",onClick:function(t){return n=e.row,void(G.value=G.value.filter(function(t){return t.name!==n.name}));var n}},{default:m(function(){return t(r[2]||(r[2]=[d("删除",-1)]))}),_:2},1032,["onClick"]),[[g,"ready"===e.row.status||"fail"===e.row.status]])]}),_:1})]}),_:1},8,["data"])]),y("ul",O,[y("li",null,"仅支持"+_(v(J)),1)])])}}}))}}})}();
