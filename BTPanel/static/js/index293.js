import{_ as a}from"./index103.js?v=1756369731";import{u as e,K as l,o as s,k as t,j as r,W as o,h as n}from"./utils-lib.js?v=1756369731";import{c as i,r as d,k as m,e as u,p as c,G as p,q as f,v as _,A as b,B as g,H as w,x as h,P as j,D as v,a9 as y,a7 as x}from"./base-lib.js?v=1756369731";import{aE as V,aF as k,aG as q}from"./firewall.js?v=1756369731";import{u as C}from"./column.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const A=i({__name:"index",setup(i){e();const A=d(!1),F=d([]),G=d(!1),H=m({cmd:""}),P=d(),U={cmd:[{trigger:["blur","change"],required:!0,message:"请输入进程名称"}]},W=async()=>{await l({loading:A,request:V(),data:[Array,F]})},B=async()=>{await P.value.validate(),await l({loading:"正在添加进程白名单，请稍后...",request:q(H),message:!0}),W(),G.value=!1,H.cmd=""},D=[{label:"进程名",render:a=>u("span",null,[a])},C([{onClick:async a=>{await s({icon:"warning-filled",title:"删除进程白名单【"+a+"】",width:"34rem",content:"删除选中的进程后，该进程将不再进行收到保护，是否继续操作？"}),await l({loading:"正在删除进程白名单，请稍后...",request:k({cmd:a}),message:!0}),W()},title:"删除"}])];return c(()=>{W()}),(e,l)=>{const s=v,i=t,d=r,m=y,c=o,V=x,k=n,q=a,C=p("bt-loading");return f(),_("div",null,[u(q,null,{"header-left":b(()=>[u(s,{type:"primary",onClick:l[0]||(l[0]=a=>G.value=!0)},{default:b(()=>[...l[3]||(l[3]=[g(" 添加进程白名单 ",-1)])]),_:1})]),content:b(()=>[w(u(i,{column:D,data:h(F),description:"进程白名单列表为空"},null,8,["data"]),[[C,h(A)],[C,"正在加载进程白名单列表，请稍后...","title"]])]),popup:b(()=>[u(k,{title:"添加进程",modelValue:h(G),"onUpdate:modelValue":l[2]||(l[2]=a=>j(G)?G.value=a:null),area:42,onConfirm:B,showFooter:""},{default:b(()=>[u(V,{ref_key:"addProcessWhiteRef",ref:P,rules:U,model:h(H),class:"p-[2rem]","label-width":"5rem"},{default:b(()=>[u(m,{label:"进程名称",prop:"cmd"},{default:b(()=>[u(d,{modelValue:h(H).cmd,"onUpdate:modelValue":l[1]||(l[1]=a=>h(H).cmd=a),width:"20rem",placeholder:"例:/bin/bash",clearable:""},null,8,["modelValue"])]),_:1}),u(c,{options:[{class:"text-danger",content:"命令需要填写全路径例如：/usr/bin/curl"}],class:"pl-[3.6rem] pt-[.4rem]"})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})])}}});export{A as default};
