!function(){function t(r){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(r)}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,o=Array(r);e<r;e++)o[e]=t[e];return o}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,r,e="function"==typeof Symbol?Symbol:{},s=e.iterator||"@@iterator",a=e.toStringTag||"@@toStringTag";function c(e,o,s,a){var c=o&&o.prototype instanceof u?o:u,l=Object.create(c.prototype);return n(l,"_invoke",function(e,o,n){var s,a,c,u=0,l=n||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(r,e){return s=r,a=0,c=t,p.n=e,i}};function d(e,o){for(a=e,c=o,r=0;!f&&u&&!n&&r<l.length;r++){var n,s=l[r],d=p.p,y=s[2];e>3?(n=y===o)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=t):s[0]<=d&&((n=e<2&&d<s[1])?(a=0,p.v=o,p.n=s[1]):d<y&&(n=e<3||s[0]>o||o>y)&&(s[4]=e,s[5]=o,p.n=y,a=0))}if(n||e>1)return i;throw f=!0,o}return function(n,l,y){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,c=y;(r=a<2?t:c)||!f;){s||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(u=2,s){if(a||(n="next"),r=s[n]){if(!(r=r.call(s,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=s.return)&&r.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+n+"' method"),a=1);s=t}else if((r=(f=p.n<0)?c:e.call(o,p))!==i)break}catch(r){s=t,a=1,c=r}finally{u=1}}return{value:r,done:f}}}(e,s,a),!0),l}var i={};function u(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][s]?r(r([][s]())):(n(r={},s,function(){return this}),r),d=f.prototype=u.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,n(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=f,n(d,"constructor",f),n(f,"constructor",l),l.displayName="GeneratorFunction",n(f,a,"GeneratorFunction"),n(d),n(d,a,"Generator"),n(d,s,function(){return this}),n(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:y}})()}function n(t,r,e,o){var s=Object.defineProperty;try{s({},"",{})}catch(t){s=0}n=function(t,r,e,o){function a(r,e){n(t,r,function(t){return this._invoke(r,e,t)})}r?s?s(t,r,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[r]=e:(a("next",0),a("throw",1),a("return",2))},n(t,r,e,o)}function s(t,r,e,o,n,s,a){try{var c=t[s](a),i=c.value}catch(t){return void e(t)}c.done?r(i):Promise.resolve(i).then(o,n)}function a(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,o)}return e}function c(r,e,o){return(e=function(r){var e=function(r,e){if("object"!=t(r)||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var n=o.call(r,e||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"==t(e)?e:e+""}(e))in r?Object.defineProperty(r,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[e]=o,r}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./firewall-legacy.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731"],function(t,e){"use strict";var n,i,u,l,f,p,d,y,v,g,m,b,h,w,_,k,S,j,O,E,x,T,P,C,A,D,G,I,M,F;return{setters:[function(t){n=t.dG,i=t.R,u=t.at,l=t.d,f=t.c,p=t.ah,d=t.e},function(t){y=t.c,v=t.r,g=t.k,m=t.g,b=t.p,h=t.G,w=t.H,_=t.x,k=t.q,S=t.v,j=t.y,O=t.J,E=t.M,x=t.F,T=t.e,P=t.B,C=t.z,A=t.C,D=t.A,G=t.a_,I=t.b3,M=t.D},function(t){F=t.a1},null],execute:function(){var e={id:"safeDetectList"},H={class:"progress-header"},N={class:"progress-header-cot"},J={key:0,class:"relative"},q={class:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},z={class:"progress-header-cot"},B={class:"scanning-progress-title"},L={class:"color-org"},R={class:"color-red"},U={class:"scanning-progress-cont"},$={class:"progress-header-cot"},K={class:"progress-cont-list"},Q=["onClick"],V={class:"progress_type"},W={class:"progress_status"},X={key:0,class:"text-danger"},Y={key:1,class:"text-warning"},Z={key:1},tt={key:2,class:"text-[#666]"},rt={key:0},et={class:"progress_fold"},ot={class:"progress_item_body"},nt={class:"info_cont"},st={class:"info_cont_desc"},at=y({__name:"index",setup:function(t){var d=v(!1),y=[{color:"#888",text:"未安装"},{color:"#666",text:"良好"},{color:"#e6a23c",text:"警告"},{color:"red",text:"危险"}],at={system_account:"系统账户",sshd_service:"SSHD远程服务",file_mode:"重要文件权限及属性",software:"重点软件检测",other:"其他项目检测",backdoor:"后门检测",proc:"恶意进程",history:"历史命令",log:"日志排查",rootkit:"rootkit检测"},ct=v({}),it=g(function(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?a(Object(e),!0).forEach(function(r){c(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}({},{scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}})),ut=function(t){return t+" 分"},lt=null,ft=m(function(){return it.scanStatus&&!it.isEnd?"正在扫描":ct.value.status?"上次检测时间 "+("刚刚"===n(ct.value.msg.time)?"一分钟内":n(ct.value.msg.time)):"当前未进行安全检测"}),pt=v(""),dt=v(""),yt=m(function(){return it.scanStatus&&!it.isEnd?"正在扫描-".concat(pt.value):it.isEnd?"检测时间："+i(it.time/1e3,"yyyy-MM-dd"):ct.value.status?"若长时间未检测，服务器可能存在安全风险，建议立即检测":"当前安全风险未知，请立即检测"}),vt=function(t,r){if(r.data){var e,o=JSON.parse(r.data.replace(/'/g,'"'));if(o.hasOwnProperty("callback"))null===(e=lt)||void 0===e||e.close(),it.scanStatus=!1,it.isEnd=!0,it.time=(new Date).getTime();else pt.value=o.name,dt.value=o.topic,it.progress=parseInt(o.progress),it.progressConfig[o.topic].push(o),it.statusTotal[o.topic]=gt(it.progressConfig[o.topic]),it.allArr.push(o),3===o.status?it.error++:2===o.status&&it.warn++,1!==o.status&&(it.progressColor="#fc6d26")}},gt=function(t){var r={};return t.forEach(function(t){r[t.status]?r[t.status]++:r[t.status]=1}),r},mt=function(){var t,r;if(it.scanStatus&&!it.isEnd||it.isEnd,it.scanStatus&&!it.isEnd)return null===(r=lt)||void 0===r||r.close(),void bt();it.isEnd&&bt(),it.scanStatus=!0,null===(t=lt=p({route:"/ws_project",onMessage:vt}))||void 0===t||t.send({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""})},bt=function(){it.scanStatus=!1,it.isEnd=!1,it.error=0,it.warn=0,it.time=0,it.progress=0,it.progressColor="#20a53a",it.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},it.statusTotal={},it.allArr=[],it.result={},it.progressStatus={},it.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},ht=function(){var t,r=(t=o().m(function t(){var r,e;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,F();case 1:r=t.v,ct.value=r.data,t.n=3;break;case 2:t.p=2,e=t.v,u(e);case 3:return t.a(2)}},t,null,[[0,2]])}),function(){var r=this,e=arguments;return new Promise(function(o,n){var a=t.apply(r,e);function c(t){s(a,o,n,c,i,"next",t)}function i(t){s(a,o,n,c,i,"throw",t)}c(void 0)})});return function(){return r.apply(this,arguments)}}();return b(function(){ht()}),function(t,o){var n,s,a,c=l,i=I,u=M,p=f,v=h("bt-loading");return w((k(),S("div",e,[j("div",H,[j("div",N,[j("div",{class:O("progresscirclebar "+(_(ct).status?"security ":"")+"text-["+(100===(null===(n=_(ct).msg)||void 0===n?void 0:n.security_count)?" #20a53a ":" #fc6d26 ")+"]")},[_(ct).status?(k(),S(x,{key:1},[_(it).scanStatus&&!_(it).isEnd?(k(),S("div",J,[T(i,{class:"animate-spin",type:"circle",percentage:70,"show-text":!1,"stroke-width":4,"define-back-color":"#fff",color:_(it).warn||_(it).error?"#fc6d26":"#20a53a",width:100},null,8,["color"]),j("div",q,[T(c,{class:"w-[full] px-[.4rem]",src:"/firewall/icon-safe-detect".concat(_(it).warn||_(it).error?"-org":"",".svg")},null,8,["src"]),o[0]||(o[0]=j("span",{class:"text-[1.2rem] font-bold py-[.4rem] leading-none"}," 安全检测 ",-1))])])):(k(),E(i,{key:1,type:"circle",percentage:null===(s=_(ct).msg)||void 0===s?void 0:s.security_count,format:ut,color:100===(null===(a=_(ct).msg)||void 0===a?void 0:a.security_count)?"#20a53a":"#fc6d26",width:100},null,8,["percentage","color"]))],64)):(k(),E(c,{key:0,class:"w-[10rem]",src:"/firewall/icon-safe-detect.svg"}))],2)]),j("div",z,[j("div",B,[_(it).isEnd?(k(),S(x,{key:1},[o[5]||(o[5]=P(" 检测已完成 ",-1)),_(it).error>0||_(it).warn>0?(k(),S(x,{key:0},[o[4]||(o[4]=P(" ，一共发现 ",-1)),_(it).warn>0?(k(),S(x,{key:0},[j("span",L,C(_(it).warn),1),o[1]||(o[1]=P(" 项风险项 ",-1))],64)):A("",!0),_(it).error>0?(k(),S(x,{key:1},[o[2]||(o[2]=P(" （包含 ",-1)),j("span",R,C(_(it).error),1),o[3]||(o[3]=P(" 项危险项，请立即处理） ",-1))],64)):A("",!0)],64)):A("",!0)],64)):(k(),S(x,{key:0},[P(C(_(ft)),1)],64))]),_(it).scanStatus?(k(),E(i,{key:0,percentage:_(it).progress,color:_(it).warn||_(it).error?"#fc6d26":"#20a53a","stroke-width":10},null,8,["percentage","color"])):A("",!0),j("div",U,C(_(yt)),1)]),j("div",$,[T(u,{type:_(it).scanStatus&&!_(it).isEnd?"warning":"primary",onClick:mt,plain:!(!_(it).scanStatus||_(it).isEnd)},{default:D(function(){return[P(C(_(it).scanStatus&&!_(it).isEnd?"取消扫描":_(it).isEnd?"重新检测":"立即检测"),1)]}),_:1},8,["type","plain"]),T(p,{class:"!absolute -bottom-[2.5rem] right-[1.4rem]",href:"https://www.bt.cn/bbs/thread-126643-1-1.html"},{default:D(function(){return r(o[6]||(o[6]=[P(" 需求反馈>> ",-1)]))}),_:1})])]),j("div",K,[(k(),S(x,null,G(at,function(t,r){return j("div",{key:r,class:O([r+"_item "+(_(it).active[r]?"active":""),"progress_item"])},[j("div",{class:"progress_item_header",onClick:function(t){return function(t){it.active[t]=!it.active[t]}(r)}},[j("div",V,[T(c,{class:"title-icon",src:"/firewall/icon-"+r+".svg"},null,8,["src"]),j("span",null,C(t),1)]),j("div",W,[_(it).statusTotal[r]?(k(),S(x,{key:0},[_(it).statusTotal[r][3]||_(it).statusTotal[r][2]?(k(),S(x,{key:0},[_(it).statusTotal[r][3]?(k(),S("span",X," 发现"+C(_(it).statusTotal[r][3])+"项危险 ",1)):A("",!0),_(it).statusTotal[r][2]?(k(),S("span",Y,C((_(it).statusTotal[r][3]?"":"发现")+_(it).statusTotal[r][2])+"项警告 ",1)):A("",!0)],64)):_(it).scanStatus&&_(dt)==r?(k(),S("span",Z," 正在扫描... ")):(k(),S("span",tt,"无风险项"))],64)):(k(),S(x,{key:1},[_(it).scanStatus&&!_(it).statusTotal[r]?(k(),S("span",rt," 等待扫描 ")):A("",!0)],64))]),j("div",et,[T(c,{src:"/firewall/arrow-down.svg"})])],8,Q),j("div",ot,[_(it).progressConfig[r]&&_(it).progressConfig[r].length?(k(!0),S(x,{key:0},G(_(it).progressConfig[r],function(t,r){return k(),S("div",{key:r,class:O([t.info?"active":"","progress_item_info"])},[j("div",nt,[j("div",null,C(t.name.replace("分析网站","")),1),j("div",{class:O("text-["+y[t.status<0?0:t.status].color+"]")},C(y[t.status<0?0:t.status].text),3)]),j("div",st,C(t.info||""),1)],2)}),128)):A("",!0)])],2)}),64))])])),[[v,_(d)]])}}});t("default",d(at,[["__scopeId","data-v-3a1d5614"]]))}}})}();
