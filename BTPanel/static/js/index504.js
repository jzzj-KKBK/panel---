import{u as a,o as e,L as t,K as s,n as l,k as i,b as o,q as n,_ as r}from"./utils-lib.js?v=1756369731";import{_ as u}from"./index120.js?v=1756369731";import{_ as d}from"./index104.js?v=1756369731";import{B as m}from"./index146.js?v=1756369731";import{_ as p}from"./index126.js?v=1756369731";import{c,r as h,k as v,p as f,G as _,q as g,v as y,x,M as j,A as w,y as k,e as V,B as b,P as q,H as C,D as A,al as E}from"./base-lib.js?v=1756369731";import{_ as F}from"./index105.js?v=1756369731";import{d as S,u as U}from"./column.js?v=1756369731";import{checkMonitorDir as I,setMonitorDir as P,webshellFileSingle as T,setHandleFile as B}from"./site.js?v=1756369731";import{S as D,u as H}from"./useStore4.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./ace.js?v=1756369731";const L={class:"flex items-center"},O={class:"p-20px"},R=r(c({__name:"index",setup(r){const{getFileEvent:c,saveFileEvent:R}=D(),G=o(),{payment:J}=a(),{siteInfo:K}=H(),M=h([]),N=h(!1),z=h(""),Q=h(!1),W=h({}),X=h(!1),Y=v({title:"动态查杀-功能介绍",ps:"当查杀站点目录中的文件发生修改就会自动的进行木马查杀并进行隔离",source:185,desc:["网页内容修改检测","木马查杀隔离"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/site/dynamic_kill.png"}]}),Z=()=>{e({isAsync:!0,title:"白名单",area:[70,55],component:()=>t((()=>import("./index471.js?v=1756369731")),__vite__mapDeps([]),import.meta.url),showFooter:!1})},$=async()=>{try{const a=await I({path:K.value.path});X.value=a.data.is_run}catch(a){}},aa=async a=>{await s({loading:"正在设置中，请稍后...",request:P(!a,{path:K.value.path}),message:!0}),$()},ea=async()=>{const a=await R({path:W.value.path,data:z.value,encoding:"utf-8"});G.request(a)},ta=async()=>{N.value=!0;try{const a=await T({path:(K.value.path+"/").replace("//","/")});M.value=Array.isArray(a.data)?a.data:[]}catch(a){}N.value=!1},sa=h([{label:"隔离时间",prop:"time"},S(),U([{width:80,onClick:async a=>{W.value=a;const e=await c({path:a.path});if(!e.status)return G.request(e),!1;z.value=e.data.data||e.msg,Q.value=!0},title:"样本文件"},{onClick:a=>{n({title:"删除文件",content:"是否要删除关联的源文件?",type:"check",icon:"warning",check:{content:"源文件",onConfirm:e=>{s({loading:"正在删除文件中，请稍后...",request:B({data:JSON.stringify({path:a.path,md5:a.md5,type:e?"delete":""})}),message:!0,success:a=>{a.status&&ta()}})}}})},title:"删除"}])]);return f((()=>{"ltd"===J.value.authType&&($(),ta())})),(a,e)=>{const t=A,s=F,o=E,n=p,r=l,c=m,h=i,v=d,f=u,S=_("bt-loading");return g(),y("div",null,["ltd"===x(J).authType?(g(),j(v,{key:0},{"header-left":w((()=>[k("div",L,[V(t,{type:"default",onClick:Z},{default:w((()=>e[3]||(e[3]=[b(" 白名单 ")]))),_:1}),V(s),e[4]||(e[4]=k("div",{class:"mr-8px"},"动态查杀站点",-1)),k("div",null,[V(o,{modelValue:x(X),"onUpdate:modelValue":e[0]||(e[0]=a=>q(X)?X.value=a:null),width:36,onChange:aa},null,8,["modelValue"])])])])),"header-right":w((()=>[V(n,{onRefresh:ta})])),content:w((()=>[C(V(r,{column:x(sa),"max-height":400,data:x(M)},null,8,["column","data"]),[[S,x(N)]])])),"footer-left":w((()=>e[5]||(e[5]=[k("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[k("li",null,"注意：隔离文件后的数字表示隔离文件总数。"),k("li",{class:"text-orange"},"动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离")],-1)]))),"footer-right":w((()=>e[6]||(e[6]=[]))),popup:w((()=>[V(h,{title:"在线编辑",showFooter:"",modelValue:x(Q),"onUpdate:modelValue":e[2]||(e[2]=a=>q(Q)?Q.value=a:null),area:70,onConfirm:ea},{default:w((()=>[k("div",O,[V(c,{modelValue:x(z),"onUpdate:modelValue":e[1]||(e[1]=a=>q(z)?z.value=a:null),class:"!h-[40rem]"},null,8,["modelValue"])])])),_:1},8,["modelValue"])])),_:1})):(g(),j(f,{key:1,data:x(Y)},null,8,["data"]))])}}}),[["__file","/Users/chudong/project/linux-10/src/views/site/views/php-model/site-safe/dynamic-killing/index.vue"]]);export{R as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
