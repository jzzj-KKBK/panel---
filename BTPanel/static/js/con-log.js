import{_ as e}from"./index116.js?v=1756369731";import{r as a,k as l,c as t,p as s,a4 as o,q as n,v as u,y as i,e as d,A as r,B as c,x as v,J as f,P as p,z as m,K as _,D as g,b6 as h}from"./base-lib.js?v=1756369731";import{K as y,hY as b,M as w,hZ as D,o as k,h_ as C,R as x,$ as z,e as M}from"./utils-lib.js?v=1756369731";const j=a(""),V=a(),S=a([]),q=a(!1),H=async({list:e,row:a},l)=>{var t;j.value=(null==(t=null==e?void 0:e.at(0))?void 0:t.id)||"",await y({loading:q,request:b(),data:Array,success:t=>{if(0===t.length)return w.error("容器列表为空"),void l();V.value=t,V.value.forEach(l=>{(null==e?void 0:e.findIndex(e=>e.id===l.id))>-1&&S.value.push(l),l.id===a.id&&(j.value=l.id)})}})},O=()=>{j.value="",V.value=[],S.value=[],q.value=!1},P=a([new Date((new Date).setHours(0,0,0,0)),new Date((new Date).setHours(23,59,59,999))]),R=a({logs:"",split_status:!0,split_type:"size",split_size:1388444647424,split_hour:2,split_minute:0,save:180,logs_path:""}),T=a("3"),A=a([]),E=a(!1),I=l({date:[]}),J=[{label:"最近3天",value:"3"},{label:"最近7天",value:"7"},{label:"全部",value:"all"}];let K="";const U=e=>{A.value=[],I.date=[],T.value=e,E.value=!1,N()},B=l({disabledDate:e=>{const a=new Date;a.setHours(23,59,59,999);const l=a.getTime();return e.getTime()>l}}),G=e=>{T.value="",e.forEach((e,a)=>{1==a&&e.setHours(23,59,59,999),I.date[a]=Math.floor(e/1e3)}),E.value=!0,N()},N=async e=>{const a={id:K};if("all"!=T.value)if(I.date.length>0)a.time_search=I.date;else{const e=Math.floor(Date.now()/1e3);let l=0;"7"==T.value?l=e-604800:"3"==T.value&&(l=e-259200),a.time_search=[l,e]}await y({request:D({data:JSON.stringify(a)}),success:({data:a})=>{R.value=a,e&&w.success("刷新成功")}})},Y=async()=>{""!==R.value.logs&&""!==R.value.logs_path?window.open("/download?filename=".concat(R.value.logs_path),"_blank","noopener,noreferrer"):w.error("暂无日志可下载")},Z=async()=>{await k({title:"清空日志",content:"删除当前容器的所有日志吗,是否继续！"}),await y({request:C({log_path:R.value.logs_path}),message:!0,success:({status:e})=>{e&&N()}})},$={class:"flex flex-col"},F={class:"flex items-center justify-between"},L={class:"btnGroup flex my-[1.6rem] items-center"},Q={class:"action flex items-center relative"},W={class:"h-[54rem] overflow-y-auto"},X=M(t({__name:"con-log",props:{compData:{default:()=>({})}},setup(l){const t=l,y=a(),b=()=>{(e=>{e.value.handleOpen()})(y)};return s(()=>(e=>{K=e.compData.id||"",N()})(t)),o(()=>(R.value={logs:"",split_status:!0,split_type:"size",split_size:1388444647424,split_hour:2,split_minute:0,save:180,logs_path:""},T.value="3",A.value=[],E.value=!1,void(I.date=[]))),(a,l)=>{const t=g,s=z,o=h,w=e;return n(),u("div",$,[i("div",null,[i("div",F,[i("div",L,[d(t,{type:"default",size:"default",onClick:l[0]||(l[0]=e=>v(N)(!0))},{default:r(()=>[...l[3]||(l[3]=[c("刷新日志",-1)])]),_:1}),l[6]||(l[6]=i("div",{class:"line mx-[1rem] w-[.1rem] h-[2rem] bg-[#ccc] align-middle"},null,-1)),d(t,{type:"default",size:"default",onClick:v(Y)},{default:r(()=>[...l[4]||(l[4]=[c("下载日志",-1)])]),_:1},8,["onClick"]),d(t,{type:"default",size:"default",onClick:v(Z)},{default:r(()=>[...l[5]||(l[5]=[c("清空日志",-1)])]),_:1},8,["onClick"])]),i("div",Q,[d(s,{class:f(["container-custom-radio",v(E)?"w-[21.5rem]":""]),type:"button",modelValue:v(T),"onUpdate:modelValue":l[1]||(l[1]=e=>p(T)?T.value=e:null),options:v(J),onChange:v(U)},null,8,["class","modelValue","options","onChange"]),d(t,{style:_(v(E)?"background:#20a53a; color:#fff;margin: 0 0 0 0rem;":"margin: 0 0 0 1rem;"),onClick:b},{default:r(()=>[c(m(v(E)?"".concat(v(x)(v(I).date[0],"yyyy-MM-dd")," - ").concat(v(x)(v(I).date[1],"yyyy-MM-dd")):"自定义时间"),1)]),_:1},8,["style"]),d(o,{modelValue:v(A),"onUpdate:modelValue":l[2]||(l[2]=e=>p(A)?A.value=e:null),class:"!absolute left-[21.9rem]",ref_key:"datePickerRef",ref:y,type:"daterange","range-separator":"","start-placeholder":"自定义时间","end-placeholder":"","default-time":v(P),"disabled-date":v(B).disabledDate,onChange:v(G)},null,8,["modelValue","default-time","disabled-date","onChange"])])]),i("div",W,[d(w,{class:"h-full",content:v(R).logs,fullScreen:{title:"全屏查看容器".concat(a.compData.name?"【".concat(a.compData.name,"】"):"","日志"),onRefresh:v(N)}},null,8,["content","fullScreen"])])])])}}}),[["__scopeId","data-v-34bf155f"]]),ee=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{X as C,j as a,ee as c,H as g,q as l,S as t,O as u};
