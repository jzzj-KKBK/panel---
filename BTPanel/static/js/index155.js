import{h as e,b as s,e as l}from"./utils-lib.js?v=1756369731";import{c as a,s as t,k as n,p as r,aD as i,G as o,q as m,v as c,e as u,A as d,B as p,x as f,y as g,M as v,C as y,z as b,H as x,O as k,P as _,D as j,aW as S,R as h}from"./base-lib.js?v=1756369731";import{H as w}from"./store3.js?v=1756369731";import{H as R}from"./store4.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const M={class:"flex justify-between items-center h-full px-[3rem] reset"},C={class:"relative h-full"},V={class:"p-[1.5rem]"},H={class:"text-[1.2rem] leading-[2.6rem]"},z={id:"SafeRestart",class:"flex justify-between"},D={key:0,class:"info"},L={key:1,class:"info"},P={key:2,class:"info"},W={key:3,class:"info"},q={key:4,class:"info"},Q={key:5,class:"info"},T={key:6,class:"info"},U={key:7,class:"info"},A={key:0,class:"flex items-center tips mb-[12px]"},B={class:"vcode flex items-center h-[4.8rem] mt-4 pl-[1.2rem] text-[1.4rem]"},F={class:"mx-[1rem]"},G={class:"el-dialog__footer absolute bottom-0 w-full flex justify-end"},I=l(a({__name:"index",setup(l){const a=w(),{showFooter:I,showServer:K,serverRestartRef:O,courseList:E}=t(a),J=R(),{isDockerPanel:N}=t(J),X=n({num1:0,num2:0,gentle:void 0}),Y=e=>{X.num1=Math.round(9*Math.random()+1),X.num2=Math.round(9*Math.random()+1),X.gentle=void 0,!0!==e&&(K.value=!0)},Z=()=>{if(X.gentle!==X.num1+X.num2&&(s().error("计算错误，请重新计算！"),1))return;const e=setTimeout(()=>{a.onRestartServer(),clearTimeout(e)},0)};return r(()=>{Y(!0)}),i(()=>{a.clearRestart()}),(s,l)=>{const t=j,n=S,r=h,i=e,w=o("focus");return m(),c("div",M,[u(t,{type:"danger",class:"danger-btn",onClick:Y},{default:d(()=>[...l[3]||(l[3]=[p("重启服务器",-1)])]),_:1}),u(t,{size:"default",onClick:f(a).onRestartPanel},{default:d(()=>[...l[4]||(l[4]=[p("重启面板",-1)])]),_:1},8,["onClick"]),u(i,{title:"安全重启服务器",modelValue:f(K),"onUpdate:modelValue":l[2]||(l[2]=e=>_(K)?K.value=e:null),area:[46.6,f(I)?49:45],ref_key:"serverRestartRef",ref:O},{default:d(()=>[g("div",C,[g("div",V,[f(N)?(m(),v(n,{key:0,title:"危险操作警告：当前服务器疑似运行在容器环境中！",type:"warning",closable:!1,class:"mb-3"},{default:d(()=>[...l[5]||(l[5]=[g("p",{class:"font-medium mb-2 text-[1.4rem] text-[#666]"},"重启服务器将造成：",-1),g("ul",{class:"list-disc list-inside space-y-1 ml-2 text-[1.2rem] text-[#666]"},[g("li",{class:"font-medium"},"容器实例立即销毁"),g("li",{class:"font-medium"},"所有未挂载数据永久丢失"),g("li",{class:"font-medium"},"网站服务完全中断"),g("li",{class:"font-medium"},"可能需要重新部署和配置")],-1),g("p",{class:"mt-2 font-medium text-[1.4rem] text-[#666]"},'建议：如仅需重启面板服务，请选择"重启面板服务"',-1)])]),_:1})):(m(),v(n,{key:1,type:"warning",closable:!1,title:"即将重启服务器",class:"mb-3"},{default:d(()=>[...l[6]||(l[6]=[g("p",{class:"font-medium mb-2 text-[1.4rem] text-[#666]"},"影响范围：",-1),g("ul",{class:"list-disc list-inside space-y-1 ml-2 text-[1.2rem] text-[#666]"},[g("li",null,"所有网站服务临时中断（1-5分钟）"),g("li",null,"正在进行的用户会话将断开"),g("li",null,"未保存的临时数据可能丢失"),g("li",null,"SSH连接将断开")],-1),g("p",{class:"mt-2 font-medium text-[1.4rem] text-[#666]"},'建议：如仅需重启面板服务，请选择"重启面板服务"',-1)])]),_:1})),g("div",H,[l[16]||(l[16]=g("p",{class:"mt-[1rem] mb-[1rem]"},"面板重启服务器将执行以下操作：",-1)),g("div",z,[f(E).webServe?(m(),c("div",L,[...l[8]||(l[8]=[g("span",{class:"green-bg"},null,-1),g("p",{class:"green-font"},"正在停止Web服务...",-1)])])):(m(),c("div",D,[...l[7]||(l[7]=[g("span",{class:"gray-bg"},null,-1),g("p",null,"1. 停止Web服务",-1)])])),f(E).mysqlServe?(m(),c("div",W,[...l[10]||(l[10]=[g("span",{class:"green-bg circle-green"},null,-1),g("p",{class:"green-font"},"正在停止MySQL服务...",-1)])])):(m(),c("div",P,[...l[9]||(l[9]=[g("span",{class:"gray-bg circle-gray"},null,-1),g("p",null,"2. 停止MySQL服务",-1)])])),f(E).restartServe?(m(),c("div",Q,[...l[12]||(l[12]=[g("span",{class:"green-bg circle-green"},null,-1),g("p",{class:"green-font"},"正在重启服务器...",-1)])])):(m(),c("div",q,[...l[11]||(l[11]=[g("span",{class:"gray-bg circle-gray"},null,-1),g("p",null,"3. 开始重启服务器",-1)])])),f(E).serveStart?(m(),c("div",U,[...l[14]||(l[14]=[g("span",{class:"green-bg circle-green"},null,-1),g("p",{class:"green-font"},"4. 等待服务器启动",-1),g("i",{class:"svgtofont-el-loading animate-spin"},null,-1)])])):(m(),c("div",T,[...l[13]||(l[13]=[g("span",{class:"gray-bg circle-gray"},null,-1),g("p",null,"4. 等待服务器启动",-1)])]))]),f(E).serveStart?(m(),c("div",A,[...l[15]||(l[15]=[g("p",null,"重启进行中时，请勿随意进行刷新，若长时间未响应，可以进行刷新尝试。",-1)])])):y("",!0)]),g("div",B,[l[17]||(l[17]=g("span",null,"计算结果：",-1)),g("span",F,b(f(X).num1)+" + "+b(f(X).num2),1),l[18]||(l[18]=g("span",{class:"mr-[1rem]"},"=",-1)),x(u(r,{modelValue:f(X).gentle,"onUpdate:modelValue":l[0]||(l[0]=e=>f(X).gentle=e),autofocus:"true","controls-position":"right",size:"small",onKeydown:k(Z,["native","enter"])},null,8,["modelValue"]),[[w]])])]),g("div",G,[u(t,{type:"warning",onClick:l[1]||(l[1]=e=>K.value=!1)},{default:d(()=>[...l[19]||(l[19]=[p("取消",-1)])]),_:1}),u(t,{type:"primary",onClick:Z},{default:d(()=>[...l[20]||(l[20]=[p("确认",-1)])]),_:1})])])]),_:1},8,["modelValue","area"])])}}}),[["__scopeId","data-v-49cd6d57"]]);export{I as default};
