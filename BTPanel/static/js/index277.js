import{u as a,l as e,L as l,K as t,M as s,o as n,aq as i,k as r,j as o,h as u}from"./utils-lib.js?v=1756369731";import{_ as m}from"./index117.js?v=1756369731";import{_ as d}from"./index103.js?v=1756369731";import{c,r as p,b4 as _,e as y,al as w,p as f,G as g,q as v,v as h,x as b,A as j,B as x,H as k,y as S,M as V,P as C,D as I}from"./base-lib.js?v=1756369731";import{Z as q,S as H,_ as D,$ as T,a0 as A,n as E}from"./firewall.js?v=1756369731";import{u as P}from"./column.js?v=1756369731";import{l as F}from"./validator.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const L={key:0},O={class:"p-[2rem] flex items-center"},z=c({__name:"index",setup(c){const{mainHeight:z,payment:M}=a(),N=p(!1),R=p(""),U=p(!1),B=p([]),G=p([]),K=p(!1),Z=_({title:"SSH系统账号管理-功能介绍",ps:"SSH系统账号管理通常涉及到在服务器上创建、删除和管理SSH用户账户的过程。这些账户可以用于通过SSH（安全壳层）协议远程访问服务器。这种管理工作通常由系统管理员进行，以确保只有授权的用户可以访问服务器。",source:305,desc:["创建系统用户","修改系统用户密码","删除系统用户","记录日志","防入侵"],isInstall:K.value,tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/ssh_system_manage.png"}],pluginInfo:{name:"bt_security"}}),$=async()=>{F({name:"bt_security"})},J=()=>{e({title:"创建系统用户",area:42,showFooter:!0,compData:{refreshFn:X},component:()=>l(()=>import("./add-user.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},Q=async()=>{if(!R.value)return s.error("请输入新密码");await t({loading:"正在设置密码，请稍后...",request:H({username:G.value[0],password:R.value}),message:!0}),N.value=!1,R.value=""},W=async(a,e,l)=>{await t({loading:"正在"+(a?"开启":"关闭")+(3===l?"防入侵":"记录日志")+"，请稍后...",request:3===l?T(a,{user:e[0]}):A(a,{uid:e[1]}),message:!0}),X()},X=async()=>{U.value=!0;const{data:a,msg:e}=await E();if(!a.status&&"插件不存在!"===e)return Z.isInstall=!1,K.value=!0,void Y();Z.isInstall=!0,K.value=!1,B.value=a.system_user,U.value=!1},Y=async()=>{try{const{data:a}=await i({sName:"bt_security"});Z.pluginInfo=a}catch(a){}},aa=[{label:"用户名",render:a=>a[0]},{label:"防入侵",width:100,render:a=>y(w,{modelValue:a[3],size:"small",onChange:e=>W(e,a,3)},null)},{label:"记录日志",width:100,render:a=>y(w,{modelValue:a[5],size:"small",onChange:e=>W(e,a,5)},null)},{label:"备注",render:a=>a[6]},P([{onClick:async a=>{const n=await t({loading:"正在获取日志，请稍后...",request:q({user:a[0]}),data:Array});if(!n.length)return s.error("当前暂无日志");G.value={user:a[0],dateTime:n[0],dateOptions:n.map(a=>({title:a,key:a}))},e({title:"命令日志",area:72,component:()=>l(()=>import("./index459.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:G.value})},title:"命令日志",width:70},{onClick:a=>{G.value=a,N.value=!0},title:"重置密码",width:70},{onClick:async a=>{await n({icon:"warning-filled",title:"删除[".concat(a[0],"]用户"),content:"危险操作，正在删除[".concat(a[0],"]用户，请在下方输入'确认删除'"),input:{content:"确认删除"},type:"input"}),await t({loading:"正在删除中,请稍后...",request:D({username:a[0]}),message:!0}),X()},title:"删除"}])];return f(X),(a,e)=>{const l=I,t=r,s=d,n=m,i=o,c=u,p=g("bt-loading");return v(),h("div",null,["ltd"!==b(M).authType||b(K)?(v(),V(n,{key:1,data:b(Z),class:"px-[20%] py-[2rem]"},null,8,["data"])):(v(),h("div",L,[y(s,null,{"header-left":j(()=>[y(l,{type:"primary",onClick:J},{default:j(()=>[...e[3]||(e[3]=[x(" 创建系统用户 ",-1)])]),_:1}),y(l,{onClick:$},{default:j(()=>[...e[4]||(e[4]=[x("堡塔防入侵",-1)])]),_:1})]),content:j(()=>[k(y(t,{column:aa,data:b(B)},null,8,["data"]),[[p,b(U)],[p,"正在加载列表，请稍后...","title"]])]),_:1}),e[5]||(e[5]=S("ul",{class:"mt-[.8rem] leading-8 text-[1.2rem] list-disc ml-[2rem]"},[S("li",null,"开启防提权，系统会针对该用户操作命令进行限制，并记录跟踪"),S("li",null,"不开启防提权，系统只针对该用户操作过的命令做记录跟踪"),S("li",null,"目前防提权默认只针对www,redis,mysql操作引起的提权问题进行处理"),S("li",{class:"text-danger"},"消息推送需要更新至最新面板的版本(2020-06-17日之后安装的版本|或者2020-06-17日之后点击过修复面板)")],-1))])),y(c,{title:"修改密码",modelValue:b(N),"onUpdate:modelValue":e[1]||(e[1]=a=>C(N)?N.value=a:null),area:38,showFooter:"",onConfirm:Q,onCancel:e[2]||(e[2]=()=>R.value="")},{default:j(()=>[S("div",O,[e[6]||(e[6]=S("span",{class:"inline-block w-[8rem] text-right"},"新密码",-1)),y(i,{class:"ml-[1.2rem]",isNull:!0,iconType:"refresh",modelValue:b(R),"onUpdate:modelValue":e[0]||(e[0]=a=>C(R)?R.value=a:null),placeholder:"请输入新密码"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}});export{z as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
