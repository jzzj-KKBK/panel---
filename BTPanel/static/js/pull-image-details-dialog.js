import{c as a,ay as e,r as l,g as t,p as s,q as n,v as c,y as i,z as m,x as u,e as o,A as p,J as r,B as d,c2 as _,D as v}from"./base-lib.js?v=1756369731";import{i2 as g,i3 as f,M as x,e as y}from"./utils-lib.js?v=1756369731";import{p as V}from"./index29.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index103.js?v=1756369731";import"./useMethods.js?v=1756369731";import"./column.js?v=1756369731";import"./index104.js?v=1756369731";const j={class:"flex-wrap p-[2rem]"},w={class:""},D={class:"bg-[#f8f8f8] p-[2rem] rounded-[.4rem]"},b={class:"text-[16px]"},h={class:"mt-[1rem] text-[#666]"},k={class:"flex mt8px"},C=["title"],H={class:"max-w-[25rem]"},I={class:"text-[1.4rem] leading-[1.4] max-w-[25rem] truncate"},M={class:"text-[1.2rem] leading-[1.2] text-[#ccc] mt-[1rem]"},S={class:"name"},q=y(a({__name:"pull-image-details-dialog",props:{compData:{default:()=>({name:""})}},setup(a){const y=a;e("popupClose",()=>{});const q=l({id:0,selectValue:"",detail:{name:"",last_updated:"",is_official:!1,pull_count:0}}),z=t(()=>{let a=q.value.detail.pull_count;return a?a.toLocaleString():""}),A=t(()=>"library"===q.value.detail.namespace?"是":"否"),B=l([]),J=a=>{q.value.selectValue=a.tag_name},L=(a,e)=>{(async()=>{await P();const l=B.value,t=q.value.selectValue,s=a===t?l.sort((a,e)=>a.tag_name===t&&e.tag_name!==t?-1:a.tag_name!==t&&e.tag_name===t?1:0):l.filter(e=>e.tag_name.includes(a));e(s)})()},P=async()=>{const{id:a}=q.value,{data:e}=await f({image:y.compData.name,id:a,search:q.value.selectValue}),l=e.data;B.value=l},U=async()=>{const a=q.value.selectValue;if(!a)return x.error("未获取到镜像ID,请选择一个镜像"),!1;await V({name:y.compData.name,tag:a},y.compData.refresh)};return s(async()=>{try{const{data:a}=await g({image:y.compData.name}),e=a.data;q.value.detail=e,q.value.id=e.id,await P()}catch(a){}}),(a,e)=>{const l=_,t=v;return n(),c("div",j,[i("div",w,[i("div",D,[i("strong",b,m(y.compData.name),1),i("ul",h,[i("li",null,[e[1]||(e[1]=i("span",null,"最近一次更新时间：",-1)),i("span",null,m(u(q).detail.last_updated),1)]),i("li",null,[e[2]||(e[2]=i("span",null,"是否为官方镜像：",-1)),i("span",null,m(u(A)),1)]),e[4]||(e[4]=i("li",null,[i("span",null,"来源："),i("span",null,"Docker Hub")],-1)),i("li",null,[e[3]||(e[3]=i("span",null,"Pulls量：",-1)),i("span",null,m(u(z)),1)])])])]),i("div",k,[o(l,{"popper-class":"my-autocomplete",modelValue:u(q).selectValue,"onUpdate:modelValue":e[0]||(e[0]=a=>u(q).selectValue=a),class:"!w-[40rem]","popper-append-to-body":!1,"fetch-suggestions":L,onSelect:J,placeholder:"请选择或搜索镜像"},{default:p(({item:a})=>{var e;return[i("div",{class:r(["flex items-center justify-between py-[1rem]",a.tag_name===u(q).selectValue?" text-[#20a53a] hover:text-[#1d9534]":""]),title:"".concat(a.tag_name)},[i("div",H,[i("div",I,m("".concat(a.tag_name)),1),i("div",M,m("".concat((null==(e=a.digest)?void 0:e.slice(0,30))||"")),1)]),i("span",S,m(a.last_updated)+"更新",1)],10,C)]}),_:1},8,["modelValue"]),o(t,{type:"primary",class:"ml-8px",onClick:U},{default:p(()=>[...e[5]||(e[5]=[d("拉取",-1)])]),_:1})])])}}}),[["__scopeId","data-v-45d313ac"]]);export{q as default};
