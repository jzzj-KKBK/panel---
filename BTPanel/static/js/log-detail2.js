import{c as a,r as s,w as t,p as e,a4 as o,q as l,v as r,e as i,A as n,B as c,y as p,x as u,n as m,D as d}from"./base-lib.js?v=1756369731";import{o as f,K as v,at as y,b as g}from"./utils-lib.js?v=1756369731";import{clearCrontabLog as x,getCrontabLog as _}from"./site.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const b={class:"p-[20px]"},w={class:"pre-box bg-[#333] mt-[12px] text-white h-[48rem] overflow-auto p-[20px]"},j=["innerHTML"],h=a({__name:"log-detail",props:{compData:{default:{}}},setup(a){const h=g(),q=a,{id:D}=q.compData,H=s("正在获取中...."),T=s(null),k=async()=>{await f({title:"提示",content:"确定清空日志吗？",icon:"warning-filled"}),v({loading:"正在清空日志，请稍后...",request:x({id:D}),message:!0,success:C})},C=async a=>{try{const s=await _({id:D});H.value=s.msg,I(),a&&h.request({status:s.status,msg:s.status?"刷新成功":"刷新失败"})}catch(s){y(s)}},I=()=>{m(()=>{const a=document.querySelector(".pre-box");a.scrollTop=a.scrollHeight})};return t(()=>q.compData,()=>{C()},{immediate:!0}),e(()=>{T.value=setInterval(async()=>{await C()},2e3)}),o(()=>{clearInterval(T.value)}),(a,s)=>{const t=d;return l(),r("div",b,[i(t,{type:"primary",onClick:s[0]||(s[0]=a=>C(!0))},{default:n(()=>[...s[1]||(s[1]=[c("刷新日志",-1)])]),_:1}),i(t,{onClick:k,type:"default"},{default:n(()=>[...s[2]||(s[2]=[c("清空日志",-1)])]),_:1}),p("div",w,[p("pre",{innerHTML:u(H)},null,8,j)])])}}});export{h as default};
