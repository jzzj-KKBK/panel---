import{R as a,o as e,K as t,l as s,L as l,S as o,k as i,h as r}from"./utils-lib.js?v=1756369731";import{B as n}from"./index140.js?v=1756369731";import{_ as m}from"./index103.js?v=1756369731";import{_ as d}from"./index112.js?v=1756369731";import{u as p}from"./column.js?v=1756369731";import{c as u,b4 as c,r as w,aB as _,e as g,p as f,G as h,q as b,v as j,A as v,H as x,x as U,y as P,P as L}from"./base-lib.js?v=1756369731";import{au as R,at as y,bw as I}from"./firewall.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./ace.js?v=1756369731";import"./index104.js?v=1756369731";const V={class:"p-[2rem] min-h-[40rem]"},k={class:"p-[2rem]"},T=u({__name:"index",props:{compData:{default:{}}},setup(u){const T=u,q=c({p:1,limit:10}),C=w(),D=w(!1),S=w(!1),H=w(0),A=w(),E={mode:"ace/mode/nginx",theme:"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!0,fontSize:"12px"},O=async a=>{await e({title:"加入IP白名单",content:"是否将".concat(a.address,"添加到IP白名单？"),icon:"warning-filled"}),await t({loading:"正在添加IP白名单，请稍后...",request:y({start_ip:a.address,end_ip:a.address}),message:!0})},z=async()=>{await t({loading:S,request:I({...q,siteName:T.compData.row.site_name}),data:{data:[Array,C],page:o(H)}})},B=[{label:"时间",render:e=>_("span",a(e.addtime))},{label:"用户IP",render:a=>g("span",{class:"bt-link",onClick:()=>O(a)},[a.address])},{label:"恶意类型",prop:"intercept"},{label:"URL地址",prop:"url"},p([{onClick:async a=>{await e({title:"加入URL白名单",content:"加入URL白名单后此URL将不再进行防御，是否继续操作？",icon:"question-filled"}),await t({loading:"正在加入URL白名单，请稍后...",request:R({url_rule:a.url}),message:!0})},title:"URL加白",width:70},{onClick:a=>{s({title:a.address+"-详情",area:56,component:()=>l(()=>import("./log-detail3.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{row:a,addIpWhiteEvent:O}})},title:"详情"},{onClick:a=>{D.value=!0,A.value=JSON.stringify(a,null,4)},title:"HTTP"}])];return f(()=>z()),(a,e)=>{const t=i,s=d,l=m,o=n,p=r,u=h("bt-loading");return b(),j("div",V,[g(l,null,{content:v(()=>[x(g(t,{height:"380",column:B,data:U(C)},null,8,["data"]),[[u,U(S)],[u,"正在加载中，请稍后...","title"]])]),"footer-right":v(()=>[g(s,{total:U(H),page:U(q).p,"onUpdate:page":e[0]||(e[0]=a=>U(q).p=a),row:U(q).limit,"onUpdate:row":e[1]||(e[1]=a=>U(q).limit=a),onChange:z},null,8,["total","page","row"])]),_:1}),g(p,{title:a.compData.row.site_name+"HTTP详情",modelValue:U(D),"onUpdate:modelValue":e[3]||(e[3]=a=>L(D)?D.value=a:null),area:60},{default:v(()=>[P("div",k,[g(o,{modelValue:U(A),"onUpdate:modelValue":e[2]||(e[2]=a=>L(A)?A.value=a:null),class:"min-h-[48rem] max-h-[60rem] overflow-auto","editor-option":E},null,8,["modelValue"])])]),_:1},8,["title","modelValue"])])}}});export{T as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
