import{u as a,l as e,L as t,K as s,k as l,h as o,b as i,o as n}from"./utils-lib.js?v=1756369731";import{_ as r}from"./index117.js?v=1756369731";import{_ as u}from"./index103.js?v=1756369731";import{B as m}from"./index140.js?v=1756369731";import{_ as d}from"./index123.js?v=1756369731";import{c as p,r as c,k as h,p as f,G as v,q as y,v as g,x as _,M as x,A as j,y as w,e as k,B as V,P as b,H as C,D as q,al as A}from"./base-lib.js?v=1756369731";import{_ as E}from"./index104.js?v=1756369731";import{d as F,u as S}from"./column.js?v=1756369731";import{checkMonitorDir as I,setMonitorDir as P,webshellFileSingle as T,setHandleFile as U}from"./site.js?v=1756369731";import{S as B,u as D}from"./useStore4.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./ace.js?v=1756369731";const H={class:"flex items-center"},L={class:"p-20px"},O=p({__name:"index",setup(p){const{getFileEvent:O,saveFileEvent:R}=B(),G=i(),{payment:J}=a(),{siteInfo:K}=D(),M=c([]),N=c(!1),z=c(""),Q=c(!1),W=c({}),X=c(!1),Y=h({title:"动态查杀-功能介绍",ps:"当查杀站点目录中的文件发生修改就会自动的进行木马查杀并进行隔离",source:185,desc:["网页内容修改检测","木马查杀隔离"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/site/dynamic_kill.png"}]}),Z=()=>{e({isAsync:!0,title:"白名单",area:[70,55],component:()=>t(()=>import("./index461.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!1})},$=async()=>{try{const a=await I({path:K.value.path});X.value=a.data.is_run}catch(a){}},aa=async a=>{await s({loading:"正在设置中，请稍后...",request:P(!a,{path:K.value.path}),message:!0}),$()},ea=async()=>{const a=await R({path:W.value.path,data:z.value,encoding:"utf-8"});G.request(a)},ta=async()=>{N.value=!0;try{const a=await T({path:(K.value.path+"/").replace("//","/")});M.value=Array.isArray(a.data)?a.data:[]}catch(a){}N.value=!1},sa=c([{label:"隔离时间",prop:"time"},F(),S([{width:80,onClick:async a=>{W.value=a;const e=await O({path:a.path});if(!e.status)return G.request(e),!1;z.value=e.data.data||e.msg,Q.value=!0},title:"样本文件"},{onClick:a=>{n({title:"删除文件",content:"是否要删除关联的源文件?",type:"check",icon:"warning",check:{content:"源文件",onConfirm:e=>{s({loading:"正在删除文件中，请稍后...",request:U({data:JSON.stringify({path:a.path,md5:a.md5,type:e?"delete":""})}),message:!0,success:a=>{a.status&&ta()}})}}})},title:"删除"}])]);return f(()=>{"ltd"===J.value.authType&&($(),ta())}),(a,e)=>{const t=q,s=E,i=A,n=d,p=l,c=m,h=o,f=u,F=r,S=v("bt-loading");return y(),g("div",null,["ltd"===_(J).authType?(y(),x(f,{key:0},{"header-left":j(()=>[w("div",H,[k(t,{type:"default",onClick:Z},{default:j(()=>[...e[3]||(e[3]=[V(" 白名单 ",-1)])]),_:1}),k(s),e[4]||(e[4]=w("div",{class:"mr-8px"},"动态查杀站点",-1)),w("div",null,[k(i,{modelValue:_(X),"onUpdate:modelValue":e[0]||(e[0]=a=>b(X)?X.value=a:null),width:36,onChange:aa},null,8,["modelValue"])])])]),"header-right":j(()=>[k(n,{onRefresh:ta})]),content:j(()=>[C(k(p,{column:_(sa),"max-height":400,data:_(M)},null,8,["column","data"]),[[S,_(N)]])]),"footer-left":j(()=>[...e[5]||(e[5]=[w("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[w("li",null,"注意：隔离文件后的数字表示隔离文件总数。"),w("li",{class:"text-orange"},"动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离")],-1)])]),"footer-right":j(()=>[...e[6]||(e[6]=[])]),popup:j(()=>[k(h,{title:"在线编辑",showFooter:"",modelValue:_(Q),"onUpdate:modelValue":e[2]||(e[2]=a=>b(Q)?Q.value=a:null),area:70,onConfirm:ea},{default:j(()=>[w("div",L,[k(c,{modelValue:_(z),"onUpdate:modelValue":e[1]||(e[1]=a=>b(z)?z.value=a:null),class:"!h-[40rem]"},null,8,["modelValue"])])]),_:1},8,["modelValue"])]),_:1})):(y(),x(F,{key:1,data:_(Y)},null,8,["data"]))])}}});export{O as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
