!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},l=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function u(n,r,l,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return o(s,"_invoke",function(n,r,o){var l,a,u,c=0,s=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return l=t,a=0,u=e,p.n=n,i}};function d(n,r){for(a=n,u=r,t=0;!f&&c&&!o&&t<s.length;t++){var o,l=s[t],d=p.p,y=l[2];n>3?(o=y===r)&&(u=l[(a=l[4])?5:(a=3,3)],l[4]=l[5]=e):l[0]<=d&&((o=n<2&&d<l[1])?(a=0,p.v=r,p.n=l[1]):d<y&&(o=n<3||l[0]>r||r>y)&&(l[4]=n,l[5]=r,p.n=y,a=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),a=s,u=y;(t=a<2?e:u)||!f;){l||(a?a<3?(a>1&&(p.n=-1),d(a,u)):p.n=u:p.v=u);try{if(c=2,l){if(a||(o="next"),t=l[o]){if(!(t=t.call(l,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,a<2&&(a=0)}else 1===a&&(t=l.return)&&t.call(l),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);l=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){l=e,a=1,u=t}finally{c=1}}return{value:t,done:f}}}(n,l,a),!0),s}var i={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var p=[][l]?t(t([][l]())):(o(t={},l,function(){return this}),t),d=f.prototype=c.prototype=Object.create(p);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=f,o(d,"constructor",f),o(f,"constructor",s),s.displayName="GeneratorFunction",o(f,a,"GeneratorFunction"),o(d),o(d,a,"Generator"),o(d,l,function(){return this}),o(d,"toString",function(){return"[object Generator]"}),(r=function(){return{w:u,m:y}})()}function o(e,t,n,r){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}o=function(e,t,n,r){function a(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?l?l(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},o(e,t,n,r)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,n||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function i(e,t,n,r,o,l,a){try{var u=e[l](a),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var l=e.apply(t,n);function a(e){i(l,r,o,a,u,"next",e)}function u(e){i(l,r,o,a,u,"throw",e)}a(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./ssl-legacy.js?v=1756369731","./index-legacy84.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy103.js?v=1756369731","./index-legacy145.js?v=1756369731","./we-com-legacy.js?v=1756369731","./validator-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./column-legacy.js?v=1756369731","./useController-legacy13.js?v=1756369731","./site-legacy.js?v=1756369731","./useStore-legacy12.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./useController-legacy6.js?v=1756369731","./useController-legacy5.js?v=1756369731","./useMethod-legacy5.js?v=1756369731","./useController-legacy4.js?v=1756369731","./useStore-legacy10.js?v=1756369731","./useMethod-legacy11.js?v=1756369731","./useStore-legacy11.js?v=1756369731","./useMethod-legacy10.js?v=1756369731"],function(e,n){"use strict";var o,l,u,i,s,f,p,d,y,m,v,b,g,j,h,_,w,k,O,x,S,P,V,T,A,C,D,q,E,G,U,F,M,L,I;return{setters:[function(e){o=e.c,l=e.K,u=e.fP,i=e.ag,s=e.W},function(e){f=e.c,p=e.s,d=e.r,y=e.e,m=e.B,v=e.p,b=e.n,g=e.a4,j=e.G,h=e.q,_=e.v,w=e.A,k=e.x,O=e.H,x=e.M,S=e.F,P=e.a_,V=e.y,T=e.z,A=e.S,C=e.a9,D=e.a$,q=e.ai,E=e.a7},function(e){G=e.T,U=e.U,F=e.A,M=e.V},function(e){L=e.u,I=e.o},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var n={class:"p-[16px]"},H={class:"flex items-center"};e("default",f({__name:"index",props:{compData:{}},emits:["close"],setup:function(e,f){var N=f.expose,R=f.emit,$=e.compData,z=$.isEdit,B=$.row,K=p(L()),W=K.deployFormData,J=K.siteList,Q=K.certificateDeployTaskList,X=K.isRefreshDeployTaskList,Y=d(),Z=d(!1),ee=d(!1),te=[{content:"提示：请先在宝塔官网->SSL模块->自动同步中创建同步任务，请不要泄露同步任务的密钥"},{content:y(o,{class:"inline-block",onClick:I},{default:function(){return[y("div",{class:"flex items-center"},[y("span",{class:"text-[1.2rem]"},[">>"]),y("span",null,[m("使用说明")])])]}})}],ne={task_name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符之间",trigger:"blur"}],cloud_id:[{required:!0,message:"请选择证书部署任务",trigger:["blur","change"]}],private_key:[{required:!0,message:"请输入密钥",trigger:"blur"}],sites:[{required:!0,message:"请选择至少一个网站",trigger:"change"},{type:"array",min:1,message:"请选择至少一个网站",trigger:"change"}]},re=function(){window.open("https://www.bt.cn/admin/safe","_blank","noopener,noreferrer")},oe=function(){var e=c(r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Y.value){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,Y.value.validate();case 2:t=a(a({},W.value),{},{sites:W.value.sites.join(",")}),l({loading:z?"正在修改同步任务":"正在创建同步任务",message:!0,request:z?G(t):U(t),success:function(e){e.status&&(X.value=!0,R("close"))}}),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),le=function(){var e=c(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:Z.value=!0,l({request:F(),success:function(e){var t=e.data;J.value=t.map(function(e){return{label:e.name,value:e.name}}),Z.value=!1}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=c(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:ee.value=!0,l({request:M(),success:function(e){Q.value=e.data.map(function(e){return{label:e.synchron_name,host:e.host,value:e.id}}),ee.value=!1}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return v(function(){le(),ae(),b(function(){var e;z?(W.value.task_id=B.id,W.value.task_name=B.task_name,W.value.cloud_id=B.cloud_id,W.value.private_key=B.private_key,W.value.sites=null===(e=B.sites)||void 0===e?void 0:e.split(",")):W.value.task_name=u(8)})}),g(function(){W.value={}}),N({onConfirm:oe}),function(e,r){var l=A,a=C,u=D,c=q,f=i,p=o,d=E,m=s,v=j("bt-loading");return h(),_("div",n,[y(d,{ref_key:"formRef",ref:Y,model:k(W),rules:ne,"label-width":"120px"},{default:w(function(){return[y(a,{label:"名称",prop:"task_name"},{default:w(function(){return[y(l,{class:"!w-[230px]",placeholder:"请输入名称",disabled:k(z),modelValue:k(W).task_name,"onUpdate:modelValue":r[0]||(r[0]=function(e){return k(W).task_name=e})},null,8,["disabled","modelValue"])]}),_:1}),y(a,{label:"选择证书部署任务",prop:"cloud_id"},{default:w(function(){return[O((h(),x(f,{class:"!w-[230px]",placeholder:"请选择证书部署任务",modelValue:k(W).cloud_id,"onUpdate:modelValue":r[1]||(r[1]=function(e){return k(W).cloud_id=e})},{default:w(function(){return[(h(!0),_(S,null,P(k(Q),function(e){return h(),x(c,{key:e.value,label:e.label,value:e.value},{default:w(function(){return[V("div",H,[V("span",null,T(e.label),1),y(u,{direction:"vertical"}),V("span",null,T(e.host),1)])]}),_:2},1032,["label","value"])}),128))]}),_:1},8,["modelValue"])),[[v,k(ee)]]),y(p,{class:"ml-[12px]",onClick:re},{default:w(function(){return t(r[4]||(r[4]=[V("div",{class:"flex items-center"},[V("span",{class:"text-[1.2rem]"},">>"),V("span",null,"去创建")],-1)]))}),_:1})]}),_:1}),y(a,{label:"密钥",prop:"private_key"},{default:w(function(){return[y(l,{class:"!w-[230px]",placeholder:"请输入密钥",modelValue:k(W).private_key,"onUpdate:modelValue":r[2]||(r[2]=function(e){return k(W).private_key=e})},null,8,["modelValue"]),y(p,{class:"ml-[12px]",onClick:re},{default:w(function(){return t(r[5]||(r[5]=[V("div",{class:"flex items-center"},[V("span",{class:"text-[1.2rem]"},">>"),V("span",null,"去获取")],-1)]))}),_:1})]}),_:1}),y(a,{label:"选择网站",prop:"sites"},{default:w(function(){return[O(y(f,{class:"!w-[230px]",multiple:!0,placeholder:"请选择网站",options:k(J),modelValue:k(W).sites,"onUpdate:modelValue":r[3]||(r[3]=function(e){return k(W).sites=e})},null,8,["options","modelValue"]),[[v,k(Z)]])]}),_:1})]}),_:1},8,["model"]),y(m,{options:te,listStyle:"disc",class:"ml-[20px]"})])}}}))}}})}();
