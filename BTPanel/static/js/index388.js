import{c as e,s,r,q as a,v as l,e as t,A as o,y as n,J as u,x as v,Q as d,P as c,aW as m,S as i}from"./base-lib.js?v=1756369731";import{b as p,o as f,K as b,e as y}from"./utils-lib.js?v=1756369731";import{H as x,I as h}from"./ssl.js?v=1756369731";import{u as g}from"./useStore11.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const _={class:"p-[16px]"},j={class:"flex flex-1 justify-start mt-[16px]"},D={class:"flex-1 mr-[2rem]"},w={class:"flex-1"},I=y(e({__name:"index",emits:["close"],setup(e,{expose:y,emit:I}){const{activeTabs:R,sslIsRefresh:V,testIsRefresh:k,encryptIsRefresh:q,otherIsRefresh:T}=s(g()),z=I,A=r(""),C=r(""),E=r(!1),F=r(!1),H=(e,s)=>{var r;if(s.preventDefault(),"key"===e?E.value=!1:F.value=!1,window.FileReader){const a=null==(r=s.dataTransfer)?void 0:r.files;if(a&&a.length>0){const s=a[0],r=new FileReader;r.onload=s=>{var r;(null==(r=s.target)?void 0:r.result)&&("key"===e?A.value=s.target.result:C.value=s.target.result)},r.onerror=()=>{p().error("请上传证书文件")},r.readAsText(s)}else p().error("无效的证书文件拖拽上传")}else p().error("当前浏览器版本不支持文件拖拽上传，请升级浏览器版本")},K={ssl:()=>V.value=!0,test:()=>k.value=!0,encrypt:()=>q.value=!0,other:()=>T.value=!0};return y({onConfirm:async()=>{var e;try{const s=await x({key:A.value,csr:C.value});p().request(s),s.status&&(z("close"),s.creat_order&&f({title:"创建证书订单",content:"检测到证书文件为let's encrypt证书，是否立即同步证书？",onConfirm:async()=>{b({request:h({ssl_hash:s.ssl_hash}),loading:"正在同步证书",message:!0,success:()=>{var e;null==(e=K[R.value])||e.call(K)}})}}),null==(e=K[R.value])||e.call(K))}catch(s){}}}),(e,s)=>{const r=m,p=i;return a(),l("div",_,[t(r,{type:"success",closable:!1},{title:o(()=>[...s[8]||(s[8]=[n("div",{class:"mr-[3.2rem] text-[1.2rem] pb-[5px]"},"温馨提示：支持拖拽证书文件上传，并自动识别。",-1)])]),_:1}),n("div",j,[n("div",D,[s[9]||(s[9]=n("div",{class:"mb-[.4rem]"},"密钥(KEY)",-1)),n("div",{class:u(["drop-zone mb-[.2rem] p-[.2rem] border border-dashed border-gray-400",{over:v(E)}]),onDragover:s[1]||(s[1]=d(e=>E.value=!0,["prevent"])),onDragleave:s[2]||(s[2]=d(e=>E.value=!1,["prevent"])),onDrop:s[3]||(s[3]=e=>H("key",e))},[t(p,{type:"textarea",rows:22,modelValue:v(A),"onUpdate:modelValue":s[0]||(s[0]=e=>c(A)?A.value=e:null)},null,8,["modelValue"])],34)]),n("div",w,[s[10]||(s[10]=n("div",{class:"mb-[.4rem]"},"证书(PEM格式)",-1)),n("div",{class:u(["drop-zone mb-[.2rem] p-[.2rem] border border-dashed border-gray-400",{over:v(F)}]),onDragover:s[5]||(s[5]=d(e=>F.value=!0,["prevent"])),onDragleave:s[6]||(s[6]=d(e=>F.value=!1,["prevent"])),onDrop:s[7]||(s[7]=e=>H("csr",e))},[t(p,{type:"textarea",rows:22,modelValue:v(C),"onUpdate:modelValue":s[4]||(s[4]=e=>c(C)?C.value=e:null)},null,8,["modelValue"])],34)])])])}}}),[["__scopeId","data-v-8e9ccb5e"]]);export{I as default};
