import{G as e,fj as a,h as s,c as l,fi as t,T as r,e as o}from"./utils-lib.js?v=1756369731";import{_ as i}from"./index103.js?v=1756369731";import{c as m,s as u,g as n,r as p,w as d,p as c,q as v,v as g,e as f,A as b,B as h,x as j,y as w,P as x,D as _}from"./base-lib.js?v=1756369731";import{b as y,k as S}from"./form-item.js?v=1756369731";import{u as C}from"./column.js?v=1756369731";import{s as F,a as V,b as q,d as L}from"./index51.js?v=1756369731";import{L as k}from"./useController8.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore6.js?v=1756369731";import"./index323.js?v=1756369731";import"./config.js?v=1756369731";import"./index123.js?v=1756369731";import"./index116.js?v=1756369731";import"./validator.js?v=1756369731";import"./useStore7.js?v=1756369731";const B={class:"p-[20px]"},D={class:"p-[2rem]"},I={class:"p-[2rem]"},P={class:"list-disc mt-[20px] pl-[28px]"},T={class:"h-[2.4rem]"},E=o(m({__name:"index",setup(o){const m=k(),{sForm:E,sendSource:U,logSystemDialog:A,logSystemForm:G,sourceForm:H,logSystemData:O,logSystemLoad:z,logSysForm:J,logSystemList:K}=u(m),{getLogSystemData:M,getLogSystemSite:N,sendSourceConfirm:Q}=m,{BtForm:R,submit:W}=e({data:G.value,options:e=>n(()=>[y("IP","ip",{attrs:{placeholder:"日志服务系统的ip",clearable:!0,class:"!w-22rem"},rules:[{required:!0,validator:(e,a,s)=>{t(a)||s(new Error("请输入正确的IP")),s()},trigger:["blur","change"]}]}),y("端口","port",{attrs:{placeholder:"请输入端口号",clearable:!0,"controls-position":"right",class:"!w-22rem",type:"number"},rules:[{required:!0,validator:(e,a,s)=>{r(a)&&a||s(new Error("请输入正确的端口(范围为1-65535)")),s()},trigger:["blur","change"]}]})]),submit:async(e,a,s)=>(await a(),await F(e.value))}),X=p({site:[],ip:G.value.port?G.value.ip+":"+G.value.port:"未配置"});d(G,e=>{K.value[0].ip,X.value.ip=e.port?e.ip+":"+e.port:"未配置"},{deep:!0});const{BtForm:Y,submit:Z}=e({data:X.value,options:e=>n(()=>[S("网站","site",V.value,{attrs:{multiple:!0,collapseTags:!0,class:"!w-22rem"},rules:[{required:!0,message:"请选择网站",trigger:"change"}]}),y("日志系统","ip",{attrs:{disabled:!0,class:"!w-22rem"}})]),submit:async(e,a,s)=>(await a(),await q({...e.value,server_id:K.value.length?K.value[0].id:""}))}),{BtTable:$}=a({request:M,columns:[{label:"已设置站点",prop:"site_name"},C([{onClick:L,title:"删除"}])]});return c(()=>{N()}),(e,a)=>{const t=_,r=i,o=s,m=l;return v(),g("div",B,[f(r,null,{"header-left":b(()=>[f(t,{onClick:a[0]||(a[0]=e=>U.value=!0),type:"primary"},{default:b(()=>[...a[5]||(a[5]=[h(" 设置发送源 ",-1)])]),_:1}),f(t,{onClick:a[1]||(a[1]=e=>A.value=!0)},{default:b(()=>[...a[6]||(a[6]=[h("日志服务系统配置",-1)])]),_:1})]),content:b(()=>[f(j($),{"max-height":"360"}),a[7]||(a[7]=w("ul",{class:"list-disc w-[50rem] pl-[1rem] mt-[12px] text-[#777]"},[w("li",null,"注意：网站被访问后才会在日志服务系统中显示")],-1))]),_:1}),f(o,{title:"设置发送源",modelValue:j(U),"onUpdate:modelValue":a[2]||(a[2]=e=>x(U)?U.value=e:null),"show-footer":!0,area:[40],onConfirm:j(Z)},{default:b(()=>[w("div",D,[f(j(Y),{"label-width":"80px"})])]),_:1},8,["modelValue","onConfirm"]),f(o,{title:"日志服务系统配置",modelValue:j(A),"onUpdate:modelValue":a[3]||(a[3]=e=>x(A)?A.value=e:null),"show-footer":!0,area:[40],onConfirm:j(W),onCancel:a[4]||(a[4]=e=>(A.value=!1,z.value=!1,void(K.value.length>0&&Object.assign(G.value,K.value[0]))))},{default:b(()=>[w("div",I,[f(j(R),{"label-width":"80px"}),w("ul",P,[w("li",T,[f(m,{href:"https://www.bt.cn/bbs/thread-120054-1-1.html"},{default:b(()=>[...a[8]||(a[8]=[h(" 如何配置日志服务系统 ",-1)])]),_:1})]),a[9]||(a[9]=w("li",null,"端口：日志服务收集端口，请在安装“日志服务系统”的机器通过 btlogs 8 获取",-1))])])]),_:1},8,["modelValue","onConfirm"])])}}}),[["__scopeId","data-v-403d4797"]]);export{E as default};
