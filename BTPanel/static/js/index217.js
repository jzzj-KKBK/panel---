import{_ as a}from"./index103.js?v=1756369731";import{o as s,K as e,h7 as t,k as l,h as o}from"./utils-lib.js?v=1756369731";import{_ as i}from"./index123.js?v=1756369731";import{c as r,r as n,aB as p,ay as u,p as c,G as d,q as m,v as f,e as h,A as v,B as j,H as b,x as _,P as x,y as w,z as y,F as g,a_ as C,D as k}from"./base-lib.js?v=1756369731";import{u as D}from"./column.js?v=1756369731";import{uploadCertToCloud as q,removeCloudCert as H}from"./site.js?v=1756369731";import{u as S}from"./useStore4.js?v=1756369731";import{s as V}from"./useController13.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore12.js?v=1756369731";import"./useController6.js?v=1756369731";import"./validator.js?v=1756369731";import"./useController5.js?v=1756369731";import"./useMethod5.js?v=1756369731";import"./useController4.js?v=1756369731";import"./useStore10.js?v=1756369731";const A={class:"p-[20px]"},B={class:"relative h-full"},z={class:"p-[20px]"},F={class:"flex flex-col p-[12px] bg-[#f5faf2]"},G={class:"mb-[4px]"},I={class:"mb-[4px]"},K={class:"mb-[4px]"},L={class:"overflow-auto h-[12rem] border border-[#efefef] p-[12px]"},M={class:"absolute bottom-0 w-full bg-[#f6f8f8] flex items-center justify-end p-[12px]"},O=r({__name:"index",props:{compData:{default:()=>({})}},setup(r){var O,P;const{siteInfo:R}=S(),T=r,U=n(null==(P=null==(O=R.value)?void 0:O.project_type)?void 0:P.toLowerCase()),E=n(!1),J=n({}),N=n([{label:"域名",prop:"subject"},{label:"到期时间",prop:"not_after"},{label:"品牌",prop:"info.issuer",showOverflowTooltip:!0},{label:"位置",render:a=>p("span",[a.cloud_id>0?"云端":"本地"])},D([{width:70,onClick:async a=>{await s({title:"上传云端证书",content:"将会上传证书信息至云端进行替换，是否继续操作？",icon:"warning-filled",type:"calc"});(await e({loading:"正在上传证书...",request:q({ssl_hash:a.hash}),message:!0})).status&&await X()},isHide:a=>a.cloud_id>0,title:"上传云端"},{onClick:a=>{J.value=a,E.value=!0},title:"部署"},{width:70,onClick:async a=>{await s({title:"删除证书",content:"删除后该证书将不会显示在证书夹，是否继续操作？",icon:"warning-filled"});(await e({loading:"正在删除证书...",request:H({local:a.cloud_id>0?0:1,ssl_hash:a.hash}),message:!0})).status&&await X()},title:"删除"}])]),Q=n([]),W=n(!1),X=async()=>{await e({loading:W,request:t(),data:[Array,Q]})},Y=u("popupClose");return c(X),(s,e)=>{const t=k,r=i,n=l,p=o,u=a,c=d("bt-loading");return m(),f("div",A,[h(u,null,{"header-left":v(()=>[h(t,{type:"default",onClick:X},{default:v(()=>[...e[3]||(e[3]=[j("从云端同步",-1)])]),_:1})]),"header-right":v(()=>[h(r,{onRefresh:X})]),content:v(()=>[b(h(n,{column:_(N),data:_(Q),"max-height":500},null,8,["column","data"]),[[c,_(W)],[c,"正在加载中，请稍后...","title"]])]),popup:v(()=>[h(p,{title:"部署当前证书",modelValue:_(E),"onUpdate:modelValue":e[2]||(e[2]=a=>x(E)?E.value=a:null),area:[52,36]},{default:v(()=>{var a;return[w("div",B,[w("div",z,[w("div",F,[w("span",G,"认证域名："+y(_(J).subject),1),w("span",I,"证书类型："+y(null==(a=_(J).info)?void 0:a.issuer),1),w("span",K,"到期时间："+y(_(J).not_after),1)]),e[4]||(e[4]=w("span",{class:"!mt-[24px] !mb-[4px] inline-block"},"如下是需要批量部署证书的站点：",-1)),w("div",L,[(m(!0),f(g,null,C(s.compData,(a,s)=>(m(),f("div",{key:s,class:"p-[4px] w-full"},y(a.name),1))),128))])]),w("div",M,[h(t,{type:"warning",onClick:e[0]||(e[0]=a=>E.value=!1)},{default:v(()=>[...e[5]||(e[5]=[j("取消",-1)])]),_:1}),h(t,{type:"primary",onClick:e[1]||(e[1]=a=>(async(a=U.value)=>{const{hash:s,subject:e}=J.value;await V({hash:s,subject:e,list:T.compData,type:a}),E.value=!1,Y()})())},{default:v(()=>[j("部署("+y(s.compData.length)+"项目)",1)]),_:1})])])]}),_:1},8,["modelValue"])]),_:1})])}}});export{O as default};
