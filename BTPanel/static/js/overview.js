import{_ as e}from"./index116.js?v=1756369731";import{c as a,r as l,q as t,v as o,e as s,A as r,F as n,a_ as u,x as i,M as d,B as m,z as c,P as p,J as v,D as y,b5 as f,b6 as h,c9 as w,k as g,ay as _,U as b,g as V,w as x,aD as k,p as D,G as j,H as N,y as C,C as U,n as q,ai as M,aj as A,ax as T,aW as R,al as E,a$ as O,a9 as $,a7 as F}from"./base-lib.js?v=1756369731";import{_ as P}from"./validator.js?v=1756369731";import{R as S,e as H,u as I,c as L,K as Y,at as J,o as W,aj as z,al as B,k as G,W as K,j as Q,h as X,b as Z}from"./utils-lib.js?v=1756369731";import{_ as ee}from"./index103.js?v=1756369731";import{_ as ae}from"./index112.js?v=1756369731";import{_ as le}from"./index123.js?v=1756369731";import{t as te}from"./useController6.js?v=1756369731";import{u as oe}from"./useStore4.js?v=1756369731";import{addExcloud as se,setSiteStatusProof as re,modifyPathConfig as ne,multiCreate as ue,setTamperAlarm as ie,setPushStatus as de,setPushConfig as me,getGlabalTotal as ce,getTamperRuleByPath as pe,delTempClose as ve,setTempClose as ye,modifyGlobalConfig as fe,getTamperCoreLogs as he,getTamperAlarm as we,getPushList as ge,delLogs as _e,getProofIndex as be,getProofLog as Ve}from"./site.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const xe={class:"time flex"},ke=H(a({__name:"day-cut",props:{days:{default:""}},emits:["cut-day","cut-day-click"],setup(e,{emit:a}){const w=a,g=l(""),_=l(1),b=l(),V=l([{content:"昨天",active:!1,event:()=>{_.value=0;const e=S(new Date((new Date).getTime()-864e5),"yyyy-MM-dd");w("cut-day",0,e),x.value=""}},{content:"今天",active:!0,event:e=>{_.value=1;const a=S(new Date,"yyyy-MM-dd");w("cut-day",1,a),x.value=""}}]),x=l(""),k=e=>e.getTime()>Date.now(),D=e=>{g.value="自定义时间",_.value=2,w("cut-day",2,S(e,"yyyy-MM-dd"))};return(e,a)=>{const l=y,w=f,g=h;return t(),o("div",xe,[s(w,{class:"control-btn"},{default:r(()=>[(t(!0),o(n,null,u(i(V),(e,a)=>(t(),d(l,{key:a,type:i(_)===a?"primary":"",onClick:e.event},{default:r(()=>[m(c(e.content),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),s(g,{align:"right",type:"date",modelValue:i(x),"onUpdate:modelValue":a[0]||(a[0]=e=>p(x)?x.value=e:null),placeholder:"自定义时间",ref_key:"player",ref:b,class:v(["auto-time !w-[13rem]","".concat(2===i(_)?"active":"")]),onChange:D,"disabled-date":k},null,8,["modelValue","class"])])}}}),[["__scopeId","data-v-deb01e80"]]),De={key:0,class:"flex justify-between mb-[1.6rem]"},je={class:"flex items-center"},Ne={class:"flex items-center"},Ce={class:"bt-danger"},Ue={key:1,class:"flex items-center justify-center mb-[1.6rem]"},qe={class:"flex items-center flex-1 mr-1rem"},Me={key:0,class:"flex-1"},Ae={class:"flex items-center"},Te={class:"current-box"},Re={class:"current-box-item"},Ee=["title"],Oe={class:"current-box-item"},$e=["title"],Fe={key:0,class:"flex justify-between"},Pe={class:"flex items-center"},Se={class:"flex items-center"},He={class:"flex items-center"},Ie={class:"flex items-center"},Le={class:"flex items-center"},Ye={class:"mt-8 leading-10 list-disc pl-2rem"},Je={class:"flex-wrap"},We=H(a({__name:"overview",props:{compData:{default:{}}},setup(a,{expose:v}){const f=a,H=Z(),{getSenderAlarmListInfo:xe}=I(),{siteInfo:We}=oe(),ze=l(!1),Be=w(),Ge=l(!1),Ke=l(1),Qe=l(S(new Date,"yyyy-MM-dd")),Xe=l({}),Ze=g({p:1,rows:10,total:0}),ea=l(!1),aa=l([]),la=l([]),ta=l({logContent:"",logDialog:!1,name:""}),oa=[{content:"如果需要频繁修改当前文件，确认提交即可。"},{content:"如果需要频繁修改该文件同级文件内容，请删除路径尾部文件名，确认提交即可。"},{content:s(n,null,[m("若大量临时缓存文件被拦截，可参考："),s("code",null,[m("/www/wwwroot/bt.cn/cache/bt_1234.php")]),m("，直接添加"),s("code",null,[m("/www/wwwroot/bt.cn/cache/bt*.php")]),m("即可")])},{content:"注意：以上操作会解除对文件或目录的限制，请确保你信任这些内容，以防止安全问题。"}],sa=l(!1),ra=l(),na=l(!1),ua=g({path:""}),ia=g({path:[{required:!0,message:"请输入目录/文件",trigger:"blur"}]}),da=_("kernelModuleStatus",b(!0)),ma=l({}),ca=l(!1),pa=l(!1),va=l(),ya=g({expire:30,unit:"minute"}),fa=l(),ha=l(!1),wa=g({name:We.value.path+"/"+We.value.name,cycle:30,count:3,interval:600,push_count:1,module:[],limit:["sms"]}),ga=V(()=>"tamper_proof_refactored"===f.compData.type?[{content:"如果开启防篡改后您的网站出现异常，请尝试排除网站日志、缓存、临时文件、上传等目录后重试，或直接关闭异常网站防篡改功能"}]:[{content:"开启防篡改后，部分项目【无法更新，文件无法上传，无法操作等】，需要关闭防篡改或添加白名单"}]),_a=g({cycle:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],push_count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],interval:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],module:[{validator:(e,a,l)=>{0===wa.module.length?l(new Error("请选择告警方式")):l()},trigger:["change"]}]}),ba=l("log"),Va=l([{label:"日志",name:"log",lazy:!0,render:()=>{}}]),xa=g({expire:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("时间必须为大于0的整数"))},trigger:["blur","change"]}]}),ka=l(),Da=l(!1),ja=g({date:""}),Na=g({date:[{required:!0,message:"请选择日期",trigger:"blur"}]}),Ca=e=>e.getTime()>Date.now(),Ua=[{label:"关闭防护",value:0},{label:"拦截模式",value:1},{label:"观察模式",value:2}],qa=g({create:"创建",delete:"删除",modify:"修改",move:"移动",rename:"重命名",chmod:"权限变更"}),Ma=g({0:"关闭",1:"拦截",2:"观察"}),Aa=l([{label:"时间",prop:"time",width:150,render:e=>S(e[0])},{label:"模式",prop:"mode",width:60,render:e=>s("span",{class:"text-[".concat(1===e[1]?"#20a53a":"#f0ad4e","]")},[Ma[e[1]]])},{label:"类型",prop:"type",width:70,render:e=>qa[e[2]]},{label:"文件",prop:"type",showOverflowTooltip:!0,render:e=>s("div",{class:"truncate"},[e[3]])},{label:"溯源日志",prop:"ip",width:78,render:e=>s("span",{class:"bt-link cursor-pointer",onClick:()=>{ta.value.logContent=e[4]&&e[4].length?e[4].join("\n"):"当前日志为空",ta.value.name=e[3],ta.value.logDialog=!0}},[m("溯源日志")])},{label:"状态",prop:"action",width:75,render:e=>"防护成功"},{label:"操作",align:"right",width:90,render:e=>s(L,{onClick:()=>{ua.path=e[3],sa.value=!0}},{default:()=>[m("加入白名单")]})}]),Ta=l([{label:"时间",prop:"date",width:150},{label:"目录",prop:"content"},{label:"类型",prop:"type",width:100,render:e=>s("span",null,[te[e.type]])},{label:"用户",prop:"user",width:90},{label:"进程",prop:"process",width:90}]),Ra=async()=>{await ra.value.validate();(await Y({loading:na,request:se({siteName:We.value.name,excludePath:ua.path}),message:!0})).status&&(sa.value=!1)},Ea=async e=>{var a,l;try{Ge.value=!0;const{data:t}=await be({day:e});Xe.value=null==(a=t.sites)?void 0:a.find(e=>e.siteName==We.value.name),Xe.value.totalNum=Xe.value.total.site.total,Xe.value.theNum=Xe.value.total.day.total,Xe.value.open=Xe.value.open,la.value=null==(l=t.sites)?void 0:l.map(e=>({siteName:e.siteName,path:e.path}))}catch(t){J(t)}finally{Ge.value=!1}},Oa=async e=>{Y({loading:ea,request:Ve({day:e,siteName:We.value.name}),data:{logs:[Array,aa]}})},$a=async e=>{var a;Xe.value.open=e;try{const l=await re({siteName:We.value.name,status:e});(null==(a=l.data)?void 0:a.length)?(H.request(l.data[0]),l.status&&Ea(Qe.value)):H.request(l)}catch(l){J(l)}},Fa=()=>{ya.expire=30,ya.unit="minute",pa.value=!0},Pa=async e=>{var a;try{if(await W({title:"".concat(e?"开启":"关闭","保护目录配置【").concat(We.value.name,"】"),content:e?"启用该保护目录配置后，目录将受到保护，是否继续操作？":"关闭该保护目录配置后，目录将失去保护，是否继续操作？",icon:"warning"}),null==(a=Xe.value)?void 0:a.path){(await Y({loading:"正在设置防篡改，请稍侯...",request:ne({path_id:Xe.value.pid,key:"status",value:e?1:0}),message:!0})).status&&Wa()}else{const{data:e}=await ue({paths:JSON.stringify([{path:We.value.path+"/",ps:We.value.name}])});e.length&&e[0].status?(H.success("开启防篡改成功"),Wa()):H.error("开启防篡改失败")}}catch(l){"cancel"===l&&q(()=>{Xe.value={...Xe.value,open:!e}})}},Sa=async e=>{var a;if(!(null==(a=Xe.value)?void 0:a.path))return H.warn("请先开启防篡改开关再进行告警设置"),void q(()=>{ca.value=!1});if(e){if(!f.compData.isNewAlarmVersion)return H.warn("当前企业级防篡改插件版本小于5.6，请升级插件"),void q(()=>{ca.value=!1});ha.value=!0}else try{await W({title:"关闭保护目录告警【".concat(We.value.name,"】"),content:"关闭该保护目录告警后，该配置将无法发送告警，是否继续操作？",icon:"warning"});(await Y({loading:"正在关闭告警任务，请稍侯...",request:f.compData.isNewAlarmVersion?ie({project:Xe.value.pid},"delete"):de({id:Xe.value.pid,name:"tamper_push",status:0}),message:!0})).status&&Wa()}catch(l){ca.value=!0}},Ha=async()=>{await xe(),H.success("刷新成功")},Ia=()=>{ha.value=!1,ca.value=!1},La=async()=>{await fa.value.validate();(await Y({loading:"正在设置告警任务，请稍侯...",request:f.compData.isNewAlarmVersion?ie({project:Xe.value.pid,cycle:Number(wa.cycle),count:Number(wa.count),interval:Number(wa.interval),day_num:Number(wa.push_count),status:1,sender:wa.module.join(",")},"add"):me({id:Xe.value.pid,name:"tamper_push",data:JSON.stringify({cycle:Number(wa.cycle),count:Number(wa.count),interval:Number(wa.interval),push_count:Number(wa.push_count),module:wa.module.join(","),type:"",title:"【".concat(We.value.path,"】篡改告警")})}),message:!0})).status&&(ha.value=!1,Ka())},Ya=async(e,a)=>{Ke.value=e,Qe.value=a,"tamper_proof_refactored"===f.compData.type?(await Ea(a),await Oa(a)):(Ze.p=1,await Ga(a))},Ja=async()=>{try{Ge.value=!0;const{data:e}=await ce();ma.value=e,da.value=e.glabal_status.kernel_module_status}catch(e){J(e)}finally{Ge.value=!1}},Wa=async()=>{try{const{data:e}=await pe({path:We.value.path});if(Xe.value=e,e.hasOwnProperty("status")){Xe.value.open=!!e.status;let a=0,l=0,t=[],o=[];for(let s in e.total.all)a+=e.total.all[s],t.push("".concat(te[s],": ").concat(e.total.all[s]));for(let s in e.total.today)l+=e.total.today[s],o.push("".concat(te[s],": ").concat(e.total.today[s]));Xe.value.totalNum=a,Xe.value.totalTitle=t.join("\n"),Xe.value.theNum=l,Xe.value.theTitle=o.join("\n"),Ga(Qe.value)}else Xe.value.open=!1,Xe.value.totalNum="--",Xe.value.theNum="--"}catch(e){J(e)}},za=async(e=!1)=>{e&&await va.value.validate();(await Y({loading:"正在设置临时关闭防护，请稍侯...",request:e?ye(ya):ve(),message:!0})).status&&(pa.value=!1,Ja(),Wa())},Ba=async()=>{await W({title:"开启全局开关",content:"开启后，站点目录对应的防篡改配置将生效，是否继续操作？",icon:"warning"});(await Y({loading:"正在开启全局开关，请稍侯...",request:fe({value:1,key:"status"}),message:!0})).status&&Ja()},Ga=async e=>{var a,l;try{const t=await he({path_id:Xe.value.pid,date:e||Qe.value,rows:Ze.rows,p:Ze.p});Array.isArray(t.data)?(aa.value=t.data,Ze.total=t.hasOwnProperty("page")?z(t.page):t.data.length):Array.isArray(null==(a=null==t?void 0:t.data)?void 0:a.data)?(aa.value=t.data.data,Ze.total=t.data.hasOwnProperty("page")?z(t.data.page):(null==(l=t.data)?void 0:l.total)||t.data.data.length):(aa.value=[],Ze.total=0)}catch(t){}},Ka=async()=>{var e;try{if(f.compData.isNewAlarmVersion){const{data:a}=await we();ca.value=null==(e=a.task_list.find(e=>e.project===Xe.value.pid))?void 0:e.status}else{const{data:e}=await ge();var a=e.tamper_push&&e.tamper_push[Xe.value.pid]||{};ca.value=!!(null==a?void 0:a.status)}}catch(l){J(l)}},Qa=()=>{ja.date="",Da.value=!0},Xa=async()=>{try{await ka.value.validate();const e=await _e({path_id:Xe.value.pid,date:ja.date});H.request(e),e.status&&(Da.value=!1,Ga())}catch(e){}};x([()=>ma.value.temp_close_time,()=>Be.value],([e,a])=>{!ze.value&&0!==e&&1e3*e+3e3<a&&(ma.value.temp_close_time=0,Ja(),Wa())});const Za=async()=>{var e;if(f.compData.maskLayer)if(Qe.value=S(new Date,"yyyy-MM-dd"),"tamper_proof_refactored"===f.compData.type)await Ea(Qe.value),await Oa(Qe.value);else{if(!f.compData.isVersion)return;await Ja(),await Wa(),(null==(e=Xe.value)?void 0:e.path)&&await Ka()}};return k(()=>{ze.value=!0}),D(Za),v({sitesList:la,init:Za}),(a,l)=>{var v,f,w,g,_,b;const V=M,x=A,k=T,D=L,q=R,H=E,I=O,Y=y,J=B,W=le,z=G,Z=ae,te=ee,oe=K,se=Q,re=$,ne=F,ue=X,ie=P,de=h,me=e,ce=j("bt-loading");return N((t(),o("div",null,["tamper_proof_refactored"===a.compData.type?(t(),o("div",De,[C("div",je,[l[26]||(l[26]=C("span",{class:"mr-1rem"},"防篡改状态",-1)),s(x,{class:"!w-[16rem]",modelValue:i(Xe).open,"onUpdate:modelValue":l[0]||(l[0]=e=>i(Xe).open=e),onChange:$a},{default:r(()=>[(t(),o(n,null,u(Ua,e=>s(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),s(k,{placement:"top-start",width:"200","popper-class":"green-tips-popover",trigger:"hover",content:""},{reference:r(()=>[...l[24]||(l[24]=[C("i",{class:"svgtofont-el-question-filled text-warning ml-[12px] text-[16px]"},null,-1)])]),default:r(()=>[l[25]||(l[25]=C("ul",{class:"list-disc pl-1.6rem"},[C("li",null,"拦截模式：拦截，并记录"),C("li",null,"观察模式：不拦截，只记录")],-1))]),_:1})]),s(ke,{days:i(Ke),onCutDay:Ya},null,8,["days"])])):(t(),o(n,{key:1},[(null==(v=i(ma))?void 0:v.temp_close_time)?(t(),d(q,{key:0,type:"warning",class:"!mb-[1.6rem] !p-[1.2rem]",closable:!1,"show-icon":""},{title:r(()=>[C("div",Ne,[l[28]||(l[28]=m(" 当前已临时关闭全局防篡改，将在 ",-1)),C("span",Ce,c(i(S)(i(ma).temp_close_time)),1),l[29]||(l[29]=m(" 恢复防护 ",-1)),s(D,{class:"bt-link ml-1rem",onClick:l[1]||(l[1]=e=>za(!1))},{default:r(()=>[...l[27]||(l[27]=[m(" 点击立即恢复 ",-1)])]),_:1})])]),_:1})):(t(),o("div",Ue,[C("div",qe,[l[32]||(l[32]=C("span",{class:"mr-1rem"},"防篡改开关",-1)),s(H,{modelValue:i(Xe).open,"onUpdate:modelValue":l[2]||(l[2]=e=>i(Xe).open=e),width:36,onChange:Pa},null,8,["modelValue"]),s(I,{direction:"vertical",class:"!h-2rem !mx-1.6rem"}),l[33]||(l[33]=C("span",{class:"mr-1rem"},"告警设置",-1)),s(H,{class:"mr-[1.6rem]",modelValue:i(ca),"onUpdate:modelValue":l[3]||(l[3]=e=>p(ca)?ca.value=e:null),width:36,onChange:Sa},null,8,["modelValue"]),(null==(w=null==(f=i(ma))?void 0:f.glabal_status)?void 0:w.settings_status)?U("",!0):(t(),o("div",Me,[s(q,{type:"warning",class:"h-3.2rem",closable:!1,"show-icon":""},{title:r(()=>[C("div",Ae,[l[31]||(l[31]=m(" 未启用企业级防篡改，请先开启 ",-1)),s(D,{class:"underline",type:"danger",onClick:Ba},{default:r(()=>[...l[30]||(l[30]=[m(" 全局开关 ",-1)])]),_:1})])]),_:1})]))]),s(Y,{type:"primary",onClick:Fa},{default:r(()=>[...l[34]||(l[34]=[m(" 全局临时开关 ",-1)])]),_:1})]))],64)),C("div",Te,[C("div",Re,[l[35]||(l[35]=C("div",null,"总拦截次数",-1)),C("div",{title:null==(g=i(Xe))?void 0:g.totalTitle},c(i(Xe).totalNum),9,Ee)]),C("div",Oe,[l[36]||(l[36]=C("div",null,"当日拦截次数",-1)),C("div",{title:null==(_=i(Xe))?void 0:_.theTitle},c(i(Xe).theNum),9,$e)])]),"tamper_core"===a.compData.type?(t(),o(n,{key:2},[s(J,{ref:"tamperRef",type:"",class:"mt-1rem",modelValue:i(ba),"onUpdate:modelValue":l[4]||(l[4]=e=>p(ba)?ba.value=e:null),options:i(Va)},null,8,["modelValue","options"]),(null==(b=i(Xe))?void 0:b.path)?(t(),o("div",Fe,[s(Y,{type:"default",onClick:Qa},{default:r(()=>[...l[37]||(l[37]=[m("清理日志",-1)])]),_:1}),C("div",Pe,[s(ke,{days:i(Ke),onCutDay:Ya},null,8,["days"]),s(W,{onRefresh:Ga,class:"ml-1rem"})])])):U("",!0)],64)):U("",!0),s(te,null,{"header-left":r(()=>[...l[38]||(l[38]=[])]),"header-right":r(()=>[...l[39]||(l[39]=[])]),content:r(()=>["tamper_core"==a.compData.type?N((t(),d(z,{key:0,column:i(Ta),maxHeight:320,data:i(aa)},null,8,["column","data"])),[[ce,i(ea)]]):N((t(),d(z,{key:1,column:i(Aa),maxHeight:400,data:i(aa)},null,8,["column","data"])),[[ce,i(ea)]])]),"footer-left":r(()=>[...l[40]||(l[40]=[])]),"footer-right":r(()=>["tamper_core"===a.compData.type?(t(),d(Z,{key:0,class:"mb-1rem",page:i(Ze).p,"onUpdate:page":l[5]||(l[5]=e=>i(Ze).p=e),row:i(Ze).rows,"onUpdate:row":l[6]||(l[6]=e=>i(Ze).rows=e),total:i(Ze).total,"pager-count":4,onChange:l[7]||(l[7]=e=>Ga())},null,8,["page","row","total"])):U("",!0)]),_:1}),s(oe,{options:i(ga),"list-style":"disc",class:"ml-2rem"},null,8,["options"]),s(ue,{title:"临时关闭防篡改",modelValue:i(pa),"onUpdate:modelValue":l[10]||(l[10]=e=>p(pa)?pa.value=e:null),area:58,onConfirm:l[11]||(l[11]=e=>za(!0)),"show-footer":""},{default:r(()=>[s(ne,{class:"p-[2rem]",ref_key:"tempFormRef",ref:va,model:i(ya),rules:i(xa)},{default:r(()=>[s(re,{label:"临时关闭",prop:"expire"},{default:r(()=>[C("div",Se,[s(se,{type:"number",modelValue:i(ya).expire,"onUpdate:modelValue":l[8]||(l[8]=e=>i(ya).expire=e),width:"14rem",class:"!w-14rem",placeholder:"请输入时间"},null,8,["modelValue"]),s(x,{class:"ml-1rem !w-[10rem]",modelValue:i(ya).unit,"onUpdate:modelValue":l[9]||(l[9]=e=>i(ya).unit=e)},{default:r(()=>[s(V,{label:"分钟",value:"minute"}),s(V,{label:"小时",value:"hour"}),s(V,{label:"天",value:"day"})]),_:1},8,["modelValue"]),l[41]||(l[41]=C("span",{class:"text-[#666] ml-[4px]"},"，到期后自动恢复防护",-1))])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s(ue,{title:"设置告警任务",modelValue:i(ha),"onUpdate:modelValue":l[18]||(l[18]=e=>p(ha)?ha.value=e:null),area:54,onConfirm:La,onCancel:Ia,"show-footer":""},{default:r(()=>[s(ne,{class:"p-[2rem]",ref_key:"alarmFormRef",ref:fa,model:i(wa),rules:i(_a)},{default:r(()=>[s(re,{label:"保护列表"},{default:r(()=>[s(se,{modelValue:i(wa).name,"onUpdate:modelValue":l[12]||(l[12]=e=>i(wa).name=e),disabled:"",width:"35rem"},null,8,["modelValue"])]),_:1}),s(re,{label:"触发条件"},{default:r(()=>[C("div",He,[s(re,{prop:"cycle"},{default:r(()=>[s(se,{modelValue:i(wa).cycle,"onUpdate:modelValue":l[13]||(l[13]=e=>i(wa).cycle=e),type:"number",width:"12rem"},null,8,["modelValue"])]),_:1}),l[42]||(l[42]=C("span",{class:"text-[#666] mx-[.6rem]"},"分钟内，篡改",-1)),s(re,{prop:"count"},{default:r(()=>[s(se,{modelValue:i(wa).count,"onUpdate:modelValue":l[14]||(l[14]=e=>i(wa).count=e),type:"number",width:"12rem"},null,8,["modelValue"])]),_:1}),l[43]||(l[43]=C("span",{class:"text-[#666] mx-[.6rem]"},"次",-1))])]),_:1}),s(re,{label:"间隔时间",prop:"interval"},{default:r(()=>[C("div",Ie,[s(se,{modelValue:i(wa).interval,"onUpdate:modelValue":l[15]||(l[15]=e=>i(wa).interval=e),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),l[44]||(l[44]=C("span",{class:"text-[#666] mx-[.6rem]"},"秒后再次监控触发条件",-1))])]),_:1}),s(re,{label:"推送次数",prop:"push_count"},{default:r(()=>[C("div",Le,[s(se,{modelValue:i(wa).push_count,"onUpdate:modelValue":l[16]||(l[16]=e=>i(wa).push_count=e),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),l[45]||(l[45]=C("span",{class:"text-[#666] mx-[.6rem]"}," 次后停止推送，次日再次监控 ",-1))])]),_:1}),s(re,{label:"告警方式",prop:"module"},{default:r(()=>[s(ie,{modelValue:i(wa).module,"onUpdate:modelValue":l[17]||(l[17]=e=>i(wa).module=e),class:"!w-35rem",limit:i(wa).limit},null,8,["modelValue","limit"])]),_:1}),C("ul",Ye,[C("li",null,[l[47]||(l[47]=m(" 点击配置后状态未更新，尝试点击【 ",-1)),s(D,{class:"!inline-block",onClick:Ha},{default:r(()=>[...l[46]||(l[46]=[m("手动刷新",-1)])]),_:1}),l[48]||(l[48]=m(" 】 ",-1))])])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s(ue,{title:"清理日志",modelValue:i(Da),"onUpdate:modelValue":l[20]||(l[20]=e=>p(Da)?Da.value=e:null),area:38,onConfirm:Xa,"show-footer":""},{default:r(()=>[s(ne,{class:"p-[2rem]",ref_key:"clearFormRef",ref:ka,model:i(ja),rules:i(Na)},{default:r(()=>[s(re,{label:"需要清理的日期",prop:"date"},{default:r(()=>[s(de,{modelValue:i(ja).date,"onUpdate:modelValue":l[19]||(l[19]=e=>i(ja).date=e),type:"date",class:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD","disabled-date":Ca},null,8,["modelValue"])]),_:1}),s(oe,{class:"pl-2rem",options:[{content:"当前仅支持按日期清理日志"}]})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s(ue,{title:"溯源日志[".concat(i(ta).name,"]"),modelValue:i(ta).logDialog,"onUpdate:modelValue":l[21]||(l[21]=e=>i(ta).logDialog=e),area:[60]},{default:r(()=>[C("div",Je,[s(me,{class:"h-[40rem] !rounded-none",content:i(ta).logContent},null,8,["content"])])]),_:1},8,["title","modelValue"]),s(ue,{title:"清理日志",modelValue:i(sa),"onUpdate:modelValue":l[23]||(l[23]=e=>p(sa)?sa.value=e:null),area:56,onConfirm:Ra,"show-footer":""},{default:r(()=>[s(ne,{class:"p-[2rem]",ref_key:"addWhiteListFormRef",ref:ra,model:i(ua),rules:i(ia),disabled:i(na)},{default:r(()=>[s(re,{label:"目录/文件",prop:"path"},{default:r(()=>[s(se,{modelValue:i(ua).path,"onUpdate:modelValue":l[22]||(l[22]=e=>i(ua).path=e),width:"35rem",placeholder:"请输入目录/文件"},null,8,["modelValue"])]),_:1}),s(re,null,{default:r(()=>[s(oe,{options:oa,class:"pl-1rem leading-2rem","list-style":"disc"})]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1},8,["modelValue"])])),[[ce,i(Ge)],[ce,"正在获取站点防篡改信息，请稍侯","title"]])}}}),[["__scopeId","data-v-f7eb5dac"]]);export{We as default};
