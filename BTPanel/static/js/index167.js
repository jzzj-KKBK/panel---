import{e,go as l,c as a,b as s,gp as t,d as i}from"./utils-lib.js?v=1756369731";import{q as o,v as n,y as r,L as c,e as u,A as m,B as d,D as p,c as f,k as b,M as y,x as _,z as w,S as h,a9 as g,a7 as x,bl as v,G as k,H as C,r as V,p as P,C as $,I as S,aV as q,ax as U,bV as j,t as T}from"./base-lib.js?v=1756369731";import{_ as H}from"./index413.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const N={class:"bt-msg-config"},A={class:"p-4rem"},L={class:"from"},M={class:"mt-2rem ml-2rem"},z={class:"el-dialog__footer flex justify-end"},R={class:"footer"};const D=e({},[["render",function(e,l){const a=p;return o(),n("div",N,[r("div",A,[r("div",L,[c(e.$slots,"from")]),r("div",M,[c(e.$slots,"tip")])]),r("div",null,[r("div",z,[r("div",R,[u(a,{type:"warning",onClick:l[0]||(l[0]=l=>e.$emit("close"))},{default:m(()=>[...l[2]||(l[2]=[d("取消",-1)])]),_:1}),u(a,{type:"primary",onClick:l[1]||(l[1]=l=>e.$emit("save"))},{default:m(()=>[...l[3]||(l[3]=[d("保存",-1)])]),_:1})])])])])}]]),I={style:{"list-style":"disc"}},B=e(f({__name:"robot-base",props:["tipName","tipUrl","placeholder","type"],setup(e){const t=e,{proxy:i}=v(),n=b({name:"",url:""}),{load:c,request:p}=s(),f=async()=>{let e;try{e=c("正在设置".concat(t.type,"信息配置，请稍后..."));let a=await l(t.type,{title:n.name,url:n.url,atall:"True"});p(a),i.$emit("callback"),i.$emit("close")}catch(a){}finally{e&&e.close()}};return(l,s)=>{const t=h,i=g,c=x,p=a;return o(),y(D,{onSave:f,onClose:s[2]||(s[2]=e=>l.$emit("close"))},{from:m(()=>[u(c,null,{default:m(()=>[u(i,{label:"名称"},{default:m(()=>[u(t,{modelValue:_(n).name,"onUpdate:modelValue":s[0]||(s[0]=e=>_(n).name=e),autofocus:"",placeholder:"机器人名称或备注"},null,8,["modelValue"])]),_:1}),u(i,{label:"URL"},{default:m(()=>[u(t,{modelValue:_(n).url,"onUpdate:modelValue":s[1]||(s[1]=e=>_(n).url=e),class:"url",type:"textarea",rows:4,placeholder:"请输入".concat(e.placeholder,"机器人URL")},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),tip:m(()=>[r("ul",I,[r("li",null,[u(p,{href:e.tipUrl},{default:m(()=>[d("如何创建"+w(e.tipName)+"机器人",1)]),_:1},8,["href"])])])]),_:1})}}}),[["__scopeId","data-v-b07059b7"]]),G={style:{"list-style":"disc"}},O=f({__name:"mail",setup(e){const{proxy:t}=v(),i=b({emailName:"",emailPass:"",emailHost:"",emailPort:"465"}),{load:n,request:c}=s(),p={emailName:[{required:!0,message:"请输入发送人邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],emailPass:[{required:!0,message:"请输入SMTP密码",trigger:"blur"}],emailHost:[{required:!0,message:"请输入SMTP服务器",trigger:"blur"}],emailPort:[{required:!0,message:"请输入端口",trigger:"blur"}]},f=()=>{t.$refs.emailRef.validate(async e=>{if(e){let e;try{e=n("正在设置邮件信息配置，请稍后...");let a=await l("mail",{send:"1",qq_mail:i.emailName,qq_stmp_pwd:i.emailPass,hosts:i.emailHost,port:i.emailPort});c(a),t.$emit("callback"),t.$emit("close")}catch(a){}finally{e&&e.close()}}})};return(e,l)=>{const s=h,t=g,n=x,c=a,b=k("focus");return o(),y(D,{onSave:f,onClose:l[4]||(l[4]=l=>e.$emit("close"))},{from:m(()=>[u(n,{ref:"emailRef",model:_(i),rules:p},{default:m(()=>[u(t,{label:"发送人邮箱",prop:"emailName"},{default:m(()=>[C(u(s,{modelValue:_(i).emailName,"onUpdate:modelValue":l[0]||(l[0]=e=>_(i).emailName=e)},null,8,["modelValue"]),[[b]])]),_:1}),u(t,{label:"SMTP密码",prop:"emailPass"},{default:m(()=>[u(s,{modelValue:_(i).emailPass,"onUpdate:modelValue":l[1]||(l[1]=e=>_(i).emailPass=e),type:"password"},null,8,["modelValue"])]),_:1}),u(t,{label:"SMTP服务器",prop:"emailHost"},{default:m(()=>[u(s,{modelValue:_(i).emailHost,"onUpdate:modelValue":l[2]||(l[2]=e=>_(i).emailHost=e)},null,8,["modelValue"])]),_:1}),u(t,{label:"端口",prop:"emailPort"},{default:m(()=>[u(s,{modelValue:_(i).emailPort,"onUpdate:modelValue":l[3]||(l[3]=e=>_(i).emailPort=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),tip:m(()=>[r("ul",G,[l[6]||(l[6]=r("li",null,"推荐使用465端口，协议为SSL/TLS",-1)),l[7]||(l[7]=r("li",null,"25端口为SMTP协议，587端口为STARTTLS协议",-1)),r("li",null,[u(c,{href:"https://www.bt.cn/bbs/thread-108097-1-1.html"},{default:m(()=>[...l[5]||(l[5]=[d("配置教程",-1)])]),_:1})])])]),_:1})}}}),E={style:{display:"flex","flex-direction":"row","flex-wrap":"nowrap","justify-content":"flex-start","align-items":"center"}},F={key:0,style:{color:"#20a53a"}},J={key:1,style:{color:"red"}},K={style:{display:"flex","flex-direction":"row","flex-wrap":"nowrap","justify-content":"flex-start","align-items":"center"}},Q={key:0,style:{color:"#20a53a"}},W={key:1,style:{display:"flex","flex-direction":"row","justify-content":"flex-start","align-items":"center"}},X={class:"ml-[1.5rem]"},Y={key:2,style:{color:"red"}},Z={style:{display:"flex","flex-direction":"column","align-items":"center"}},ee=f({__name:"we-chat-account",setup(e){const l=b({circleUrl:"",visible:!1,weChatAccount:!1,nickname:""});let a=b({nonce:0,res:{is_bound:0,is_subscribe:0,head_img:"",nickname:"",remaining:0},success:!1,status:!1});const{load:c,request:f}=s();let y=V("");const h=async()=>{let e;try{e=c("正在获取信息配置，请稍后...");const{data:l}=await t("wx_account","get_web_info");a=Object.assign(a,l)}catch(l){}finally{e&&e.close()}},v=async()=>{try{if(l.weChatAccount&&""!==y.value)return;const{data:e}=await t("wx_account","get_auth_url");y.value=e.res}catch(e){}},T=async()=>{l.visible=!1,l.weChatAccount=!1,y.value="",await h()},N=async()=>{let e;try{e=c("正在发送测试消息，请稍后...");const l=await t("wx_account","push_data","发送测试消息");f(l)}catch(l){}finally{e&&e.close()}};return P(async()=>{await h()}),(e,s)=>{const t=i,c=p,f=q,b=U,h=g,V=j,P=H,A=x,L=k("bt-loading");return o(),n("div",null,[u(D,{onSave:s[1]||(s[1]=l=>e.$emit("close"))},{from:m(()=>[u(A,{"label-position":"right","label-width":"100px"},{default:m(()=>[u(h,{label:"绑定微信公众号"},{default:m(()=>[r("div",E,[1===_(a).res.is_subscribe?(o(),n("span",F,"已绑定")):$("",!0),0===_(a).res.is_subscribe?(o(),n("span",J,"未绑定")):$("",!0),u(b,{width:"160",modelValue:_(l).visible,"onUpdate:modelValue":s[0]||(s[0]=e=>_(l).visible=e),"popper-class":"white-popover"},{reference:m(()=>[u(c,{class:"ml-[1.6rem]"},{default:m(()=>[...s[4]||(s[4]=[d("立即绑定",-1)])]),_:1})]),default:m(()=>[u(f,{shadow:"always",style:{"box-shadow":"rgb(0 0 0 / 46%) 0px 0 2rem 0px"}},{default:m(()=>[s[3]||(s[3]=r("span",{style:{"font-size":"12px"}},"请扫码，进行绑定",-1)),u(t,{src:"https://www.bt.cn/Public/img/bt_wx.jpg",custom:!0}),u(c,{onClick:T},{default:m(()=>[...s[2]||(s[2]=[d("已扫码并完成绑定",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1}),u(h,{label:"绑定微信帐号"},{default:m(()=>[r("div",K,[1===_(a).res.is_bound&&""===_(a).res.nickname?(o(),n("span",Q,"已绑定")):$("",!0),1===_(a).res.is_bound?(o(),n("div",W,[u(V,{size:"small",src:_(a).res.head_img},null,8,["src"]),r("span",X,w(_(a).res.nickname),1)])):$("",!0),0===_(a).res.is_bound?(o(),n("span",Y,"未绑定")):$("",!0),u(b,{width:"190",visible:_(l).weChatAccount,"popper-class":"white-popover"},{reference:m(()=>[u(c,{onClick:v,class:"ml-[1.6rem]"},{default:m(()=>[d(w(1===_(a).res.is_bound?"更换微信账号":"立即绑定"),1)]),_:1})]),default:m(()=>[u(f,{shadow:"always",style:{"box-shadow":"rgb(0 0 0 / 46%) 0px 0 2rem 0px"}},{default:m(()=>[r("div",Z,[s[6]||(s[6]=r("span",{style:{"font-size":"12px"}},"请扫码，进行绑定",-1)),C(u(P,{value:_(y),size:150},null,8,["value"]),[[L,""===_(y)],[L,"正在获取二维码，请稍后....","title"],[S,""!==_(y)]]),u(c,{onClick:T},{default:m(()=>[...s[5]||(s[5]=[d("已扫码并完成绑定",-1)])]),_:1})])]),_:1})]),_:1},8,["visible"])])]),_:1}),u(h,{label:"今日剩余发送次数"},{default:m(()=>[r("span",null,w(_(a).res.remaining),1),u(c,{class:"ml-[1.6rem]",onClick:N},{default:m(()=>[...s[7]||(s[7]=[d("发送测试消息",-1)])]),_:1})]),_:1})]),_:1})]),tip:m(()=>[...s[8]||(s[8]=[r("ul",{style:{"list-style":"disc"}},[r("li",null,"没有绑定微信公众号无法接收面板告警消息"),r("li",null,"当前为体验版,限制每个宝塔账号发送频率100条/天")],-1)])]),_:1})])}}}),le=f({__name:"index",props:{compData:{default:()=>({type:"",callback:()=>{}})}},setup(e){const l=e,{type:a,callback:s}=T(l.compData);return(e,l)=>(o(),n("div",null,["dingding"===_(a)?(o(),y(B,{key:0,class:"dingding",placeholder:"钉钉","tip-name":"钉钉","tip-url":"https://www.bt.cn/bbs/thread-108081-1-1.html",type:"dingding",onClose:l[0]||(l[0]=l=>e.$emit("close")),onCallback:_(s)},null,8,["onCallback"])):$("",!0),"feishu"===_(a)?(o(),y(B,{key:1,class:"feishu",placeholder:"飞书","tip-name":"飞书","tip-url":"https://www.bt.cn/bbs/thread-108274-1-1.html",type:"feishu",onClose:l[1]||(l[1]=l=>e.$emit("close")),onCallback:_(s)},null,8,["onCallback"])):$("",!0),"weixin"===_(a)?(o(),y(B,{key:2,class:"weixin",placeholder:"企业微信","tip-name":"企业微信","tip-url":"https://www.bt.cn/bbs/thread-108116-1-1.html",type:"weixin",onClose:l[2]||(l[2]=l=>e.$emit("close")),onCallback:_(s)},null,8,["onCallback"])):$("",!0),"mail"===_(a)?(o(),y(O,{key:3,onCallback:_(s),onClose:l[3]||(l[3]=l=>e.$emit("close"))},null,8,["onCallback"])):$("",!0),"wx_account"===_(a)?(o(),y(ee,{key:4,onSave:l[4]||(l[4]=l=>e.$emit("close"))})):$("",!0)]))}});export{le as default};
