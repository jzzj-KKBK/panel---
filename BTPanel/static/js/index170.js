import{o as e,K as a,gz as s,M as t,gA as l,aq as n,bT as i,l as o,L as r,R as _,v as c,bz as u,r as d,at as m,gx as f,W as p,ag as b,h,j as y,al as z,e as v}from"./utils-lib.js?v=1756369731";import{s as g,r as w,k as x,c as q,g as k,p as C,G as V,q as j,v as B,e as M,A as S,y as N,x as I,M as U,B as L,C as F,P as G,z as P,H as D,F as E,a_ as H,I as K,D as O,a9 as Q,a7 as T,aA as R,bN as A,bM as J,au as W,aw as Y,ai as $,aj as X,a$ as Z,al as ee}from"./base-lib.js?v=1756369731";import{_ as ae}from"./index116.js?v=1756369731";import{_ as se}from"./index101.js?v=1756369731";import{B as te}from"./index140.js?v=1756369731";import{S as le,_ as ne}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1756369731";import{S as ie,_ as oe}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1756369731";import{E as re,f as _e,F as ce,G as ue,H as de,J as me,K as fe,L as pe,M as be,N as he,O as ye,P as ze,Q as ve,R as ge,T as we}from"./validator.js?v=1756369731";import{H as xe}from"./store4.js?v=1756369731";import{u as qe}from"./useMethod4.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./ace.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";import"./database.js?v=1756369731";import"./useStore2.js?v=1756369731";const ke=le(),Ce=ie(),{compData:Ve}=g(ie()),je=xe();g(je);const Be=w("service"),Me=w(!1);w(!0);const Se=w(""),Ne=w(!1),Ie=x({re_level:1,tips:""}),Ue=[{label:"级别一",value:1},{label:"级别二",value:2},{label:"级别三",value:3},{label:"级别四",value:4},{label:"级别五",value:5},{label:"级别六",value:6}],Le=w(null),Fe={recover:[{content:"启动完成后请立即备份和检查数据库完整性"},{content:"恢复级别说明（从1到6进行尝试）："},{content:"级别一：尝试忽略损坏的页，适用于轻微损坏的情况，可以尝试从数据中恢复。"},{content:"级别二：禁用后台线程，适合解决由于并发操作导致的问题。"},{content:"级别三：适用于需要快速恢复的场景，但可能会导致最近的数据丢失。"},{content:"级别四：适用于插入缓冲区引起问题时的恢复，可能会导致数据文件损坏。"},{content:"级别五：适合于需要快速启动但可能会导致数据一致性问题的情况。"},{content:"级别六：适用于最严重的情况，可能会导致较高的数据丢失及数据文件损坏。"}],config:[{content:"此处为mysql主配置文件，若您不了解配置规则，请勿随意修改"}],storage:[{content:"风险提示：迁移过程中Mysql将会停止运行，请谨慎操作"},{content:"风险提示：迁移过程中请等待迁移完成后再进行其他操作"}],memoryProtection:[{content:"说明：开启后将调整Mysql内存优先级，设置mysql为永不被系统杀死，可确保Mysql稳定运行。但可能导致其他进程异常被杀，严重时可能影响系统运行，建议需要Mysql稳定运行时在开启。"}]},Ge=async()=>{await e({title:"mysqld服务",icon:"warning-filled",content:"即将开始修复mysql启动问题，是否继续？"}),await a({loading:"正在修复启动，请稍后...",request:s(),success:async e=>{"data_err"===e.err_type?(Ie.tips=e.msg,Ne.value=!0):"log_err"===e.err_type?Pe(e.msg):(Ee(),t.msg({dangerouslyUseHTMLString:!0,message:e.msg,type:e.status?"success":"error",duration:e.status?2e3:0,showClose:!e.status,customClass:"".concat("port_in_use"===e.err_type?"max-w-[48rem]":"")}))}})},Pe=async s=>{await e({title:"修复MySQL启动",icon:"warning-filled",content:s}),a({loading:"正在修复MySQL启动，请稍后...",request:re(),message:!0,success:e=>{Ee()}})},De=async()=>{Ie.re_level>=4&&await e({title:"修复MYSQL启动",width:"39rem",isHtml:!0,content:'警告：当前选择的恢复等级将可能导致<span class="text-danger">数据文件损坏会丢失</span>，请做好服务器快照或备份好数据库数据目录【/www/server/data】如果启动成功，数据库将会进入只读模式'}),await a({loading:"正在修复启动，请稍后...",request:l({re_level:Ie.re_level}),message:!0,success:async e=>{e.status&&(Ne.value=!1),Ee()}})},Ee=()=>{a({request:n({sName:"mysql"}),success:e=>{Ve.value=e.data}})},He=w(""),Ke=async()=>{await a({loading:"正在保存配置，请稍后...",request:i({path:"/etc/my.cnf",data:He.value,encoding:"utf-8"}),message:!0})},Oe=x({path:"",port:"",oldData:{path:"",port:""}}),Qe=()=>{_e({type:"dir",path:Oe.path,change:e=>{Oe.path=e}})},Te=async()=>{const s="port"===Be.value;if(!Oe.path&&!s)return t.error("存储位置不能为空");if(!Oe.port&&s)return t.error("端口不能为空");if(s&&Oe.port===Oe.oldData.port)return t.success("未修改端口数据");if(!s&&Oe.path===Oe.oldData.path)return t.success("未修改存储位置数据");!s&&await e({title:"数据库迁移",icon:"warning-filled",content:"请确定是否迁移至:【".concat(Oe.path,"】？")});const l={[s?"port":"datadir"]:Oe[s?"port":"path"]};a({loading:"正在设置，请稍后...",request:(s?ze:ve)(l),message:!0,success:async e=>{(await Le.value).unmount(),Ae()}}),setTimeout(()=>{!s&&Re()},1e3)},Re=async()=>{Le.value=o({title:"迁移任务",area:60,component:()=>r(()=>import("./progress2.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},Ae=async()=>{await a({loading:Me,request:ce(),success:e=>{var a,s,t,l;Oe.path=(null==(a=null==e?void 0:e.data)?void 0:a.datadir)||"",Oe.port=(null==(s=null==e?void 0:e.data)?void 0:s.port)||"",Oe.oldData.path=(null==(t=null==e?void 0:e.data)?void 0:t.datadir)||"",Oe.oldData.port=(null==(l=null==e?void 0:e.data)?void 0:l.port)||""}})},Je=w([{name:"启动时间",field:"Run",value:"无",function:e=>_(e.Run)},{name:"总连接次数",field:"Connections",value:"无"},{name:"发送",value:"无",field:"other",function:e=>c(Number(e.Bytes_sent))},{name:"接收",value:"无",field:"other",function:e=>c(Number(e.Bytes_received))},{name:"每秒查询",value:"无",field:"other",function:e=>parseInt((e.Questions/e.Uptime).toString())},{name:"每秒事务",value:"无",field:"other",function:e=>parseInt(((parseInt(e.Com_commit)+parseInt(e.Com_rollback))/e.Uptime).toString())},{name:"File",value:"无",field:"File"},{name:"Position",value:"无",field:"Position"}]),We=w([{name:"活动/峰值连接数",function:e=>e.Threads_running+"/"+e.Max_used_connections,value:"",ps:"若值过大,增加max_connections"},{name:"线程缓存命中率",value:"",function:e=>{let a=(100*(1-e.Threads_created/e.Connections)).toFixed(2);return isNaN(a)?"0":a+"%"},ps:"若过低,增加thread_cache_size"},{value:"",name:"索引命中率",function:e=>{let a=(100*(1-e.Key_reads/e.Key_read_requests)).toFixed(2);return isNaN(a)?"0":a+"%"},ps:"若过低,增加key_buffer_size"},{value:"",name:"Innodb索引命中率",function:e=>{let a=(100*(1-e.Innodb_buffer_pool_reads/e.Innodb_buffer_pool_read_requests)).toFixed(2);return isNaN(a)?"0":a},ps:"若过低,增加innodb_buffer_pool_size"},{value:"",name:"查询缓存命中率",function:e=>{let a=(parseInt(e.Qcache_hits)/(parseInt(e.Qcache_hits)+parseInt(e.Qcache_inserts))*100).toFixed(2)+"%";return"NaN%"==a&&(a="OFF"),a},ps:"若过低,增加query_cache_size"},{value:"",name:"创建临时表到磁盘",function:e=>{let a=(e.Created_tmp_disk_tables/e.Created_tmp_tables*100).toFixed(2);return isNaN(a)?"0":a+"%"},ps:"若过大,尝试增加tmp_table_size"},{value:"",name:"已打开的表",function:e=>e.Open_tables,ps:"table_open_cache配置值应大于等于此值"},{value:"",name:"没有使用索引的量",function:e=>e.Select_full_join,ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"没有索引的JOIN量",function:e=>e.Select_range_check,ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"排序后的合并次数",function:e=>e.Sort_merge_passes,ps:"若值过大,增加sort_buffer_size"},{value:"",name:"锁表次数",function:e=>e.Table_locks_waited,ps:"若值过大,请考虑增加您的数据库性能"}]),Ye=[{title:"1-2GB",data:{key_buffer_size:32,query_cache_size:32,tmp_table_size:32,innodb_buffer_pool_size:64,sort_buffer_size:256,read_buffer_size:256,read_rnd_buffer_size:256,join_buffer_size:512,thread_stack:256,binlog_cache_size:64,thread_cache_size:64,table_open_cache:128,max_connections:100}},{title:"2-4GB",data:{key_buffer_size:64,query_cache_size:64,tmp_table_size:64,innodb_buffer_pool_size:128,sort_buffer_size:512,read_buffer_size:512,read_rnd_buffer_size:512,join_buffer_size:1024,thread_stack:256,binlog_cache_size:64,thread_cache_size:96,table_open_cache:192,max_connections:200}},{title:"4-8GB",data:{key_buffer_size:128,query_cache_size:128,tmp_table_size:128,innodb_buffer_pool_size:256,sort_buffer_size:1024,read_buffer_size:1024,read_rnd_buffer_size:768,join_buffer_size:2048,thread_stack:256,binlog_cache_size:128,thread_cache_size:128,table_open_cache:384,max_connections:300}},{title:"8-16GB",data:{key_buffer_size:256,query_cache_size:256,tmp_table_size:256,innodb_buffer_pool_size:1024,sort_buffer_size:1024,read_buffer_size:2048,read_rnd_buffer_size:1024,join_buffer_size:2048,thread_stack:384,binlog_cache_size:192,thread_cache_size:192,table_open_cache:1024,max_connections:400}},{title:"16-32GB",data:{key_buffer_size:512,query_cache_size:384,tmp_table_size:1024,innodb_buffer_pool_size:2048,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:2048,join_buffer_size:4096,thread_stack:512,binlog_cache_size:256,thread_cache_size:256,table_open_cache:2048,max_connections:500}},{title:"32-48GB",data:{key_buffer_size:1024,query_cache_size:512,tmp_table_size:1536,innodb_buffer_pool_size:4096,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:3072,join_buffer_size:6144,thread_stack:512,binlog_cache_size:384,thread_cache_size:384,table_open_cache:3072,max_connections:750}},{title:"48-64GB",data:{key_buffer_size:2048,query_cache_size:768,tmp_table_size:2048,innodb_buffer_pool_size:8192,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:512,binlog_cache_size:512,thread_cache_size:512,table_open_cache:4096,max_connections:1e3}},{title:"64-96GB",data:{key_buffer_size:2048,query_cache_size:1024,tmp_table_size:3072,innodb_buffer_pool_size:16384,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:768,binlog_cache_size:768,thread_cache_size:768,table_open_cache:6144,max_connections:1500}},{title:"96-128GB",data:{key_buffer_size:2048,query_cache_size:1536,tmp_table_size:4096,innodb_buffer_pool_size:32768,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:1024,binlog_cache_size:1024,thread_cache_size:1024,table_open_cache:8192,max_connections:2e3}},{title:"128-256GB",data:{key_buffer_size:4096,query_cache_size:2048,tmp_table_size:8192,innodb_buffer_pool_size:65536,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:2048,binlog_cache_size:2048,thread_cache_size:2048,table_open_cache:16384,max_connections:4e3}}],$e={key_buffer_size:"MB,用于索引的缓冲区大小",query_cache_size:"MB,查询缓存,不开启请设为0",tmp_table_size:"MB,临时表缓存大小",innodb_buffer_pool_size:"MB,Innodb缓冲区大小",innodb_log_buffer_size:"MB,Innodb日志缓冲区大小",sort_buffer_size:"KB * 连接数,每个线程排序的缓冲大小",read_buffer_size:"KB * 连接数读入缓冲区大小",read_rnd_buffer_size:"KB * 连接数随机读取缓冲区大小",join_buffer_size:"KB * 连接数关联表缓存大小",thread_stack:"KB * 连接数每个线程的堆栈大小",binlog_cache_size:"KB * 连接数二进制日志缓存大小(4096的倍数)",thread_cache_size:"线程池大小",table_open_cache:"表缓存",max_connections:"最大连接数"},Xe=w(""),Ze=w([]),ea=w(),aa=async e=>{Ze.value.forEach(a=>{Ye[e].data[a.name]&&(a.value=Ye[e].data[a.name]),"query_cache_size"!==a.name||Ye[e].data.query_cache_size||(a.value=0)}),sa()},sa=()=>{let e=0,a=0,s=0;const t=["key_buffer_size","query_cache_size","tmp_table_size","innodb_buffer_pool_size","innodb_log_buffer_size"],l=["sort_buffer_size","read_buffer_size","read_rnd_buffer_size","join_buffer_size","thread_stack","binlog_cache_size"],n=Number(Ze.value.find(e=>"max_connections"===e.name).value);Ze.value.forEach(e=>{t.includes(e.name)?a+=Number(e.value):l.includes(e.name)&&(s+=Number(e.value)/1024)}),e=a+s*n,ea.value=e},ta=async()=>{let e={query_cache_type:0};Ze.value.forEach(a=>{const s="bt_query_cache_size"===a.name?"query_cache_size":a.name;e[s]=a.value}),e.query_cache_size>0&&(e.query_cache_type=1),delete e.query_cache_supprot,e.max_heap_table_size=e.tmp_table_size,await a({loading:"正在保存中，请稍后...",request:ue(e),message:!0,success:e=>{e.status&&t.success("设置成功，重启数据库后配置生效，请重启数据库")}})},la=async s=>{const t={restart:"重启",stop:"停止",reload:"重载配置",start:"启动"};await e({title:"".concat(t[s],"mysqld服务"),content:"是否".concat(t[s],"mysqld服务？")}),await a({loading:"正在".concat(t[s],"mysqld服务，请稍后..."),request:u({name:"mysqld",type:s}),message:!0,success:e=>{e.status&&d.go(0)}})},na=w(""),ia=async()=>{await e({title:"清空日志操作提示",icon:"warning-filled",content:"清空日志会导致运行错误信息丢失，无法排除问题，请谨慎操作，是否继续？"}),await a({loading:"正在清空日志，请稍后...",request:de({close:1}),message:!0,success:oa})},oa=async()=>{await a({loading:Me,request:me(),data:[String,na]}),na.value=na.value||"当前暂无数据"},ra=async()=>{await a({loading:Me,request:fe(),data:{msg:[String,na]}}),na.value=na.value||"当前暂无数据"},_a=w(!1),ca=w(),ua=w([]),da=x({status:!1,size:""}),ma=w(!1),fa=x({days:""}),pa=x({days:[{required:!0,message:"请输入天数",trigger:"blur"},{validator:(e,a,s)=>{a<7?s(new Error("请输入大于7的天数")):s()}}]}),ba=async s=>{da.status=!s,await e({title:(s?"开启":"关闭")+"二进制日志",icon:"warning-filled",content:(s?"开启二进制日志可以保护Mysql的数据安全，但同时会消耗一定磁盘存储，是否继续?":"关闭二进制日志后，将不会再记录所有对数据库的修改操作")+"二进制日志?"}),await a({loading:"正在"+(s?"开启":"关闭")+"二进制日志，请稍后...",request:pe(),message:!0,success:e=>{za()}})},ha=async()=>{await ca.value.validate(),await e({title:"清理日志",content:"即将清理【"+fa.days+"】天前的MySQL二进制日志，是否继续？",icon:"warning-filled"}),await a({loading:"正在清理日志，请稍后...",request:re({days:fa.days}),message:!0,success:e=>{e.status&&(ma.value=!1,ya(),za(),va())}})},ya=()=>{var e,a;ma.value=!1,null==(e=ca.value)||e.clearValidate(),null==(a=ca.value)||a.resetFields()},za=async()=>{await a({request:pe({status:1}),success:e=>{da.status=e.data.binlog_status,da.size=c(e.data.size)}})},va=async()=>{await a({loading:Me,request:be(),data:{data:[Array,ua]}})},ga=async({row:s})=>{await e({title:"删除日志",icon:"warning-filled",content:"您真的要删除【".concat(s.name,"】日志？"),type:"calc"}),await a({loading:"正在删除【".concat(s.name,"】日志，请稍后..."),request:he({path:s.path}),message:!0,success:va})},wa=w(!1),xa=async e=>{try{let a="get"===e?{}:{status:Number(e)};const s=await ye(a);"get"===e?(s.status||"当前状态关闭中！"===s.msg||t.request(s),wa.value=Boolean(s.status)):t.request(s)}catch(a){m(a)}},qa=async e=>{switch(e){case"config":(async()=>{await a({loading:Me,request:f({path:"/etc/my.cnf"}),data:{data:[String,He]}})})();break;case"port":case"storage":Ae();break;case"state":(async()=>{await a({loading:Me,request:ge(),success:e=>{var a;if(!1===e.status||(null==(a=e.data)?void 0:a.status))return t.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:e.msg||e.data.msg,type:"error",showClose:!0});Je.value.forEach(a=>{a.function?a.value=a.function(e.data):a.value=e.data[a.field]}),We.value.forEach(a=>{a.function&&(a.value=a.function(e.data))})}})})();break;case"performance":(async()=>{Me.value=!0;try{const{data:e}=await we();Ze.value=[],e.mem.hasOwnProperty("join_buffer_size")||(e.mem.join_buffer_size=512),e.mem.hasOwnProperty("thread_stack")||(e.mem.thread_stack=256),e.mem.hasOwnProperty("binlog_cache_size")||(e.mem.binlog_cache_size=32);const a="disable"===e.mem.query_cache_supprot;Object.keys(e.mem).forEach(s=>{"query_cache_size"===s||"bt_query_cache_size"===s?a||Ze.value.push({name:"query_cache_size",value:e.mem.bt_query_cache_size,ps:$e[s]?$e[s]:""}):Ze.value.push({name:s,value:e.mem[s],ps:$e[s]?$e[s]:""})}),ea.value=e.mem.bt_mem_size,Xe.value="",sa()}catch(e){m(e)}finally{Me.value=!1}})();break;case"errorLogs":oa();break;case"slowLogs":ra();break;case"binaryLogs":await va(),za();break;case"memoryProtection":xa("get")}},ka={key:0},Ca={class:"p-2rem"},Va={class:"content flex items-center"},ja={class:"message flex-1 ml-4 py-[.3rem] leading-[2.4rem] text-[1.3rem]"},Ba={class:"text text-[15px] leading-[2.5rem] flex !flex-wrap break-all"},Ma={class:"my-[12px]"},Sa={class:"flex text-[#666] items-center"},Na={class:"flex text-[#666] items-center"},Ia={class:"text-[#666] performance"},Ua={class:"flex items-center justify-center"},La={class:"flex items-center"},Fa={class:"ml-2rem"},Ga={class:"my-[12px]"},Pa={class:"my-[12px]"},Da={class:"flex items-center"},Ea={class:"ml-[16rem]"},Ha=["onClick"],Ka={class:"p-[20px]"},Oa=v(q({__name:"index",props:{compData:{default:{}}},setup(e){const{compData:a}=g(ie()),s=e,t=k(()=>a.value.status);return C(()=>{(e=>{Be.value="service",e&&(Ve.value=e);const a={...Ve.value,name:"mysqld"};Ce.init(a),ke.init(a),Se.value=Ve.value.status})(s.compData),a.value.refreshEvent=async()=>{const e=await qe("mysql");a.value.status=e.s_status}}),(e,a)=>{const s=O,l=p,n=b,i=Q,o=T,r=h,u=R,d=te,m=se,f=y,v=A,g=J,w=W,x=Y,q=$,k=X,C=Z,le=ae,ie=ee,re=z,_e=V("bt-loading");return j(),B("div",null,[M(re,{modelValue:I(Be),"onUpdate:modelValue":a[12]||(a[12]=e=>G(Be)?Be.value=e:null),type:"left-bg-card",position:"left",class:"h-full",onChange:I(qa)},{default:S(()=>[M(u,{label:"服务",name:"service"},{default:S(()=>[N("div",null,[M(oe),M(ne),I(t)?F("",!0):(j(),U(s,{key:0,class:"mt-4rem",onClick:I(Ge)},{default:S(()=>[...a[13]||(a[13]=[L("修复启动",-1)])]),_:1},8,["onClick"])),M(l,{options:[{content:"如需更换mysql版本，请备份好数据后，卸载mysql重新安装"}],class:"pl-1rem"},{default:S(()=>[I(t)?F("",!0):(j(),B("li",ka,"如无法正常启动，请尝试使用修复启动按钮进行修复启动"))]),_:1}),M(r,{modelValue:I(Ne),"onUpdate:modelValue":a[1]||(a[1]=e=>G(Ne)?Ne.value=e:null),area:50,title:"修复启动-恢复模式-innodb_force_recovery","show-footer":"",onConfirm:I(De)},{default:S(()=>[N("div",Ca,[N("div",Va,[a[14]||(a[14]=N("i",{class:"svgtofont-el-warning-filled !text-[4rem] text-warning"},null,-1)),N("div",ja,[N("div",Ba,P(I(Ie).tips),1)])]),M(o,{model:I(Ie),"label-width":"80px"},{default:S(()=>[M(i,{label:"恢复级别"},{default:S(()=>[M(n,{modelValue:I(Ie).re_level,"onUpdate:modelValue":a[0]||(a[0]=e=>I(Ie).re_level=e),options:I(Ue),class:"!w-20rem"},null,8,["modelValue","options"])]),_:1})]),_:1},8,["model"]),M(l,{options:I(Fe).recover,class:"pl-3rem"},null,8,["options"])])]),_:1},8,["modelValue","onConfirm"])])]),_:1}),M(u,{label:"配置文件",name:"config",lazy:!0},{default:S(()=>[D((j(),B("div",null,[a[16]||(a[16]=N("span",{class:"my-[4px] text-[#666]"}," 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ",-1)),N("div",Ma,[M(d,{class:"!h-[48rem] !w-full",modelValue:I(He),"onUpdate:modelValue":a[2]||(a[2]=e=>G(He)?He.value=e:null),id:"configContent",onSave:I(Ke)},null,8,["modelValue","onSave"])]),M(s,{type:"primary",onClick:I(Ke)},{default:S(()=>[...a[15]||(a[15]=[L("保存",-1)])]),_:1},8,["onClick"]),M(l,{options:I(Fe).config,class:"pl-2rem"},null,8,["options"])])),[[_e,I(Me)]])]),_:1}),M(u,{label:"存储位置",name:"storage",lazy:!0},{default:S(()=>[D((j(),B("div",null,[N("div",Sa,[M(m,{icon:"icon-file_mode",onIconClick:I(Qe),width:"32rem",modelValue:I(Oe).path,"onUpdate:modelValue":a[3]||(a[3]=e=>I(Oe).path=e),class:"!w-32rem"},null,8,["onIconClick","modelValue"]),M(s,{class:"ml-[12px]",onClick:I(Te),type:"primary"},{default:S(()=>[...a[17]||(a[17]=[L("迁移",-1)])]),_:1},8,["onClick"])]),M(l,{options:I(Fe).storage,class:"pl-2rem"},null,8,["options"])])),[[_e,I(Me)]])]),_:1}),M(u,{label:"端口配置",name:"port",lazy:!0},{default:S(()=>[D((j(),B("div",Na,[M(f,{modelValue:I(Oe).port,"onUpdate:modelValue":a[4]||(a[4]=e=>I(Oe).port=e),type:"number",width:"10rem",class:"!w-10rem"},null,8,["modelValue"]),M(s,{type:"primary",class:"ml-[12px]",onClick:I(Te)},{default:S(()=>[...a[18]||(a[18]=[L("修改",-1)])]),_:1},8,["onClick"])])),[[_e,I(Me)]])]),_:1}),M(u,{label:"当前状态",name:"state",lazy:!0},{default:S(()=>[D((j(),B("div",null,[M(g,{class:"margin-top table-descriptions",column:2,border:""},{default:S(()=>[(j(!0),B(E,null,H(I(Je),(e,a)=>(j(),U(v,{key:a},{label:S(()=>[L(P(e.name),1)]),default:S(()=>[L(" "+P(e.value),1)]),_:2},1024))),128))]),_:1}),M(x,{data:I(We),class:"mt-[20px]","max-height":"400"},{default:S(()=>[M(w,{prop:"name",label:"字段",width:"180"}),M(w,{prop:"value",label:"当前值",width:"100"}),M(w,{prop:"ps",label:"注意"})]),_:1},8,["data"])])),[[_e,I(Me)]])]),_:1}),M(u,{label:"性能调整",name:"performance",lazy:!0},{default:S(()=>[D((j(),B("div",Ia,[N("div",Ua,[a[19]||(a[19]=L(" 优化方案 ",-1)),M(k,{class:"!w-[12rem] mr-[20px] ml-8px",modelValue:I(Xe),"onUpdate:modelValue":a[5]||(a[5]=e=>G(Xe)?Xe.value=e:null),onChange:I(aa)},{default:S(()=>[(j(!0),B(E,null,H(I(Ye),(e,a)=>(j(),U(q,{key:a,value:a,label:e.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"]),a[20]||(a[20]=L(" 最大使用内存 ",-1)),M(f,{"text-type":"MB",width:"16rem",class:"!w-16rem ml-8px",readonly:"",modelValue:I(ea),"onUpdate:modelValue":a[6]||(a[6]=e=>G(ea)?ea.value=e:null)},null,8,["modelValue"])]),M(C),M(o,{class:"performance-form","label-position":"right","label-width":"146px"},{default:S(()=>[(j(!0),B(E,null,H(I(Ze),(e,a)=>D((j(),U(i,{label:e.name,key:a},{default:S(()=>[N("div",La,[M(f,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,width:"16rem",class:"!w-16rem",type:"number",onChange:I(sa)},null,8,["modelValue","onUpdate:modelValue","onChange"]),N("span",Fa,P(e.ps),1)])]),_:2},1032,["label"])),[[K,e.ps]])),128)),M(i,{label:" ",class:"mt-1rem"},{default:S(()=>[M(s,{type:"primary",onClick:I(ta)},{default:S(()=>[...a[21]||(a[21]=[L("保存",-1)])]),_:1},8,["onClick"]),M(s,{onClick:a[7]||(a[7]=e=>I(la)("restart"))},{default:S(()=>[...a[22]||(a[22]=[L("重启数据库",-1)])]),_:1}),a[23]||(a[23]=N("span",{class:"ml-3rem"},"* 修改配置后，需重启数据库生效",-1))]),_:1})]),_:1})])),[[_e,I(Me)]])]),_:1}),M(u,{label:"错误日志",name:"errorLogs",lazy:!0},{default:S(()=>[D((j(),B("div",null,[M(s,{type:"default",onClick:I(ia)},{default:S(()=>[...a[24]||(a[24]=[L("清空日志",-1)])]),_:1},8,["onClick"]),N("div",Ga,[M(le,{class:"!h-[56rem] !w-full",content:I(na),id:"errorLogs",isHtml:!0,fullScreen:{title:"全屏查看【错误日志】",onRefresh:I(oa)}},null,8,["content","fullScreen"])])])),[[_e,I(Me)]])]),_:1}),M(u,{label:"慢日志",name:"slowLogs",lazy:!0},{default:S(()=>[D((j(),B("div",Pa,[M(le,{content:I(na),isHtml:!0,class:"!h-[60rem] !w-full",id:"slowLogs",fullScreen:{title:"全屏查看【慢日志】",onRefresh:I(ra)}},null,8,["content","fullScreen"])])),[[_e,I(Me)]])]),_:1}),M(u,{label:"二进制日志",name:"binaryLogs",lazy:!0},{default:S(()=>[N("div",null,[N("div",Da,[N("div",null,[a[25]||(a[25]=L(" 二进制日志 ",-1)),M(ie,{modelValue:I(da).status,"onUpdate:modelValue":a[8]||(a[8]=e=>I(da).status=e),onChange:I(ba)},null,8,["modelValue","onChange"])]),N("span",Ea,P(I(da).size),1)]),M(C),a[27]||(a[27]=N("span",null," · 温馨提示：Mysql二进制日志是记录当前的操作日志，可用于数据恢复，数据备份。 ",-1)),D((j(),U(x,{class:"mt-[20px]",data:I(ua),"max-height":"500"},{default:S(()=>[M(w,{prop:"name",label:"文件名"}),M(w,{prop:"size",label:"大小"},{default:S(e=>[L(P(I(c)(e.row.size)),1)]),_:1}),M(w,{prop:"last_modified",label:"最后修改时间"},{default:S(e=>[L(P(I(_)(e.row.last_modified)),1)]),_:1}),M(w,{align:"right",label:"操作"},{default:S(e=>[N("span",{class:"bt-link",onClick:a=>I(ga)(e)},"删除",8,Ha)]),_:1})]),_:1},8,["data"])),[[_e,I(Me)]]),M(r,{title:"清理日志",modelValue:I(ma),"onUpdate:modelValue":a[10]||(a[10]=e=>G(ma)?ma.value=e:null),area:42,showFooter:"",onCancel:I(ya),onConfirm:I(ha)},{default:S(()=>[N("div",Ka,[M(o,{disabled:I(_a),class:"flex justify-center","label-position":"right",model:I(fa),ref_key:"binlogFormRef",ref:ca,rules:I(pa)},{default:S(()=>[M(i,{label:"清理周期",prop:"days"},{default:S(()=>[M(f,{modelValue:I(fa).days,"onUpdate:modelValue":a[9]||(a[9]=e=>I(fa).days=e),type:"number",min:7,width:"24","text-type":"天"},null,8,["modelValue"])]),_:1})]),_:1},8,["disabled","model","rules"]),a[26]||(a[26]=N("ul",{class:"leading-8 text-[1.2rem] list-disc ml-[48px]"},[N("li",null,"只能清理7天前的日志,请输入大于7的天数")],-1))])]),_:1},8,["modelValue","onCancel","onConfirm"])])]),_:1}),M(u,{label:"内存保护",name:"memoryProtection",lazy:!0},{default:S(()=>[N("div",null,[N("div",null,[a[28]||(a[28]=L(" 内存保护 ",-1)),M(ie,{modelValue:I(wa),"onUpdate:modelValue":a[11]||(a[11]=e=>G(wa)?wa.value=e:null),onChange:I(xa)},null,8,["modelValue","onChange"])]),M(l,{options:I(Fe).memoryProtection,class:"pl-2rem"},null,8,["options"])])]),_:1})]),_:1},8,["modelValue","onChange"])])}}}),[["__scopeId","data-v-ed08ed41"]]);export{Oa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
