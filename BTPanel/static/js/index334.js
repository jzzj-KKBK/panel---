import{r as a,c as e,t as s,g as t,e as l,S as i,ai as o,B as u,ba as r,aj as n,p,a4 as c,H as m,x as d,q as v,v as g,A as f,aW as y,bq as b}from"./base-lib.js?v=1756369731";import{K as x,iG as _,G as j,W as w}from"./utils-lib.js?v=1756369731";import{c as h,i as I,g as P}from"./index56.js?v=1756369731";import{h as q,o as H}from"./form-item.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index103.js?v=1756369731";import"./index112.js?v=1756369731";import"./useMethod7.js?v=1756369731";import"./validator.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";import"./useMethod9.js?v=1756369731";import"./header-nav-tools.vue_vue_type_script_setup_true_lang.js?v=1756369731";const V=a({bind:"",status:!0,tags:[],cycle:10}),k=a(!1),B={class:"pt-[1.6rem] px-[3rem]"},C=e({__name:"index",props:{compData:{type:Object,default:()=>({})}},setup(a,{expose:e}){const C=a,{row:D}=s(C.compData),G=[{isHtml:!0,content:'<span class="text-[#e6a23c]">开启IP轮换后会定时在选择的多个IP中依次轮换，需要多IP的机器</span>'},{isHtml:!0,content:'<span class="text-[#e6a23c]">此功能为附加功能，不影响使用，普通用户可以忽略</span>'}],{BtForm:M,submit:O}=j({data:()=>V.value,options:a=>t(()=>[q("轮换周期",()=>l(i,{modelValue:a.value.cycle,"onUpdate:modelValue":e=>a.value.cycle=e,placeholder:"请输入轮换周期"},{append:()=>"分钟"}),"cycle",{rules:[{required:!0,message:"请输入轮换周期",trigger:"blur"}]}),q("IP池",()=>l(n,{class:"bt-multiple-select",modelValue:a.value.tags,"onUpdate:modelValue":e=>a.value.tags=e,placeholder:"请选择IP",multiple:!0},{default:()=>[I.value.map(a=>l(o,{key:a.value,label:a.label,value:a.value},{default:()=>[l("span",{style:"float: left; max-width: 10ch; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"},[a.label]),l("span",{class:"ml-[.8rem]",style:"float: right; color: #8492a6; font-size: 12px"},[u("IP: "),a.ip])]}))],tag:()=>{var e;return(null==(e=a.value.tags)?void 0:e.length)?l("div",{class:"flex flex-wrap gap-[5px]"},[a.value.tags.map(a=>l(r,{key:a,type:"info",closable:!0,class:"!w-auto inline-flex items-center",onClose:()=>S(a)},{default:()=>[a,u(" "),l("span",{class:"text-[#8492a6] ml-1"},[u("IP: "),U(a)])]}))]):null}}),"tags",{rules:[{required:!0,message:"请选择IP",trigger:"blur"}]}),H("状态","status")]),submit:async(a,e)=>(await e(),await(async a=>{const e=await x({request:_({bind:a.bind,tags:a.tags.join(","),cycle:a.cycle,status:a.status?1:0}),loading:"设置中...",message:!0});return e.status&&h(),e.status})(a.value))}),S=a=>{const e=V.value.tags.indexOf(a);e>-1&&V.value.tags.splice(e,1)},U=a=>{const e=I.value.find(e=>e.value===a);return(null==e?void 0:e.ip)||""};return p(async()=>{(a=>{a.domain&&(V.value.bind=a.domain),a.ip_tag&&(V.value.tags=a.ip_tag.map(a=>a.tag)),a.ip_rotate&&(V.value.cycle=a.ip_rotate.cycle,V.value.status=a.ip_rotate.status)})(D.value),k.value=!0,await P(),k.value=!1}),c(()=>{V.value.tags=[],V.value.cycle=10,V.value.status=!0,V.value.bind=""}),e({onConfirm:async()=>{try{return await O()}catch(a){return!1}}}),(a,e)=>{const s=w,t=y,i=b;return m((v(),g("div",B,[l(t,{class:"!mb-[1.6rem]",type:"warning",closable:!1},{default:f(()=>[l(s,{options:G,listStyle:"disc",class:"!text-[#e6a23c]"})]),_:1}),l(d(M))])),[[i,d(k)]])}}});export{C as default};
