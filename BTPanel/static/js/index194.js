import{ay as e,K as a,gD as s,b as l,ah as o,e as t,al as r}from"./utils-lib.js?v=1756369731";import{c as n,k as u,r as d,q as c,v as m,e as i,A as p,x as f,O as _,B as v,y as b,Q as y,D as j,S as g,a9 as x,a7 as h,ay as k,P as C,aA as D}from"./base-lib.js?v=1756369731";import V from"./container-edit.js?v=1756369731";import{_ as w}from"./index116.js?v=1756369731";import{A as T}from"./add-compose.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index101.js?v=1756369731";import"./useMethods.js?v=1756369731";import"./column.js?v=1756369731";import"./index104.js?v=1756369731";import"./validator.js?v=1756369731";import"./form-item.js?v=1756369731";const q={class:"container-dialog !p-0"},z={class:"result"},A={class:"p-[.6rem] rounded-default bg-[#333333] h-[45.6rem]"},S=t(n({__name:"create-con-cmd",setup(t){const r=l(),{refs:{isRefreshTableList:n}}=e();let k=null;const C=u({order:"",result:""}),D=d(!1),V=d(""),T=d(!1),S=u({model_index:"btdocker",mod_name:"container",def_name:"get_cmd_log",ws_callback:111}),I=(e,a)=>{try{const e=a.data;if(V.value+="".concat(e),e.includes("bt_successful")||e.includes("bt_failed")){const a={status:e.includes("bt_successful"),msg:e.includes("bt_successful")?"创建成功":"创建失败"};r.request(a),a.status&&(n.value=!0),null==k||k.close(),D.value=!1}}catch(s){}},K=async()=>{""!==C.order&&(T.value=!0,D.value=!0,a({request:s({cmd:C.order}),success:e=>{e.status?(null==k||k.close(),V.value="",k=o({route:"/ws_model",onMessage:I}),null==k||k.send(S)):(r.error(e.msg),D.value=!1)}}))};return(e,a)=>{const s=j,l=g,o=x,t=w,r=h;return c(),m("div",q,[i(r,{size:"large",model:f(C),class:"relative w-full","label-position":"top",onSubmit:a[1]||(a[1]=y(()=>{},["prevent"]))},{default:p(()=>[i(o,{prop:"name"},{default:p(()=>[i(l,{autofocus:"",modelValue:f(C).order,"onUpdate:modelValue":a[0]||(a[0]=e=>f(C).order=e),disabled:f(D),onKeyup:_(K,["enter","native"]),placeholder:"请输入需要执行的命令，例如 docker run -d nginx:latest，按回车执行"},{append:p(()=>[i(s,{type:"default",onClick:K},{default:p(()=>[...a[2]||(a[2]=[v("执行命令",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),a[3]||(a[3]=b("div",{class:"text-right"},null,-1)),a[4]||(a[4]=b("div",{class:"resultTitle px-[.2rem] py-[.4rem]"},"命令执行结果：",-1)),b("div",z,[b("div",A,[i(t,{class:"h-[45.6rem] !rounded-none",content:f(V)},null,8,["content"])])])]),_:1},8,["model"])])}}}),[["__scopeId","data-v-fd5882ab"]]),I={class:"container-dialog"},K=t(n({__name:"index",props:{compData:{default:()=>({})}},emits:["close"],setup(a,{expose:s,emit:l}){const o=k("popupSetFooter"),t=l,{refs:{isRefreshTableList:n}}=e(),u=d(),_=d(),v=d(),b=d("manual"),y=()=>{t("close"),n.value=!0},j=e=>{b.value=null==e?void 0:e.props.name,"cmd"===b.value?o(!1):o(!0)};return s({onConfirm:()=>{"manual"===b.value?u.value.onConfirm():"cmd"===b.value?y():v.value.onConfirm()}}),(e,a)=>{const s=D,l=r;return c(),m("div",I,[i(l,{type:"card",modelValue:f(b),"onUpdate:modelValue":a[0]||(a[0]=e=>C(b)?b.value=e:null),onTabClick:j},{default:p(()=>[i(s,{label:"手动创建",name:"manual",class:"overflow-y-auto"},{default:p(()=>[i(V,{ref_key:"manual",ref:u,type:"add",compData:e.compData,onClose:y},null,8,["compData"])]),_:1}),i(s,{label:"命令创建",name:"cmd",lazy:!0},{default:p(()=>[i(S,{ref_key:"cmd",ref:_},null,512)]),_:1}),i(s,{label:"容器编排",name:"compose",class:"mt-[.4rem]",lazy:!0},{default:p(()=>[i(T,{ref_key:"compose",ref:v,onClose:y},null,512)]),_:1})]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-81902562"]]);export{K as default};
