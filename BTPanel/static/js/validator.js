import{n as e,u as t,d as a,aV as s,R as n,o as l,M as i,aW as o,S as r,l as c,L as u,a4 as p,aX as d,at as m,aY as v,ai as g,aZ as y,r as h,a_ as f,N as _,a$ as b,b0 as w,b1 as P,b2 as k,O as x,I as E,aq as T,p as L,b3 as S,b4 as j,v as I,b5 as D,b6 as V,b7 as O,b8 as C,b9 as A,ba as R,Z as N,b as q,C as H,bb as F,bc as M,ag as G,bd as U,be as z,a3 as B,bf as J,bg as $,bh as W,bi as Y}from"./utils-lib.js?v=1756369731";import{e as Q,B as Z,ax as K,al as X,aE as ee,j as te,s as ae,r as se,U as ne,k as le,as as ie,t as oe,g as re,F as ce,b as ue,bb as pe,b4 as de,o as me,c as ve,W as ge,X as ye,p as he,G as fe,H as _e,x as be,q as we,M as Pe,w as ke,n as xe,m as Ee}from"./base-lib.js?v=1756369731";import{_ as Te}from"./index104.js?v=1756369731";import{o as Le,a as Se,c as je}from"./column.js?v=1756369731";const Ie=t=>e.post("plugin/get_soft_list",{data:t,customType:"default"}),De=t=>e.post("deployment/DelPackage",{data:t,customType:"default",check:"msg"}),Ve=()=>e.post("site/GetPHPVersion",{customType:"default",check:"array"}),Oe=t=>e.post("site/AddSite",{data:t,customType:"default",check:"object"}),Ce=t=>e.post("deployment/SetupPackage",{data:t,customType:"default",check:"msg"}),Ae=t=>e.post("auth/create_plugin_other_order",{data:t,loading:"正在获取支付信息，请稍候...",customType:"default",check:"object"}),Re=t=>e.post("files/GetFileBody",{data:t}),Ne=t=>e.post("plugin/install_plugin",{data:t,check:"object"}),qe=t=>e.post("ajax/GetOpeLogs",{data:t,check:"msg"}),He=t=>e.post("ftp/set_ftp_logs",{data:t,check:"msg"}),Fe=()=>e.post("ajax/GetMemcachedStatus",{}),Me=t=>e.post("ajax/SetMemcachedCache",{data:t,check:"msg"}),Ge=()=>e.post("ajax/GetNginxStatus",{check:"object"}),Ue=()=>e.post("config/GetNginxValue",{check:"array"}),ze=t=>e.post("config/SetNginxValue",{data:t,check:"msg"}),Be=()=>e.post("config/get_ols_value",{}),Je=t=>e.post("config/set_ols_value",{data:t,check:"msg"}),$e=()=>e.post("database/GetRunStatus",{check:"object"}),We=t=>e.post("database/GetErrorLog",{data:t,check:"string"}),Ye=t=>e.post("database/GetErrorLog",{data:t,check:"msg"}),Qe=t=>e.post("database/GetSlowLogs",{data:t,check:"msg"}),Ze=()=>e.post("database/GetMySQLBinlogs",{check:"msg"}),Ke=t=>e.post("database/BinLog",{data:t,check:"msg"}),Xe=t=>e.post("database/ClearMySQLBinlog",{data:t,check:"msg"}),et=()=>e.post("database/GetMySQLInfo",{check:"object"}),tt=t=>e.post("database/SetDataDir",{data:t,check:"msg"}),at=t=>e.post("database/SetMySQLPort",{data:t,check:"msg"}),st=t=>e.post("database/mysql_oom_adj",{data:t,check:"msg"}),nt=()=>e.post("database/GetDbStatus",{check:"object"}),lt=t=>e.post("database/SetDbConf",{data:t,check:"msg"}),it=t=>e.post("ajax/GetPHPConfig",{data:t,check:"object"}),ot=t=>e.post("files/UninstallSoft",{data:t,check:"msg"}),rt=t=>e.post("files/InstallSoft",{data:t,check:"msg"}),ct=t=>e.post("config/GetPHPConf",{data:t}),ut=t=>e.post("config/SetPHPConf",{data:t,check:"msg"}),pt=t=>e.post("config/setPHPDisable",{data:t,check:"msg"}),dt=t=>e.post("config/getFpmConfig",{data:t,check:"object"}),mt=t=>e.post("config/setFpmConfig",{data:t,check:"msg"}),vt=t=>e.post("ajax/GetPHPStatus",{data:t,check:"object"}),gt=t=>e.post("ajax/GetFpmSlowLogs",{data:t,check:"object"}),yt=t=>e.post("ajax/GetFpmLogs",{data:t,check:"msg"}),ht=t=>e.post("config/GetSessionConf",{data:t,check:"object"}),ft=t=>e.post("config/GetSessionCount",{data:t,check:"object"}),_t=t=>e.post("config/SetSessionConf",{data:t,check:"msg"}),bt=()=>e.post("config/DelOldSession",{check:"msg"}),wt=t=>e.post("ajax/GetPHPInfo",{data:t,check:"string"}),Pt=t=>e.post("ajax/php_info",{data:t,check:"object"}),kt=t=>e.post("config/get_php_config",{data:t,check:"object"}),xt=t=>e.post("config/setPHPMaxSize",{data:t,check:"msg"}),Et=t=>e.post("config/setPHPMaxTime",{data:t,check:"msg"}),Tt=()=>e.post("ajax/GetApacheStatus",{check:"object"}),Lt=t=>e.post("site/set_restart_task",{data:t,check:"msg"}),St=()=>e.post("site/get_restart_task",{check:"msg"}),jt=()=>e.post("config/GetApacheValue",{check:"array"}),It=t=>e.post("config/SetApacheValue",{data:t,check:"msg"}),Dt=t=>e.post("files/DeleteFile",{data:t,check:"msg"}),Vt=()=>e.post("deployment/check_project_env",{check:"object"}),Ot=t=>e.post("deployment/GetJarPath",{data:t,check:"object"}),Ct=t=>e.post("/mod/java/project/create_project",{data:t,check:"object",customType:"model"}),At=t=>e.post("/mod/php/php_async/create_project",{data:t,customType:"model",check:"object"}),Rt=()=>e.post("/mod/java/project/get_system_info",{check:"msg",customType:"model"}),Nt=()=>e.post("deployment/GetInLog",{check:"msg"}),qt=()=>e.post("database/GetmvDataDirSpeed",{check:"object"}),Ht=()=>e.post("plugin/RegetCloudPHPExt",{check:"object"}),Ft=t=>e.post("config/phpPeclUninstall",{data:t,check:"msg"}),Mt=t=>e.post("config/phpPeclInstall",{data:t,check:"msg"}),Gt=t=>e.post("config/GetPeclInstallList",{data:t,check:"array"}),Ut=t=>e.post("config/GetPhpPeclLog",{data:t,check:"msg"}),{setAuthState:zt,enterpriseRec:Bt,payment:Jt}=t(),$t=e=>{const{type:t}=e;return{label:"app"===t?"软件名称":"名称",prop:"title",width:250,sortable:e.sortable,showOverflowTooltip:!1,render:s=>{var n;const l="soft_ico/ico-"+((null==(n=s.name)?void 0:n.indexOf("php-"))>-1?"php":s.name)+".png",i="/dep_ico/".concat(s.name,".png"),o=s.title.indexOf("PHP-")>-1?"PHP":s.title;return Q("div",{class:"whitespace-normal inline-flex items-center p-[2px] ".concat(s.setup?"cursor-pointer":""),title:s.setup?"打开插件":"".concat(o," ").concat(s.version),onClick:()=>e.onClick(s)},[Q(a,{src:"app"===t?l:i,class:"".concat(10===s.type?"!h-[20px] !w-[22px]":""," soft-ico-img"),type:"img"},{error:()=>Q("img",{src:"/static/images/soft_ico/icon_plug.svg",alt:""},null)}),Q("span",null,["".concat(s.setup?o:s.title," ").concat(s.version||"")]),Q("span",{class:"text-[#FC6D26] ".concat(s.is_beta?"":"hidden")},[Z("[测试版]")])])}}},Wt=()=>({label:"开发商",width:80,render:e=>Q("span",{class:"truncate inline-block w-[8rem]"},[Z(" "),e.author||"官方"])}),Yt=e=>({label:"app"===e?"说明":"介绍",showOverflowTooltip:!1,render:e=>Q("div",{class:"leading-[16px]",innerHTML:e.ps},null)}),Qt=e=>{const{onClick:t,sortable:a}=e;return{label:"评分",prop:"score",width:80,sortable:a,render:e=>e.hasOwnProperty("score")?Q("span",{class:"bt-link inline-block w-[4rem]",onClick:()=>t(e)},[e.score?e.score:"无评分"]):Q("span",null,[Z("--")])}},Zt=()=>({label:"价格/天",width:70,render:e=>e.price>0?Q("span",{class:"text-[#fc6d26]"},["≈".concat((e.price/("btiplibrary"===e.name?365:30)).toFixed(2),"元"),Z(" ")]):Q("span",{class:"text-[#666]"},[Z("免费")])}),Kt=e=>({label:"到期时间",width:130,showOverflowTooltip:!1,render:t=>{let a=t.endtime?n(t.endtime,"yyyy-MM-dd"):"--",s=Q("span",{class:"bt-link",onClick:()=>e.onClick(t)},[Z("(续费)")]);return t.price>0&&0===t.endtime&&!Jt.value.bindUser?Q("span",null,[Z("--")]):(t.price>0?[0,-1].includes(t.endtime)?(s=Q("i",null,null),a=0===t.endtime?"永久":"未开通"):[1,-2].includes(t.endtime)&&(a=t.endtime>1?a:"已到期"):(a="--",s=Q("i",null,null)),Q("span",null,[a,s]))}}),Xt=()=>({label:"位置",width:50,render:e=>e.setup?Q("span",{class:"flex"},[Q("i",{title:"打开插件文件目录",class:"text-[#efc566] cursor-pointer svgtofont-folder-open !text-[1.8rem]",onClick:()=>Le({path:e.install_checks})},null)]):Q("span",null,[Z("--")])}),ea=e=>({label:"首页显示",prop:"labels",width:80,render:t=>t.setup?Q(X,{size:"small",modelValue:t.index_display,"onUpdate:modelValue":e=>t.index_display=e,onChange:a=>e.onChange(t,Boolean(a))},null):Q("span",null,[Z("--")])}),ta=e=>({label:"操作",align:"right",width:175,showOverflowTooltip:!1,render:(t,n)=>{var l;const i="soft_ico/ico-".concat((null==(l=null==t?void 0:t.name)?void 0:l.includes("php-"))?"php":t.name,".png");let o=e;const r="/dep_ico/".concat(t.name,".png");s(e)&&(o=e(t));const c=![5,6,13,7,8,12,10,11].includes(t.type);return Q(K,{popperClass:"el-popover-shadow el-light-popover !py-[6px]",trigger:"hover",placement:"top-start",enterable:!1,"show-after":200,"hide-after":0,width:"auto"},{default:()=>[Q("div",{class:"flex items-center p-[2px] whitespace-nowrap"},[Q(a,{src:c?r:i,class:"".concat(c?"":"!h-[20px] !w-[22px]"," soft-ico-img"),type:"img"},{error:()=>Q("img",{src:"/static/images/soft_ico/icon_plug.svg",alt:""},null)}),Q("span",null,["".concat(t.title," ").concat(t.version)]),Q("span",{class:"text-[#FC6D26] ".concat(t.is_beta?"":"hidden")},[Z("[测试版]")])])],reference:()=>Q("div",{class:"text-right w-full"},[o.map((e,a)=>{if(!(e.isHide&&e.isHide(t)||"更新"===e.title&&"tomcat"===t.name))return Q("span",{class:"soft-link"},[Q("span",{class:"bt-link",title:e.title,onClick:a=>{if("pay"==e.type&&10===t.type){const{buyThirdPluginView:e}=da();return e(t)}return e.onClick(t,e.type,e.sourceId),!1}},[e.title]),a!==o.length-1?Q(Te,null,null):""])})])})}}),aa=async(e,t)=>{try{if(await ps())return;let a="i";switch(t){case"install":a="i";break;case"update":a="u";break;case"repair":a="r"}if(10!==e.type){const t={...e,callback:()=>{const{refreshRouteData:e}=ga();e("1")}};await Ya({name:e.name,type:a,pluginInfo:t})}else{await l({title:"安装第三方插件",content:"您真的要安装[".concat(e.title,"]插件吗？"),icon:"question-filled"});let t=i.load("正在获取插件信息，请稍后...");const a=await ra(e);if(!a.status)return i.error(a.msg);const{data:s}=await Ne({sName:e.name,version:e.versions[0].m_version,min_version:e.versions[0].version});if(t.close(),s.hasOwnProperty("status")&&!s.status)return i.error(s.msg);const{installOtherEvent:n}=da();n(s)}}catch(a){}},sa=async(t,a)=>{const s=a?await(n={sName:t.name},e.post("plugin/add_index",{data:n,customType:"default",check:"msg"})):await(t=>e.post("plugin/remove_index",{data:t,customType:"default",check:"msg"}))({sName:t.name});var n;return i.request(s),s},na=e=>{window.open(e,"_blank","noopener,noreferrer")},la=async e=>{const{softList:t,total:a,historyList:s,ltd:n,pro:l,m_list:i,typeList:c,isForce:u}=new o(e,{"list.data":[Array,"softList"],"list.page":r(),ltd:Number,pro:Number,search_history:[Array,"historyList"],m_list:Array,type:[Array,"typeList"],is_force:[Number,e=>({isForce:Boolean(e)})]}).exportData();zt([0,l,n]);return{softList:[...t,...[...i].map(e=>({...e,is_docker:1}))],total:a,historyList:s,typeList:c,isForce:u}},ia=e=>{let t="";t=e?"软件列表更新成功":e||Bt.value?"云端连接失败，无法获取最新软件列表，请检查网络或稍后重试":"未绑定宝塔官网账号，无法获取最新软件列表",i.msg({dangerouslyUseHTMLString:!e,message:t,type:e?"success":"warning",duration:2e3})},oa=e=>{window.open(e.preview_url,"_blank","noopener,noreferrer")},ra=async e=>{try{const{data:t,msg:a,status:s}=await Ae({pid:e.pid,cycle:"1",type:0});return t}catch(t){}},ca=async(e,a,s)=>{const{authExpirationTime:n,forceLtd:l,aliyunEcsLtd:i}=t();let o={disablePro:8!==e.type,compulsionLtd:8!==e.type,sourceId:s,plugin:!0,pluginInfo:e};-2===Number(n.value)&&(s=32),(l.value||i.value)&&(o={disablePro:!0,compulsionLtd:!0,sourceId:s,plugin:!0,pluginInfo:e}),await Wa(o)},ua=e=>{ee().push({path:e.route})},pa=async e=>{const a=await ps();if(!e.setup||a)return;if([8,12].includes(e.type)&&e.endtime<0)return i.error("加载失败：该插件未购买或已到期");const s=["mysql","pureftpd","nginx","apache","tomcat","memcached","openlitespeed","phpmyadmin"].includes(e.name),n=-1!==e.name.indexOf("php-");if(s||n)return Ka({pluginInfo:e});if(!(await xs(e.name)))return!1;sessionStorage.setItem("pluginViewInfo",JSON.stringify({...e,built:e.built?"1":"0"}));const{pluginInfo:l}=t();l.value.visible=!0,l.value.id=e.name,l.value.name=e.title,l.value.callback=(null==e?void 0:e.callback)||null},da=te("SOFT-OTHER-STORE",()=>{const{payment:a}=t(),{searchVal:s,historyList:n,showNpsCollect:l,isLoading:o,inputZipFlag:r,speedInstallView:g}=ae(ga()),{scoreEvent:y,unInstallPlugin:h}=ga(),f=se(),_=se(null),b=ne([]),w=se({total:0,page:1,row:15}),P=e=>{f.value=e,c({title:"安装第三方插件包",area:50,btn:["确定安装","取消"],component:()=>u(()=>import("./index148.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},k=async e=>{f.value=e,_.value=c({title:"".concat(e.title,"购买"),area:50,component:()=>u(()=>import("./index149.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},x=()=>ne([$t({type:"app",onClick:e=>pa(e)}),Wt(),Yt("app"),Zt(),Kt({onClick:k}),Xt(),Qt({onClick:y}),ea({onChange:async(e,t)=>{(await sa(e,t)).status||L("0")}}),ta(e=>{let t=[];const s=!(e=>e.endtime<0)(e);if(t.push({onClick:k,title:-1!==e.endtime?"立即续费":"立即购买",isHide:()=>s}),e.setup&&!s&&t.push({onClick:h,title:"卸载"}),!s)return t;if(e.setup){const a=Vs(e);t.push({onClick:e=>aa(e,"update"),title:"更新",isHide:()=>!a}),t.push({onClick:pa,title:"设置"}),t.push({onClick:h,title:"卸载"})}else e.price>0&&!a.value.bindUser?t.push({onClick:()=>Ba(),title:"立即购买"}):t.push({onClick:aa,title:"安装"});return t})]),E=async(e={type:10,query:s.value,p:w.value.page,row:w.value.row,force:"0"})=>{try{e.query=s.value||"";const{data:t}=await Ie(e),{softList:a,total:i,historyList:o,isForce:r}=await la(t);r&&ia(r),l.value=!a.length,b.value=a,n.value=o,w.value.total=i}catch(t){m(t,"getSoftListData")}finally{o.value=!1}};let T=x();const L=(e="0")=>{T=x(),E({type:10,query:s.value,p:w.value.page,row:w.value.row,force:e})},S=le({bugTime:"1",qrcode:"https://www.bt.cn",qrcodeSize:160}),j=se(0),I=se("0"),D=se(0),V=async()=>{clearTimeout(D.value),D.value=setTimeout(async()=>{const{data:t}=await(t=>e.post("auth/get_order_stat",{data:t,check:"number"}))({oid:j.value,type:-1===f.value.endtime?0:1});if(0!==t){L("1");return(await _.value).unmount(),i.success(-1!==f.value.endtime?"续费成功":"购买成功")}V()},1e3)},O=se(!1);return{searchVal:s,softTableList:b,tablePageConfig:w,TableColumn:T,importOtherEvent:()=>{const e=document.createElement("input");e.type="file",e.style.display="none",e.accept=".zip,.tar.gz",e.id="update_zip",e.multiple=!0,e.addEventListener("change",async()=>{const t=e.files||[];if(0===t.length)return;const a=new FormData;a.append("plugin_zip",t[0]);let s={headers:{"Content-Type":"multipart/form-data","x-http-token":window.vite_public_request_token}};const n=await p.post("/plugin?action=update_zip",a,s);if(d("status",n.data)&&d("msg",n.data)&&!n.data.status)return i.error(n.data.msg);P(n.data)}),e.click()},pageChangeEvent:(e,t)=>{w.value.page=e,w.value.row=t,L("0")},getSoftListData:E,refreshList:L,buyThirdPluginView:k,$reset:()=>{s.value="",b.value=[],w.value.page=1},plugin:S,oid:j,price:I,buyPopup:_,getRenewOrder:async()=>{clearTimeout(D.value),I.value=(f.value.price*Number(S.bugTime)).toFixed(2);const{data:e}=await Ae({pid:f.value.pid,cycle:S.bugTime,type:-1===f.value.endtime?0:1});if(!(null==e?void 0:e.msg.code)){i.request(e);return void(await _.value).unmount()}S.qrcode=e.msg.code,j.value=e.msg.oid,V()},getOrderStatus:V,$reset_buy:()=>{clearTimeout(D.value),j.value=0},rowData:f,isShowSpeedVisible:O,installThirdPlugin:async e=>{try{O.value=!0;const{status:t,msg:a}=await v({plugin_name:f.value.name,tmp_path:f.value.tmp_path});r.value=!1,i.request({status:t,msg:null==a?void 0:a.replace(/<br>/g,"\n")}),g.value=!1,O.value=!1,L("0"),e()}catch(t){}},cancelInstall:()=>{O.value=!1,i.error("已取消安装!")},installOtherEvent:P,$reset_install:()=>{f.value={}}}}),ma=te("SOFT-PLUGIN-STORE",()=>{const e=le({total:0,page:1,row:15}),a=ie("softTypeList",[]),s=se([]),{isSpecial:l,searchVal:o,isLoading:r,tabTypeActive:p,showNpsCollect:d,historyList:v}=ae(ga()),{unInstallPlugin:f}=ga(),{payment:_,forceLtd:b,aliyunEcsLtd:w}=t(),{authType:P,authExpirationTime:k}=oe(_.value),x=le({upgrades:[],version:"",options:[],info:{}}),E=se(),T=se(),L=[{title:"5分钟极速响应",icon:"free-time-icon"},{title:"15天无理由退款",icon:"free-refund-icon"},{title:"30+款付费插件",icon:"free-plunge-icon"},{title:"20+企业版专享功能",icon:"free-function-icon"},{title:"1000条免费短信（年付）",icon:"free-message-icon"},{title:"2张SSL商用证书（年付）",icon:"free-certificate-icon"}],S=[{title:"更换授权IP",icon:"free-ip-icon"},{title:"客服优先响应",icon:"contact-customer"},{title:"15+款付费插件",icon:"free-fifteen-icon"},{title:"商用防火墙授权",icon:"icon-file-lock"}],j=re(()=>k.value>=0&&"free"!==P.value),I=re(()=>12===p.value),D=re(()=>8===p.value),V=re(()=>j.value&&!(I.value&&"pro"===P.value)),O=re(()=>!(!b.value&&!w.value)||(!!(I.value||j.value&&"ltd"===P.value)||!(!D.value&&j.value&&"pro"===P.value)&&!D.value)),C=re(()=>n(k.value,"yyyy-MM-dd")),A=re(()=>{const e=(new Date).getTime()/1e3,t=k.value-e;return Math.ceil(t/86400)}),R=re(()=>O.value?"#966000":"#f1ad29"),N=re(()=>I.value||O.value?L:S),q=re(()=>[{title:"全部",id:0},{title:"已安装",id:-1},...a.value].filter(e=>11!=e.id&&10!=e.id)),H=async(t={type:p.value,query:o.value,p:e.page,row:e.row,force:"0"})=>{try{r.value=!0,t.query=o.value||"";const{data:n}=await Ie(t),{softList:l,total:i,historyList:c,typeList:u,isForce:p}=await la(n);"1"==t.force&&ia(p),d.value=!i,s.value=l,v.value=c,a.value=u,e.total=i}catch(n){m(n,"getSoftListData")}finally{r.value=!1}},F=()=>ne([$t({type:"app",onClick:e=>pa(e)}),Wt(),Yt("app"),Zt(),Kt({onClick:e=>{10!=e.type&&ca(e,0,34)}}),Xt(),{label:"状态",prop:"gateway",width:50,render:e=>{if(5!==e.type)return Q("span",null,[Z("--")]);const t="phpmyadmin"===e.name||e.status?"svgtofont-icon-start text-[#20a53a]":"svgtofont-icon-stop text-danger";return e.setup?Q("span",{class:"flex"},[Q("i",{class:t},null)]):Q("span",null,[Z("--")])}},ea({onChange:async(e,t)=>{(await sa(e,t)).status||G("0")}}),ta(e=>{let t=[];const a=g(Os(e.task)),s=Ds(e,P.value),n=g(null==e?void 0:e.preview_url)&&""!=e.preview_url&&!s,l=!!e.route,i=(e,a,s=()=>!1)=>t.push({title:e,onClick:a,isHide:s});if(!s)return i("立即跳转",ua,()=>!l),i(Os(e.task),Ra,()=>!a),i("预览",oa,()=>!n),i(-1!==e.endtime?"立即续费":"立即购买",e=>ca(e,e.type,-1!==e.endtime?34:31),()=>s),i("卸载",f,()=>!(!s&&e.setup)),t;const o=Vs(e),r=5!==e.type;return e.setup?(i("更新",e=>aa(e,"update"),()=>!o),i("设置",pa),i("修复",U,()=>!r),i("卸载",f)):e.is_docker?i("立即前往",()=>{h.push({name:"docker"})}):i("安装",aa),t})]);let M=F();const G=(t="0")=>{M=F(),H({type:p.value,query:o.value,p:e.page,row:e.row,force:t})},U=async e=>{await ps()||(E.value=e,T.value=c({title:"".concat(e.title,"v").concat(e.version,"-修复插件"),area:50,component:()=>u(()=>import("./index150.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}))};return{TableColumn:M,searchVal:o,tablePage:e,softTableList:s,typeList:q,refreshPluginList:G,getSoftListData:H,openNpsEvent:()=>Ma({type:16,id:993,isNoRate:!0}),toggleClassEvent:t=>{p.value=t,sessionStorage.setItem("SOFT-PLUGIN-TYPE",String(t)),e.page=1,G("0")},isPay:j,isActiveLtd:I,isActivePro:D,isActivePay:V,isShowType:O,isExpTime:C,isDistanceDays:A,isShowColor:R,recomList:N,pluginPayEvent:async e=>{-2===k.value&&(e=32),Wa({sourceId:e,disablePro:O.value,compulsionLtd:O.value})},plugin:x,helpList:[{content:"无法修复？请尝试切换下版本。"}],getPluginInfo:async()=>{var e;const t=await y({plugin_name:E.value.name,show:1});if(t.status){x.upgrades=t.data;const a=x.upgrades.at(-1)||{beta:!1},s=a.beta?a:{},n=x.upgrades.at(0);if(x.info=E.value.is_beta?s:n,!x.info){const e=E.value.version;x.info={beta:2,m_version:e.split[0],update_msg:0,update_time:0,version:e.split[1]}}l&&(x.options=x.upgrades.map(e=>({label:e.m_version+"."+e.version+(e.beta?"bate":"Stable"),value:e.m_version+"."+e.version})),x.version="".concat((null==(e=x.options.at(0))?void 0:e.value)||""))}else i.error(t.msg)},cutVersionEvent:async()=>{aa({...E.value,version:x.version},"repair")},repairPluginEvent:async()=>{(await T.value).unmount(),aa(E.value,"repair")},softData:E,$reset:()=>{o.value="",s.value=[],a.value=[],e.page=1,E.value={},x.options=[],x.version="",x.upgrades=[],M.value=[]}}}),va=te("SOFT-DEPLOY-STORE",()=>{const{tabDeployActive:t,isLoading:a,searchVal:s}=ae(ga()),{scoreEvent:n}=ga(),o=se(null),r=se(),d=se(),v=se({total:0,page:1,row:15}),g=ie("deployTypeList",[]),y=ne([]),h=ne([]),w=se("all"),P=re(()=>[{title:"全部",tid:0},...g.value]),k=e=>{o.value=e||null,c({title:"".concat(e?"更新":"导入","一键部署项目包").concat(e?"【".concat(e.title,"】"):""),area:60,btn:["提交","取消"],component:()=>u(()=>import("./import.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showClose:!0})},x=()=>{var e;h.value=(e={list:y.value,limit:v.value.row,p:v.value.page},b(e.limit,e.list)[e.p-1]||[])},E=async t=>{try{t.search||delete t.search,a.value=!0;const{data:s,status:n}=await(t=>e.post("deployment/GetList",{data:t,customType:"default",check:"object"}))(t),l=f(s),{list:i,dep_type:o}=s;1===Number(t.force)&&ia(n);const r="all"===w.value?"":w.value;l("list")&&_(i)&&(y.value=r?i.filter(e=>{switch(r){case"php":return null===e.project_type||e.project_type===r||0===e.project_type&&0===e.install_type;case"php_async":return e.project_type===r||0===e.project_type&&1===e.install_type;case"java":return e.project_type===r||1===e.project_type;default:return e.project_type===r}}):i,v.value.total=y.value.length,x()),l("dep_type")&&_(o)&&(g.value=o,g.value.push({tid:100,title:"其他"}))}catch(s){m(s)}finally{a.value=!1}};let T=ne([Se({isHide:100!=t.value,type:"page",key:"name"}),$t({type:"deploy",sortable:!0,onClick:e=>L(e)}),{label:"版本",prop:"version"},Yt("deploy"),{label:"项目类型",width:90,render:e=>{if(100===t.value){const t={php_async:"异步项目",java:"Java项目",default:"PHP项目"};return t[e.project_type]||t.default}{const t={1:"Java项目",0:"PHP项目"};return t[e.project_type]||t.default}}},{label:"支持版本",render:e=>{const{php:t,java:a,project_type:s}=e,n=1===s||"java"===s?"JDK版本：":"PHP版本：",l=t||a;return Q("span",{title:"支持的".concat(n).concat(l)},[n,l])}},{label:"提供者",prop:"author",render:e=>{let t="--";if("宝塔"===e.author)t=e.title;else t=e.author;return Q("span",{class:"bt-link",onClick:()=>(async e=>{e.official?window.open(e.official,"_blank","noopener,noreferrer"):location.reload()})(e)},[t])}},Qt({onClick:e=>n(e),sortable:!0}),ta(e=>{let t=[{onClick:L,title:"一键部署"}];return 0===e.id&&(t.push({onClick:k,title:"更新"}),t.push({onClick:I,title:"删除"})),t})]);const L=async e=>(o.value=e,r.value=c({title:"【".concat(e.title,"】一键部署"),area:60,btn:["提交","取消"],component:()=>u(()=>import("./index151.js?v=1756369731").then(e=>e.i),__vite__mapDeps([]),import.meta.url),showClose:!0}),r.value),S=[{label:"删除自定义项目",value:"delete",event:async(e,a)=>{const n=async e=>await De({dname:e.name});await e({title:"批量删除",content:"即将删除所选中的项目，是否继续操作?",column:[{prop:"name",label:"项目名称"},je()],onConfirm:async()=>(await a(n),E({type:t.value,search:s.value}),!1)})}}],j=(e="0")=>{E({type:t.value,search:s.value,force:e})},I=async e=>{try{await l({title:"删除自定义项目",type:"calc",icon:"warning-filled",content:"您真的要删除【".concat(e.name,"】吗？")});const t=await De({dname:e.name});t.status?(i.success(t.msg),j()):i.error(t.msg)}catch(t){}},D=le({name:"",title:"",php:"",enable_functions:"",version:"",ps:"",file:null,project_type:"php",mysql_version:"",java_version:""}),V=se("未选择任何文件"),O=se();return{searchVal:s,typeList:P,projectType:w,projectTypeOptions:[{label:"全部项目",value:"all"},{label:"PHP项目",value:"php"},{label:"异步项目",value:"php_async"},{label:"Java项目",value:"java"}],TableColumn:T,deployShowTableList:h,deployTableListRef:d,TableBatchOptions:S,tablePageConfig:v,getDeployListData:E,pageChangeEvent:(e,t)=>{v.value.page=e,v.value.row=t,x()},importProjectEvent:k,toggleClassEvent:e=>{t.value=e,sessionStorage.setItem("SOFT-DEPLOY-TYPE",String(e)),v.value.page=1,v.value.total=0,E({type:e,search:s.value}),T.value[0].isHide=100!=t.value},onChangeProjectType:e=>{v.value.page=1,E({type:t.value,search:s.value,force:"0"})},refreshDeployList:j,fileName:V,helpList:[{content:()=>Q(ce,null,[Q("span",{class:"text-danger"},[Z("请上传zip格式的项目包")]),Z(",里面必需包含auto_install.json配置文件")])}],cmdForm:D,cmdRules:{name:[{required:!0,message:"请输入项目英文名称",trigger:["blur"]}],title:[{required:!0,message:"请输入项目中文名称",trigger:["blur"]}],php:[{required:!0,message:"请输入项目PHP版本",trigger:["blur"]}],version:[{required:!0,message:"请输入项目版本",trigger:["blur"]}],ps:[{required:!0,message:"请输入项目简介",trigger:["blur"]}],java_version:[{required:!0,message:"请输入JDK版本",trigger:["blur"]}],mysql_version:[{required:!0,message:"请输入Mysql版本",trigger:["blur"]}]},cmdFormRef:O,projectTypeRadio:[{label:"PHP",value:"php"},{label:"Java",value:"java"}],changeProjectType:e=>{O.value.resetFields(),D.project_type=e},importPlugin:()=>{const e=document.createElement("input");e.type="file",e.style.display="none",e.accept=".zip",e.id="update_zip",e.multiple=!0,e.addEventListener("change",async()=>{const t=e.files||[];0!==t.length&&(V.value=t[0].name,D.file=t[0])}),e.click()},onConfirm:async e=>{try{if(await O.value.validate(),!D.file)return void i.error("请上传项目包");if(!D.file.name.endsWith(".zip"))return void i.error("请上传zip格式的项目包");const a=new FormData;a.append("name",D.name),a.append("title",D.title),"php"===D.project_type?(a.append("php",D.php),a.append("enable_functions",D.enable_functions)):(a.append("mysql_version",D.mysql_version),a.append("java_version",D.java_version),a.append("project_type",D.project_type)),a.append("version",D.version),a.append("ps",D.ps),a.append("dep_zip",D.file);let s={headers:{"Content-Type":"multipart/form-data","x-http-token":window.vite_public_request_token}};const n=i.load("正在导入项目，请稍后..."),l=await p.post("/deployment?action=AddPackage",a,s);n.close(),l.data.status?(v.value.page=1,t.value=100,j(),e(),i.success(l.data.msg)):i.error(l.data.msg)}catch(a){}},initImportForm:()=>{if(o.value){const{name:e,title:t,php:a,enable_functions:s,version:n,ps:l,project_type:i,java:r,mysql:c}=o.value;Object.assign(D,{name:e,title:t,php:a||"",enable_functions:s||"",version:n,ps:l,project_type:"java"===i?"java":"php",mysql_version:c||"",java_version:r||""})}},oneDeploy:r,rowData:o,$reset:()=>{s.value="",w.value="all",y.value=[],h.value=[],v.value={total:0,page:1,row:10}},$reset_import_form:()=>{o.value=null,V.value="未选择任何文件",Object.assign(D,{name:"",title:"",php:"",enable_functions:"",version:"",ps:"",file:null,project_type:"php",mysql_version:"",java_version:""})}}}),ga=te("SOFT-STORE",()=>{const{mainWidth:a}=t(),s=ee(),n=ue(),o=re(()=>{var e;return(null==(e=ue())?void 0:e.name)||"plugin"}),r=sessionStorage.getItem("SOFT-PLUGIN-TYPE"),p=se(r?Number(r):0),d=sessionStorage.getItem("SOFT-DEPLOY-TYPE"),m=se(d?Number(d):0),v=se(!1),g=se(!1),y=se(!1),h=se(!1),f=se(!1),b=se([]),T=ne([]),L=ne([]),S=se(),j={name:"get_soft_list",key:"get_soft_list"},I=se(),D=re(()=>"deployment"!==o.value),V=re(()=>"plugin"===o.value),O=se(),C=se(),A=se(),R=re(()=>{var e;const t=null==(e=O.value)?void 0:e.name;return"total"===t||"rsync"===t||"syssafe"===t||"tamper_proof"===t}),N=se(!1),q=()=>{var e,t;(null==(e=S.value)?void 0:e.blur)&&S.value.blur(),(null==(t=S.value)?void 0:t.hidePopover)&&S.value.hidePopover()},H=()=>{var e;(null==(e=S.value)?void 0:e.showPopover)&&S.value.showPopover()},F=async(e="0",t)=>{if("other"===o.value){const a=da(),{tablePageConfig:s}=ae(a);t&&(s.value.page=1),a.refreshList(e)}else if("plugin"===o.value){const a=ma(),{tablePage:s}=ae(a);t&&(s.value.page=1),a.refreshPluginList(e)}else if("deployment"===o.value){const a=va(),{tablePageConfig:s}=ae(a);t&&(s.value.page=1),a.refreshDeployList(e)}},M=async()=>{var t,a;const{data:s}=await e.post("plugin/push_plugin",{customType:"default",check:"array"});_(s)&&2===s.length&&(T.value=(null==(t=s[0])?void 0:t.plugin)||[],L.value=(null==(a=s[1])?void 0:a.plugin)||[])},G=ie("softList",[]),U=re(()=>G.value.slice(0,z.value)||[]),z=re(()=>a.value<=400?1:Math.floor((a.value-200)/120)),B=async()=>{const{data:t}=await e.post("plugin/get_usually_plugin",{customType:"default",check:"array"});G.value=t},J=se(!1),$=se(5),W=ne([{score:5,name:"力荐"},{score:4,name:"好"},{score:3,name:"一般"},{score:2,name:"差"},{score:1,name:"非常差"}]),Y=le({count:0,total:0,avg:0,rate:0,starList:[]}),Q=async(t,a)=>{var s,n;const l=await(o={sName:t,version:a},e.post("plugin/uninstall_plugin",{data:o,loading:"正在卸载，请稍候...",customType:"default",check:"msg"}));var o;return l.status?(i.success(l.msg),F()):i.msg({dangerouslyUseHTMLString:!0,message:l.msg,type:"error",duration:0,showClose:!0}),(null==(s=O.value)?void 0:s.callBack)&&(null==(n=O.value)||n.callBack(l.status)),l.status},Z=e=>{"refreshSoftTable"===e.data&&F()};return{tabActive:o,historyList:b,tabTypeActive:p,tabDeployActive:m,showNpsCollect:v,isLoading:g,inputZipFlag:y,speedInstallView:h,isResetDeployPage:f,isPluginView:V,redirectRouter:async()=>{n.name!==o.value&&s.push({name:o.value})},cutTabsEvent:e=>{o.value=e,x("/soft/"+e)},initSoftView:()=>{window.addEventListener("message",Z)},$reset:()=>{window.removeEventListener("message",Z),E(["/plugin?action=get_soft_list","/plugin?action=push_plugin","/plugin?action=get_usually_plugin"])},refreshRouteData:F,searchRef:S,softSearchList:T,softRecommendList:L,handleOpenPluginEvent:async(e,t=22)=>{q(),ks({pluginName:e,source:t})},getHotSoft:M,clearSoftHistory:e=>{b.value.splice(e,1),b.value=[...b.value]},clearFindHistoryEvent:async(e,t)=>{await l({icon:"warning-filled",title:"删除搜索历史记录",content:"删除该条搜索历史【"+e+"】，是否继续？"});const a=w("正在删除指定搜索历史记录，请稍后...");try{const a=await P({val:e,...j});a.status&&b.value.splice(t,1),i.request(a),H()}catch(s){}finally{a.close()}},inputHistoryEvent:e=>{I.value=e,q(),F("0")},clearAllHistoryEvent:async()=>{await l({icon:"warning-filled",title:"清空搜索历史",content:"清空所有搜索历史记录，是否继续？"});const e=w("正在清空搜索历史记录，请稍后...");try{const e=await k(j);e.status&&(b.value=[]),i.request(e),H()}catch(t){}finally{e.close()}},initHistory:()=>{0===b.value.length&&q(),ws({promises:[M],delay:100})},$reset_history:()=>{I.value="",b.value=[],T.value=[],L.value=[],v.value=!1},showRefresh:D,triggerHideEvent:q,triggerShowEvent:H,openNPS:()=>{Ma({type:16,id:993,isNoRate:!0})},searchVal:I,initRecently:()=>{ws({promises:[B],delay:500})},handleOpenRecentEvent:e=>{ks({pluginName:e.name,type:"default"})},getHistoryInfo:B,softNum:z,softList:G,softListSliceData:U,$reset_recently:()=>{G.value=[]},scoreEvent:e=>{O.value=e,C.value=c({title:"【".concat(e.title,"】评分"),area:55,component:()=>u(()=>import("./index152.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},loading:J,pluginData:O,pluginScore:Y,score:$,getComment:e=>W.value.filter(t=>t.score===e)[0].name,getDetail:async()=>{try{J.value=!0;const a=await(t={pid:O.value.id,p:1},e.post("plugin/get_score",{data:t,customType:"default",check:"array"}));if(a.status){const e=a.data.split.reverse(),t=a.data.total;Y.avg=Number(((1*e[4]+2*e[3]+3*e[2]+4*e[1]+5*e[0])/t).toFixed(1)),Y.count=O.value.count,Y.total=t,Y.rate=0!==t?Number((100*Number(((e[0]+e[1])/t).toFixed(2))).toFixed(0)):0;for(let a=0;a<5;a++)Y.starList.push(Number((100*Number((e[a]/t).toFixed(2))).toFixed(0)));J.value=!1}}catch(a){}var t},onSubmitScore:async()=>{try{const a=await(t={pid:O.value.id,num:$.value,ps:"用户未做任何评价"},e.post("plugin/set_score",{data:t,customType:"default",check:"msg"}));a.status?(F(),(async e=>{const t=await e.value;t&&t.unmount()})(C),i.success(a.msg)):i.error(a.msg)}catch(a){}var t},$reset_score:()=>{O.value={},Y.starList=[]},unInstallPlugin:e=>{O.value=e,A.value=c({showFooter:!0,title:"卸载",area:45,component:()=>u(()=>import("./index153.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},onUnInstall:async()=>{let t=O.value.version;for(var a=0;a<O.value.versions.length;a++)if(O.value.versions[a].setup&&O.value.version.includes(O.value.versions[a].m_version)){t=O.value.versions[a].m_version,t.indexOf(".")<0&&(t+="."+O.value.versions[a].version);break}const s=O.value.name;if(R){if(N.value){const a=await(n={soft_name:s},e.post("plugin/save_plugin_settings",{data:n,customType:"default",check:"msg"}));return a.status?Q(s,t):(i.error(a.msg),a.status)}return Q(s,t)}return Q(s,t);var n},unInstall:Q,isSpecial:R,checked:N}}),ya=Object.freeze(Object.defineProperty({__proto__:null,SOFT_STORE:ga,useSoftStore:()=>{const e=ga();return{...e,...ae(e)}}},Symbol.toStringTag,{value:"Module"})),ha=e=>c({title:"".concat(e.title,"- 更新日志"),area:52,component:()=>u(()=>import("./history-version.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{name:e.name,title:e.title}}),{isRefreshSoftList:fa,isUpdatePayment:_a}=t(),ba=(e,t,a)=>{var s,n;const{title:l,name:i,ps:o,type:r,dependnet:c,other_php:u,versions:p,version:d}=e,m=i.split("-")[0];var v;a.title=l,a.name=i,a.isBeta=!!e.is_beta,a.ps=o,a.type=r,a.call=t,a.isInstall="i"===t,a.isUpdate="u"===t,a.isRepair="r"===t,a.isPHPInstall="php"===m&&"i"===t,a.isBeta=!!e.is_beta,a.isSystem=5===r,a.isPHPInstall="php"===m,a.isMysqlUpdate="mysql"===m&&("r"===t||"u"===t),a.isSpecialPlugins=["apache","nginx","mysql"].includes(i),a.introduction=(v=e.introduction)?v.split(";").map(e=>e.split("|")):[],a.compile=["nginx","apache","mysql","php"].includes(m),a.currentVersion=d||"",a.otherPHP=u||[],a.versions=p||[],a.dependnet=c,a.isDependnet=!((null==(s=null==c?void 0:c.need)?void 0:s.length)||(null==(n=null==c?void 0:c.selected)?void 0:n.length))},wa=async(e,t,a)=>{var s,l;const o=L(a);let r=e.versions[a||0];if(o&&e.isSystem){const t=e.versions.findIndex(t=>e.currentVersion.indexOf(t.m_version)>-1);t>=0&&(r=e.versions[t])}if(e.isPHPInstall)if(o&&(a=e.otherPHP.findIndex(t=>t.name===e.name)),r=e.otherPHP[a||0],e.name!==r.name){const e=i.load("正在获取PHP版本信息，请稍候..."),{data:t}=await T({sName:r.name});r=t.versions[0],e.close()}else r=e.versions[0];if(e.isSystem||(t.updateTime=r.update_time?n(r.update_time,"yyyy/MM/dd"):"无",t.isBeta=!!r.beta,t.updateMsg=r.update_msg||"暂无内容"),t.mVersion=r.m_version,e.isSystem&&e.isUpdate&&!e.isPHPInstall){const a=await ja(e);if(!a.length)return void(t.fullVersion="版本错误");t.version=null==(s=a[0])?void 0:s.version,t.fullVersion="".concat(null==(l=a[0])?void 0:l.m_version,".").concat(a[0].version)}else t.version=r.version,t.fullVersion="".concat(r.m_version).concat(r.version?"."+r.version:"");return t},Pa=(e,t)=>({sName:e.name,version:t.mVersion,min_version:t.version}),ka=async(e,t=1,a)=>{if(await Ia(e))return;if(0===t){if(!(await xa(e,e.upgrade?"更新":"安装")))return;a()}const s=i.load("正在添加安装任务，请稍候...");try{const{data:a}=await Ne({...e,type:t});if(d("status",a)&&d("msg",a)&&!a.status)return void i.msg({dangerouslyUseHTMLString:!0,message:'<div style="line-height:22px;">'.concat(a.msg,"</div>"),type:"error",duration:2e3});fa.value=!0,Ra(),setTimeout(()=>{i.request(a)},1e3)}catch(n){}finally{s.close()}},xa=async(e,t)=>{return e.sName,a=t,new Promise((e,t)=>{c({title:"编译安装",area:45,btn:["提交并".concat(a),"取消"],component:()=>u(()=>import("./compile-install.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),onConfirm:()=>e(!0),onCancel:()=>e(!1)})});var a},Ea=async(e,t)=>{try{const a=await La({pluginTitle:t.title,pluginName:e.sName,fullVersion:t.fullVersion}),{data:s}=await Ne({...e});return a.unmount(),d("status",s)&&d("msg",s)&&!s.status?(i.msg({message:'<div style="line-height:22px;">'.concat(s.msg,"</div>"),type:"error",duration:2e3,showClose:!0,dangerouslyUseHTMLString:!0}),!1):s}catch(a){}},Ta=async(e,t,a,s="")=>{const n=await Sa({title:"正在".concat({i:"安装",r:"修复",u:"更新"}[a],"插件：").concat(s,",请稍候..."),msg:"正在安装插件，请稍候..."}),l=await j({plugin_name:e,tmp_path:t,install_opt:a});i.request(l);const{inputZipFlag:o}=ae(ga());o.value=!0,n.unmount(),"/soft/plugin"!==location.pathname?window.location.reload():fa.value=!0},La=({pluginTitle:e,pluginName:t,fullVersion:a})=>(({pluginTitle:e,pluginName:t,fullVersion:a})=>{const{downLoadPopup:s}=ae(Da());return s.value=c({area:45,component:()=>u(()=>import("./download-speed.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{pluginTitle:e,pluginName:t,fullVersion:a}})})({pluginTitle:e,pluginName:t,fullVersion:a}),Sa=e=>(e=>{const{compData:t}=ae(Da());return t.value={speedConfig:e},c({title:e.title||"正在执行安装脚本，请稍候...",area:[50,26.4],component:()=>u(()=>import("./speed-install.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e})})(e),ja=async e=>{var t,a,s;let n=[];const l=null==(a=null==(t=e.currentVersion)?void 0:t.match(/(\d+\.\d+)/))?void 0:a.at(1);if(e.isMysqlUpdate){const t=null==(s=e.currentVersion.match(/(greatsql_\d+\.\d+|mariadb_\d+\.\d+|AliSQL)/))?void 0:s.at(1);n=e.versions.filter(e=>e.m_version===t||e.m_version===l)}else n=e.versions.filter(e=>e.m_version===l);return n},Ia=async e=>{const{data:t}=await S();if(!d("task",t))return!1;const{task:a}=t;if(e.sName.indexOf("php-")>-1){if(a.some(t=>{let a=t.name.match(/-(.*?)\]/)&&t.name.match(/-(.*?)\]/)[1]===e.version,s=t.name.indexOf("php-")>-1;return a&&s}))return i.error("正在安装相同版本的php插件，不可重复安装!"),!0}let s=["nginx","apache","openlitespeed"];if(s.includes(e.sName)){if(a.some(e=>e.name.match(/\[(.*?)-/)&&s.includes(e.name.match(/\[(.*?)-/)[1])))return i.error("正在安装同类型软件nginx,apache或openLiteSpeed，不可重复安装!"),!0}return!1},Da=te("INSTALL-STORE",()=>{var e,a;const{installInfo:s}=t(),n=se(),o=se(),r=[[7,"免","border-[#E1E1E1] text-[#9a9a9a]"],[8,"专","border-[#F9EE9E] text-[#FFC82F]"],[12,"企","border-[#E8D6B3] text-[#A3782F]"]],c=de({title:"",name:"",ps:"",type:0,call:"i",isBeta:!1,isSystem:!1,isInstall:!1,isUpdate:!1,isRepair:!1,isSpecialPlugins:!1,isPHPInstall:!1,isMysqlUpdate:!1,otherPHP:[],compile:!1,currentVersion:"",versions:[],label:[],introduction:[],isDependnet:!1,dependnet:{need:[],selected:[]}}),u=le({fullVersion:"",mVersion:"",version:"",isBeta:!1,status:!1,updateTime:"",updateMsg:""}),p=de({value:0,version:[]}),m=se(!1),v=se([]),g=se(!0),h=le({progress:0,done:0,total:0,estimated:0,speed:0}),f=["安装完成","Successify","complete"],_=se(null==(a=null==(e=n.value)?void 0:e.speedConfig)?void 0:a.msg),b=se(null),w=se({args_name:"",ps:"",args:"",init:"#在编译前执行的shell脚本内容，通常为第三方模块的依赖安装和源码下载等前置准备"}),P=se(),k=se(!1),x=re(()=>c.title.indexOf("PHP-")>-1?"PHP":c.title),E=re(()=>r.find(e=>e[0]===c.type)||[]),S=re(()=>{var e;return"soft_ico/ico-"+((null==(e=c.name)?void 0:e.indexOf("php-"))>-1?"php":c.name)+".png"}),j=re(()=>I(h.done)),N=re(()=>I(h.total)),q=re(()=>I(h.speed)),H=se([{label:"模块名称",prop:"name"},{label:"模块描述",prop:"ps"},{label:"是否启用",render:e=>Q(X,{modelValue:e.checked,"onUpdate:modelValue":t=>e.checked=t,onChange:()=>{z()}},null)},{label:"操作",align:"right",render:e=>[Q("div",{class:"flex items-center justify-end"},[Q("span",{class:"bt-link",onClick:()=>U(e)},[Z("删除")])])]}]),F=se([{name:"模块名称",ps:"模块描述"}]),M=ne({args_name:[{required:!0,message:"请输入模块名称",trigger:"blur"}],args:[{required:!0,message:"请输入模块参数",trigger:"blur"}]}),G=async()=>{try{const e=await C({name:c.name});F.value=e.data.args;let t=e.data.config.split("\n");F.value.forEach(e=>{t.includes(e.name)?e.checked=!0:e.checked=!1})}catch(e){}},U=async e=>{try{await l({content:"确认删除模块【 ".concat(e.name,"】 吗？"),title:"提示",icon:"warning-filled"});const t=await D({name:c.name,args_name:e.name});G(),i.request(t)}catch(t){}},z=async()=>{const e=i.load("正在设置模块，请稍后...");try{const t=F.value.filter(e=>e.checked).map(e=>e.name).join("\n"),a=await V({name:c.name,args_names:t});e.close(),i.request(a),G()}catch(t){}finally{e.close()}},B=async()=>{var e;const{inputZipFlag:t,speedInstallView:a}=ae(ga());try{const s=await R({num:10,filename:"/tmp/panelShell.pl"}),n=s.msg.trim().split("\n"),l=f.some(e=>n[n.length-1].includes(e));if("Successify"===n[n.length-1]||!0===t.value||l)return t.value=!1,a.value=!1,te(),!1;_.value=s.msg,(null==(e=b.value)?void 0:e.scrollHeight)&&(b.value.scrollTop=b.value.scrollHeight),setTimeout(()=>{B()},1e3)}catch(s){}},J=async()=>{try{const{data:e}=await A({plugin_name:c.name});e.status&&(h.done=e.down_size,h.total=e.total_size,h.progress=e.down_pre,h.estimated=e.need_time,h.speed=e.sec_speed),g.value&&setTimeout(()=>{g.value&&J()},400)}catch(e){}},$=e=>{p.value=e,wa(c,u,p.value)},W=async()=>{const e=await s.value;null==e||e.unmount()},Y=()=>{n.value.softData&&n.value.softData.callBack&&n.value.softData.callBack()},K=se(),ee=se(),te=()=>{K.value&&clearTimeout(K.value),ee.value&&clearTimeout(ee.value)};return{customFormRef:P,compData:n,$reset:()=>{u.fullVersion="",u.mVersion="",u.version="",u.isBeta=!1,u.status=!1,u.updateTime="",u.updateMsg="暂无日志"},init:async()=>{if(!n.value.name)return;const e=d("name",n.value.pluginInfo)?n.value.pluginInfo:n.value.name;await(async(e,t,a)=>{if(pe(e)&&d("name",e))return void ba(e,t,a);const s=i.load("正在获取插件信息，请稍候..."),{data:n}=await T({sName:e});s.close(),ba(n,t,a)})(e,n.value.type,c),await((e,t)=>{const a=[],{versions:s,isPHPInstall:n,otherPHP:l}=e;n?(l.map((e,t)=>{a.push({title:e.name,key:t,disabled:e.status,data:e})}),t.value=l.findIndex(t=>t.name===e.name),t.version=a):(s.map((t,s)=>{let n=L(t.beta)?" Beta":" Stable",l=e.name+" ";e.isSystem?n="":l="",a.push({title:"".concat(l).concat(t.m_version).concat(""===t.version?"":".".concat(t.version)).concat(n),key:s,data:t})}),t.value=0,t.version=a)})(c,p),await wa(c,u),n.value.name&&"mysql"===n.value.name&&c.isInstall&&p.version.forEach((e,t)=>{/^5\.7\.\d+/.test(e.title.replace("mysql","").trim())&&(p.value=t,$(t))})},pluginModuleInfo:c,pluginActiveInfo:u,versionModel:p,cutPluginActiveInfo:$,install:async e=>{try{const t=Pa(c,u);if(0!==e&&W(),c.isSystem)return await ka(t,e,()=>W());const a=await(async(e,t)=>{const a=await Ea(e,t);if(!a)return!1;a&&Ta(e.sName,a.tmp_path,"i",t.title)})(t,{title:c.title,fullVersion:u.fullVersion});if(!a)return!1;Y()}catch(t){}},repair:async()=>{try{const e=Pa(c,u);W(),(async(e,t)=>{const a=await Ea(e,t);a&&Ta(e.sName,a.tmp_path,"r",t.title)})(e,{title:c.title,fullVersion:u.fullVersion})}catch(e){}},update:async()=>{try{const e=Pa(c,u);if(e.upgrade=e.version,!c.isSystem&&W(),c.isSystem)return await(async(e,t)=>{e.isMysqlUpdate&&await l({title:"更新[MySQL]",isHtml:!0,width:"40rem",content:'<div class="!text-[#666]">更新过程可能会导致服务中断,您真的现在就将[MySQL]更新到['.concat(t,']吗?</div>\n\t\t\t\t<div class="text-danger">更新数据库有风险,建议在更新前,先备份您的数据库</div>\n\t\t\t\t<div class="text-danger">若您的是云服务器,强烈建议您在更新前做一个快照</div>\n\t\t\t\t<div class="text-danger">建议您在服务器负载闲时进行软件更新</div>'),type:"calc"})})(c,u.fullVersion),await ka(e,0,()=>W());(async(e,t)=>{const a=await Ea(e,t);a&&Ta(e.sName,a.tmp_path,"u",t.title)})(e,{title:c.title,fullVersion:u.fullVersion})}catch(e){}},clearTimeoutAll:te,pluginImgSrc:S,pluginTitle:x,pluginLabel:E,pluginPictureSrc:e=>{const t=c.name.includes("php-")?"php":c.name,a=c.introduction[e];return"https://www.bt.cn/Public/new/plugin/".concat(t,"/").concat(a[1])},getHistoryVersion:async()=>{try{m.value=!0;const{data:e}=await y({plugin_name:n.value.name});v.value=e,m.value=!1}catch(e){}},historyLoad:m,historyData:v,getSoftDownloadSpeed:J,downloadSpeed:h,doneSize:j,totalSize:N,speedSize:q,closeInstall:Y,initDownLoad:()=>{K.value=setTimeout(()=>{J()},100)},downLoadPopup:o,closeDownLoad:async()=>{g.value=!1;(await o.value).unmount()},initSpeed:()=>{const{speedInstallView:e}=ae(ga());ee.value=setTimeout(()=>{B(),e.value=!0},100)},speedMsg:_,getCustomModuleData:G,config:{mode:"ace/mode/nginx",theme:"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!1,fontSize:"12px"},customForm:w,customVisible:k,clearAddForm:()=>{w.value={args_name:"",ps:"",args:"",init:"#在编译前执行的shell脚本内容，通常为第三方模块的依赖安装和源码下载等前置准备"}},rules:M,setCustomModuleData:z,tableColumn:H,handleAddCustomModule:()=>{k.value=!0},customData:F,submitCustomModule:async()=>{var e;await(null==(e=P.value)?void 0:e.validate());try{k.value=!1;const e=await O({name:c.name,...w.value});i.request(e),G()}catch(t){}}}}),Va=()=>ae(Da());Va();const{forceLtd:Oa,aliyunEcsLtd:Ca,payment:Aa}=t(),Ra=()=>c({title:"消息盒子",area:[72,56],component:()=>u(()=>import("./index154.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),Na=async()=>c({title:"重启服务器或者面板",area:[33,11],component:()=>u(()=>import("./index155.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),qa=()=>c({title:"设置菜单显示隐藏",area:[35,40],component:()=>u(()=>import("./index156.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),Ha=()=>c({title:!1,area:20,component:()=>u(()=>import("./index157.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),Fa=()=>c({area:60,component:()=>u(()=>import("./index158.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),Ma=e=>c({area:52,compData:e,component:()=>u(()=>import("./index159.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),Ga=()=>c({area:60,component:()=>u(()=>import("./index160.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),async cancel(){await F({questions:JSON.stringify({25:"用户未填写任何信息"}),product_type:19,software_name:"Enterprise-Edition-Survey",rate:0})}}),Ua=e=>c({title:"".concat(e.title,"配置"),area:54,compData:e,component:()=>u(()=>import("./index161.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),za=e=>c({area:[75,68.6],compData:e,component:()=>u(()=>import("./index162.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),Ba=async(e="绑定宝塔账号，享受更多服务",t="")=>{var a,s;if(Oa.value||Ca.value)return q().error("当前为企业版，无法切换账号。");let n=()=>u(()=>import("./index106.js?v=1756369731"),__vite__mapDeps([]),import.meta.url);try{const l=se({client:0,login:0}),i=await H();if(i.status&&0!==(null==(a=i.data)?void 0:a.login))switch(l.value.client=i.data.client,l.value.login=i.data.login,null==(s=i.data)?void 0:s.client){case 1:n=()=>u(()=>import("./tencent-bind-user.js?v=1756369731"),__vite__mapDeps([]),import.meta.url);break;case 2:n=()=>u(()=>import("./ali-bind-user.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}return c({area:40,component:n,compData:{authData:l.value,title:e,isDialog:!0,redirect:t}})}catch(l){return c({area:40,component:()=>u(()=>import("./index106.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})}},Ja=()=>c({area:20,component:()=>u(()=>import("./index163.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),$a=()=>c({area:20,component:()=>u(()=>import("./index164.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),Wa=me(e=>{const t=Ca.value?[82,60]:[100,72],a=(!Ca.value||"ltd"===Aa.value.authType)&&(!N(e.showClose)||e.showClose);return c({area:t,showClose:a,compData:{...e,disablePro:!!L(e.disablePro)||e.disablePro},component:()=>u(()=>import("./index165.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},1e3),Ya=async e=>{const{installInfo:a}=t();return a.value=c({area:63,compData:e,component:()=>u(()=>import("./index166.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),a.value},Qa=e=>{const{title:t,type:a,callback:s}=e;return c({title:t,area:50,compData:{type:a,callback:s},component:()=>u(()=>import("./index167.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},Za=async({id:e=999,type:t,name:a,softName:s="panel",description:n,isNoRate:l=!1,title:i,isCard:o=!0,isShowPhone:r=!0})=>Ma({id:e,type:t,name:a,softName:s,description:n,isNoRate:l,title:i,isCard:o,isShowPhone:r}),Ka=async e=>{var t;const a=e.pluginInfo;if(!a){const{data:t}=await T({sName:e.name});e.pluginInfo=t}const s={phpmyadmin:()=>Xa(),tomcat:()=>as(a),pureftpd:()=>es(a),memcached:()=>ss(a),nginx:()=>ns(a),mysql:()=>ts(a),openlitespeed:()=>ls(a),php:()=>is(a),apache:()=>os(a)};if((null==(t=a.name)?void 0:t.includes("php-"))||s[a.name]){if(a.name.includes("php-"))return s.php();if(s[a.name])return s[a.name]()}},Xa=()=>c({isAsync:!0,title:"phpMyAdmin",area:74,component:()=>u(()=>import("./index168.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),es=e=>c({isAsync:!0,title:"Ftp管理",area:[100,56],component:()=>u(()=>import("./index169.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),ts=e=>c({isAsync:!0,title:"Mysql",area:[80,65],component:()=>u(()=>import("./index170.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),as=e=>c({isAsync:!0,title:"Tomcat管理",area:[64,54],component:()=>u(()=>import("./index171.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),ss=e=>c({isAsync:!0,title:"Memcached管理",area:[64,54],component:()=>u(()=>import("./index172.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),ns=e=>c({isAsync:!0,title:"Nginx",area:[68,58],component:()=>u(()=>import("./index173.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),ls=e=>c({isAsync:!0,title:"OpenLiteSpeed",area:[64,54],component:()=>u(()=>import("./index174.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),is=e=>c({isAsync:!0,title:"PHP-".concat(e.version,"管理"),area:[80,64],component:()=>u(()=>import("./index175.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),os=e=>c({isAsync:!0,title:"Apache",area:[68,58],component:()=>u(()=>import("./index176.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),rs=async({name:e,options:t,request:a,selectList:s})=>{await c({title:"批量设置".concat(e),area:"40",compData:{name:e,options:t,selectList:s,request:a},showFooter:!0,component:()=>u(()=>import("./index177.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},cs=async(e,t="editor",a="")=>{const s=await u(()=>import("./store.js?v=1756369731").then(e=>e.aV),__vite__mapDeps([]),import.meta.url),{useCreateEditorTabs:n,editorExample:l}=await u(()=>import("./store.js?v=1756369731").then(e=>e.aU),__vite__mapDeps([]),import.meta.url),{FilesAceEditor:i}=s,o={path:e,title:e.split("/").pop(),type:t,mode:a};l.value?n(o):i(o)},us=(e,t)=>{if(!e.length)return q().error("操作失败，请重试");c({title:"批量".concat(t.title||"操作","结果"),area:42,component:()=>u(()=>import("./index118.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{resultData:e,resultTitle:t.title||"操作"}})},ps=async()=>{if(sessionStorage.getItem("diskWarn"))return!1;const e=localStorage.getItem("checkWarnInfo");if(e)try{const t=JSON.parse(e),{byte_size:a}=t;return Number(a[0])-Number(a[1])<=524288e3?(await c({title:!1,showClose:!1,area:[40,36],component:()=>u(()=>import("./index178.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)}),!0):(sessionStorage.removeItem("diskWarn"),!1)}catch(t){return!1}return!1},ds=ve({__name:"index",props:ge({version:{},allAlarm:{type:Boolean,default:!1},multiple:{type:Boolean,default:()=>!0},limit:{default:()=>[]},options:{},isDefault:{type:Boolean,default:!1},isShowApi:{type:Boolean,default:!0}},{modelValue:{},modelModifiers:{}}),emits:ge(["change"],["update:modelValue"]),setup(e,{expose:a,emit:s}){const{getOldSenderAlarmListInfo:n,push:l}=t(),i=e,{load:o,error:r}=q(),c=se(!1),u=ye(e,"modelValue"),p=["dingding","feishu","mail","weixin","wx_account","sms"],d=s,m=ne([]),v=e=>{d("change",e)},y=async()=>{try{c.value=!0,await n();const e=[];for(const t in l.value.old)if(Object.prototype.hasOwnProperty.call(l.value.old,t)){const a=l.value.old[t];if(a.setup&&!i.limit.includes(a.name)){const t=!("{}"===JSON.stringify(a.data));a.isSetAlarm=t,e.push({label:a.title,value:a.name,disabled:!a.setup||!t,isSetAlarm:!t,render:()=>{const e=!a.setup||!t;return Q("div",{class:"flex justify-between"},[Q("span",null,[a.title]),Q("span",{class:"".concat(e?"text-danger":"hover:text-primary"," cursor-pointer mr-[4px]")},[Q("span",{onClick:e=>{e.stopPropagation(),h(a)}},[e?"[未配置]":"[已配置]"])])])}})}}if(m.value=e,i.options&&(m.value=[...i.options,...e]),i.isShowApi||(m.value=m.value.filter(e=>p.includes(e.value))),i.allAlarm&&m.value.unshift({label:"全部",value:"all",disabled:!1,isSetAlarm:!1,render:()=>Q("div",{class:"flex justify-between"},[Z("全部"),Q("span",null,null)])}),Array.isArray(u.value)&&u.value.length?u.value.forEach(e=>{m.value.find(t=>t.value===e)||(u.value=u.value.filter(t=>t!==e))}):g(u.value)&&u.value&&(m.value.find(e=>e.value===u.value)||(u.value="")),i.isDefault&&!u.value){const t=e.filter(e=>!e.disabled);t.length&&(u.value=i.multiple?[t[0].value]:t[0].value)}}catch(e){}finally{c.value=!1}},h=async e=>{const t=[{title:"钉钉机器人",type:"dingding"},{title:"飞书机器人",type:"feishu"},{title:"邮箱",type:"mail"},{title:"企业微信机器人",type:"weixin"},{title:"微信公众号",type:"wx_account"}].find(t=>t.type===e.name)||{title:"",type:"",data:{}};"wx_account"!==e.name||e.setup||await f(e.name),Ua({...t,callback:y})},f=async e=>{const t=o("正在安装模块，请稍后...");try{await M({name:e})}catch(a){}finally{t.close()}};return he(y),a({refresh:y}),(e,t)=>{const a=G,s=fe("bt-loading");return _e((we(),Pe(a,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),multiple:e.multiple,options:be(m),placeholder:"请选择告警方式",onChange:v},null,8,["modelValue","multiple","options"])),[[s,be(c)]])}}}),ms=ve({__name:"index",props:ge({multiple:{type:Boolean,default:()=>!0},limit:{default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:ge(["change"],["update:modelValue"]),setup(e,{expose:a,emit:s}){const{getSenderAlarmListInfo:n,push:l}=t(),i=e,o=se(!1),r=ye(e,"modelValue"),c=s,u=ne([]),p=e=>{c("change",e)},d=[{title:"钉钉",type:"dingding"},{title:"飞书",type:"feishu"},{title:"邮箱",type:"mail"},{title:"企业微信",type:"weixin"},{title:"微信公众号",type:"wx_account"},{title:"短信通知",type:"sms"},{title:"自定义消息通道",type:"webhook"}],m=async()=>{try{const e=[...d];o.value=!0,await n(!1),u.value=[];const t=l.value.config.filter(e=>e.used&&!i.limit.includes(e.sender_type)),a=e.filter(e=>!t.some(t=>t.sender_type===e.type)&&!i.limit.includes(e.type));t.forEach(e=>{var t;const a=d.find(t=>t.type===e.sender_type);let s=(null==(t=e.data)?void 0:t.title)?e.data.title+(e.data.title?" (".concat((null==a?void 0:a.title)||"",")"):""):a.title;if("sms"===e.sender_type){if(!e.data.total)return!1;s="短信通知 (".concat(e.data.count,"条)")}u.value.push({label:s||a.title,value:e.id,disabled:!1,render:()=>Q("div",{class:"flex justify-between"},[Q("span",{class:"mr-[10px]"},[s]),Q("span",{class:"hover:text-primary cursor-pointer mr-[4px]"},[Q("span",{onClick:t=>{t.stopPropagation(),v({...a,data:e,name:e.sender_type,setup:!0,isSetAlarm:!0})}},["sms"!==e.sender_type?"[已配置]":""])])])})}),a.forEach(e=>{u.value.push({label:e.title,value:"",disabled:!0,render:()=>Q("div",{class:"flex justify-between"},[Q("span",null,[e.title]),Q("span",{class:"text-danger cursor-pointer mr-[4px]",onClick:t=>{t.stopPropagation(),v({...e,setup:!1,name:e.type,data:{},isSetAlarm:!1})}},["sms"!==e.type?"[未配置]":""])])})})}catch(e){}finally{o.value=!1}},v=async e=>{const t=[{title:"钉钉机器人",type:"dingding"},{title:"飞书机器人",type:"feishu"},{title:"邮箱",type:"mail"},{title:"企业微信机器人",type:"weixin"},{title:"微信公众号",type:"wx_account"},{title:"自定义消息通道",type:"webhook"},{title:"短信通知",type:"sms"}].find(t=>t.type===e.name)||{title:"",type:"",data:{}};Ua({...t,data:e})};a({refresh:m}),he(m);const g=re(()=>{var e;return(null==(e=i.limit)?void 0:e.length)?u.value.filter(e=>{var t;const a=null==(t=d.find(t=>{var a;return(null==(a=e.label)?void 0:a.includes(t.title))||"function"==typeof e.render&&e.render().toString().includes(t.title)}))?void 0:t.type;return!i.limit.includes(a)}):u.value});return ke([()=>i.limit,()=>u.value],([e,t])=>{if((null==e?void 0:e.length)&&r.value&&(null==t?void 0:t.length))if(Array.isArray(r.value)){const e=g.value.map(e=>e.value);e.length>0&&(r.value=r.value.filter(t=>e.includes(t)))}else g.value.some(e=>e.value===r.value)||(r.value=void 0)},{deep:!0,immediate:!0}),ke(()=>u.value,e=>{(null==e?void 0:e.length)&&r.value&&xe(()=>{const e=g.value.map(e=>e.value);Array.isArray(r.value)?r.value=r.value.filter(t=>e.includes(t)):e.includes(r.value)||(r.value=void 0)})},{immediate:!0}),(e,t)=>{const a=G,s=fe("bt-loading");return _e((we(),Pe(a,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),multiple:e.multiple,options:be(g),onChange:p,placeholder:"请选择告警方式"},null,8,["modelValue","multiple","options"])),[[s,be(o)]])}}}),{payment:vs,pluginInfo:gs,forceLtd:ys,aliyunEcsLtd:hs,resetAuthState:fs}=t(),_s=q(),bs=async(e,t)=>{if(0===e.length)return t&&t(!0);const[a,...s]=e;try{const e=await a();t&&t(e)}catch(n){}return bs(s,t)},ws=async({promises:e,callback:t,delay:a,isRouter:s,check:n})=>{const l=window.location.pathname;return await new Promise(e=>{setTimeout(()=>{s||(s=window.location.pathname),s&&!n?e(z(s,l)):n&&n()?e(!0):e(!1)},a||0)})?bs(e,t):t&&t(!0)},Ps=async e=>{try{let{pluginName:t,pluginInfo:a}=e;if(L(t)&&L(a))return _s.error("缺少参数: options.name 或 options.pluginInfo"),Promise.reject(new Error("缺少参数: options.name 或 options.pluginInfo"));if(B(a))return a;g(a)&&(t=a);const{data:s}=await T({sName:t});return a=s,a}catch(t){return Promise.reject(t)}},ks=async e=>{(e.name||e.softData)&&(e.pluginName=(null==e?void 0:e.name)||"",e.pluginInfo=(null==e?void 0:e.softData)||e.pluginInfo);const t=await Ps(e),{isPay:a}=await(async e=>{if("ltd"===vs.value.authType&&vs.value.authExpirationTime>0)return{isPay:!0,type:"ltd",pluginInfo:B(e.pluginInfo)?e.pluginInfo:e.pluginName};const t=await Ps(e),{endtime:a,type:s}=t;return"pro"===vs.value.authType&&vs.value.authExpirationTime>0&&8===s?{isPay:!0,type:"pro",pluginInfo:t}:a>=0?{isPay:!0,type:"plugin",pluginInfo:t}:{isPay:!1,type:"free",pluginInfo:t}})({pluginInfo:t});if(!a&&[8,12].includes(t.type))return Wa({disablePro:8!==t.type,compulsionLtd:8!==t.type,sourceId:e.source,...(null==e?void 0:e.plugin)?{pluginInfo:t}:{}});if(!t.setup)return(async e=>{await Ya({...e,name:e.name||e.pluginInfo.name,type:"i"})})({pluginInfo:t});const s=["mysql","pureftpd","nginx","apache","tomcat","memcached","openlitespeed","phpmyadmin"].includes(t.name),n=-1!==t.name.indexOf("php-");if(s||n)return Ka({pluginInfo:t});if(!(await xs(t.name)))return!1;sessionStorage.setItem("pluginViewInfo",JSON.stringify({...t,built:e.pluginInfo?"1":"0"})),gs.value.visible=!0,gs.value.id=t.name,gs.value.name=t.title,gs.value.callback=(null==e?void 0:e.callback)||null},xs=async e=>{try{const{data:t}=await U(e);return t.msg&&-1!==t.msg.indexOf("您无操作此插件的权限")?(_s.request(t),Promise.resolve(!1)):Promise.resolve(!0)}catch(t){}},Es=async()=>{try{if(ys.value||hs.value)return q().error("当前为企业版，无法解绑账号。");await l({icon:"warning-filled",title:"解绑宝塔账号",width:"35rem",content:"解绑宝塔账号后，将无法正常使用面板功能，是否继续操作？"});const e=await W();fs(),_s.request(e),e.status&&setTimeout(()=>h.push({name:"bind-user"}),2e3)}catch(e){}},Ts=(e={readonly:!1,theme:"chrome"})=>({mode:"ace/mode/nginx",theme:"ace/theme/".concat(e.theme||"chrome"),wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:e.readonly,fontSize:"12px"}),Ls=(e,t,a,s)=>({type:"custom",key:t,rules:(null==a?void 0:a.rules)||{},render:n=>{const l=J({key:t},n);return Q($,{label:e,prop:l},{default:()=>[Q(ds,Ee({modelValue:n.value[l],"onUpdate:modelValue":e=>n.value[l]=e},(null==a?void 0:a.attrs)||{},{onChange:s}),null)]})}}),Ss=(e,t,a,s)=>({type:"custom",key:t,rules:(null==a?void 0:a.rules)||{},render:n=>{var l;const i=J({key:t},n);return Q($,{label:e,prop:i,"label-width":null==(l=null==a?void 0:a.attrs)?void 0:l.labelWidth},{default:()=>[Q(ms,Ee({modelValue:n.value[i],"onUpdate:modelValue":e=>n.value[i]=e},(null==a?void 0:a.attrs)||{},{onChange:s}),null)]})}}),js=(e,t,a,s)=>{try{let n={all:Number(a)||0,exclude_ids:[]};if(t&&B(t[0])?n.exclude_ids=t.map(e=>e.id):n.exclude_ids=t,n.exclude_ids=JSON.stringify(n.exclude_ids),s&&s.params&&(n={...n,...s.params}),a)return n;const l=h.currentRoute.value.meta.icon;return e&&_(e)&&(null==e||e.forEach(e=>{const t="".concat(l,"_list");n[t]||(n[t]=[]),n[t].push({id:e.id,[(null==s?void 0:s.key)||"name"]:e[(null==s?void 0:s.key)||"name"]})}),n["".concat(l,"_list")]=JSON.stringify(n["".concat(l,"_list")])),n}catch(n){}},Is=e=>{var t,a,s,n,l,i;try{const o={data:[],msg:(null==e?void 0:e.msg)||"操作成功！"};return d("data",e)&&e.data||d("success",e)||d("error",e)?(d("data",e)&&e.data||(e.data={error:e.error||[],success:e.success||[]}),o.msg=e.msg||"操作完成！",B(null==(t=e.data)?void 0:t.error)&&(e.data.error=Object.entries(e.data.error).map(e=>({name:e[0],msg:e[1],status:!1}))),g(null==(a=e.data)?void 0:a.success[0])&&(e.data.success=e.data.success.map(e=>({name:e,msg:"操作成功！",status:!0}))),(null==(s=e.data)?void 0:s.error.length)>0&&(e.data.error=e.data.error.map(e=>(d("status",e)||(e.status=!1),e))),(null==(n=e.data)?void 0:n.success.length)>0&&(e.data.success=e.data.success.map(e=>(d("status",e)||(e.status=!0),e))),o.data=null==(i=e.data)?void 0:i.error.concat(null==(l=e.data)?void 0:l.success)):_(e)?o.data=e:_s.request(e),o}catch(o){}},Ds=({endtime:e,type:t},a)=>e>=0||"ltd"===a||("pro"===a&&12!==t||"free"===a&&12!==t&&8!==t),Vs=e=>{var t;if("phpmyadmin"===e.name)return!1;if(!e.versions)return!1;if((null==(t=e.versions)?void 0:t.length)>1){const t=["Redis"];if(e.admin&&!t.includes(e.title)){const t=e.versions[0],a="".concat(t.m_version,".").concat(t.version);let s=e.version!==a;if(e.is_beta){const t=e.versions[e.versions.length-1];if(1===t.beta){const a="".concat(t.m_version,".").concat(t.version);s=e.version!==a&&e.version<a}}if(s&&"mongodb"!==e.name)return!0}else for(let a=0;a<e.versions.length;a++){const t=e.versions[a];if(2===Y(e.version,"".concat(t.m_version,".").concat(t.version)))return!0}}else{const t=e.versions[0];let a=!!t.beta;void 0===a&&(a=!1),void 0===e.is_beta&&(e.is_beta=!1);const s="".concat(t.m_version,".").concat(t.version);if(e.version!==s&&a===e.is_beta&&e.version<s)return!0}return!1},Os=e=>{let t=!1;switch(e){case"-1":t="正在安装";break;case"0":t="等待安装";break;case"-2":t="正在更新"}return t};export{Ue as $,Na as A,Va as B,ha as C,He as D,Xe as E,et as F,lt as G,Ye as H,Da as I,We as J,Qe as K,Ke as L,Ze as M,Dt as N,st as O,at as P,tt as Q,$e as R,ga as S,nt as T,Ne as U,Re as V,qe as W,Me as X,Fe as Y,ze as Z,ms as _,qa as a,Ge as a0,Be as a1,Je as a2,gt as a3,yt as a4,ot as a5,rt as a6,it as a7,ut as a8,ct as a9,Nt as aA,Ot as aB,Oe as aC,At as aD,Ct as aE,Vt as aF,Ls as aG,ds as aH,Ss as aI,Es as aJ,Ga as aK,Ts as aL,qt as aM,ya as aN,mt as aa,_t as ab,bt as ac,ft as ad,wt as ae,Ht as af,Mt as ag,Gt as ah,Ut as ai,kt as aj,Et as ak,xt as al,vt as am,pt as an,dt as ao,ht as ap,Pt as aq,Ft as ar,Lt as as,It as at,St as au,jt as av,Tt as aw,Rt as ax,Ve as ay,Ce as az,Ba as b,rs as c,Za as d,Ma as e,za as f,ws as g,js as h,Is as i,Ja as j,Ya as k,ks as l,Ra as m,Fa as n,us as o,Wa as p,Qa as q,cs as r,Ua as s,$a as t,ps as u,Ha as v,ma as w,da as x,na as y,va as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
