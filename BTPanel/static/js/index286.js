import{l as e,L as s,M as a,K as l,c as t,R as i,gB as n,e as o}from"./utils-lib.js?v=1756369731";import{c as r,r as m,p as u,G as d,H as c,x as v,q as p,v as f,y,e as h,P as g,B as _,C as k,M as w,A as x,F as C,a_ as P,J as b,al as j,D,av as F,z as q,K as B,ax as H}from"./base-lib.js?v=1756369731";import{_ as A}from"./index104.js?v=1756369731";import{g as E}from"./useStore5.js?v=1756369731";import{aj as V,ak as I,al as L,am as R,an as K}from"./firewall.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const M={class:"sn-home"},T={class:"sn-home-switch"},U={class:"flex items-center"},z={key:0,class:"sn-home-note flex items-center"},G={key:1},J={class:"mt-[2rem]"},O={class:"sn-home-overview-item-title"},S={key:0,class:"sn-home-list"},N={class:"sn-home-list-item flex items-center"},Q={class:"ml-[0.4rem] truncate flex-1"},W={class:"text-right"},X={class:"text-[#999] leading-2.2rem"},Y={class:"mt-1rem"},Z={class:"flex justify-end items-center"},$={key:1,class:"sn-home-list"},ee=o(r({__name:"index",setup(o){const{refs:{phpTabActive:r}}=E(),ee=m(!1),se=m(!1),ae=m(!1),le=m(!1),te=m([]),ie=m(!1),ne=[{title:"高风险",value:0,style:"color: #F50606;",name:"risk_high"},{title:"中危",value:0,style:"color: #FF9900",name:"risk_mod"},{title:"低危",value:0,style:"color: #DDC400",name:"risk_low"},{title:"网站数量",value:0,style:"color: #333",name:"site_count"},{title:"告警次数",value:0,style:"color: #333",name:"risk_count"}],oe=async()=>{const{data:e}=await l({loading:se,request:L()});te.value=e.logs,ne.forEach(s=>{s.value=e[s.name]})},re=()=>{e({title:"模拟攻击",area:60,compData:()=>de(),component:()=>s(()=>import("./simulate-attack.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},me=async e=>{if(ee.value=!e,!ae.value||!le.value)return ee.value=!1,void a.error("请先开启PHP模块设置");await l({loading:"正在"+(e?"开启":"关闭")+"监控，请稍后...",request:V({status:e?"start":"stop"}),message:!0,data:{status:[Boolean,s=>{s&&(ee.value=e)}]}})},ue=()=>r.value="php",de=()=>{(async()=>{await l({request:I(),data:{status:[Boolean,ee],send:[Boolean,ae],php_status:[Boolean,le]}}),ae.value&&le.value?ie.value=!1:ie.value=!0})(),oe()};return u(()=>de()),(e,s)=>{const a=j,o=t,r=D,m=A,u=H,E=F,V=d("bt-loading");return c((p(),f("div",M,[y("div",T,[y("div",U,[s[1]||(s[1]=y("div",{class:"mr-4"},"监控开关",-1)),h(a,{modelValue:v(ee),"onUpdate:modelValue":s[0]||(s[0]=e=>g(ee)?ee.value=e:null),width:36,onChange:me,disabled:v(ie)},null,8,["modelValue","disabled"])]),v(ie)?(p(),f("div",z,[s[3]||(s[3]=y("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] text-[1.6rem]"},null,-1)),s[4]||(s[4]=_(" 无法使用PHP安全告警，请开启 ",-1)),v(le)?k("",!0):(p(),f("span",{key:0,class:"bt-link !text-danger underline",onClick:ue,title:"点击跳转PHP模块页面"}," PHP模块 ")),v(le)||v(ae)?k("",!0):(p(),f("span",G,"、")),v(ae)?k("",!0):(p(),w(o,{key:2,title:"点击跳转告警设置页面",type:"danger",class:"underline"},{default:x(()=>[...s[2]||(s[2]=[_(" 设置告警 ",-1)])]),_:1}))])):k("",!0),v(ae)&&v(le)?(p(),w(r,{key:1,type:"primary",onClick:re},{default:x(()=>[...s[5]||(s[5]=[_("模拟攻击",-1)])]),_:1})):k("",!0)]),y("div",{class:b(["sn-home-overview",ne[0].value?"sn-home-overview-red":ne[1].value?"sn-home-overview-yellow":"sn-home-overview-green"])},[s[6]||(s[6]=y("div",{class:"text-[#666] text-[1.4rem]"},"风险等级概览",-1)),y("div",J,[(p(),f(C,null,P(ne,(e,s)=>y("div",{class:b(["sn-home-overview-item",s<3?"line-border":""]),key:s},[y("div",O,q(e.title),1),y("div",{class:"sn-home-overview-item-num",style:B(e.style)},q(e.value),5)],2)),64))])],2),v(te).length?(p(),f("div",S,[(p(!0),f(C,null,P(v(te),(e,a)=>(p(),w(u,{key:a,placement:"bottom",width:260,trigger:"hover",offset:0,"show-after":300},{reference:x(()=>[y("div",N,[y("div",null,[y("div",{class:b(["sn-home-list-item-type max-w-[12rem] w-max flex items-center",1===e.risk?"green":2===e.risk?"org":"red"])},[s[7]||(s[7]=y("i",{class:"svgtofont-el-warning !text-[1.6rem] w-[16px]"},null,-1)),y("span",Q,q(e.intercept),1)],2)]),y("span",null,"攻击者IP："+q(e.address),1),y("span",null,"网站："+q(e.domain),1),y("span",null,"路径："+q(e.url),1),y("div",W,"触发时间："+q(v(i)(e.addtime)),1)])]),default:x(()=>{return[y("div",X,[y("div",null,"【"+q(e.domain)+"】",1),y("div",Y,[s[8]||(s[8]=_(" 路径： ",-1)),y("span",{class:b((t=e.risk,3===t?"text-[#F50606]":2===t?"text-[#FF9900]":"text-[#DDC400]"))},q(e.intercept),3)]),y("div",null,"路径："+q(v(n)(e.url)),1),y("div",null,[s[9]||(s[9]=_(" 解决方案： ",-1)),(p(!0),f(C,null,P((a=e.solution,(null==a?void 0:a.split("|split|"))||[]),(e,s)=>(p(),f("p",{key:s},q(e),1))),128))]),y("div",Z,[h(o,{onClick:s=>(async e=>{await l({loading:"正在加入URL白名单...",request:R({url_rule:e}),message:!0}),await oe()})(e.url)},{default:x(()=>[...s[10]||(s[10]=[_("误报",-1)])]),_:2},1032,["onClick"]),h(m),h(o,{onClick:s=>(async e=>{await l({loading:"正在处理，请稍候...",request:K({operation:1,id:e}),message:!0}),await oe()})(e.id)},{default:x(()=>[...s[11]||(s[11]=[_("已处理",-1)])]),_:2},1032,["onClick"])])])];var a,t}),_:2},1024))),128))])):(p(),f("div",$,[h(E,{description:"暂无数据"})])),s[12]||(s[12]=y("div",{class:"text-[#C1C1C1] mt-[1rem]"},"以上仅提供最新的前100条风险数据",-1))])),[[V,v(se)]])}}}),[["__scopeId","data-v-8022050a"]]);export{ee as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
