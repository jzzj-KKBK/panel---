import{e as a,l as e,L as t,o as s,K as l,b as n,ai as o,R as i,k as c,a0 as r}from"./utils-lib.js?v=1756369731";import{_ as u}from"./index103.js?v=1756369731";import{c as d,X as m,q as p,v,e as _,A as y,y as f,F as w,ah as g,af as b,b6 as h,r as k,p as I,G as x,H as j,x as D,P as T,B as V,a_ as L,al as P,a$ as C,D as M,z as q,K as H}from"./base-lib.js?v=1756369731";import{a as S,s as U,e as E}from"./useMethod8.js?v=1756369731";import{a as R,u as A,c as F}from"./column.js?v=1756369731";import{aN as O,aO as K,aP as z,aQ as B}from"./firewall.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const G={class:"ml-8px"},N=a(d({__name:"date",props:{type:{},typeModifiers:{},value:{default:()=>[]},valueModifiers:{}},emits:["update:type","update:value"],setup(a){const e=m(a,"type"),t=m(a,"value");function s(a=new Date){const e=U(a),t=E(a);return[e.getTime(),t.getTime()]}const l=a=>{switch(a){case"today":t.value=s();break;case"yesterday":t.value=s(S(new Date,-1))}},n=a=>{const e=new Date,t=S(e,-30);return U(t).getTime()>a||E(e).getTime()<a},o=a=>{e.value="custom",t.value=[U(a[0]).getTime(),E(a[1]).getTime()]};return(a,s)=>{const i=g,c=b,r=h;return p(),v(w,null,[_(c,{class:"network-custom-radio",modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=a=>e.value=a),onChange:l},{default:y(()=>[_(i,{label:"今日",value:"today"}),_(i,{label:"昨日",value:"yesterday"})]),_:1},8,["modelValue"]),f("div",G,[_(r,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value=a),type:"daterange","disabled-date":n,onChange:o},null,8,["modelValue"])])],64)}}}),[["__scopeId","data-v-f355f5ec"]]),Q={class:"sn-home"},X={class:"sn-home-switch"},$={class:"flex items-center"},J={class:"flex items-center"},W={class:"sn-home-overview sn-home-overview-green"},Y={class:"mt-[2rem]"},Z={class:"sn-home-overview-item-title"},aa=a(d({__name:"index",setup(a){const d=k(!1),m=k(!1),g=k([]),b=k(),h=k([{title:"今日扫描次数",value:0,style:"color: #333"},{title:"今日扫描IP数",value:0,style:"color: #333"},{title:"总扫描次数",value:0,style:"color: #333"}]),S=k({type:"today",data:G()}),U=k(),E=[R({key:"scan_ip"}),{label:"扫描IP",prop:"scan_ip"},{label:"扫描类型",prop:"scan_type"},{label:"今日扫描次数",render:a=>a.scan_count_today.toLocaleString()||0},{label:"总扫描次数",render:a=>a.total_scan_count.toLocaleString()||0},{label:"被扫描的端口",render:a=>_("div",{innerHTML:a.scanned_ports,title:a.scanned_ports,class:"max-w-[25rem] truncate"},null)},{label:"扫描开始时间",prop:"scan_start_time"},{label:"扫描持续时间",render:a=>ia(a.scan_duration)},A([{onClick:a=>{e({title:"".concat(a.scan_ip," 扫描详情"),area:50,compData:{ip:a.scan_ip},showFooter:!1,component:()=>t(()=>import("./datails.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},title:"详情"},{onClick:async a=>{await s({title:"封禁IP",content:"是否封禁【".concat(a.scan_ip,"】24小时？")}),await l({loading:"正在执行，请稍后...",request:O({ip:a.scan_ip,timeout:86400}),success:a=>{n().request(a)}})},title:"封锁"}])];function G(){const{start:a,end:e}=function(a){const e=new Date(a);e.setHours(0,0,0,0);const t=new Date(a);return t.setHours(23,59,59,999),{start:e,end:t}}(new Date);return[a.getTime(),e.getTime()]}const aa=()=>{na()},ea=async()=>{try{await l({loading:"正在设置扫描感知开关,请稍后...",request:K({switch_type:"scan_sensing",status:m.value}),success:a=>{o(a.data.data)&&!a.status?n().error(a.msg+"【"+a.data.data+"】"):n().request(a)}})}catch(a){}},ta=async()=>{await s({title:"导出IP列表",content:"确定要导出当前扫描IP列表吗？"}),await l({loading:"正在执行，请稍后...",request:z(),success:a=>{a.data.status?window.open("/download?filename="+a.data.url,"_blank","noopener,noreferrer"):n().error(a.data.msg)}})},sa=async()=>{await e({title:"高级配置",area:45,compData:{config:U.value},showFooter:!1,component:()=>t(()=>import("./advanced.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},la=[{label:"封锁",value:"lock",event:async(a,e,t,s)=>{const l=async(a,e)=>{const{scan_ip:t}=a,s=new Map([["lock",O]]).get(o);if("lock"===o)if(s)return await s({ip:t,timeout:86400})},{label:n,value:o}=s;await a({title:"批量".concat(n),content:"即将批量".concat(n,"选中的IP，是否继续操作?"),column:[{label:"批量封锁",prop:"scan_ip"},F()],onConfirm:async()=>(await e(l),na(),!1)})}}],na=async()=>{const{data:a}=await B(oa()),e=a.overview;h.value[0].value=e.scan_count_today.toLocaleString(),h.value[1].value=e.ip_count_today.toLocaleString(),h.value[2].value=e.total_scan_count.toLocaleString(),m.value=e.scan_status,U.value=e,g.value=a.scan_info},oa=()=>({start_timestamp:i(S.value.data[0],"yyyy-MM-dd"),end_timestamp:i(S.value.data[1],"yyyy-MM-dd")}),ia=a=>{const e=a.split(":"),t=parseInt(e[0]),s=parseInt(e[1]),l=parseInt(e[2]);return t>999?"999+":"00:00:00"===a?"-":"".concat(60*t+s,"分").concat(l,"秒")},ca=()=>{S.value.data=G(),g.value=[],na()};return I(()=>ca()),(a,e)=>{const t=P,s=C,l=M,n=c,o=r,i=u,k=x("bt-loading");return j((p(),v("div",Q,[f("div",X,[f("div",$,[e[3]||(e[3]=f("div",{class:"mr-4"},"扫描感知",-1)),_(t,{modelValue:D(m),"onUpdate:modelValue":e[0]||(e[0]=a=>T(m)?m.value=a:null),width:36,onChange:ea},null,8,["modelValue"])]),f("div",null,[f("div",J,[_(N,{type:D(S).type,"onUpdate:type":e[1]||(e[1]=a=>D(S).type=a),value:D(S).data,"onUpdate:value":[e[2]||(e[2]=a=>D(S).data=a),aa]},null,8,["type","value"]),_(s,{direction:"vertical"}),_(l,{onClick:ca},{default:y(()=>[...e[4]||(e[4]=[V("刷新",-1)])]),_:1}),_(l,{onClick:ta},{default:y(()=>[...e[5]||(e[5]=[V("导出",-1)])]),_:1}),_(l,{onClick:sa},{default:y(()=>[...e[6]||(e[6]=[V("高级配置",-1)])]),_:1})])])]),f("div",W,[e[7]||(e[7]=f("div",{class:"text-[#666] text-[1.4rem]"},"扫描概览",-1)),f("div",Y,[(p(!0),v(w,null,L(D(h),(a,e)=>(p(),v("div",{class:"sn-home-overview-item",key:e},[f("div",Z,q(a.title),1),f("div",{class:"sn-home-overview-item-num",style:H(a.style)},q(a.value),5)]))),128))])]),_(i,null,{content:y(()=>[_(n,{ref_key:"scanListRef",ref:b,column:E,data:D(g),"max-height":"400"},null,8,["data"])]),"footer-left":y(()=>[_(o,{"table-ref":D(b),options:la},null,8,["table-ref"])]),_:1})])),[[k,D(d)]])}}}),[["__scopeId","data-v-6fda3751"]]);export{aa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
