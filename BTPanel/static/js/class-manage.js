import{_ as a}from"./index103.js?v=1756369731";import{K as e,o as l,k as s,j as t,h as o,b as i}from"./utils-lib.js?v=1756369731";import{c as u,x as n,r,U as d,p as c,G as m,q as p,v,e as f,A as h,P as b,B as g,H as w,y,Q as C,a$ as _,S as x,D as V,a9 as j,a7 as k}from"./base-lib.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const P={class:"p-[20px]"},q={class:"p-[20px]"},U=u({__name:"class-manage",props:{compData:{default:()=>({ignore:[],getClassList:()=>Promise.resolve([]),addClass:()=>Promise.resolve({}),editClass:()=>Promise.resolve({}),deleteClass:()=>Promise.resolve({}),updateOptions:()=>Promise.resolve([]),field:"ps",showEdit:!0})}},setup(u){const U=u,{getClassList:D,addClass:O,editClass:S,deleteClass:E,ignore:H,field:L,updateOptions:A,showEdit:B}=n(U.compData),G=r(""),K=r(""),Q=r(!1),T=r(!1),$=d([]),z=d({label:"",value:0}),F=i(),I=[{label:"分类名称",prop:"label",showOverflowTooltip:!0},{label:"操作",align:"right",render:a=>"all"===a.value||(null==H?void 0:H.includes("".concat(a.value)))?"不可操作":f("div",{class:"flex items-center"},[B&&f("span",{class:"flex items-center"},[f("span",{class:"bt-link",onClick:()=>N(a)},[g("编辑")]),f(_,{direction:"vertical"},null)]),f("span",{class:"bt-link",onClick:()=>W(a)},[g("删除")])])}],J=async()=>{try{Q.value=!0;const a=await D();$.value=a||[],A($.value)}catch(a){}finally{Q.value=!1}},M=async()=>{try{if(!G.value)return F.error("请输入分类名称");const a={[L]:G.value},l=await e({loading:"正在添加分类，请稍后...",request:O(a)});X(l),G.value=""}catch(a){}},N=a=>{T.value=!0,z.value=a,K.value=a.label},R=async()=>{try{const a={[L]:K.value,id:z.value.value},l=await e({loading:"正在编辑分类，请稍后...",request:S(a)});l.status&&(T.value=!1),K.value="",X(l)}catch(a){}},W=async a=>{try{await l({title:"提示",content:"确认删除该分类吗？该分类下的所有数据将会被移动至全部分类下，是否继续？"});const s=await e({loading:"正在删除分类，请稍后...",request:E({id:a.value})});X(s)}catch(s){}},X=a=>{a.status&&J(),F.request(a)};return c(()=>{J()}),(e,l)=>{const i=x,u=V,r=s,d=t,c=j,_=k,U=o,D=a,O=m("bt-loading");return p(),v("div",P,[f(D,null,{"header-left":h(()=>[f(i,{modelValue:n(G),"onUpdate:modelValue":l[0]||(l[0]=a=>b(G)?G.value=a:null),placeholder:"请输入分类名称",class:"!w-[41rem]"},null,8,["modelValue"]),f(u,{type:"primary",class:"ml-[1rem]",onClick:M},{default:h(()=>[...l[4]||(l[4]=[g(" 添加分类 ",-1)])]),_:1})]),content:h(()=>[w(f(r,{column:I,data:n($),"max-height":"250"},null,8,["data"]),[[O,n(Q)]])]),popup:h(()=>[f(U,{modelValue:n(T),"onUpdate:modelValue":l[3]||(l[3]=a=>b(T)?T.value=a:null),area:40,title:"编辑分类","show-footer":"",onConfirm:R},{default:h(()=>[y("div",q,[f(_,{onSubmit:l[2]||(l[2]=C(()=>{},["prevent"]))},{default:h(()=>[f(c,{label:"分类名称",prop:"name"},{default:h(()=>[f(d,{modelValue:n(K),"onUpdate:modelValue":l[1]||(l[1]=a=>b(K)?K.value=a:null),autofocus:"",placeholder:"请输入分类名称",onSubmit:R,width:"22rem"},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),_:1}),l[5]||(l[5]=y("ul",{class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},[y("li",null,"【批量操作-设置分类】可修改当前分类，仅具备批量操作的列表")],-1))])}}});export{U as default};
