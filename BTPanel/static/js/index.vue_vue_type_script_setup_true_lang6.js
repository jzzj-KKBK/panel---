import{_ as a}from"./index130.js?v=1756369731";import{c as s,r as t,as as e,k as n,p as i,aD as o,x as r,q as l,M as m,A as c,v as u,y as p,e as v,B as d,C as f,a$ as x}from"./base-lib.js?v=1756369731";import{u as y,aq as k,aL as g,c as b,b as _}from"./utils-lib.js?v=1756369731";import{k as w}from"./validator.js?v=1756369731";import{u as j}from"./useStore4.js?v=1756369731";const h={key:0,class:"content-mask"},I={key:1,class:"content-mask"},T=s({__name:"index",props:{compData:{default:{}}},emits:["init"],setup(s,{expose:T,emit:C}){const D=_(),S=C,{plugin:q,getGlobalInfo:A}=y(),{activeType:L}=j(),N=t(q.value.webserver),B=e("_".concat(L.value,"_mask"),!1),G=t(!1),M=n({title:"",name:"",status:!0,version:"",admin:!1,s_version:"",setup:!1}),O=async a=>{const{data:s}=await k({sName:a.name});if("-1"===s.task)return D.error("当前插件正在安装，不可重复安装");w({name:null==s?void 0:s.name,type:"i",pluginInfo:s}),z()};let $=!1;const z=async(a=!1)=>{try{if($)return;const{data:s}=await g({name:"web"});s.status||a||setTimeout(()=>{z()},3e3),s.status&&!a&&S("init"),B.value=!s.status,Object.assign(M,s),"proxy"===L.value&&"nginx"!==s.name&&(B.value=!0,G.value=s.status)}catch(s){a||setTimeout(()=>{z()},3e3)}};return i(()=>{z(!0)}),o(()=>{$=!0}),T({checkInstallStatus:z,pluginInfo:M,maskLayer:B,webServerType:N}),(s,t)=>{const e=b,n=x,i=a;return r(B)?(l(),m(i,{key:0,width:"38rem"},{content:c(()=>[r(G)?(l(),u("div",I,[...t[6]||(t[6]=[p("span",null,"反向代理项目只支持nginx环境",-1)])])):(l(),u("div",h,[t[4]||(t[4]=p("i",{class:"svgtofont-el-warning text-warning !text-[2.2rem] mr-4px"},null,-1)),t[5]||(t[5]=p("span",null,"未安装运行环境，",-1)),v(e,{onClick:t[0]||(t[0]=a=>O({name:"nginx"})),class:"!font-bold !text-[1.4rem]"},{default:c(()=>[...t[2]||(t[2]=[d("安装Nginx",-1)])]),_:1}),v(n,{direction:"vertical"}),"proxy"!==s.compData.type?(l(),m(e,{key:0,onClick:t[1]||(t[1]=a=>O({name:"apache"})),class:"!font-bold !text-[1.4rem]"},{default:c(()=>[...t[3]||(t[3]=[d("安装Apache",-1)])]),_:1})):f("",!0)]))]),_:1})):f("",!0)}}});export{T as _};
