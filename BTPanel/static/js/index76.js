import{_ as e}from"./index103.js?v=1756369731";import{u as t}from"./index141.js?v=1756369731";import{r as a,c as s,s as n,e as r,B as o,w as l,p as i,q as c,M as u,A as m,x as p,y as d}from"./base-lib.js?v=1756369731";import{l as _,L as f,bv as g,M as v,o as j,u as y,aM as b,a6 as w,p as h,a8 as x}from"./utils-lib.js?v=1756369731";import{f as S}from"./validator.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";import{c as C,a as O,d as k,g as B,u as L}from"./column.js?v=1756369731";import{b as P,g as T,c as M,d as I,f as J,h as N,s as R,u as E,a as A,j as q}from"./useController6.js?v=1756369731";import{u as G,S as D}from"./useStore4.js?v=1756369731";import{setProject as U,removeProject as V}from"./site.js?v=1756369731";const{activeType:z,settingTabActive:F,siteInfo:H,isRefreshList:K}=G(),{addGeneralProject:Q,editGeneralProject:W,delGeneralProjectEvent:X,setSiteInfo:Y,getRootUser:Z,getProjectConfig:$}=D(),ee=a([]),te=()=>{H.value=null,_({title:"添加通用项目",area:62,component:()=>f(()=>import("./index376.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!0})},ae=(e,t)=>{Y(e,t),_({title:"通用项目管理["+e.name+"] -- 添加时间["+e.addtime+"]",area:[84,72],component:()=>f(()=>import("./index377.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},se=async(e,t,a,s)=>{const{label:n,value:r}=s,o=new Map([["start","批量启动选中项目后，项目将正常访问"],["stop","批量停用选中的项目后，项目将会停止运行"],["restart","批量重启选中的项目后，项目将会重新启动"],["delete","批量删除选中的项目后，项目将无法恢复"]]),l=async(e,t)=>{const a=new Map([["start",U],["stop",U],["restart",U],["delete",V]]),{name:s}=e,n=a.get(r);switch(r){case"start":case"stop":case"restart":if(n){const t=await n({data:JSON.stringify({project_name:s})},z.value,r),a=t.status?1:2;return"start"===r?{...e,batchStatus:a,message:t.msg.replace(/<br>/g,"\n")}:{...e,batchStatus:a,message:t.status?t.data.msg:t.data.data}}case"delete":if(n)return await n({data:JSON.stringify({project_name:s})},z.value)}};await e({title:"批量".concat(n),content:"".concat(o.get(r),"，是否继续操作？"),column:[{label:"项目名称",prop:"name"},C()],onConfirm:async()=>(await t(l),K.value=!0,!1)})},ne=(e,t)=>{S({type:"file",path:e,change:e=>{t&&t(e)}})},re=async()=>{const{data:e}=await Z();if(ee.value=e.map(e=>({label:e,value:e})),H.value){const{data:e}=await $({data:JSON.stringify({project_name:H.value.name})});return{...null==e?void 0:e.project_config,project_ps:null==e?void 0:e.ps,is_power_on:!!(null==e?void 0:e.project_config.is_power_on),project_log:(null==e?void 0:e.project_config.project_log)?1:0,web_log:(null==e?void 0:e.project_config.web_log)?1:0}}return{project_exe:"",project_name:"",port:"",project_cmd:"",run_user:"www",project_ps:"",domains:"",release_firewall:!1,is_power_on:!1,bind_extranet:!1}},oe=async e=>{try{const t={...e};if(""!==t.domains){t.bind_extranet=1;const e=g(t.domains,"string","");t.domains=e.split("\n")}else t.bind_extranet=0,delete t.domains;H.value&&(t.id=H.value.id);const a=H.value?W:Q,s=await a({data:JSON.stringify(t)});return v.msg({dangerouslyUseHTMLString:!0,message:s.msg,type:s.status?"success":"error",duration:s.status?2e3:0,showClose:!s.status,customClass:"!max-w-[66rem]"}),K.value=!0,s.status}catch(t){return{status:!1,msg:"发生错误"}}},le=async e=>{try{await j({title:"删除项目-".concat(e.name),content:"风险操作，此操作不可逆，删除".concat(e.name,"项目后您将无法管理该项目，是否继续操作？"),type:"calc"});const t={data:JSON.stringify({project_name:e.name})},a=await X(t);return v.request(a),K.value=!0,a}catch(t){return{status:!1,msg:"删除项目失败"}}},ie=s({__name:"index",setup(a){y();const{getSiteList:s,setSiteInfo:_}=D(),{isRefreshList:f,siteInfo:v}=n(D()),{BtOperation:j}=b({options:[{type:"button",label:"添加项目",active:!0,onClick:te}]}),S=t({key:"type_id",name:"Other分类",options:()=>[{label:"全部分类",value:"all"}],event:N,ignore:["0"],field:"type_name"}),C=x([{label:"启动项目",value:"start",event:se},{label:"停用项目",value:"stop",event:se},{label:"重启项目",value:"restart",event:se},E(),A({classList:q}),{label:"删除项目",value:"delete",event:se}]),{BtTable:G,BtPage:U,BtRefresh:V,BtSearch:z,BtColumn:F,BtBatch:H,BtTableCategory:K,refresh:Q,config:W}=w({request:e=>{const{type_id:t,...a}=e;return s({data:JSON.stringify({...a,type_id:h(t)||"all"===t?"":t})})},columns:[O(),P({onClick:e=>{ae(e)}}),T({onClick:(e,t)=>{if("setting"===t)return void ae(e,"state");const a=e.run?"stop":"start";R(e,"restart"===t?t:a)}}),{label:"运行端口",isCustom:!0,render:e=>{const t=g(e.listen,"array",[]);return 0==t.length?"--":t.join("、")}},k(),M(),B({table:"sites",width:200}),I({onClick:e=>{ae(e,"ssl")}}),L([{title:"设置",onClick:e=>ae(e)},{title:"删除",onClick:le}])],extension:[S,C],empty:()=>r("span",null,[o("您的列表为空，您可以"),r("span",{class:"bt-link",onClick:te},[o("添加一个项目")])])});return l(f,async e=>{var t;if(e){if(await Q(),null==(t=v.value)?void 0:t.name){const e=W.data.find(e=>e.name===v.value.name);e&&_(e)}f.value=!1}}),i(()=>{}),(t,a)=>{const s=e;return c(),u(s,null,{"header-left":m(()=>[r(p(j)),d("div",{class:"flex items-center ml-1rem",onClick:a[0]||(a[0]=(...e)=>p(J)&&p(J)(...e))},[...a[1]||(a[1]=[d("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),d("span",{class:"bt-link"},"需求反馈",-1)])])]),"header-right":m(()=>[r(p(K),{class:"!w-[200px] mr-[10px]"}),r(p(z),{class:"mr-[10px]",placeholder:"请输入项目名称或备注"}),r(p(V),{class:"mr-[10px]"}),r(p(F))]),content:m(()=>[r(p(G),null,{empty:m(()=>[...a[2]||(a[2]=[o(" 您的列表为空，您可以添加一个项目 ",-1)])]),_:1})]),"footer-left":m(()=>[r(p(H))]),"footer-right":m(()=>[r(p(U))]),_:1})}}}),ce=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{re as a,ce as i,ne as o,oe as s,ee as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
