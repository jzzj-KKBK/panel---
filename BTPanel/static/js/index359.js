import{u as e,R as s,d as a,_ as t,c as l,e as c}from"./utils-lib.js?v=1756369731";import{c as i,t as r,r as n,g as m,p as d,G as o,H as f,x as u,q as v,v as p,y as b,M as x,C as y,z as w,A as g,e as j,b7 as _,F as k,a_ as h,P as S,D as T,a$ as C,f as H,bw as V,B as F,ba as A,bv as z}from"./base-lib.js?v=1756369731";import{scanSitesVluList as M}from"./site.js?v=1756369731";import{p as B}from"./validator.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const L={class:"p-2rem"},D={class:"mb-[2rem]"},J={class:"flex flex-row flex-wrap items-center justify-between"},N={class:"flex flex-row flex-wrap justify-center items-center"},R={class:"flex justify-between flex-col px-[2rem]"},q=["innerHTML"],E={class:"text-[1.6rem] mt-[1.2rem]"},G={class:"justify-end relative"},I={key:0},P={class:"webedit-con flex items-center justify-center"},U={key:1},W={key:0,class:"scan-dangerous"},Z={class:"overflow-auto h-[36rem]"},$={class:"flex items-center"},K={class:"w-[26rem] flex items-center justify-start"},O={class:"ml-[1.2rem]"},Q={class:"flex items-center justify-between w-full"},X={class:"flex items-center ml-[1.2rem]"},Y={class:"text-[#999] ml-[1.2rem]"},ee={class:"bg-[#f6f6f6] text-[#999]"},se={class:"p-[3rem] bg-[#F8F8F8]"},ae={class:"flex items-center"},te={class:"collapse-item"},le={class:"flex mt-[10px] items-center"},ce={class:"collapse-item"},ie={class:"flex mt-[10px] items-center"},re={class:"collapse-item"},ne={class:"flex mt-[10px] items-center"},me={class:"collapse-item"},de={class:"flex mt-[10px] items-center"},oe={class:"collapse-item"},fe={class:"flex mt-[10px] items-center"},ue={class:"collapse-item"},ve={key:1,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-[#e8e8e8] flex items-center justify-center"},pe={class:"flex flex-column items-center"},be=c(i({__name:"index",setup(c){const{payment:i}=e(),{authType:be}=r(i.value),xe=["danger","高危"],ye=["warning","中危"],we=["info","低危"],ge=n("success"),je=m(()=>he.value.total>0),_e=n({scanTitle:"当前未发现风险项。"}),ke=n(!1),he=n({list:[],total:0,time:""}),Se=n(["1"]),Te=e=>(e=Number(e))>=0&&e<=3.9?we:e>=4&&e<=6.9?ye:e>=7&&e<=10?xe:["default","未知风险"],Ce=async()=>{ke.value=!0;try{const{data:e}=await M();he.value.list=e.list,he.value.total=e.count,he.value.time=s(e.time),He(e.count)}finally{ke.value=!1}},He=e=>{e>0?(ge.value="danger",_e.value.scanTitle="<span class='text-danger'>".concat(e,"</span>个漏洞风险项待处理！")):(ge.value="success",_e.value.scanTitle="当前未发现风险项。")};return d(Ce),(e,s)=>{const c=t,i=T,r=C,n=H,m=A,d=l,M=z,xe=V,ye=a,we=o("bt-loading");return f((v(),p("div",L,[b("div",D,[b("div",J,[b("div",N,["success"==u(ge)?(v(),x(c,{key:0,icon:"scanning-success",size:80,color:"#20a53a"})):y("",!0),"danger"==u(ge)?(v(),x(c,{key:1,icon:"scanning-danger",size:80,color:"#ef0808"})):y("",!0),b("div",R,[b("div",{class:"text-[2rem] font-bold",innerHTML:u(_e).scanTitle},null,8,q),b("div",E,"上一次扫描时间:"+w(u(he).time),1)])]),b("div",G,["ltd"!==u(be)?(v(),x(i,{key:0,class:"scan-btn h-[4rem] w-[10rem]",type:"primary",size:"large",onClick:s[0]||(s[0]=e=>u(B)({sourceId:168}))},{default:g(()=>[...s[2]||(s[2]=[b("span",{class:"text-[1.5rem]"},"立即查看",-1)])]),_:1})):y("",!0),j(i,{class:"scan-btn h-[4rem] w-[10rem]",type:"primary",size:"large",onClick:Ce},{default:g(()=>[...s[3]||(s[3]=[b("span",{class:"text-[1.5rem]"},"重新检测",-1)])]),_:1})])])]),j(r,{class:"!mt-0"}),"ltd"!==u(be)?(v(),p("div",I,[b("div",P,[j(n,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",src:"https://www.bt.cn/Public/new/plugin/introduce/site/javaVulScan.png",custom:!0}),s[4]||(s[4]=_('<div class="thumbnail-introduce mt-[0rem]" data-v-f0ceaf3b><span class="text-[1.8rem] font-bold" data-v-f0ceaf3b>漏洞扫描工具介绍：</span><ul class="block leading-[2.6rem] mx-[2rem] list-square mt-[2rem]" data-v-f0ceaf3b><li data-v-f0ceaf3b> 可识别多款Java组件漏洞，支持如下：<br data-v-f0ceaf3b> Apache Log4j2、Apache Shiro、Fastjson、<br data-v-f0ceaf3b> Spring Boot、Spring Framework、Struts2、<br data-v-f0ceaf3b> Tomcat、Weblogic、JBoss、Hibernate、Nexus<br data-v-f0ceaf3b> Dubbo、Nacos、Druid、MyBatis、Spring Cloud<br data-v-f0ceaf3b> Eureka、Ribbon、Hystrix、Zuul、Gateway<br data-v-f0ceaf3b> Thymeleaf、FreeMarker、Velocity<br data-v-f0ceaf3b></li><li data-v-f0ceaf3b>提供修复/提供付费解决方案</li><li data-v-f0ceaf3b>提供详细的漏洞描述和风险等级(CVSS评分)</li></ul></div>',1))])])):(v(),p("div",U,[u(je)?(v(),p("div",W,[s[13]||(s[13]=b("div",{class:"flex items-center mb-[2rem] text-[#333]"},[b("span",{class:"w-[26rem]"},"项目名称"),b("span",null,"类型")],-1)),b("div",Z,[j(xe,{modelValue:u(Se),"onUpdate:modelValue":s[1]||(s[1]=e=>S(Se)?Se.value=e:null),accordion:""},{default:g(()=>[(v(!0),p(k,null,h(u(he).list,(e,a)=>(v(),x(M,{key:a},{title:g(()=>[b("div",$,[b("div",K,[j(m,{type:"warning",effect:"dark"},{default:g(()=>[F(w(e.list.length)+"项 ",1)]),_:2},1024),b("span",O,w(e.title),1)]),s[5]||(s[5]=b("div",{class:"text-[#666] text-[1.2rem]"},"无法自动修复,请手动处理",-1))])]),default:g(()=>[j(xe,{accordion:""},{default:g(()=>[(v(!0),p(k,null,h(e.list,(e,a)=>(v(),x(M,{key:a},{title:g(()=>[b("div",Q,[b("div",X,[j(m,{type:Te(e.cvss)[0]},{default:g(()=>[F(w(Te(e.cvss)[1]),1)]),_:2},1032,["type"]),b("span",Y,w(e.desc),1)]),j(d,{class:"mb-[.2rem] mr-[1.6rem]"},{default:g(()=>[...s[6]||(s[6]=[F("详情",-1)])]),_:1})])]),default:g(()=>[b("div",ee,[b("div",se,[b("div",ae,[s[7]||(s[7]=b("div",{class:"text-[#333] collapse-title"},"漏洞编号",-1)),b("div",te,w(e.CVE),1)]),b("div",le,[s[8]||(s[8]=b("div",{class:"text-[#333] collapse-title"},"风险描述",-1)),b("div",ce,w(e.desc),1)]),b("div",ie,[s[9]||(s[9]=b("div",{class:"text-[#333] collapse-title"},"CVSS",-1)),b("div",re,w(e.cvss),1)]),b("div",ne,[s[10]||(s[10]=b("div",{class:"text-[#333] collapse-title"},"JAR",-1)),b("div",me,w(e.jar),1)]),b("div",de,[s[11]||(s[11]=b("div",{class:"text-[#333] collapse-title"},"CLASS",-1)),b("div",oe,w(e.class),1)]),b("div",fe,[s[12]||(s[12]=b("div",{class:"text-[#333] collapse-title"},"HASH(16)",-1)),b("div",ue,w(e.hash256),1)])])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])])):(v(),p("div",ve,[b("div",pe,[j(ye,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),s[14]||(s[14]=b("span",{class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])]))]))])),[[we,u(ke)]])}}}),[["__scopeId","data-v-f0ceaf3b"]]);export{be as default};
