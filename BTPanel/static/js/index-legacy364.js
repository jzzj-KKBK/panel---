!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,l="function"==typeof Symbol?Symbol:{},a=l.iterator||"@@iterator",u=l.toStringTag||"@@toStringTag";function o(t,l,a,u){var o=l&&l.prototype instanceof c?l:c,s=Object.create(o.prototype);return r(s,"_invoke",function(t,r,l){var a,u,o,c=0,s=l||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,u=0,o=e,p.n=t,i}};function f(t,r){for(u=t,o=r,n=0;!d&&c&&!l&&n<s.length;n++){var l,a=s[n],f=p.p,y=a[2];t>3?(l=y===r)&&(o=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=e):a[0]<=f&&((l=t<2&&f<a[1])?(u=0,p.v=r,p.n=a[1]):f<y&&(l=t<3||a[0]>r||r>y)&&(a[4]=t,a[5]=r,p.n=y,u=0))}if(l||t>1)return i;throw d=!0,r}return function(l,s,y){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&f(s,y),u=s,o=y;(n=u<2?e:o)||!d;){a||(u?u<3?(u>1&&(p.n=-1),f(u,o)):p.n=o:p.v=o);try{if(c=2,a){if(u||(l="next"),n=a[l]){if(!(n=n.call(a,o)))throw TypeError("iterator result is not an object");if(!n.done)return n;o=n.value,u<2&&(u=0)}else 1===u&&(n=a.return)&&n.call(a),u<2&&(o=TypeError("The iterator does not provide a '"+l+"' method"),u=1);a=e}else if((n=(d=p.n<0)?o:t.call(r,p))!==i)break}catch(n){a=e,u=1,o=n}finally{c=1}}return{value:n,done:d}}}(t,a,u),!0),s}var i={};function c(){}function s(){}function d(){}n=Object.getPrototypeOf;var p=[][a]?n(n([][a]())):(r(n={},a,function(){return this}),n),f=d.prototype=c.prototype=Object.create(p);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,u,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=d,r(f,"constructor",d),r(d,"constructor",s),s.displayName="GeneratorFunction",r(d,u,"GeneratorFunction"),r(f),r(f,u,"Generator"),r(f,a,function(){return this}),r(f,"toString",function(){return"[object Generator]"}),(t=function(){return{w:o,m:y}})()}function r(e,n,t,l){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,n,t,l){function u(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!l,configurable:!l,writable:!l}):e[n]=t:(u("next",0),u("throw",1),u("return",2))},r(e,n,t,l)}function l(e,n,t,r,l,a,u){try{var o=e[a](u),i=o.value}catch(e){return void t(e)}o.done?n(i):Promise.resolve(i).then(r,l)}function a(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var u=e.apply(n,t);function o(e){l(u,r,a,o,i,"next",e)}function i(e){l(u,r,a,o,i,"throw",e)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./index-legacy70.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./traditional-project.vue_vue_type_script_setup_true_lang-legacy.js?v=1756369731","./index.vue_vue_type_style_index_0_lang-legacy2.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy14.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy16.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy17.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy18.js?v=1756369731","./index-legacy476.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy19.js?v=1756369731","./index-legacy103.js?v=1756369731","./column-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy20.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy21.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy130.js?v=1756369731","./index-legacy104.js?v=1756369731","./validator-legacy.js?v=1756369731","./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang-legacy.js?v=1756369731","./useController-legacy6.js?v=1756369731","./index-legacy141.js?v=1756369731","./index-legacy124.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1756369731","./index-legacy101.js?v=1756369731","./index-legacy140.js?v=1756369731","./ace-legacy.js?v=1756369731","./index-legacy418.js?v=1756369731","./form-item-legacy.js?v=1756369731","./useStore-legacy12.js?v=1756369731","./useController-legacy14.js?v=1756369731","./config-legacy.js?v=1756369731","./useController-legacy15.js?v=1756369731","./useController-legacy16.js?v=1756369731","./useController-legacy13.js?v=1756369731","./useController-legacy5.js?v=1756369731","./useMethod-legacy5.js?v=1756369731","./useController-legacy4.js?v=1756369731","./useStore-legacy10.js?v=1756369731","./useController-legacy17.js?v=1756369731","./index-legacy116.js?v=1756369731","./useController-legacy18.js?v=1756369731","./index-legacy323.js?v=1756369731","./useStore-legacy6.js?v=1756369731"],function(n,r){"use strict";var l,u,o,i,c,s,d,p,f,y,_,m,v,g,j,b,h,x,w,S,C,k,O,T,M,z,V,A,P,U,G,I,L,N,H,J,q,D,E,F,B,K,Z,$,Q,R,W,X,Y,ee,ne,te,re,le;return{setters:[function(e){l=e.K,u=e.o,o=e.j,i=e.c,c=e.k,s=e.h,d=e.b,p=e.ah,f=e.a2},function(e){y=e.c,_=e.r,m=e.p,v=e.aD,g=e.G,j=e.q,b=e.v,h=e.e,x=e.A,w=e.y,S=e.x,C=e.B,k=e.H,O=e.M,T=e.P,M=e.U,z=e.ai,V=e.aj,A=e.D,P=e.w,U=e.Z},function(e){G=e.g},function(e){I=e.u,L=e.S},function(e){N=e._,H=e.a,J=e.b},function(e){q=e._},function(e){D=e._},function(e){E=e._},function(e){F=e._},function(e){B=e._},function(e){K=e._},function(e){Z=e._},function(e){$=e.default},function(e){Q=e._},function(e){R=e._},function(e){W=e.u},function(e){X=e.getNodeModules,Y=e.installPackages,ee=e.installModule,ne=e.upgradeModule,te=e.uninstallModule},function(e){re=e._},function(e){le=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var r={class:"flex items-center"},ae={class:"flex items-center justify-center text-[12px]"},ue={class:"bg-[#333] p-[12px] h-[36rem] text-white overflow-auto"},oe=["innerHTML"],ie=y({__name:"index",props:{compData:{default:{}}},setup:function(n,f){var y=f.expose,P=I().siteInfo,U=d(),G=_(!1),L=_([]),N=_(!1),H=_({mod_name:"",type:"yarn"}),J=_(),q=_("正在请求安装..."),D=function(){var e=a(t().m(function e(){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:N,request:X({data:JSON.stringify({project_name:P.value.name,project_cwd:P.value.project_cwd})}),data:[Array,L]});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=a(t().m(function e(n,r){var a,o,i,c,s,d,p,f,y,_,m,v;return t().w(function(e){for(;;)switch(e.n){case 0:if(o=P.value.name,i=H.value,c=i.mod_name,s=i.type,""!==c||"install"!==r){e.n=1;break}return U.error("请输入模块名称"),e.a(2);case 1:if("install"===r){e.n=2;break}return e.n=2,u({width:38,title:"".concat("update"===r?"更新":"卸载","模块【").concat(null==n?void 0:n.name,"】"),content:"".concat("update"===r?"更新":"卸载","模块后，可能影响项目正常运行，请谨慎操作，是否继续操作？"),type:"calc"});case 2:return d={install:{data:JSON.stringify({project_name:o,mod_name:c,pkg_manager:s})},update:{data:JSON.stringify({project_name:o,mod_name:null==n?void 0:n.name,type:s})},uninstall:{data:JSON.stringify({project_name:o,mod_name:null==n?void 0:n.name})}},p=new Map([["install",ee],["update",ne],["uninstall",te]]),f=p.get(r),y=d[r],e.n=3,l({loading:"正在操作,请稍后...",request:f(y)});case 3:null!=(_=e.v)&&null!==(a=_.data)&&void 0!==a&&a.status?(H.value.mod_name="",D(),U.success(null==_||null===(m=_.data)||void 0===m?void 0:m.data)):U.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:null==_||null===(v=_.data)||void 0===v?void 0:v.error_msg,type:"error",duration:0,showClose:!0});case 4:return e.a(2)}},e)}));return function(n,t){return e.apply(this,arguments)}}(),F=null,B=function(){F=p({route:"/sock_shell",onMessage:K})},K=function(e,n){var t,r=n.data;q.value+="\n"+r,r.includes("Done")&&(null===(t=F)||void 0===t||t.close())},Z=function(){var e=a(t().m(function e(){var n,r,l,a,u,o;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,q.value="",l=Y({data:JSON.stringify({project_name:P.value.name})}),B(),null===(n=F)||void 0===n||n.send({"x-http-token":window.vite_public_request_token}),null===(r=F)||void 0===r||r.send("tail -f /www/server/panel/logs/npm-exec.log"),G.value=!0,e.n=1,l;case 1:return J.value=e.v,e.n=2,l;case 2:a=e.v,(u=a.data).status||(U.request({status:u.status,msg:u.data||u.msg}),null===(o=F)||void 0===o||o.close()),U.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:J.value.data.data,type:J.value.status?"success":"error"}),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}(),$=M([{label:"模块名称",prop:"name"},{label:"版本",prop:"version"},{label:"协议",prop:"license"},{label:"描述",prop:"description"},W([{onClick:function(e){E(e,"update")},title:"更新"},{onClick:function(e){E(e,"uninstall")},title:"卸载"}])]);return m(D),y({init:D}),v(function(){var e;null===(e=F)||void 0===e||e.close()}),function(n,t){var l=z,a=V,u=o,d=A,p=i,f=c,y=s,_=R,m=g("bt-loading"),v=g("scroll-bottom");return j(),b("div",null,[h(_,null,{"header-left":x(function(){return[w("div",r,[h(a,{modelValue:S(H).type,"onUpdate:modelValue":t[0]||(t[0]=function(e){return S(H).type=e}),class:"!w-[10rem]"},{default:x(function(){return[h(l,{label:"yarn",value:"yarn"}),h(l,{label:"pnpm",value:"pnpm"}),h(l,{label:"npm",value:"npm"})]}),_:1},8,["modelValue"]),h(u,{class:"ml-4px !w-[24rem]",modelValue:S(H).mod_name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return S(H).mod_name=e}),placeholder:"模块名称"},null,8,["modelValue"]),h(d,{type:"primary",class:"ml-1.4rem",onClick:t[2]||(t[2]=function(e){return E(null,"install")})},{default:x(function(){return e(t[4]||(t[4]=[C("安装模块",-1)]))}),_:1})])]}),"header-right":x(function(){return[h(d,{type:"primary",onClick:Z},{default:x(function(){return e(t[5]||(t[5]=[C("一键安装项目模块",-1)]))}),_:1})]}),content:x(function(){return[k((j(),O(f,{"max-height":"620",column:S($),data:S(L)},{empty:x(function(){return[w("div",ae,[t[7]||(t[7]=C(" 未安装模块,点击 ",-1)),h(p,{onClick:Z},{default:x(function(){return e(t[6]||(t[6]=[C("一键安装项目模块",-1)]))}),_:1})])]}),_:1},8,["column","data"])),[[m,S(N)]])]}),popup:x(function(){return[h(y,{title:"正在安装模块,请稍后...",modelValue:S(G),"onUpdate:modelValue":t[3]||(t[3]=function(e){return T(G)?G.value=e:null}),area:[50,36]},{default:x(function(){return[k((j(),b("div",ue,[w("pre",{class:"whitespace-pre-line",innerHTML:S(q)},null,8,oe)])),[[v]])]}),_:1},8,["modelValue"])]}),_:1})])}}});n("default",y({__name:"index",setup:function(e){var n=I(),r=n.siteInfo,l=n.settingTabActive,u=n.isJump,o=L().resetTab,i=_(l.value||"project"),c=_(r.value),s=[{label:"项目配置",name:"project",lazy:!0,render:function(){var e={node:N,pm2:H,general:J};return e[c.value.project_config.project_type]||e.node}},{label:"域名管理",name:"domain",lazy:!0,render:q},{label:"外网映射",name:"mapping",lazy:!0,render:D},{label:"流量限制",name:"limit",lazy:!0,render:E},{label:"伪静态",name:"pseudo",lazy:!0,render:F},{label:"配置文件",name:"configFile",lazy:!0,render:B},{label:"SSL",name:"ssl",lazy:!0,render:K},{label:"重定向",name:"redirect",render:Z},{label:"负载状态",name:"load",lazy:!0,render:$},{label:"服务",name:"state",lazy:!0,render:Q},{label:"模块管理",name:"modules",lazy:!0,render:ie},{label:"项目日志",name:"projectLogs",lazy:!0,render:re},{label:"网站日志",name:"siteLogs",lazy:!0,render:le}],d=f({type:"left-bg-card",value:i,options:s}).BtTabs;P(function(){return u.value},function(e){e&&(i.value=l.value,o())});var p=_({});return U("nodeData",p),m(a(t().m(function e(){var n,r;return t().w(function(e){for(;;)switch(e.n){case 0:return"general"===c.value.project_config.project_type&&(n=s.findIndex(function(e){return"modules"===e.name}),s.splice(n,1)),"pm2"===c.value.project_config.project_type&&(r=s.findIndex(function(e){return"load"===e.name}),s.splice(r,1)),e.n=1,G();case 1:p.value=e.v;case 2:return e.a(2)}},e)}))),function(e,n){return j(),O(S(d),{type:"left-bg-card",modelValue:S(i),"onUpdate:modelValue":n[0]||(n[0]=function(e){return T(i)?i.value=e:null}),options:s},null,8,["modelValue"])}}}))}}})}();
