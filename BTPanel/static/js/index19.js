import{K as a,at as e,h as s,c as t,J as l,k as o,a0 as n,S as r,l as i,L as u}from"./utils-lib.js?v=1756369731";import{_ as d}from"./index103.js?v=1756369731";import{_ as m}from"./index112.js?v=1756369731";import{c,r as p,q as _,v as f,e as g,A as v,B as y,y as b,x as h,P as x,D as j,al as w,k,U as C,g as S,w as V,p as U,G as q,M as D,C as J,J as A,F as L,a_ as O,H as R,ai as T,aj as H,z as M}from"./base-lib.js?v=1756369731";import{_ as N}from"./index130.js?v=1756369731";import{setAuthStatus as z,getModulesCloudServer as B,getMongodbConfig as E,getModulesList as F}from"./database.js?v=1756369731";import{a as P,f as G,g as I,u as K}from"./column.js?v=1756369731";import{g as Q}from"./useStore2.js?v=1756369731";import{o as W,e as X,a as Y,d as Z,f as $,i as aa,l as ea,g as sa,h as ta,j as la}from"./useMethod4.js?v=1756369731";import{e as oa}from"./validator.js?v=1756369731";import{_ as na}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1756369731";import{_ as ra}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";const ia={class:"p-20px"},ua={class:"flex items-center"},da=c({__name:"index",setup(t){const{refs:{safetyStatus:l}}=Q(),o=p(!1),n=async()=>{try{await a({loading:"正在设置安全状态，请稍候...",request:z({data:JSON.stringify({status:l.value?"1":"0"})}),message:!0,success:a=>{a.status||(l.value=!l.value)}})}catch(s){e(s,"changeSafety")}};return(a,e)=>{const t=j,r=w,i=s;return _(),f("div",null,[g(t,{type:"default",onClick:e[0]||(e[0]=a=>o.value=!0)},{default:v(()=>[...e[3]||(e[3]=[y("安全认证",-1)])]),_:1}),g(i,{title:"安全认证",modelValue:h(o),"onUpdate:modelValue":e[2]||(e[2]=a=>x(o)?o.value=a:null),area:40},{default:v(()=>[b("div",ia,[b("div",ua,[e[4]||(e[4]=b("span",{class:"mr-8px"},"安全认证：",-1)),g(r,{modelValue:h(l),"onUpdate:modelValue":e[1]||(e[1]=a=>x(l)?l.value=a:null),width:36,onChange:n},null,8,["modelValue"])]),e[5]||(e[5]=b("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[b("li",null,"安全认证：开启后访问数据需要使用帐号和密码")],-1))])]),_:1},8,["modelValue"])])}}}),ma={class:"flex items-center"},ca={class:"w-[20rem] truncate inline-block"},pa=c({__name:"index",setup(e){const{refs:{isRefreshTable:s,isLoading:c,safetyStatus:w,envStatus:z,isHaveServer:ia},resetRefresh:ua,refreshTableList:pa}=Q(),_a=k({total:0,page:1,row:10}),fa=p([]),ga=C([]),va=p(null),ya=p("all"),ba=p(""),ha=p(""),xa=p([]),ja=Z(),wa=S(()=>!z.value.setup&&!ia.value),ka=()=>[P(),...$(aa),G({event:(a,e)=>ea(a,e)}),sa(xa.value,"mongodb"),I({table:"databases"}),K([{onClick:a=>(a=>{i({title:"【".concat(a.name,"】权限配置"),area:53,compData:a,showFooter:!0,component:()=>u(()=>import("./index132.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})})(a),title:"权限"},{onClick:a=>ta(a),title:"工具"},{onClick:a=>aa(a),title:"改密"},{onClick:a=>la(a),title:"删除"}])],Ca=async()=>(await a({request:B({data:JSON.stringify({type:"mongodb"})},"mongodb"),data:[Array,xa]}),xa.value.length||(ia.value=!1),xa.value),Sa=async()=>{let e={p:_a.page,limit:_a.row,tables:"databases",search:ba.value,sid:"all"===ya.value?"":ya.value};""===e.sid&&delete e.sid,await a({loading:c,request:F({data:JSON.stringify(e)},"mongodb"),data:{data:[Array,fa],page:r(_a)}})},Va=async()=>{const e=await a({request:E(),data:{root:[String,ha],authorization:[String,a=>({status:"enabled"===a||!1})]}});w.value=e.status};return V(()=>s.value,async a=>{a&&await Sa(),ua()}),U(()=>(async()=>{Sa(),!wa.value&&Va(),await Ca(),ga.value=ka()})()),(a,e)=>{const s=N,r=j,i=t,u=T,p=H,k=l,C=o,S=n,V=m,U=d,z=q("bt-loading");return _(),f("div",null,[h(wa)?(_(),D(s,{key:0},{content:v(()=>[g(ra,{type:"MongoDB"})]),_:1})):J("",!0),g(U,null,{"header-left":v(()=>[b("div",ma,[g(r,{type:"primary",onClick:e[0]||(e[0]=a=>h(W)(Ca))},{default:v(()=>[...e[7]||(e[7]=[y("添加数据库",-1)])]),_:1}),h(w)?(_(),D(r,{key:0,onClick:e[1]||(e[1]=a=>h(X)(h(ha),()=>Va()))},{default:v(()=>[...e[8]||(e[8]=[y("root密码",-1)])]),_:1})):J("",!0),g(r,{onClick:h(Y)},{default:v(()=>[...e[9]||(e[9]=[y("远程数据库",-1)])]),_:1},8,["onClick"]),g(da,{class:"mx-[10px]"}),g(na,{"comp-data":h(xa)},null,8,["comp-data"]),g(i,{onClick:e[2]||(e[2]=a=>h(oa)({name:"数据库",type:12})),icon:"desired",class:"ml-[12px]",iconClass:"text-1.6rem"},{default:v(()=>[...e[10]||(e[10]=[y("需求反馈",-1)])]),_:1})])]),"header-right":v(()=>[g(p,{modelValue:h(ya),"onUpdate:modelValue":e[3]||(e[3]=a=>x(ya)?ya.value=a:null),onChange:h(pa),class:A(["!w-[14rem] mr-[8px]",{"custom-types-bg-green":"all"!==h(ya)}])},{default:v(()=>[g(u,{label:"全部",value:"all"}),(_(!0),f(L,null,O(h(xa),(a,e)=>(_(),D(u,{key:e,label:"".concat("all"!==h(ya)?"已选：":"").concat(a.ps),value:a.id},{default:v(()=>[b("span",ca,M(a.ps),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onChange","class"]),g(k,{class:"w-[26rem]",modelValue:h(ba),"onUpdate:modelValue":e[4]||(e[4]=a=>x(ba)?ba.value=a:null),onSearch:h(pa),placeholder:"请输入数据库名称/备注"},null,8,["modelValue","onSearch"])]),content:v(()=>[R(g(C,{ref_key:"mongoDbTableRef",ref:va,column:h(ga),data:h(fa)},null,8,["column","data"]),[[z,h(c)]])]),"footer-left":v(()=>[g(S,{options:h(ja),"table-ref":h(va)},null,8,["options","table-ref"])]),"footer-right":v(()=>[g(V,{total:h(_a).total,page:h(_a).page,"onUpdate:page":e[5]||(e[5]=a=>h(_a).page=a),row:h(_a).row,"onUpdate:row":e[6]||(e[6]=a=>h(_a).row=a),onChange:h(pa)},null,8,["total","page","row","onChange"])]),_:1})])}}});export{pa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
