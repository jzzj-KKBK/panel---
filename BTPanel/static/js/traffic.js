import{_ as e}from"./index130.js?v=1756369731";import{G as r,bg as a,j as t}from"./utils-lib.js?v=1756369731";import{c as s,g as l,e as o,T as i,B as u,D as m,q as p,v as n,x as d,M as v,A as c,z as _,C as b,J as f}from"./base-lib.js?v=1756369731";import{u as y,S as g}from"./useStore4.js?v=1756369731";import{i as j,h as x,p as h,o as w,m as V,b as C,a as q}from"./useController14.js?v=1756369731";import"./index104.js?v=1756369731";import"./validator.js?v=1756369731";import"./column.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./site.js?v=1756369731";import"./useController6.js?v=1756369731";import"./config.js?v=1756369731";const B=s({__name:"traffic",setup(s,{expose:B}){const{isBindExtranet:I,siteInfo:U}=y();g();const{BtForm:k,submit:E}=r({data:j,options:e=>l(()=>{var r;return[{type:"custom",render:()=>o(a,{label:"是否启用"},{default:()=>[o(i,{modelValue:e.value.value,"onUpdate:modelValue":r=>e.value.value=r,onChange:r=>x(r,e.value)},{default:()=>[u("启用流量控制")]})]})},{type:"select",label:"限制方案",key:"type",options:h.value,attrs:{style:"width: 24rem;",onChange:r=>{const{perserver:a,perip:t,limit_rate:s}=h.value[r].items;e.value.perserver=a,e.value.perip=t,e.value.limit_rate=s}}},{type:"custom",render:()=>o(a,{label:"并发限制",prop:"perserver"},{default:()=>[o(t,{modelValue:e.value.perserver,"onUpdate:modelValue":r=>e.value.perserver=r,type:"number",width:"24rem",class:"mr-1rem"},null),o("div",{class:"text-[#999] text-[1.2rem]"},[u("* 限制当前站点最大并发数")])]}),rules:{perserver:[{required:!0,message:"请输入并发限制",trigger:"blur"},{validator:(e,r,a)=>{r>65535?a(new Error("不能大于65535")):a()}}]}},{type:"custom",render:()=>o(a,{label:"单IP限制",prop:"perip"},{default:()=>[o(t,{modelValue:e.value.perip,"onUpdate:modelValue":r=>e.value.perip=r,type:"number",width:"24rem",class:"mr-1rem"},null),o("span",{class:"text-[#999] text-[1.2rem]"},[u("* 限制单个IP访问最大并发数")])]}),rules:{perip:[{required:!0,message:"请输入单IP限制",trigger:"blur"},{validator:(e,r,a)=>{r>65535?a(new Error("不能大于65535")):a()}}]}},{type:"custom",render:()=>o(a,{label:"流量限制",prop:"limit_rate"},{default:()=>[o(t,{modelValue:e.value.limit_rate,"onUpdate:modelValue":r=>e.value.limit_rate=r,type:"number",width:"24rem",class:"mr-1rem"},null),o("span",{class:"text-[#999] text-[1.2rem]"},[u("* 限制每个请求的流量上限（单位：KB）")])]}),rules:{limit_rate:[{required:!0,message:"请输入流量限制",trigger:"blur"}]}},...(null==(r=U.value)?void 0:r.id)?[{type:"custom",render:()=>o(a,{label:" "},{default:()=>[o(m,{type:"primary",onClick:E},{default:()=>[e.value.value?"保存":"保存并启用"]})]})}]:[]]}),submit:async(e,r)=>(await r(),await w(e.value))});return B({onConfirm:E}),(r,a)=>{const t=e;return p(),n("div",{class:f(["h-full",{"p-2rem":d(q)}])},[d(V)?(p(),v(t,{key:0,width:"36rem"},{content:c(()=>[u(_(d(C)),1)]),_:1})):b("",!0),o(d(k))],2)}}});export{B as default};
