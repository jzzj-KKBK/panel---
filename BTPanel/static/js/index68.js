import{u as e,aM as a,a6 as t,p as s,v as l,a7 as o,cu as n,cv as i,L as r,a8 as p,h as u}from"./utils-lib.js?v=1756369731";import{_ as c}from"./index103.js?v=1756369731";import{_ as d}from"./index117.js?v=1756369731";import{_ as m}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1756369731";import{delSorted as _,addSiteTypes as v,modifySiteTypes as f,removeSiteType as b}from"./site.js?v=1756369731";import{B as h}from"./index131.js?v=1756369731";import{u as k}from"./index141.js?v=1756369731";import{c as x,t as C,s as g,w as y,e as w,B as j,D as P,p as B,n as S,q as L,v as R,x as T,A as I,y as W,J as E,P as H}from"./base-lib.js?v=1756369731";import"./validator.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";import{a as A,b as D,d as O,k as V,g as q,u as N}from"./column.js?v=1756369731";import{b as M,c as F,d as J,e as Q,f as U}from"./useController6.js?v=1756369731";import{S as z}from"./useStore4.js?v=1756369731";import{S as G,a as K,p as X,b as Y,c as Z,d as $,t as ee,e as ae,f as te,g as se,o as le,r as oe,h as ne,i as ie,j as re,k as pe,l as ue,m as ce,n as de,q as me}from"./useController5.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index130.js?v=1756369731";import"./index104.js?v=1756369731";import"./index124.js?v=1756369731";import"./useMethod5.js?v=1756369731";const _e={class:"p-[20px] pb-[24px]"},ve=x({__name:"index",setup(x){const{payment:ve,mainHeight:fe,plugin:be,enterpriseRec:he}=e(),{authType:ke}=C(ve.value),{activeType:xe,isRefreshList:Ce,searchWidth:ge}=g(z()),{getClassList:ye}=z(),{pluginInfo:we,scanData:je}=g(G()),{getPhpList:Pe}=G();y(Q,e=>{(null==e?void 0:e.pluginInfo)&&(we.value=e.pluginInfo)},{immediate:!0,deep:!0});const Be=k({key:"type",name:"PHP分类",options:()=>[{label:"全部分类",value:"all"}],event:{get:async()=>{const{data:e}=await ye();return ue.value=e,e},add:e=>v(e,xe.value),update:e=>f(e,xe.value),delete:e=>b(e,xe.value)},ignore:["0","-2"],field:"name"}),Se=p(me),{BtOperation:Le}=a({options:[{type:"button",label:"添加站点",active:!0,onClick:K},{type:"dropdown",label:"高级设置",onClick:X,options:[{label:"修改默认页面",onClick:X},{label:"默认站点",onClick:()=>X("defaultSite")},{label:"PHP命令行版本",onClick:()=>X("phpCommandLine")},{label:"HTTPS防窜站",onClick:()=>X("httpsOfficersSite")},{label:"TLS设置",onClick:()=>X("tlsSetting")},{label:"全局设置",onClick:()=>X("globalSetting")},{label:"关联数据库",onClick:()=>X("associatedDatabase")}]},...he.value?[{type:"custom",render:()=>w(P,{onClick:Y},{default:()=>{var e,a;return[j("漏洞扫描"),w("span",{class:"ml-4px py-1px px-4px text-white text-center font-bold ".concat((null==(e=je.value)?void 0:e.loophole_num)>0?"bg-[red]":"bg-[#f0ad4e]")},[null==(a=je.value)?void 0:a.loophole_num])]}})},{type:"custom",render:()=>w(P,{onClick:Z},{default:()=>{var e,a;return[j("网站安全"),w("span",{class:"ml-4px py-1px px-4px text-white text-center font-bold ".concat((null==(e=je.value)?void 0:e.web_scaning_times)>0?"bg-[red]":"bg-[#f0ad4e]")},[null==(a=je.value)?void 0:a.web_scaning_times])]}})}]:[],{type:"custom",render:()=>w(h,{class:"ml-1rem",isRequest:!1,pluginInfo:we.value},null)}]}),{BtTable:Re,BtPage:Te,BtRefresh:Ie,BtTableCategory:We,BtRecommendSearch:Ee,BtColumn:He,BtBatch:Ae,BtErrorMask:De,refresh:Oe,categoryRef:Ve,config:qe}=t({request:async e=>{const{type:a,...t}=e,l=await Pe({type:s(a)||"all"===a?"-1":a,...t,table:"sites",order:qe.order||""}),o=$("/site/php_column");return l.data.forEach(e=>{e.isWaf=!(null==o?void 0:o.length)||o[1].isCustom}),ee.value=l.data,l},sort:async({column:e,prop:a,order:t})=>{let s=a;if(t){let e={orderName:s,orderStatus:"ascending"===t?"asc":"desc"};qe.order="".concat(e.orderName," ").concat(e.orderStatus)}else s="",await _(),qe.order="";Oe()},columns:[A({type:"page",key:"id"}),{subtitle:"WAF图标",isCustom:!0,isLtd:!0,isHide:!0,showClick:e=>{qe.data.forEach(a=>{a.isWaf=e})}},M({label:"网站名",type:xe.value,openPlugin:ae,onClick:te}),D({width:80,sortable:"custom",event:ce,data:["已停止","运行中"]}),{label:"备份",width:65,isCustom:!0,render:e=>w("span",{onClick:()=>se(e),class:"".concat(e.backup_count?"text-[#20a53a]":"text-warning"," cursor-pointer")},[e.backup_count?"有(".concat(e.backup_count,")"):"无备份"])},O({prop:"path",labelClassName:"php-table-path",minWidth:140}),...he.value?[{...V({event:e=>te({...e,tabName:"flowQuota"},"directory")}),isCustom:!1},{label:"日流量",width:80,isCustom:!0,isLtd:!0,render:e=>{var a,t;return"free"===ke.value?w("span",{class:"cursor-pointer bt-link",onClick:()=>{le(e)}},[j("查看")]):be.value.total?(null==(a=null==e?void 0:e.net)?void 0:a.hasOwnProperty("one_day_total_flow"))?l((null==(t=null==e?void 0:e.net)?void 0:t.one_day_total_flow)||0,!0,2):"--":w("span",{class:"cursor-pointer bt-link",onClick:()=>{le(e)}},[j("查看")])}}]:[],F(),q({table:"sites",minWidth:110,width:"auto"}),{label:"PHP",isCustom:!0,minWidth:80,width:80,render:e=>{let a=!e.php_version_status;return w("span",{class:"cursor-pointer "+(a&&"静态"!==e.php_version?"bt-warn":"bt-link"),onClick:()=>te(e,"php")},[a&&"静态"!==e.php_version?e.php_version+"[未安装]":"其它"==e.php_version?"自定义":e.php_version])}},J({onClick:e=>{te(e,"ssl")}}),N([{onClick:e=>{ae(e,"monitor-setting")},title:"统计"},{onClick:e=>{ae(e,"bt_waf")},title:"WAF"},{title:"设置",onClick:e=>te(e)},{title:"删除",onClick:e=>de(e)}])],extension:[Be,Se,o(Ce),n("search",{name:"sites",key:"php",list:oe.value}),i()],empty:()=>w("span",null,[j("您的列表为空，您可以"),w("span",{class:"bt-link",onClick:K},[j("添加一个项目")])])});return B(()=>{S(()=>{ne.value=Ve(),r(()=>import("./index356.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),r(()=>import("./index210.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),he.value&&ie()})}),(e,a)=>{const t=d,s=u,l=c;return L(),R("div",null,[w(m,{ref_key:"envRef",ref:Q,onInit:T(Oe)},null,8,["onInit"]),w(T(De)),w(l,null,{"header-left":I(()=>[w(T(Le)),W("div",{class:"flex items-center ml-1rem",onClick:a[0]||(a[0]=(...e)=>T(U)&&T(U)(...e))},[...a[2]||(a[2]=[W("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),W("span",{class:"bt-link"},"需求反馈",-1)])])]),"header-right":I(()=>[w(T(We),{class:"!w-[140px] mr-[10px]"}),w(T(Ee),{type:"php",placeholder:"请输入域名或备注",class:E(["mr-[10px]","!w-[".concat(T(ge),"px]")])},null,8,["class"]),w(T(Ie),{class:"mr-[10px]"}),w(T(He))]),content:I(()=>[w(T(Re))]),"footer-left":I(()=>[w(T(Ae))]),"footer-right":I(()=>[w(T(Te))]),popup:I(()=>[w(s,{title:"插件预览",modelValue:T(re),"onUpdate:modelValue":a[1]||(a[1]=e=>H(re)?re.value=e:null),area:66},{default:I(()=>[W("div",_e,[w(t,{data:T(pe)},null,8,["data"])])]),_:1},8,["modelValue"])]),_:1})])}}});export{ve as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
