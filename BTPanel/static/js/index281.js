import{v as a,l as t,L as e,K as s,aj as l,k as i,W as o,h as n,e as r}from"./utils-lib.js?v=1756369731";import{c as d,r as m,k as p,aB as u,p as c,G as _,q as b,v as f,e as g,A as v,y as h,B as x,H as j,x as w,z as y,ar as S,D as A,bN as D,bM as F}from"./base-lib.js?v=1756369731";import{_ as H}from"./index103.js?v=1756369731";import{_ as k}from"./index112.js?v=1756369731";import{_ as T}from"./index145.js?v=1756369731";import{a9 as V,aa as q,ab as C}from"./firewall.js?v=1756369731";import{u as E}from"./column.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const M={class:"flex items-center"},O={class:"p-[2rem]"},I={class:"mt-1rem detail-info"},L=r(d({__name:"index",setup(r){const d=m({total:0,loading:!1,data:[]}),L=p({p:1,limit:50}),N=p({visible:!1,data:{Describe:"",File:"",NewHash:"",OldHash:"",Status:0,Suggestion:"",Time:"",id:0}}),U=[{active:!0,content:"立即检测",event:()=>{R()}},{content:"检测目录",event:()=>{t({title:"检测目录",area:58,isAsync:!0,component:()=>e(()=>import("./index464.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})}}],z=[{content:"注意：初次使用请先添加检测目录，当前表格仅展示检测目录的结果"},{content:"检测内容主要以系统重要执行文件为主"},{content:"若出现风险项将在首页上展示"}],B=()=>{t({title:"定期扫描",area:48,isAsync:!0,showFooter:!0,component:()=>e(()=>import("./index465.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},P=[{label:"所在目录",prop:"File"},{label:"描述",prop:"Describe"},{label:"状态",prop:"Status",render:a=>u("span",{class:1!==a.Status?"text-primary":"text-warning"},1!==a.Status?"正常":"异常")},{label:"最后一次修改时间",prop:"Mtime",minWidth:120},E([{onClick:async a=>{s({request:V({path:a.File}),message:!0,success:a=>{a.status&&W()}})},title:"已处理",width:50},{onClick:a=>{N.visible=!0,N.data=a},title:"详情"}])],R=async()=>{s({request:q(),loading:"正在检测中，请稍后...",message:!0,success:a=>{a.status&&W()}})},W=async()=>{s({request:C(L),loading:S(d.value,"loading"),data:{data:[Array,S(d.value,"data")],page:[String,a=>{d.value.total=l(a)}]}})};return c(()=>{W()}),(t,e)=>{const s=T,l=A,r=i,m=k,p=H,u=o,c=D,S=F,V=n,q=_("bt-loading");return b(),f("div",null,[g(p,null,{"header-left":v(()=>[h("div",M,[g(s,{options:U}),e[4]||(e[4]=h("div",{class:"bg-[#ccc] w-1px h-2rem mx-8"},null,-1)),g(l,{type:"default",onClick:B},{default:v(()=>[...e[3]||(e[3]=[x("定期扫描",-1)])]),_:1})])]),content:v(()=>[j(g(r,{ref:"portTable",column:P,data:w(d).data,"max-height":"500",description:"文件完整性列表为空"},null,8,["data"]),[[q,w(d).loading],[q,"正在加载文件完整性列表，请稍后...","title"]])]),"footer-right":v(()=>[g(m,{page:w(L).p,"onUpdate:page":e[0]||(e[0]=a=>w(L).p=a),row:w(L).limit,"onUpdate:row":e[1]||(e[1]=a=>w(L).limit=a),total:w(d).total,onChange:W},null,8,["page","row","total"])]),_:1}),g(u,{options:z,class:"mx-[1.6rem] my-[0.6rem]"}),g(V,{title:"[".concat(w(N).data.File,"]详情"),modelValue:w(N).visible,"onUpdate:modelValue":e[2]||(e[2]=a=>w(N).visible=a),"show-footer":!1,area:[60]},{default:v(()=>[h("div",O,[g(S,{class:"margin-top table-descriptions",column:2,border:""},{default:v(()=>[g(c,{label:"文件大小"},{default:v(()=>[x(y(w(a)(w(N).data.Size)),1)]),_:1}),g(c,null,{label:v(()=>[...e[5]||(e[5]=[x("最近一次修改时间",-1)])]),default:v(()=>[x(" "+y(w(N).data.Mtime),1)]),_:1}),g(c,{span:2},{label:v(()=>[...e[6]||(e[6]=[x("创建时间",-1)])]),default:v(()=>[x(" "+y(w(N).data.Time),1)]),_:1}),g(c,null,{label:v(()=>[...e[7]||(e[7]=[x("建议",-1)])]),default:v(()=>[x(" "+y(w(N).data.Suggestion),1)]),_:1})]),_:1}),h("div",I,[h("div",null,[e[8]||(e[8]=h("div",{class:""},"文件路径",-1)),h("p",null,y(w(N).data.File),1)]),h("div",null,[e[10]||(e[10]=h("div",{class:""},"MD5",-1)),h("p",null,[x(" 新："+y(w(N).data.NewHash)+" ",1),e[9]||(e[9]=h("br",null,null,-1)),x(" 旧："+y(w(N).data.OldHash),1)])])])])]),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-e3d031de"]]);export{L as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
