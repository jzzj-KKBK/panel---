!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,a,o){var i=r&&r.prototype instanceof c?r:c,s=Object.create(i.prototype);return u(s,"_invoke",function(n,r,a){var o,u,i,c=0,s=a||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,u=0,i=e,p.n=n,l}};function d(n,r){for(u=n,i=r,t=0;!f&&c&&!a&&t<s.length;t++){var a,o=s[t],d=p.p,v=o[2];n>3?(a=v===r)&&(i=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(u=0,p.v=r,p.n=o[1]):d<v&&(a=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,p.n=v,u=0))}if(a||n>1)return l;throw f=!0,r}return function(a,s,v){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,v),u=s,i=v;(t=u<2?e:i)||!f;){o||(u?u<3?(u>1&&(p.n=-1),d(u,i)):p.n=i:p.v=i);try{if(c=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=e}else if((t=(f=p.n<0)?i:n.call(r,p))!==l)break}catch(t){o=e,u=1,i=t}finally{c=1}}return{value:t,done:f}}}(n,a,o),!0),s}var l={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(u(t={},r,function(){return this}),t),d=f.prototype=c.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,u(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=f,u(d,"constructor",f),u(f,"constructor",s),s.displayName="GeneratorFunction",u(f,a,"GeneratorFunction"),u(d),u(d,a,"Generator"),u(d,r,function(){return this}),u(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:i,m:v}})()}function u(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}u=function(e,t,n,r){function o(t,n){u(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},u(e,t,n,r)}function i(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function l(e,t,n,r,a,o,u){try{var i=e[o](u),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function u(e){l(o,r,a,u,i,"next",e)}function i(e){l(o,r,a,u,i,"throw",e)}u(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./index-legacy103.js?v=1756369731","./index-legacy123.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./column-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./useController-legacy6.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./masker.vue_vue_type_script_setup_true_lang-legacy.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./validator-legacy.js?v=1756369731","./index-legacy130.js?v=1756369731","./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang-legacy.js?v=1756369731"],function(e,n){"use strict";var r,u,l,s,f,p,d,v,m,h,y,w,b,g,_,j,O,k,P,S,x,D,E,A,F,T,W,C,V,M,G,H,q,R,I,U,z,B,L,N,K,$,J,Q,X,Y,Z,ee,te,ne,re,ae;return{setters:[function(e){r=e.R,u=e.at,l=e.o,s=e.K,f=e.aj,p=e.al,d=e.j,v=e.k,m=e.a0,h=e.W,y=e.b,w=e.e},function(e){b=e._},function(e){g=e._},function(e){_=e.c,j=e.r,O=e.k,k=e.g,P=e.e,S=e.B,x=e.F,D=e.p,E=e.G,A=e.H,F=e.x,T=e.q,W=e.v,C=e.M,V=e.C,M=e.P,G=e.A,H=e.y,q=e.al,R=e.n,I=e.D},function(e){U=e.a,z=e.g,B=e.u,L=e.c},function(e){N=e.getTamperRuleByPath,K=e.addWhiteDirs,$=e.addWhiteFiles,J=e.releaseWhiteDirname,Q=e.releaseWhiteFileExt,X=e.getActionLogsForDirname,Y=e.getActionLogsForFilename,Z=e.setWhiteDirWithPs,ee=e.removeWhiteDirs,te=e.removeWhiteFiles},function(e){ne=e.r},function(e){re=e.u},function(e){ae=e._},null,null,null,null,null],execute:function(){var n={class:"flex gap-col-1rem"},oe=_({__name:"white-list",props:{compData:{default:{}}},setup:function(e,w){var _=w.expose,oe=re().siteInfo,ue=y(),ie=j("dir"),le=j(),ce=j(!1),se=j(""),fe=j(!1),pe=j({}),de=j([]);j(!1),j(!1),j(),j(!1),O({sites:[],list:[]}),O({isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:""}});var ve=k(function(){return"dir"===ie.value?[{content:P(x,null,[S("此处允许使用全路径或目录名或路径的一部分如："),P("code",null,[S("/www/abc/cache/test/,test,cache/test/")])])},{content:P(x,null,[S("全路径首位必需为"),P("code",null,[S("/")]),S("，如："),P("code",null,[S("/www/abc/cache/test/")])])},{content:P(x,null,[S("录名或路径的一部分首位不能是"),P("code",null,[S("/")]),S("，如："),P("code",null,[S("cache/test/")]),S("或"),P("code",null,[S("test")])])},{content:P(x,null,[S("例1："),P("code",null,[S("/www/abc/")]),S("匹配:"),P("code",null,[S("/www/abc/*")]),S("不匹配："),P("code",null,[S("/www/abc")]),P("code",null,[S("/www/abc123")])])},{content:P(x,null,[S("例2："),P("code",null,[S("test")]),S("匹配："),P("code",null,[S("/www/test/1.txt")]),P("code",null,[S("/www/test_abc")]),S("不匹配："),P("code",null,[S("/www/1.php")])])},{content:P(x,null,[S("例3："),P("code",null,[S("cache/test/")]),S("匹配："),P("code",null,[S("/www/cache/test/1.txt")]),P("code",null,[S("/cache/test/")]),S("不匹配："),P("code",null,[S("/www/cache/test")]),P("code",null,[S("/cache/")])])}]:[{content:"支持以下5种方式"},{content:P(x,null,[S("1、完整文件路径，如："),P("code",null,[S("/www/wwwroot/test/123.php")])])},{content:P(x,null,[S("2、相对于网站的相对路径，如：全路径是"),P("code",null,[S("/www/wwwroot/test/app/123.php")]),S("相对路径"),P("code",null,[S("./app/123.php")])])},{content:P(x,null,[S("3、指定目录下的所有文件，如："),P("code",null,[S("/www/wwwroot/test/app/*")]),S("相对路径"),P("code",null,[S("./app/*")])])},{content:P(x,null,[S("4、指定目录下的指定文件类型，如："),P("code",null,[S("/www/wwwroot/test/app/*.php")]),S("相对路径"),P("code",null,[S("./app/*.php")])])},{content:P("span",{class:"text-danger"},[S("注意，已经在【受保护的文件类型】中被包含的文件无需专门设置规则")])}]}),me=function(){var e=c(o().m(function e(t,n,r,a){var u,l,s,f,p,d;return o().w(function(e){for(;;)switch(e.n){case 0:return u="dir"===ie.value,l=u?"目录":"文件",s=a.label,f=a.value,p=new Map([["start","批量开启选中的".concat(l,"白名单")],["stop","批量关闭选中的".concat(l,"白名单")],["delete","批量删除选中的".concat(l,"白名单")]]),d=function(){var e=c(o().m(function e(t,n){var r,a,l,c;return o().w(function(e){for(;;)switch(e.n){case 0:r=new Map([["start",u?J:Q],["stop",u?J:Q],["delete",u?ee:te]]),a=r.get(f),l=i({path_id:pe.value.pid},u?"dirname":"filename",t[u?"dir":"filename"]),c=f,e.n="start"===c||"stop"===c?1:"delete"===c?2:3;break;case 1:return l.release="start"===f?1:0,e.a(2,a(l));case 2:return l.path=pe.value.path,e.a(2,a(l));case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),e.n=1,t({title:"批量".concat(s),content:"".concat(p.get(f),"，是否继续操作？"),column:[{prop:"".concat(u?"dir":"filename"),label:"".concat(u?"文件全路径 或 相对路径":"文件类型")},L()],onConfirm:function(){var e=c(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n(d);case 1:return be(),e.a(2,!1)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),he=function(){return j([{label:"开启".concat("dir"==ie.value?"目录":"文件","白名单"),value:"start",event:me},{label:"关闭".concat("dir"==ie.value?"目录":"文件","白名单"),value:"stop",event:me},{label:"删除".concat("dir"==ie.value?"目录":"文件","白名单"),value:"delete",event:me}])},ye=function(){return j([U({key:"dir"}),{label:"dir"==ie.value?"目录":"文件名",prop:"dir"==ie.value?"dir":"filename"},"dir"==ie.value?z({minWidth:150,width:300,request:ke}):{label:"备注",prop:"ps"},{label:"状态",prop:"limit_status",width:50,render:function(e){var t=1===e.limit_status;return P(q,{size:"small",modelValue:t,"onUpdate:modelValue":function(e){return t=e},onChange:function(t){return _e(e,t)}},null)}},B([{title:"日志",onClick:Oe},{title:"删除",onClick:je}])])},we=j([{label:"目录白名单",name:"dir",lazy:!0,render:function(){return P("span",null,null)}},{label:"文件白名单",name:"file",lazy:!0,render:function(){return P("span",null,null)}}]),be=function(){var e=c(o().m(function e(){var t,n,i,l,c,s,f,p,d=arguments;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=d.length>0&&void 0!==d[0]&&d[0],e.p=1,t&&(ce.value=!0),e.n=2,N({path:oe.value.path});case 2:n=e.v,i=n.data,l=[],i.hasOwnProperty("status")&&(pe.value=i,"dir"==ie.value?(null==i||null===(c=i.unused_white_dirs)||void 0===c||c.forEach(function(e){l.push(a(a({},e),{},{ps:e.ps||"",limit_status:0}))}),null==i||null===(s=i.white_dirs)||void 0===s||s.forEach(function(e){var t,n=a(a({},e),{},{ps:e.ps||"",limit_status:1}),o=null==i||null===(t=i.temporarily_dirs)||void 0===t?void 0:t.find(function(t){return t.value===e.dir});o&&(n.time=o.time,n.ps="临时放行截止至"+r(o.time,"yyyy-MM-dd HH:mm:ss")),l.push(n)})):(f=i.white_files,i.unused_white_files.forEach(function(e){l.push({filename:e,limit_status:0,ps:"-"})}),f.forEach(function(e){var t,n={filename:e,limit_status:1,ps:"-"},a=null==i||null===(t=i.temporarily_files)||void 0===t?void 0:t.find(function(t){return t.value===e});a&&(n.time=a.time,n.ps="临时放行截止至"+r(a.time,"yyyy-MM-dd HH:mm:ss")),l.push(n)}))),de.value=l,e.n=4;break;case 3:e.p=3,p=e.v,u(p);case 4:return e.p=4,t&&(ce.value=!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=c(o().m(function e(){var t,n;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(""!==se.value){e.n=1;break}return e.a(2,ue.error("文件类型不能为空"));case 1:if(e.p=1,"dir"!=ie.value){e.n=3;break}return e.n=2,K({path_id:pe.value.pid,path:pe.value.path,dirnames:se.value});case 2:n=e.v,e.n=5;break;case 3:return e.n=4,$({path_id:pe.value.pid,path:pe.value.path,filename:se.value});case 4:n=e.v;case 5:t=n,ue.request(t),t.status&&(se.value="",be()),e.n=7;break;case 6:e.p=6,e.v;case 7:return e.a(2)}},e,null,[[1,6]])}));return function(){return e.apply(this,arguments)}}(),_e=function(){var e=c(o().m(function e(t,n){var r,a,u;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r="dir"==ie.value,e.p=1,!t.hasOwnProperty("time")){e.n=2;break}return R(function(){t.limit_status=!n,ue.error("临时放行文件无法修改状态")}),e.a(2);case 2:return t.limit_status=n?1:0,e.n=3,l({title:"".concat(n?"开启":"关闭","【").concat(r?t.dir:t.filename,"】"),content:"".concat(n?"开启该文件白名单后，该文件将不被保护，是否继续？":"关闭该文件白名单后，该文件将被保护，是否继续？")});case 3:return a=i(i({path_id:pe.value.pid},r?"dirname":"filename",t[r?"dir":"filename"]),"release",n?1:0),u=r?J:Q,e.n=4,s({loading:"正在设置白名单状态，请稍后...",request:u(a),message:!0});case 4:e.v.status&&be(),e.n=6;break;case 5:e.p=5,"cancel"===e.v&&(t.limit_status=n?0:1);case 6:return e.a(2)}},e,null,[[1,5]])}));return function(t,n){return e.apply(this,arguments)}}(),je=function(){var e=c(o().m(function e(t){var n,r,a,u;return o().w(function(e){for(;;)switch(e.n){case 0:return n="dir"===ie.value,r=n?"目录":"文件",e.n=1,l({title:"删除【".concat(n?t.dir:t.filename,"】"),content:"删除该".concat(r,"白名单后，该").concat(r,"将受到保护，是否继续操作？")});case 1:return a=i({path_id:pe.value.pid,path:pe.value.path},n?"dirname":"filename",t[n?"dir":"filename"]),u=n?ee:te,e.n=2,s({loading:"正在删除".concat(r,"白名单，请稍后..."),request:u(a),message:!0});case 2:e.v.status&&be();case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=c(o().m(function e(t){var n,r,l,c,s,p,d;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return n="dir"===ie.value,e.p=1,l=i(i(i(i({path_id:pe.value.pid},n?"dirname":"filename",t[n?"dir":"filename"]),"row",10),"pid",pe.value.pid),"p",1),c=n?X:Y,e.n=2,c(l);case 2:s=e.v,p=s.data,null!==(r=p.data)&&void 0!==r&&r.length?ne({title:"".concat("dir"===ie.value?"目录【".concat(t.dir,"】"):"文件【".concat(t.filename,"】"),"白名单日志"),row:t,data:p,params:a(a({},l),{},{total:f(p.page)})}):ue.error("暂无日志"),e.n=4;break;case 3:e.p=3,d=e.v,u(d);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=c(o().m(function e(t,n){return o().w(function(e){for(;;)switch(e.n){case 0:s({loading:"正在修改备注信息，请稍后...",request:Z({path_id:pe.value.pid,dir_name:t.dir,ps:n}),message:!0});case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Pe=ye(),Se=he(),xe=function(e){se.value="",ie.value=e,Pe.value=ye().value,Se.value=he().value,de.value=[],be()};return D(function(){be(!0)}),_({init:function(){be(!0)}}),function(e,r){var o,u=p,i=d,l=I,c=g,s=v,f=m,y=b,w=h,_=E("bt-loading");return A((T(),W("div",null,[null!==(o=F(pe))&&void 0!==o&&o.path?V("",!0):(T(),C(ae,{key:0,compData:a(a({},e.compData),{},{init:be})},null,8,["compData"])),P(u,{ref:"tamperRef",type:"",modelValue:F(ie),"onUpdate:modelValue":r[0]||(r[0]=function(e){return M(ie)?ie.value=e:null}),options:F(we),onChange:xe},null,8,["modelValue","options"]),P(y,null,{"header-left":G(function(){return[H("div",n,[P(i,{modelValue:F(se),"onUpdate:modelValue":r[1]||(r[1]=function(e){return M(se)?se.value=e:null}),width:"30rem",placeholder:"".concat("dir"===F(ie)?"目录名":"文件名")},null,8,["modelValue","placeholder"]),P(l,{type:"primary",onClick:ge},{default:G(function(){return t(r[2]||(r[2]=[S("添加",-1)]))}),_:1})])]}),"header-right":G(function(){return[P(c,{onRefresh:be})]}),content:G(function(){return[A(P(s,{ref_key:"whiteTableRef",ref:le,column:F(Pe),maxHeight:350,data:F(de)},null,8,["column","data"]),[[_,F(fe)]])]}),"footer-left":G(function(){return[P(f,{"table-ref":F(le),options:F(Se)},null,8,["table-ref","options"])]}),"footer-right":G(function(){return t(r[3]||(r[3]=[]))}),_:1}),P(w,{options:F(ve),class:"ml-2rem mt-2rem tamper-help-info leading-2rem"},null,8,["options"])])),[[_,F(ce)],[_,"正在获取站点防篡改信息，请稍侯","title"]])}}});e("default",w(oe,[["__scopeId","data-v-af75ef5a"]]))}}})}();
