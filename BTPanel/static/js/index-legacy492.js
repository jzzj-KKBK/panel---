!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function o(t,a,s,i){var o=a&&a.prototype instanceof l?a:l,u=Object.create(o.prototype);return r(u,"_invoke",function(t,r,a){var s,i,o,l=0,u=a||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return s=n,i=0,o=e,f.n=t,c}};function p(t,r){for(i=t,o=r,n=0;!d&&l&&!a&&n<u.length;n++){var a,s=u[n],p=f.p,m=s[2];t>3?(a=m===r)&&(o=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=p&&((a=t<2&&p<s[1])?(i=0,f.v=r,f.n=s[1]):p<m&&(a=t<3||s[0]>r||r>m)&&(s[4]=t,s[5]=r,f.n=m,i=0))}if(a||t>1)return c;throw d=!0,r}return function(a,u,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,m),i=u,o=m;(n=i<2?e:o)||!d;){s||(i?i<3?(i>1&&(f.n=-1),p(i,o)):f.n=o:f.v=o);try{if(l=2,s){if(i||(a="next"),n=s[a]){if(!(n=n.call(s,o)))throw TypeError("iterator result is not an object");if(!n.done)return n;o=n.value,i<2&&(i=0)}else 1===i&&(n=s.return)&&n.call(s),i<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),i=1);s=e}else if((n=(d=f.n<0)?o:t.call(r,f))!==c)break}catch(n){s=e,i=1,o=n}finally{l=1}}return{value:n,done:d}}}(t,s,i),!0),u}var c={};function l(){}function u(){}function d(){}n=Object.getPrototypeOf;var f=[][s]?n(n([][s]())):(r(n={},s,function(){return this}),n),p=d.prototype=l.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,r(p,"constructor",d),r(d,"constructor",u),u.displayName="GeneratorFunction",r(d,i,"GeneratorFunction"),r(p),r(p,i,"Generator"),r(p,s,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:o,m:m}})()}function r(e,n,t,a){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}r=function(e,n,t,a){function i(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?s?s(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},r(e,n,t,a)}function a(e,n,t,r,a,s,i){try{var o=e[s](i),c=o.value}catch(e){return void t(e)}o.done?n(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(r,s){var i=e.apply(n,t);function o(e){a(i,r,s,o,c,"next",e)}function c(e){a(i,r,s,o,c,"throw",e)}o(void 0)})}}System.register(["./index-legacy117.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./validator-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./column-legacy.js?v=1756369731"],function(n,r){"use strict";var a,i,o,c,l,u,d,f,p,m,v,g,y,b,w,h,x,k,_,S,E,T,j,C,O,F,M,I,P,A,H,G,L,D,z,q,B,J,N,R;return{setters:[function(e){a=e._},function(e){i=e.c,o=e.r,c=e.k,l=e.g,u=e.p,d=e.G,f=e.H,p=e.x,m=e.q,v=e.v,g=e.y,y=e.e,b=e.M,w=e.F,h=e.B,x=e.z,k=e.C,_=e.A,S=e.J,E=e.a_,T=e.K,j=e.I,C=e.D,O=e.a$,F=e.bv,M=e.bw},function(e){I=e.u,P=e.o,A=e.R,H=e._,G=e.d,L=e.c,D=e.b,z=e.ah,q=e.e},function(e){B=e.j,J=e.p},function(e){N=e.scanSingleSite},function(e){R=e.u},null,null,null],execute:function(){var r={id:"safeDetectList"},$={key:0},K={class:"progress-header"},U={class:"progress-header-cot"},Q={class:"flex items-center"},V={key:0,class:"scan-icon relative h-[8rem] w-[8rem] flex"},W={key:1},X={class:"progress-header-cot"},Y={class:"scanning-progress-title"},Z={class:"text-danger"},ee={class:"scanning-progress-cont"},ne={class:"progress-header-cot"},te={class:"progress-cont-list"},re={key:0},ae={class:"inline-grid grid-cols-4 w-full mt-20px"},se=["onClick"],ie={class:"progress_type"},oe={class:"flex-1"},ce={key:0,class:"text-danger mr-4px"},le={key:1},ue={key:2,class:"text-primary"},de={key:3},fe={class:"progress_fold text-[1.2rem] flex items-center"},pe={class:"mr-4px"},me={class:"progress_item_body"},ve={class:"flex items-center justify-between w-full"},ge={class:"flex items-center ml-12px"},ye=["innerHTML"],be={class:"flex flex-col py-[1rem] px-[1.6rem] text-[1.2rem] progress_item_info"},we={class:"flex items-center"},he=["innerHTML"],xe={class:"flex"},ke=["innerHTML"],_e=i({__name:"index",setup:function(n,i){var q,_e=i.expose,Se=D(),Ee=R().siteInfo,Te=I().payment,je=Te.value.authType,Ce=o(!1),Oe=o([{name:"webscan",title:"网站配置安全性"},{name:"filescan",title:"文件泄露"},{name:"backup",title:"备份文件"},{name:"index",title:"首页内容风险"},{name:"webhorse",title:"挂马排查"},{name:"deadchain",title:"坏链检测"},{name:"database",title:"数据库安全"},{name:"ftps",title:"网站FTP风险"},{name:"backend",title:"网站后台安全"}]),Fe=o(0),Me=o(""),Ie=o(""),Pe=c({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{},statusTotal:{},result:{},progressStatus:{},active:{}}),Ae=null,He=c({0:{text:"警告",bg:"rgba(252, 109, 38, 0.1)",color:"#fc6d26"},1:{text:"低危",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"中危",bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:"高危",bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),Ge=c({title:"安全扫描-功能介绍",height:36,ps:"扫描服务器系统的漏洞，异常用户，已安装软件的安全问题并提供修复方案.",source:66,desc:["漏洞扫描","网站配置安全性","文件泄露","备份文件","木马程序"],tabImgs:["https://www.bt.cn/Public/new/plugin/introduce/site/security-Introduction.png"]}),Le=function(){Ae=z({route:"/ws_project",onMessage:Be})},De=function(e){"free"==je&&J({sourceId:65})},ze=l(function(){return Pe.scanStatus&&!Pe.isEnd?"正在扫描":"定期扫描网站，提升网站安全性"}),qe=l(function(){return Pe.scanStatus&&!Pe.isEnd?"".concat(Me.value||""):Pe.time?"上次检测时间：".concat(Pe.time):"当前安全风险未知，请立即检测"}),Be=function(e,n){if(n.data){var t=JSON.parse(n.data.replace(/'/g,'"'));if(t.hasOwnProperty("end")&&t.end){var r,a,s;if((null===(r=t.webinfo)||void 0===r||null===(r=r.result)||void 0===r?void 0:r[t.type].length)>0?(Pe.progressConfig[t.type]=t.webinfo.result[t.type],Pe.statusTotal[t.type]=t.webinfo.result[t.type].length):Pe.statusTotal[t.type]=0,Me.value=t.info,Fe.value===Oe.value.length-1)return null===(s=Ae)||void 0===s||s.close(),Fe.value=0,Pe.scanStatus=!1,void(Pe.isEnd=!0);var i=(new Date).getTime();Fe.value++,null===(a=Ae)||void 0===a||a.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:i,name:Ee.value.name,scan_list:[Oe.value[Fe.value].name]})}else Me.value=t.info,Ie.value=t.type,t.is_error&&Pe.error++}},Je=function(){var e=s(t().m(function e(){var n,r,a,s,i;return t().w(function(e){for(;;)switch(e.n){case 0:if(Pe.scanStatus&&!Pe.isEnd||Pe.isEnd,!Pe.scanStatus||Pe.isEnd){e.n=2;break}return e.n=1,P({title:"取消扫描",content:"确定取消扫描吗?",icon:"warning"});case 1:return null===(a=Ae)||void 0===a||a.close(),Fe.value=0,Ne(),e.a(2);case 2:if(!Pe.isEnd){e.n=4;break}return e.n=3,null===(s=Ae)||void 0===s?void 0:s.close();case 3:return Fe.value=0,e.n=4,Ne();case 4:Pe.scanStatus=!0,Le(),i=(new Date).getTime(),null===(n=Ae)||void 0===n||n.send({"x-http-token":window.vite_public_request_token}),null===(r=Ae)||void 0===r||r.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:i,name:Ee.value.name,scan_list:[Oe.value[Fe.value].name]});case 5:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Ne=function(){Pe.scanStatus=!1,Pe.isEnd=!1,Pe.error=0,Pe.warn=0,Pe.time=0,Pe.progress=0,Pe.progressConfig={vulscan:[],webscan:[],filescan:[],backup:[],webshell:[],index:[],webhorse:[],deadchain:[],database:[],ftps:[],backend:[]},Pe.statusTotal={},Pe.result={},Pe.progressStatus={},Pe.active={vulscan:!1,webscan:!1,filescan:!1,backup:!1,webshell:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1}},Re=function(){var e=s(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if("ltd"===Te.value.authType){e.n=1;break}return e.a(2);case 1:return Ce.value=!0,e.p=2,e.n=3,N({data:JSON.stringify({name:Ee.value.name})});case 3:if((n=e.v).status){e.n=4;break}return Se.request(n),e.a(2);case 4:Pe.isEnd=Pe.time||!1,Pe.time=A(n.data.time,"yyyy-MM-dd"),e.n=6;break;case 5:e.p=5,e.v;case 6:return e.p=6,Ce.value=!1,e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])}));return function(){return e.apply(this,arguments)}}();return u(function(){Re(),Ne()}),_e({onRefresh:(q=s(t().m(function e(){return t().w(function(e){for(;;)switch(e.n){case 0:Re(),Ne();case 1:return e.a(2)}},e)})),function(){return q.apply(this,arguments)})}),function(n,t){var s=H,i=C,o=O,c=G,l=L,u=F,I=M,P=a,A=d("bt-loading");return f((m(),v("div",r,["ltd"===p(Te).authType?(m(),v("div",$,[g("div",K,[g("div",U,[g("div",Q,[p(Pe).scanStatus&&!p(Pe).isEnd?(m(),v("div",V,[t[0]||(t[0]=g("div",{class:"animate-spin absolute top-0 border-[#F39C12] border-b-2 rounded-full h-full w-full bg-#cccccc00"},null,-1)),y(s,{icon:"scanning-danger",size:60,color:"#F39C12",class:"m-auto"})])):(m(),v("div",W,[p(Pe).warn||p(Pe).error?(m(),b(s,{key:0,icon:"scanning-danger",size:70,color:"#ef0808"})):(m(),b(s,{key:1,icon:"scanning-"+(p(Pe).isEnd?"success":"danger"),size:72,color:p(Pe).isEnd?"#20a53a":"#F39C12"},null,8,["icon","color"]))]))])]),g("div",X,[g("div",Y,[p(Pe).isEnd?(m(),v(w,{key:1},[t[3]||(t[3]=h(" 检测完成 ",-1)),p(Pe).error>0||p(Pe).warn>0?(m(),v(w,{key:0},[t[2]||(t[2]=h(" ，共发现 ",-1)),p(Pe).error>0?(m(),v(w,{key:0},[g("span",Z,x(p(Pe).error),1),t[1]||(t[1]=h(" 项风险 ",-1))],64)):k("",!0)],64)):k("",!0)],64)):(m(),v(w,{key:0},[h(x(p(ze)),1)],64))]),g("div",ee,x(p(qe)),1)]),g("div",ne,[y(i,{class:S({"warning-hover":p(Pe).scanStatus&&!p(Pe).isEnd}),type:p(Pe).scanStatus&&!p(Pe).isEnd?"warning":"primary",onClick:Je,plain:!(!p(Pe).scanStatus||p(Pe).isEnd)},{default:_(function(){return[h(x(p(Pe).scanStatus&&!p(Pe).isEnd?"取消扫描":p(Pe).isEnd?"重新检测":"立即检测"),1)]}),_:1},8,["class","type","plain"]),p(Pe).isEnd?(m(),b(i,{key:0,type:"default",onClick:p(B)},{default:_(function(){return e(t[4]||(t[4]=[h(" 立即修复 ",-1)]))}),_:1},8,["onClick"])):k("",!0)])]),y(o,{class:"!mt-0 !mb-20px !bg-[#F1F1F1]"}),g("div",te,[p(Pe).scanStatus||p(Pe).isEnd?k("",!0):(m(),v("div",re,[t[5]||(t[5]=g("div",{class:"font-bold text-[1.6rem] text-[#666] mb-[2rem]"},"支持网站以下安全扫描项:",-1)),g("div",ae,[(m(!0),v(w,null,E(p(Oe),function(e,n){return m(),v("div",{key:n,class:"flex flex-col inline-block items-center mb-[20px]"},[y(c,{class:"w-[4rem] inline-block mb-8px opacity-90",src:"/scan/scanning-"+e.name+"-ico.svg"},null,8,["src"]),h(" "+x(e.title),1)])}),128))])])),p(Pe).scanStatus||p(Pe).isEnd?(m(!0),v(w,{key:1},E(p(Oe),function(n,r){return m(),v("div",{key:r,class:S([n.name+"_item "+(p(Pe).active[n.name]?"active":""),"progress_item"])},[g("div",{class:"progress_item_header",onClick:function(e){return function(e){Pe.active[e]=!Pe.active[e]}(n.name)}},[g("div",ie,[g("span",null,x(n.title),1)]),g("div",oe,[p(Pe).statusTotal[n.name]?(m(),v("span",ce," 发现"+x(p(Pe).statusTotal[n.name])+"项危险 ",1)):k("",!0),p(Pe).scanStatus&&p(Ie)==n.name?(m(),v("span",le," 正在扫描... ")):k("",!0),p(Pe).scanStatus||p(Pe).statusTotal[n.name]?k("",!0):(m(),v("span",ue," 无风险项 ")),p(Pe).scanStatus&&p(Ie)!=n.name&&!p(Pe).statusTotal[n.name]?(m(),v("span",de," 等待扫描 ")):k("",!0)]),g("div",fe,[g("span",pe,x(p(Pe).active[n.name]?"收起":"展开"),1),g("i",{class:S(p(Pe).active[n.name]?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down")},null,2)])],8,se),f(g("div",me,[y(I,{accordion:""},{default:_(function(){return[(m(!0),v(w,null,E(p(Pe).progressConfig[n.name],function(n,r){return m(),b(u,{key:r,disabled:"free"==p(je)},{title:_(function(){return[g("div",ve,[g("div",ge,[g("span",{class:"text-[1.2rem] h-[2.2rem] flex items-center px-[8px] rounded-[0.2rem] mr-[1rem]",style:T({color:p(He)[n.dangerous||0].color,backgroundColor:p(He)[n.dangerous||0].bg})},x(p(He)[n.dangerous||0].text),5),g("span",{innerHTML:n.name},null,8,ye)]),y(l,{class:"mb-2px mr-4px",onClick:De},{default:_(function(){return e(t[6]||(t[6]=[h(" 详情 ",-1)]))}),_:1})])]}),default:_(function(){return[g("div",be,[g("div",we,[t[7]||(t[7]=g("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 详情： ",-1)),g("span",{class:"leading-[1.6rem]",innerHTML:n.name},null,8,he)]),y(o,{class:"!my-8px"}),g("div",xe,[t[8]||(t[8]=g("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 修复方案： ",-1)),g("span",{innerHTML:n.repair},null,8,ke)])])]}),_:2},1032,["disabled"])}),128))]}),_:2},1024)],512),[[j,p(Pe).active[n.name]]])],2)}),128)):k("",!0)])])):(m(),b(P,{key:1,data:p(Ge)},null,8,["data"]))])),[[A,p(Ce)]])}}});n("default",q(_e,[["__scopeId","data-v-d448d5ed"]]))}}})}();
