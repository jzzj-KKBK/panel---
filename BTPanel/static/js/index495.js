import{c as a,s as e,k as s,r as l,p as t,q as o,v as r,e as n,A as c,x as i,B as u,y as m,al as d,a9 as p,a7 as f}from"./base-lib.js?v=1756369731";import{_ as v}from"./validator.js?v=1756369731";import{u as y,K as _,j as h,b as j,e as b}from"./utils-lib.js?v=1756369731";import{aV as w,aW as x}from"./firewall.js?v=1756369731";import{H as V}from"./index317.js?v=1756369731";import{H as g}from"./store8.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";import"./store5.js?v=1756369731";const k={class:"p-[2rem]"},C={class:"tip"},H=b(a({__name:"index",emits:["close"],setup(a,{expose:b,emit:H}){const S=V(),T=g(),{repairTypeActive:U}=e(S),{isMalwareConfirm:q}=e(T),A=H,{payment:B}=y(),{authType:D}=B.value,F=j(),I=s({cycle:"0",channel:[],status:!1}),K=l(),M=l(!1),N=async(a=!1)=>{const{data:e}=await w();I.cycle=e.cycle,I.channel=""===e.channel?[]:e.channel.split(","),I.status=!!e.status,a&&F.success("刷新成功")};return b({onConfirm:async()=>{if("ltd"!==D)return F.error("抱歉！该功能为企业版专享功能！");I.channel=I.channel.filter(a=>a);let a=I.channel.join(",");a||!I.status?(await K.value.validate(),_({loading:M,request:x({day:Number(I.cycle),channel:a,status:I.status?1:0}),message:!0,success:a=>{a.status&&(N(),"overview"===U.value&&(q.value=!0,T.capabilitySwitch.vul_scan.status=I.status,T.getSafeOverviewData()),A("close"))}})):F.error("请选择告警方式")}}),t(()=>{N()}),(a,e)=>{const s=d,l=p,t=h,y=v,_=f;return o(),r("div",k,[n(_,{model:i(I),ref_key:"safeScanForm",ref:K,disabled:i(M)},{default:c(()=>[n(l,{label:"自动扫描"},{default:c(()=>[n(s,{modelValue:i(I).status,"onUpdate:modelValue":e[0]||(e[0]=a=>i(I).status=a)},null,8,["modelValue"])]),_:1}),n(l,{label:"周期",prop:"cycle"},{default:c(()=>[n(t,{class:"!w-[14rem]",modelValue:i(I).cycle,"onUpdate:modelValue":e[1]||(e[1]=a=>i(I).cycle=a),min:0,type:"number",textType:"天"},{append:c(()=>[...e[4]||(e[4]=[u(" 天 ",-1)])]),_:1},8,["modelValue"])]),_:1}),n(l,{label:"告警方式",prop:"give"},{default:c(()=>[n(y,{class:"!w-[36rem]",modelValue:i(I).channel,"onUpdate:modelValue":e[2]||(e[2]=a=>i(I).channel=a),limit:["sms","wx_account"]},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),m("div",C,[m("ul",null,[m("li",null,[e[5]||(e[5]=u(" 点击配置后状态未更新，尝试点击【 ",-1)),m("span",{class:"text-[#20a53a] hover:text-[#1d9534] cursor-pointer",onClick:e[3]||(e[3]=a=>N(!0))},"手动刷新"),e[6]||(e[6]=u(" 】 ",-1))])])])])}}}),[["__scopeId","data-v-00192d90"]]);export{H as default};
