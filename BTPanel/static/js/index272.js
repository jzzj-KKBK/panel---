import{l as e,L as a,K as r,S as t,J as o,k as s,a0 as l,o as i}from"./utils-lib.js?v=1756369731";import{_ as n}from"./index103.js?v=1756369731";import{_ as p}from"./index112.js?v=1756369731";import{c as d,r as _,k as m,p as u,G as c,q as f,v as w,x as v,M as b,A as j,e as g,C as y,B as P,P as h,H as T,D as x}from"./base-lib.js?v=1756369731";import{_ as A}from"./index130.js?v=1756369731";import{D as S,E}from"./firewall.js?v=1756369731";import{a as k}from"./column.js?v=1756369731";import{r as q,e as C,f as D}from"./useMethod6.js?v=1756369731";import{_ as I}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1756369731";import{g as V}from"./useStore5.js?v=1756369731";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./validator.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";const H={class:"min-h-[30rem]"},L=d({__name:"index",setup(d){const{refs:{systemTabActive:L,firewallInfo:U}}=V(),M=_(),R=_([]),B=_(""),G=_(0),J=_(!1),K=m({p:1,row:20}),O=(r,t)=>{e({title:r?"修改端口转发规则":"添加端口转发规则",area:44,component:()=>a(()=>import("./add-port-transmit.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!0,compData:{...t,isEdit:r,refreshFn:z}})},z=async()=>{"forward"===L.value&&await r({loading:J,request:S({query:B.value}),data:{data:[Array,R],page:t(G)}})},N=(e,a)=>({operation:a,protocol:e.Protocol.toLowerCase(),S_Address:e.S_Address,S_Port:e.S_Port,T_Address:e.T_Address,T_Port:e.T_Port}),Q=[k(),{label:"协议",prop:"Protocol"},{label:"源端口",prop:"S_Port"},{label:"目标IP",render:e=>e.T_Address?e.T_Address:"127.0.0.1"},{label:"目标端口",prop:"T_Port"},{label:"时间",prop:"addtime",renderHeader:()=>q("时间","-- : 表示面板数据库中未记录创建时间，规则从系统中直接读取，忽略即可")},{label:"备注",prop:"brief"},C({editEvent:e=>{O(!0,e)},deleteEvent:async e=>{await i({icon:"warning-filled",title:"删除端口转发规则【源端口："+e.S_Port+" -> 目标端口："+e.T_Port+"】",content:"删除选中规则后，该源端口将停止转发至目标端口，是否继续操作？"}),await r({loading:"正在删除IP规则，请稍后...",request:E(N(e,"remove")),message:!0,success:z})}})],W=[{label:"删除",value:"delete",event:async(e,a)=>{await D(e,a,async(e,a)=>await E(N(e,"remove")),{label:"端口",prop:"T_Address"},z)}}];return u(()=>z()),(e,a)=>{const r=A,t=x,i=o,d=s,_=l,m=p,u=n,S=c("bt-loading");return f(),w("div",H,[v(U).init_status?y("",!0):(f(),b(r,{key:0,width:"38rem"},{content:j(()=>[g(F)]),_:1})),g(u,null,{"header-left":j(()=>[g(t,{type:"primary",onClick:a[0]||(a[0]=e=>O())},{default:j(()=>[...a[6]||(a[6]=[P(" 添加端口转发 ",-1)])]),_:1}),g(I,{type:"forward",refreshFn:z})]),"header-right":j(()=>[g(i,{class:"!w-[32rem]",modelValue:v(B),"onUpdate:modelValue":a[1]||(a[1]=e=>h(B)?B.value=e:null),onSearch:a[2]||(a[2]=e=>z()),placeholder:"请输入端口/来源"},null,8,["modelValue"])]),content:j(()=>[T(g(d,{ref_key:"portTransmitRef",ref:M,column:Q,data:v(R),description:"端口转发列表为空"},null,8,["data"]),[[S,v(J)],[S,"正在加载端口转发列表，请稍后...","title"]])]),"footer-left":j(()=>[g(_,{"table-ref":v(M),options:W},null,8,["table-ref"])]),"footer-right":j(()=>[g(m,{total:v(G),page:v(K).p,"onUpdate:page":a[3]||(a[3]=e=>v(K).p=e),row:v(K).row,"onUpdate:row":a[4]||(a[4]=e=>v(K).row=e),onChange:a[5]||(a[5]=e=>z()),name:"forward"},null,8,["total","page","row"])]),_:1})])}}});export{L as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
