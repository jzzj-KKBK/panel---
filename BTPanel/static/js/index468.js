import{c as e,g as a,q as t,v as s,y as l,B as i,z as r,x as n,C as o,J as c,s as d,F as m,a_ as u,e as p,a$ as _,k as f,b4 as v,A as y,aQ as x,r as b,G as h,H as g,P as k,aA as w,aC as D,bN as V,bM as S,w as j,n as A,b8 as C,b9 as L}from"./base-lib.js?v=1756369731";import{H as M}from"./store8.js?v=1756369731";import{e as T,u as z,o as E,K as H,l as I,L as F,M as O,bm as U,af as N,R as P,k as q,h as B}from"./utils-lib.js?v=1756369731";import{l as Q,r as R,t as W,u as G,v as J}from"./store5.js?v=1756369731";import{getPluginInfo as K}from"./site.js?v=1756369731";import{H as $}from"./index317.js?v=1756369731";import{l as X}from"./validator.js?v=1756369731";import{u as Y}from"./column.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const Z={class:"risk-chart"},ee={class:"circle-box"},ae={class:"circle-box-inner"},te={class:"circle-box-value"},se={class:"circle-box-desc"},le={class:"flex-1 ml-[2rem] mr-[4rem] mt-[2rem]"},ie={key:0,class:"mb-[1rem]"},re=T(e({__name:"totalScore",setup(e){const d=M(),{scoreData:m}=d,u=[{color:"#ef0808",percentage:60,type:"danger"},{color:"#f0ad4e",percentage:80,type:"warn"},{color:"#e8d544",percentage:90,type:"alert"},{color:"#20a53a",percentage:100,type:"safe"}],p=a(()=>u.find(e=>m.score<e.percentage));return(e,a)=>{var d;return t(),s("div",{class:c(["flex mt-[2rem] ml-[1rem] items-center","circle-".concat(null==(d=n(p))?void 0:d.type)])},[l("div",Z,[l("div",ee,[a[1]||(a[1]=l("div",{class:"circle-box-bg"},null,-1)),l("div",ae,[l("div",te,[i(r(n(m).score)+" ",1),a[0]||(a[0]=l("div",{class:"unit"},"分",-1))]),l("div",se,r(n(m).scoreLevel),1)])])]),l("div",le,[n(m).riskNum>0?(t(),s("div",ie,[a[2]||(a[2]=i("发现",-1)),l("span",null,r(n(m).riskNum),1),a[3]||(a[3]=i("条风险",-1))])):o("",!0),a[4]||(a[4]=l("template",null,[l("div",{class:"mb-[1rem]"},"无风险")],-1)),l("p",null,r(n(m).subtitle),1)])],2)}}}),[["__scopeId","data-v-c844ba38"]]),ne={class:"flex items-center justify-between text-[11px]"},oe={class:"text-[30px] mx-[0.4rem] text-primary"},ce={class:"leading-[2rem]"},de={class:"flex items-center"},me={class:"flex ml-[0.6rem]"},ue={class:"mr-[0.1rem]"},pe=["title","src"],_e={class:"flex ml-[1rem] text-[14px] text-bold"},fe={class:"flex items-center mr-[2rem]"},ve={class:"flex items-center mr-[2rem]"},ye={class:"flex items-center"},xe=e({__name:"defenseInfo",setup(e){z();const a=M(),{capabilitySwitch:o}=a,{safeDay:c,scanTime:f,virusUpdateTime:v,isMalwareConfirm:y}=d(a),x=async e=>{let a=e?"开启":"关闭",t=e?"将全天候检测系统是否存在恶意文件":"将不再检测系统是否存在恶意文件";try{await E({title:"".concat(a,"动态查杀"),content:"".concat(a,"后，").concat(t,"，是否继续？")}),o.file_detection.status=e,await H({loading:"正在保存配置，请稍后...",request:Q({dynamic_detection:e}),message:!0})}catch(s){o.file_detection.status=!e}},b=()=>{I({title:"设置自动扫描",area:54,component:()=>F(()=>import("./index495.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!0,close:()=>{y.value?y.value=!1:o.vul_scan.status=!o.vul_scan.status}})},h=async e=>{if(e){const{data:e}=await K({sName:"bt_hids"});e.setup?await a():(O.error("请先安装入侵检测插件"),o.hids.status=!1)}else await a();async function a(){const e=await R();O.request(e)}};return(e,a)=>{const d=_,y=U;return t(),s("div",null,[l("div",ne,[l("div",null,[a[3]||(a[3]=i(" 已累计保护您的资产",-1)),l("strong",oe,r(n(c)),1),a[4]||(a[4]=i("天 ",-1))]),l("div",ce,[l("div",de,[a[5]||(a[5]=l("span",null,"已开启安全能力",-1)),l("ul",me,[(t(!0),s(m,null,u(n(o),(e,a)=>(t(),s("li",ue,[l("img",{alt:"",title:e.name,src:"/static/images/home/".concat(e.icon).concat(e.status?"-active":"",".svg"),width:"14"},null,8,pe)]))),256))])]),l("div",null,"首页风险扫描时间："+r(n(f)),1),l("div",null,"病毒库版本更新时间："+r(n(v)),1)])]),p(d,{direction:"horizontal",class:"!mb-[1.8rem] !mt-0"}),l("div",_e,[l("div",fe,[a[6]||(a[6]=l("span",{class:"mr-2"},"恶意文件检测",-1)),p(y,{size:"small",modelValue:n(o).file_detection.status,"onUpdate:modelValue":a[0]||(a[0]=e=>n(o).file_detection.status=e),onChange:x},null,8,["modelValue"])]),l("div",ve,[a[7]||(a[7]=l("span",{class:"mr-2"},"漏洞扫描",-1)),p(y,{size:"small",modelValue:n(o).vul_scan.status,"onUpdate:modelValue":a[1]||(a[1]=e=>n(o).vul_scan.status=e),onChange:b},null,8,["modelValue"])]),l("div",ye,[a[8]||(a[8]=l("span",{class:"mr-2"},"入侵检测",-1)),p(y,{size:"small",modelValue:n(o).hids.status,"onUpdate:modelValue":a[2]||(a[2]=e=>n(o).hids.status=e),onChange:h},null,8,["modelValue"])])])])}}}),be={class:"my-10"},he={class:"flex h-[3.2rem]"},ge={class:"text-[30px] mr-[2rem]"},ke={class:"flex items-end alertNum"},we={class:"bg-[#ef0808]"},De={class:"bg-[#f0ad4e]"},Ve={class:"bg-[#a1a1a1]"},Se=T(e({__name:"pendingAlarm",setup(e,{expose:a}){const i=f({total:0,high_risk:0,medium_risk:0,low_risk:0}),o=v({tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{width:1,type:"solid"}}},grid:{top:"16%",left:"-8%",right:"0%",bottom:"0%",containLabel:!1},xAxis:{data:[],show:!1},yAxis:{show:!1},series:[]}),{BtECharts:c,getEChart:d,setOption:m,setQuickOption:u}=N({options:{}});return a({setData:async()=>{try{const{data:e}=await W(),a=e.trend_list.map(e=>P(e.timestamp)),t=e.trend_list.map(e=>e.count);o.xAxis={data:a,show:!1},o.series=((e=[0,0,0,0,0,0])=>[{name:"风险数量",type:"line",data:e,itemStyle:{color:"#ec958d"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#fcdcd5"},{offset:1,color:"#fcdcd5"}]}}}])(t),i.total=e.total,i.high_risk=e.high_risk,i.medium_risk=e.medium_risk,i.low_risk=e.low_risk,m(o)}catch(e){}}}),(e,a)=>(t(),s("div",be,[a[0]||(a[0]=l("div",null,"待处理风险",-1)),l("div",he,[l("span",ge,r(n(i).total),1),l("div",ke,[l("span",we,r(n(i).high_risk),1),l("span",De,r(n(i).medium_risk),1),l("span",Ve,r(n(i).low_risk),1)])]),p(n(c),{style:{height:"60px"}})]))}}),[["__scopeId","data-v-b8f2692d"]]),je={class:"flex flex-wrap mt-4"},Ae={class:"flex flex-col items-center w-[11rem] mb-[1rem]"},Ce=["onClick"],Le=T(e({__name:"pendingRisk",setup(e){const a=M(),{risk_details:i}=d(a),{riskInstallDetails:o}=a,{repairTypeActive:_}=d($());return(e,a)=>{const d=x;return t(),s("div",je,[(t(!0),s(m,null,u(n(i),(e,i)=>(t(),s("div",Ae,[l("div",null,[l("span",null,r(e.title),1),p(d,{content:e.tips,placement:"top"},{default:y(()=>[...a[0]||(a[0]=[l("span",{class:"ml-4px bt-ico-ask"},"?",-1)])]),_:2},1032,["content"])]),l("div",{class:c(["text-[22px] cursor-pointer",e.value>0?"text-[#333]":"text-[#777]"]),onClick:a=>(e=>{switch(e.type){case"vul_scan":_.value="web";break;case"file_detection":_.value="malware";break;case"homepage_risk":_.value="risk";break;case"safe_detect":_.value="safeDetect";break;case"hids":if(!o.hids)return O.error("请先安装入侵检测插件");X({name:"bt_hids"});break;case"tamper":if(!o.tamper)return O.error("请先安装堡塔企业级防篡改插件");X({name:"tamper_core"})}})(e)},r(e.value),11,Ce)]))),256))])}}}),[["__scopeId","data-v-d64df5d8"]]),Me={class:""},Te=e({__name:"securityTrend",setup(e,{expose:a}){const i=v({tooltip:{trigger:"axis",axisPointer:{type:"shadow",label:{show:!0}}},legend:{bottom:0,itemWidth:12,itemHeight:10,itemGap:10,textStyle:{fontSize:10,color:"#666666"},data:[]},grid:{top:"4%",right:"10%",bottom:"24%"},xAxis:[{type:"category",axisTick:{alignWithLabel:!0},axisLabel:{textStyle:{color:"#666666"}},data:[]}],yAxis:[{type:"value",min:0,axisLabel:{textStyle:{color:"#666666"}}}],series:[]}),{BtECharts:r,getEChart:o,setOption:c,setQuickOption:d}=N({options:{}}),m=(e,a=[],t)=>[{name:e,type:"line",lineStyle:{normal:{}},smooth:!0,showSymbol:!1,sampling:"average",data:a}],u=(e,a=[],t)=>[{name:e,type:"bar",barWidth:"8px",itemStyle:{normal:{color:t}},data:a}];return a({setData:async()=>{try{const{data:e}=await G(),a=[],t=[],s=[],l=[],r=[];e.trend_list.forEach(e=>{a.push(e.unhandled_risks),t.push(e.handled_risks),s.push(e.risk_scan),l.push(e.vul_scan),r.push(e.server_risks)}),i.xAxis[0].data=e.trend_list.map(e=>P(e.timestamp,"MM/dd")),i.series=[...m("未处理风险",a),...m("已处理风险",t),...u("首页",s,"rgb(29, 159, 234, 1)"),...u("漏洞",l,"rgb(30,67,180,1)"),...u("基线",r,"rgb(70,44,104,1)")],i.legend.data=["未处理风险","已处理风险","首页","漏洞","基线"],c(i)}catch(e){}}}),(e,a)=>(t(),s("div",Me,[a[0]||(a[0]=l("div",{class:"h-[4rem] leading-[4rem]"},"安全趋势",-1)),p(n(r),{class:"!h-[20rem]"})]))}}),ze={class:"p-[2rem]"},Ee=T(e({__name:"securityDynamic",setup(e,{expose:a}){const o=b("safeDynamic"),c=b(!1),d=b({type:"",behavior:"",level:0,time:"",scan_type:"",description:"",solution:""}),m=b({total:0,loading:!1,data:[]}),u=[{label:"风险行为",prop:"description",render:e=>p("span",{class:"truncate !w-[12rem]",title:e.description},[e.description])},{label:"风险等级",prop:"level",width:64,render:e=>{const{text:a,style:t}=_(e.level);return p("span",{style:t},[i("["),a,i("]")])}},{label:"发现时间",prop:"time",width:64,render:e=>P(e.time,"MM-dd")},Y([{onClick:e=>{c.value=!0,d.value=e},title:"详情"}])],_=e=>{switch(e){case 2:return{text:"中危",style:"color: #FF9900"};case 3:return{text:"高危",style:"color: #FF0000"};case 4:return{text:"紧急",style:"color: #ba281e"};default:return{text:"--",style:"color: #000000"}}};return a({getListData:async()=>{m.value.loading=!0;try{const{data:e}=await J();m.value.data=e.events}finally{m.value.loading=!1}}}),(e,a)=>{const f=q,v=w,x=D,b=V,j=S,A=B,C=h("bt-loading");return t(),s("div",null,[p(x,{modelValue:n(o),"onUpdate:modelValue":a[0]||(a[0]=e=>k(o)?o.value=e:null),class:"dynamic-tabs"},{default:y(()=>[p(v,{label:"安全动态",name:"safeDynamic"},{default:y(()=>[g(p(f,{ref:"malwareTable",column:u,data:n(m).data,"max-height":"185"},null,8,["data"]),[[C,n(m).loading],[C,"正在获取安全动态列表，请稍后...","title"]])]),_:1})]),_:1},8,["modelValue"]),p(A,{title:"【".concat(n(d).scan_type,"】详情"),modelValue:n(c),"onUpdate:modelValue":a[1]||(a[1]=e=>k(c)?c.value=e:null),area:53},{default:y(()=>[l("div",ze,[p(j,{column:2,size:"small",border:"",class:"table-descriptions"},{default:y(()=>[p(b,{label:"风险行为："},{default:y(()=>[i(r(n(d).behavior),1)]),_:1}),p(b,{label:"风险等级："},{default:y(()=>[i(r(_(n(d).level).text),1)]),_:1}),p(b,{label:"发现时间："},{default:y(()=>[i(r(n(P)(n(d).time,"yyyy-MM-dd HH:mm:ss")),1)]),_:1}),p(b,{label:"扫描类型："},{default:y(()=>[i(r(n(d).scan_type),1)]),_:1}),p(b,{label:"描述：",span:2},{default:y(()=>[i(r(n(d).description),1)]),_:1}),p(b,{label:"解决方案：",span:2},{default:y(()=>[i(r(n(d).solution),1)]),_:1})]),_:1})])]),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-1c77097b"]]),He=e({__name:"index",setup(e){const a=$(),i=M(),{repairTypeActive:r}=d(a),n=b(),o=b(),c=b();return j(r,e=>{"overview"===e&&A(()=>{i.getSafeOverviewData(),n.value.setData(),o.value.setData(),c.value.getListData()})},{immediate:!0}),(e,a)=>{const i=C,r=L,d=_;return t(),s("section",null,[a[0]||(a[0]=l("div",{class:"text-[1.8rem] mb-6"},"安全总览",-1)),p(r,null,{default:y(()=>[p(i,{span:13},{default:y(()=>[p(re)]),_:1}),p(i,{span:11},{default:y(()=>[p(xe)]),_:1})]),_:1}),p(r,null,{default:y(()=>[p(i,{span:13},{default:y(()=>[p(Se,{ref_key:"pendingAlarm",ref:n},null,512)]),_:1}),p(i,{span:11},{default:y(()=>[p(Le)]),_:1})]),_:1}),p(d,{direction:"horizontal",class:"!my-0"}),p(r,null,{default:y(()=>[p(i,{span:14},{default:y(()=>[p(Te,{ref_key:"securityTrend",ref:o},null,512)]),_:1}),p(i,{span:10},{default:y(()=>[p(Ee,{ref_key:"securityDynamic",ref:c},null,512)]),_:1})]),_:1})])}}});export{He as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
