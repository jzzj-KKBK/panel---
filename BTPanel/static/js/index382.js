import{c as e,s as a,g as l,e as s,H as t,I as o,B as r,D as i,r as u,p as n,q as d,v as m,A as p,y as c,x as f,ax as v,P as y,F as b,a_ as h,M as _,z as x,J as V,Q as g,C,a9 as A,ag as w,aQ as j,af as k,ai as T,aj as S,au as H,aw as U,S as I,a7 as P}from"./base-lib.js?v=1756369731";import{G as M,bg as N,bV as R,M as D,fi as E,a3 as z,j as B,$ as F,h as L,W as O,e as q}from"./utils-lib.js?v=1756369731";import{n as J}from"./form-item.js?v=1756369731";import{_ as Q}from"./input-popover.vue_vue_type_script_setup_true_lang.js?v=1756369731";import{f as G,g as K,h as W,j as $,k as X,n as Y,p as Z,q as ee,v as ae,w as le,x as se,y as te,z as oe,A as re,B as ie,D as ue,E as ne,F as de,G as me,H as pe,I as ce,J as fe,K as ve,L as ye,M as be,N as he,O as _e,P as xe,Q as Ve,R as ge,S as Ce}from"./useController13.js?v=1756369731";import{u as Ae,S as we}from"./useStore12.js?v=1756369731";import{applyBusSsl as je}from"./site.js?v=1756369731";import{c as ke}from"./useMethod11.js?v=1756369731";import{u as Te}from"./useStore11.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./index103.js?v=1756369731";import"./column.js?v=1756369731";import"./useStore4.js?v=1756369731";import"./useController6.js?v=1756369731";import"./validator.js?v=1756369731";import"./useController5.js?v=1756369731";import"./useMethod5.js?v=1756369731";import"./useController4.js?v=1756369731";import"./useStore10.js?v=1756369731";import"./ssl.js?v=1756369731";import"./useMethod10.js?v=1756369731";const Se={class:"px-3rem py-1.2rem"},He={class:"flex flex-col"},Ue=["innerHTML"],Ie={class:"mr-[2px]"},Pe=["onClick"],Me={key:1,class:"!caret-medium inline-flex items-center"},Ne={class:"flex justify-between"},Re={class:"flex flex-col p-[20px] error"},De={class:"p-[20px]"},Ee={class:"mb-[8px] border-light"},ze={class:"p-[20px]"},Be=q(e({__name:"index",props:{compData:{}},emits:["close"],setup(e,{emit:q}){const{activeTabs:Be,sslIsRefresh:Fe,testIsRefresh:Le,encryptIsRefresh:Oe,otherIsRefresh:qe}=a(Te()),{orderInfo:Je,sslDnsApiInfo:Qe,sslApplicationInfo:Ge}=Ae(),{verifyBusCertEvent:Ke,getCertAdminInfoEvent:We}=we(),$e=q,Xe=e,{BtForm:Ye,param:Ze}=M({data:G.value,options:e=>l(()=>[{type:"custom",render:()=>s(N,{label:"证书信息"},{default:()=>[s("span",{class:"text-primary"},[s("span",null,[Je.value.title]),t(s("span",null,[r("，包含"),Je.value.limit,r("个域名")]),[[o,Je.value.limit>1]])])]})},{type:"slots",key:"domains",rules:{domains:[R({message:"域名不能为空"})]}},{type:"slots",key:"sslVerifyType"},..."CNAME_CSR_HASH"===K.value?[{type:"slots",key:"dnsVerify"}]:[],J(W,"证书用户信息"),...W.value?[{type:"custom",render:()=>s(N,{label:"所在地区"},{default:()=>[s("div",{class:"flex flex-row"},[s(Q,{"custom-class":"mr-[16px] !w-[20rem]",modelValue:e.value.Administrator.state,"onUpdate:modelValue":a=>e.value.Administrator.state=a,"placeholder-tips":"请输入所在省份，必填项"},null),s(Q,{"custom-class":"!w-[20rem]",modelValue:e.value.Administrator.city,"onUpdate:modelValue":a=>e.value.Administrator.city=a,"placeholder-tips":"请输入所在市/县，必填项"},null)])]})},..."dv"!==Je.value.type?[{type:"custom",render:()=>s(N,{label:"公司详细地址"},{default:()=>[s(Q,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.address,"onUpdate:modelValue":a=>e.value.Administrator.address=a,"placeholder-tips":"请输入公司详细地址，具体要求见说明，必填项"},null)]})}]:[],{type:"custom",render:()=>s(N,{label:"公司名称"},{default:()=>[s(Q,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.organation,"onUpdate:modelValue":a=>e.value.Administrator.organation=a,"placeholder-tips":"请输入公司名称，如为个人申请请输入个人姓名，必填项"},null)]})},{type:"custom",render:()=>s(N,{label:"姓名"},{default:()=>[s(Q,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.name,"onUpdate:modelValue":a=>e.value.Administrator.name=a,"placeholder-tips":"请输入姓名，必填项"},null)]})},{type:"custom",render:()=>s(N,{label:"邮箱"},{default:()=>[s(Q,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.email,"onUpdate:modelValue":a=>e.value.Administrator.email=a,"placeholder-tips":"请输入邮箱地址，必填项"},null)]})},{type:"custom",render:()=>s(N,{label:"手机"},{default:()=>[s(Q,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.mobile,"onUpdate:modelValue":a=>e.value.Administrator.mobile=a,"placeholder-tips":"请输入手机号码，若为空，则使用当前绑定手机号"},null)]})}]:[],{type:"custom",render:()=>s(N,{label:" "},{default:()=>[s(i,{type:"primary",onClick:aa},{default:()=>[r("提交资料")]})]})},{type:"help",options:$.value}])}),ea=u(!1),aa=async()=>{var e,a;let l=null;if(!G.value.domains)return D.error("域名不能为空");if(X.value&&!E(G.value.domains))return D.error("IP证书申请域名格式错误，请输入正确的ipv4地址");if(!G.value.Administrator.state&&!G.value.Administrator.city)return D.error("所在地区不能为空");if(!G.value.Administrator.address&&"dv"!==Je.value.type)return D.error("公司详细地址不能为空");if(!G.value.Administrator.organation)return D.error("公司名称不能为空");if(!G.value.Administrator.name)return D.error("姓名不能为空");if(!G.value.Administrator.email)return D.error("邮箱不能为空");if(!G.value.Administrator.mobile)return D.error("手机不能为空");try{l=D.load("正在提交证书信息，请稍后...");const{job:s,postCode:t,country:o,firstName:r,lastName:i,name:u,state:n,city:d,address:m,organation:p,email:c,mobile:f}=G.value.Administrator,v=await je(JSON.stringify({pid:Je.value.pid,cert_ssl_type:Xe.compData.orderInfo.cert_ssl_type,oid:Je.value.oid,domains:null==(e=G.value.domains)?void 0:e.split("\n").filter(e=>e.trim()),dcvMethod:K.value,auth_to:Y.value,Administrator:{job:s,postCode:t,country:o,lastName:u,state:n,city:d,address:m,organation:p,email:c,mobile:f}}));if(z(v.data.msg)&&v.data.msg.hasOwnProperty("code")){let e=v.data.errors;Z.value=[],Object.keys(e).forEach(a=>{e[a].forEach((e,l)=>{Z.value.push({field:a,error:e})})}),ee.value=!0}else{let e=v.msg||v.data.msg,a=v.data.status;D.request(v.data||{msg:a?e||"提交成功":e||"资料提交错误，请检查管理员信息是否填写正确，如填写错误请联系客服重置订单",status:a})}if(v.data.status){$e("close");const e={ssl:()=>Fe.value=!0,test:()=>Le.value=!0,encrypt:()=>Oe.value=!0,other:()=>qe.value=!0};null==(a=e[Be.value])||a.call(e),ke(Je.value.oid,Je.value.cert_ssl_type,Je.value.pid),G.value.domains="",de.value=!1,ie.value=[{value:"CNAME_CSR_HASH",label:"DNS验证(CNAME解析)",tips:"如网站还未备案完成，可选【DNS验证】",isCheck:"",checkTips:[]},{value:"HTTP_CSR_HASH",label:"文件验证(HTTP)",tips:"如网站未开启301、302、强制HTTPS、反向代理功能，请选择HTTP",isCheck:"",checkTips:[]},{value:"HTTPS_CSR_HASH",label:"文件验证(HTTPS)",tips:"如网站开启【强制HTTPS】，请选【HTTPS验证】",isCheck:"",checkTips:[]}]}}catch(s){}finally{l&&l.close()}};return n(async()=>{const e=await We();Ge.value={...Ge.value,...e.data},ae(),le()}),(e,a)=>{const l=A,u=w,n=j,M=k,R=T,E=S,z=H,q=U,J=L,Q=I,G=O,W=P;return d(),m("div",Se,[s(f(Ye),{"label-width":"80px"},{domains:p(()=>[s(l,{label:"域名",prop:"domains"},{default:p(()=>[c("div",He,[s(f(v),{ref:"popover",placement:"top-start","popper-class":"green-tips-popover",title:"",width:"200",disabled:!f(se),visible:f(ea),"onUpdate:visible":a[2]||(a[2]=e=>y(ea)?ea.value=e:null),"trigger-keys":[],trigger:"focus"},{reference:p(()=>[s(f(B),{modelValue:f(Ze).domains,"onUpdate:modelValue":a[0]||(a[0]=e=>f(Ze).domains=e),disabled:!f(se),width:"42rem",resize:"none",rows:3,class:"disabled-input",type:f(se)?"textarea":"text",onFocus:a[1]||(a[1]=e=>ea.value=!0),placeholder:f(te)},null,8,["modelValue","disabled","type","placeholder"])]),default:p(()=>[c("div",{class:"bg-[#20a53a] text-white",innerHTML:f(te)},null,8,Ue)]),_:1},8,["disabled","visible"]),t(c("div",null,[s(f(i),{size:"small",type:"primary",onClick:f(oe)},{default:p(()=>[...a[13]||(a[13]=[r("选择已有域名",-1)])]),_:1},8,["onClick"]),s(f(i),{size:"small",type:"default",onClick:f(re)},{default:p(()=>[...a[14]||(a[14]=[r("自定义域名",-1)])]),_:1},8,["onClick"])],512),[[o,!f(se)]])])]),_:1})]),sslVerifyType:p(()=>[s(f(N),{label:"验证方式"},{default:p(()=>[s(M,{class:"!leading-[2.4rem]",modelValue:f(K),"onUpdate:modelValue":a[3]||(a[3]=e=>y(K)?K.value=e:null)},{default:p(()=>[(d(!0),m(b,null,h(f(ie),e=>(d(),m(b,{key:e.value},[f(ue)(f(ne),f(X),e)?(d(),_(n,{key:e.value,effect:"dark",content:e.tips,placement:"top-start",enterable:!1},{default:p(()=>[s(u,{value:e.value},{default:p(()=>[c("span",Ie,x(e.label),1),""!==e.isCheck?(d(),m("span",{key:0,class:V(["cursor-pointer",e.isCheck?"!text-primary":"!text-danger"]),onClick:g(a=>(e=>{D.msg({customClass:"el-error-html-message",dangerouslyUseHTMLString:!0,message:e.join("<br>"),type:"error"})})(e.checkTips),["stop"])}," ["+x(e.isCheck?"正常":"异常")+"] ",11,Pe)):C("",!0),f(de)?(d(),m("span",Me,[...a[15]||(a[15]=[r(" [ ",-1),c("i",{class:"svgtofont-el-loading mx-[2px]"},null,-1),c("span",{class:"align-middle"},"检测中",-1),r(" ] ",-1)])])):C("",!0)]),_:2},1032,["value"])]),_:2},1032,["content"])):C("",!0)],64))),128))]),_:1},8,["modelValue"])]),_:1})]),dnsVerify:p(()=>[s(f(N),{label:"选择DNS接口"},{default:p(()=>[s(E,{class:"mr-[16px] !w-[16rem]",modelValue:f(Y),"onUpdate:modelValue":a[4]||(a[4]=e=>y(Y)?Y.value=e:null),placeholder:"请选择",onChange:a[5]||(a[5]=e=>f(me)(!0))},{default:p(()=>[(d(!0),m(b,null,h(f(Qe),e=>(d(),_(R,{key:e.value,label:e.label,value:e.value},{default:p(()=>[c("span",Ne,[c("span",null,x(e.label),1),t(c("span",{class:V(e.data?"text-primary":"text-orange")},x(e.data?"[已配置]":"[未配置]"),3),[[o,e.config]])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),t(s(f(i),{class:"ml-[8px]",type:"default",onClick:a[6]||(a[6]=e=>f(me)(!1))},{default:p(()=>[...a[16]||(a[16]=[r("配置",-1)])]),_:1},512),[[o,"dns"!==f(Y)]])]),_:1})]),_:1}),s(J,{modelValue:f(ee),"onUpdate:modelValue":a[7]||(a[7]=e=>y(ee)?ee.value=e:null),area:50},{default:p(()=>[c("div",Re,[a[17]||(a[17]=c("span",{class:"flex items-center mb-[12px]"},[c("i",{class:"svgtofont-el-warning text-warning text-[4rem] mr-[4px]"}),c("span",{class:"text-[1.6rem]"},"当前提交信息存在以下问题，请解决后重新提交！")],-1)),s(q,{data:f(Z),border:""},{default:p(()=>[s(z,{prop:"field",label:"错误字段"}),s(z,{prop:"error",label:"错误信息"})]),_:1},8,["data"])])]),_:1},8,["modelValue"]),s(J,{title:"选择域名",modelValue:f(be),"onUpdate:modelValue":a[10]||(a[10]=e=>y(be)?be.value=e:null),area:57,"show-footer":!0,onConfirm:f(he)},{default:p(()=>[c("div",De,[s(Q,{class:"!w-[53rem] mb-[16px]",modelValue:f(pe),"onUpdate:modelValue":a[8]||(a[8]=e=>y(pe)?pe.value=e:null),placeholder:"支持字段模糊搜索",onInput:f(ce),clearable:""},null,8,["modelValue","onInput"]),c("div",Ee,[a[18]||(a[18]=c("div",{class:"flex justify-between items-center bg-[#f6f6f6] py-[1rem] pl-[1rem]"},"域名",-1)),s(f(F),{modelValue:f(fe),"onUpdate:modelValue":a[9]||(a[9]=e=>y(fe)?fe.value=e:null),options:f(ve),class:"custom-radio-group whitespace-nowrap py-[2px] w-full"},null,8,["modelValue","options"])]),s(G,{options:f(ye),class:"ml-[20px]"},null,8,["options"])])]),_:1},8,["modelValue","onConfirm"]),s(J,{title:"自定义域名",modelValue:f(ge),"onUpdate:modelValue":a[12]||(a[12]=e=>y(ge)?ge.value=e:null),area:57,"show-footer":!0,onConfirm:f(Ce)},{default:p(()=>[c("div",ze,[s(W,{class:"mb-[16px]",ref_key:"customDomainRef",ref:_e,model:f(xe),rules:f(Ve)},{default:p(()=>[s(l,{label:"自定义域名",prop:"domain"},{default:p(()=>[s(Q,{autofocus:"",class:"!w-[40rem] mb-[8px]",modelValue:f(xe).domain,"onUpdate:modelValue":a[11]||(a[11]=e=>f(xe).domain=e),placeholder:"请输入需要申请证书的".concat(f(X)?"IP（IP证书）":"域名（单域名证书）","，必填项，例如：").concat(f(X)?"192.168.1.1":"www.bt.cn")},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model","rules"]),s(G,{options:f(ye),class:"ml-[20px]"},null,8,["options"])])]),_:1},8,["modelValue","onConfirm"])])}}}),[["__scopeId","data-v-f5e08aac"]]);export{Be as default};
