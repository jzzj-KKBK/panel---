import{_ as a}from"./index103.js?v=1756369731";import{_ as e}from"./index112.js?v=1756369731";import{K as s,c as l,J as t,k as o,a0 as r,S as n}from"./utils-lib.js?v=1756369731";import{c as i,r as u,k as d,U as p,g as m,w as c,p as _,G as f,q as v,v as g,x as b,M as y,A as j,e as h,C as x,y as w,B as k,P as C,J as S,F as q,a_ as V,H as U,D as J,ai as A,aj as H,z as R}from"./base-lib.js?v=1756369731";import{_ as T}from"./index130.js?v=1756369731";import{g as L}from"./useStore2.js?v=1756369731";import{d as M,o as N,a as O,f as z,i as B,g as D,j as F}from"./useMethod4.js?v=1756369731";import{a as G,g as K,u as P}from"./column.js?v=1756369731";import{getModulesCloudServer as E,getModulesList as I}from"./database.js?v=1756369731";import{e as Q}from"./validator.js?v=1756369731";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1756369731";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";const Y={class:"flex items-center"},Z={class:"w-[20rem] truncate inline-block"},$=i({__name:"index",setup(i){const{refs:{isRefreshTable:$,isLoading:aa,isHaveServer:ea},resetRefresh:sa,refreshTableList:la}=L(),ta=u(null),oa=u([]),ra=d({total:0,page:1,row:10}),na=p([]),ia=u("all"),ua=u(""),da=u([]),pa=M().filter(a=>"back"!==a.value),ma=m(()=>!ea.value),ca=async()=>(await s({request:E({data:JSON.stringify({type:"sqlserver"})},"mongodb"),data:[Array,da]}),da.value.length||(ea.value=!1),da.value),_a=async()=>{let a={p:ra.page,limit:ra.row,tables:"databases",search:ua.value,sid:"all"===ia.value?"":ia.value};""===a.sid&&delete a.sid,await s({loading:aa,request:I({data:JSON.stringify(a)},"sqlserver"),data:{data:[Array,oa],page:n(ra)}})},fa=async()=>{_a(),await ca(),na.value=[G(),...z(B),D(da.value,"sqlserver"),K({table:"databases"}),P([{onClick:a=>B(a),title:"改密"},{onClick:a=>F(a),title:"删除"}])]};return c(()=>$.value,async a=>{a&&await _a(),sa()}),_(()=>fa()),(s,n)=>{const i=T,u=J,d=l,p=A,m=H,c=t,_=o,L=r,M=e,z=a,B=f("bt-loading");return v(),g("div",null,[b(ma)?(v(),y(i,{key:0},{content:j(()=>[h(X,{type:"SqlServer"})]),_:1})):x("",!0),h(z,null,{"header-left":j(()=>[w("div",Y,[h(u,{type:"primary",onClick:n[0]||(n[0]=a=>b(N)(ca))},{default:j(()=>[...n[6]||(n[6]=[k("添加数据库",-1)])]),_:1}),h(u,{onClick:b(O)},{default:j(()=>[...n[7]||(n[7]=[k("远程数据库",-1)])]),_:1},8,["onClick"]),h(W,{"comp-data":b(da),class:"ml-[10px]"},null,8,["comp-data"]),h(d,{onClick:n[1]||(n[1]=a=>b(Q)({name:"数据库",type:12})),icon:"desired",class:"ml-[12px]",iconClass:"text-1.6rem"},{default:j(()=>[...n[8]||(n[8]=[k("需求反馈",-1)])]),_:1})])]),"header-right":j(()=>[h(m,{modelValue:b(ia),"onUpdate:modelValue":n[2]||(n[2]=a=>C(ia)?ia.value=a:null),onChange:b(la),class:S(["!w-[14rem] mr-[8px]",{"custom-types-bg-green":"all"!==b(ia)}])},{default:j(()=>[h(p,{label:"全部",value:"all"}),(v(!0),g(q,null,V(b(da),(a,e)=>(v(),y(p,{key:e,label:"".concat("all"!==b(ia)?"已选：":"").concat(a.ps),value:a.id},{default:j(()=>[w("span",Z,R(a.ps),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onChange","class"]),h(c,{class:"w-[26rem]",modelValue:b(ua),"onUpdate:modelValue":n[3]||(n[3]=a=>C(ua)?ua.value=a:null),onSearch:b(la),placeholder:"请输入数据库名称/备注"},null,8,["modelValue","onSearch"])]),content:j(()=>[U(h(_,{ref_key:"sqlTableRef",ref:ta,column:b(na),data:b(oa)},null,8,["column","data"]),[[B,b(aa)]])]),"footer-left":j(()=>[h(L,{options:b(pa),"table-ref":b(ta)},null,8,["options","table-ref"])]),"footer-right":j(()=>[h(M,{total:b(ra).total,page:b(ra).page,"onUpdate:page":n[4]||(n[4]=a=>b(ra).page=a),row:b(ra).row,"onUpdate:row":n[5]||(n[5]=a=>b(ra).row=a),onChange:b(la)},null,8,["total","page","row","onChange"])]),_:1})])}}});export{$ as default};
