import{B as e}from"./index140.js?v=1756369731";import{u as a,o as l,K as t,ag as s,k as i,a0 as r,c as n,h as m,b as o,e as c}from"./utils-lib.js?v=1756369731";import{c as d,t as u,s as v,r as f,g as p,e as x,ba as w,w as y,G as _,q as b,v as h,y as g,x as k,F as j,z as V,a_ as C,K as D,P as S,A as q,B as F,H as M,D as T,al as H,a$ as z,f as U,aV as A}from"./base-lib.js?v=1756369731";import{_ as N}from"./index103.js?v=1756369731";import{H as P}from"./index317.js?v=1756369731";import{a as B,u as E}from"./column.js?v=1756369731";import{y as I,z as J,A as K,j as L}from"./store5.js?v=1756369731";import{S as O}from"./useStore4.js?v=1756369731";import{f as G}from"./useMethod6.js?v=1756369731";import"./ace.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./index104.js?v=1756369731";import"./site.js?v=1756369731";import"./firewall.js?v=1756369731";import"./useStore5.js?v=1756369731";const R={class:"text-right text-[#666] mb-2"},$={class:"flex mb-[1.6rem] p-[1.6rem] border-[0.1rem] border-[#efefef] rounded-[0.4rem]"},Q={class:"text-[1.2rem] text-[#666] mb-[1.6rem]"},W={class:"flex justify-between items-center"},X={class:"flex items-center"},Y={class:"flex items-center"},Z={key:1,class:"p-[1rem]"},ee={class:"flex justify-between items-center px-4"},ae={class:"text-[2rem]"},le=["innerHTML"],te={class:"text-[1.6rem] mt-[1.2rem]"},se={class:"text-[1.5rem]"},ie={class:"flex justify-center"},re={class:"p-[2rem]"},ne={class:"flex items-center mb-[1.6rem]"},me={class:"flex-1 truncate"},oe={class:"flex items-center mb-[1.6rem]"},ce={class:"flex-1 truncate"},de={class:"flex items-center mb-[1.6rem]"},ue={class:"flex-1 truncate"},ve={class:"flex items-center mb-[1.6rem]"},fe={class:"flex-1 truncate"},pe={class:"flex items-center mb-[1.6rem]"},xe={class:"flex-1 truncate"},we={class:"flex items-center mb-[1.6rem]"},ye={class:"flex-1 truncate"},_e={class:"flex items-center"},be={class:"flex-1"},he={class:"p-20px"},ge=c(d({__name:"malware",setup(c){const{payment:d}=a(),{authType:ge}=u(d.value),ke=P(),{repairTypeActive:je,tootipTotal:Ve,malwareData:Ce}=v(ke),{getScanTotal:De,openPayView:Se,convertDataStructure:qe,malwareAdvanced:Fe,setMalwareConfig:Me}=ke,Te=o(),{getFileEvent:He,saveFileEvent:ze}=O(),Ue=f(),Ae=f([{title:"总检测文件数",value:0,style:"color: #333"},{title:"高危",value:0,style:"color: #F50606;",id:2},{title:"中危",value:0,style:"color: #FF9900",id:1},{title:"低危",value:0,style:"color: #DDC400",id:0}]),Ne=[{label:"不限时间",value:""},{label:"最近1天",value:1},{label:"最近7天",value:7},{label:"最近30天",value:30}],Pe=f("");f(!1);const Be=f(!1),Ee=f(!1),Ie=f({filename:"",filepath:"",threat_type:"",md5:"",risk_level:0,time:"",quarantined:!1,rule:"",processed:0,risk_level_desc:""}),Je=f(""),Ke=f(""),Le=f(!1),Oe=f({total:0,loading:!1,data:[]}),Ge=p(()=>{const e=Ve.value.malware;return e?'<span class="text-[#ff0000]">'.concat(e,"</span>个高危文件待处理！总扫描文件数量").concat(Ae.value[0].value,"个"):"已完成".concat(Ae.value[0].value,"个文件深度扫描，未发现任何恶意文件或异常行为")}),Re=[B({key:"keyid"}),{label:"文件名",prop:"filename"},{label:"威胁标签",prop:"threat_type",width:86,render:e=>x(w,{type:"info",effect:"plain"},{default:()=>["网站后门"]})},{label:"MD5",prop:"md5",width:140,render:e=>x("div",{class:"truncate w-[15rem]",title:e.md5},[e.md5])},{label:"等级",prop:"risk_level_desc",width:50,render:e=>{var a;let l=null==(a=Ae.value.find(a=>a.id===e.risk_level))?void 0:a.style;return x("span",{style:l},[e.risk_level_desc])}},{label:"检测时间",prop:"time",width:140},E([{onClick:async e=>{await l({title:"忽略恶意文件",content:"是否忽略该文件？",onConfirm:async()=>{const{filepath:a,md5:l,filename:s,risk_level:i}=e,r=await t({loading:"正在保存配置，请稍后...",request:I({filepath:a,md5:l,filename:s,risk:i})});r.status?Te.success("忽略成功"):Te.error(r.msg),await ea()}})},title:"忽略"},{onClick:async e=>{await l({title:"处理恶意文件",content:"是否要删除关联的源文件？",onConfirm:async()=>{await t({loading:"正在保存配置，请稍后...",request:J({file_list:JSON.stringify([{filepath:e.filepath,md5:e.md5}]),action_type:"delete"}),message:!0}),await ea()}})},title:"处理"},{onClick:async e=>{Ie.value=e,Ee.value=!0},title:"详情"}])],$e=async e=>{Pe.value=e,await We()},Qe=async e=>{let a=e?"开启":"关闭",t=e?"将全天候检测系统是否存在恶意文件":"将不再检测系统是否存在恶意文件";await l({title:"".concat(a,"动态查杀"),content:"".concat(a,"后，").concat(t,"，是否继续？")}),Be.value=e,await Me({dynamic_detection:Be.value})},We=async()=>{Oe.value.loading=!0;const e=""!==Pe.value?{day:Number(Pe.value)}:void 0,{data:a}=await K(e);Oe.value.loading=!1,Oe.value.data=a.detected.map((e,a)=>({...e,keyid:a})),Je.value=a.last_scan_time;const{total_scanned_files:l,risk_stats:t}=a;Ae.value[0].value=l,Ae.value[1].value=t[2],Ae.value[2].value=t[1],Ae.value[3].value=t[0]},Xe=async()=>{const e=await He({path:Ie.value.filepath});if(!e.status)return Te.error(e.data.msg),!1;Ke.value=e.data.data||e.msg,Le.value=!0},Ye=async()=>{const e=await ze({path:Ie.value.filepath,data:Ke.value,encoding:"utf-8"});Te.request(e)},Ze=[{label:"处理恶意文件",value:"delete",event:async(e,a)=>{await G(e,a,async e=>{const a={filepath:e.filepath,md5:e.md5};return await J({file_list:JSON.stringify([a]),action_type:"delete"})},{label:"文件名",prop:"filename"},ea)}}],ea=async(e=!1)=>{await(async()=>{const{data:e}=await L(),a=e.data;Be.value=a.dynamic_detection,Ce.value.autoIntercept=a.quarantine,Ce.value.ossConfig={status:a.scan_oss,isHasMounts:a.has_oss_mounts},Ce.value.exclude_dirs=qe(a.exclude_dirs),Ce.value.monitor_dirs=qe(a.monitor_dirs)})(),await We(),e||await De()};return y(je,e=>{"malware"===e&&ea(!0)}),(a,l)=>{const t=s,o=T,c=H,d=i,u=r,v=N,f=z,p=U,w=n,y=A,P=m,B=e,E=_("bt-loading");return b(),h("div",null,[l[20]||(l[20]=g("div",{class:"text-[1.8rem] mb-6"},"恶意文件检测",-1)),"ltd"===k(ge)?(b(),h(j,{key:0},[g("div",R,"最近一次扫描时间："+V(k(Je)),1),g("div",$,[(b(!0),h(j,null,C(k(Ae),e=>(b(),h("div",{class:"flex-1",key:e.title},[g("div",Q,V(e.title),1),g("div",{class:"text-[2.4rem]",style:D(e.style)},V(e.value),5)]))),128))]),g("div",W,[x(t,{modelValue:k(Pe),"onUpdate:modelValue":l[0]||(l[0]=e=>S(Pe)?Pe.value=e:null),options:Ne,onChange:$e,class:"mr-[1rem] !w-[12rem]","empty-values":[null,void 0]},null,8,["modelValue"]),g("div",X,[x(o,{size:"small",onClick:k(Fe)},{default:q(()=>[...l[5]||(l[5]=[F("高级设置",-1)])]),_:1},8,["onClick"]),l[7]||(l[7]=g("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),g("div",Y,[l[6]||(l[6]=g("span",{class:"mr-[.8rem]"},"动态查杀开关",-1)),x(c,{modelValue:k(Be),"onUpdate:modelValue":l[1]||(l[1]=e=>S(Be)?Be.value=e:null),size:"small",onChange:Qe},null,8,["modelValue"])])])]),x(v,null,{content:q(()=>[M(x(d,{ref_key:"malwareTable",ref:Ue,column:Re,data:k(Oe).data,"max-height":"270",description:"文件列表为空"},null,8,["data"]),[[E,k(Oe).loading],[E,"正在获取恶意文件列表，请稍后...","title"]])]),"footer-left":q(()=>[x(u,{"table-ref":k(Ue),options:Ze},null,8,["table-ref"])]),_:1}),l[8]||(l[8]=g("ul",{class:"ml-6 mt-6 list-disc leading-10"},[g("li",{class:"text-medium"},"恶意文件检测每6小时自动运行，24小时不间断保护您的系统安全，无需任何手动操作！")],-1))],64)):(b(),h("div",Z,[g("div",ee,[g("div",ae,[g("span",{class:"font-bold",innerHTML:k(Ge)},null,8,le),g("p",te,"上一次扫描时间："+V(k(Je)),1)]),x(o,{type:"primary",onClick:k(Se),class:"h-[4rem] w-[10rem]",size:"large"},{default:q(()=>[g("span",se,V(k(Ve).malware>0?"立即处理":"立即开启"),1)]),_:1},8,["onClick"])]),x(f),g("div",ie,[x(p,{class:"w-[63rem] mr-[2rem]",fit:"scale-down",src:"https://www.bt.cn/Public/new/plugin/introduce/home/malware.png"}),l[9]||(l[9]=g("div",{class:"max-w-[22rem]"},[g("span",{class:"text-[1.8rem] font-bold"},"恶意文件检测工具介绍"),g("ul",{class:"block leading-[2.6rem] mx-[2rem] list-square mt-[2rem]"},[g("li",null,[F("支持检测21种恶意文件类型： "),g("br"),F("反弹Shell后门、DDoS木马、下载器木马、 黑客工具、高危程序、被污染的基础软件、 恶意脚本、恶意程序、挖矿程序、 代理工具、勒索病毒、高危软件、 Rootkit、窃密工具、恶意扫描器、 可疑程序、感染型病毒、网站后门、 蠕虫病毒、广告程序、破解程序 ")])])],-1))])])),x(P,{modelValue:k(Ee),"onUpdate:modelValue":l[2]||(l[2]=e=>S(Ee)?Ee.value=e:null),title:"[".concat(k(Ie).filename,"]详情"),area:54},{default:q(()=>[g("div",re,[g("div",ne,[l[10]||(l[10]=g("div",{class:"text-[1.2rem] text-[#000] w-[10rem]"},"文件名称",-1)),g("div",me,V(k(Ie).filename),1)]),g("div",oe,[l[11]||(l[11]=g("div",{class:"text-[1.2rem] text-[#000] w-[10rem]"},"文件路径",-1)),g("div",ce,V(k(Ie).filepath),1)]),g("div",de,[l[12]||(l[12]=g("div",{class:"text-[1.2rem] text-[#000] w-[10rem]"},"MD5",-1)),g("div",ue,V(k(Ie).md5),1)]),g("div",ve,[l[13]||(l[13]=g("div",{class:"text-[1.2rem] text-[#000] w-[10rem]"},"威胁标签",-1)),g("div",fe,V(k(Ie).threat_type),1)]),g("div",pe,[l[14]||(l[14]=g("div",{class:"text-[1.2rem] text-[#000] w-[10rem]"},"是否已进行隔离",-1)),g("div",xe,V(k(Ie).quarantined?"是":"否"),1)]),g("div",we,[l[16]||(l[16]=g("div",{class:"text-[1.2rem] text-[#000] w-[10rem]"},"样本文件",-1)),g("div",ye,[x(w,{onClick:Xe},{default:q(()=>[...l[15]||(l[15]=[F("查看",-1)])]),_:1})])]),l[19]||(l[19]=g("div",{class:"mb-[1rem] mt-[4rem] font-bold text-[#333] text-[1.4rem]"},"事件说明",-1)),g("div",_e,[g("div",be,[x(y,{style:{width:"480px"},shadow:"always",class:"p-[1rem]"},{default:q(()=>[l[17]||(l[17]=F(" 发现了一个可疑文件，建议您先确认文件合法性并进行处理 ",-1)),x(f,{class:"!my-1.2rem"}),l[18]||(l[18]=g("div",{class:"flex flex-wrap"},[g("div",null,"处置建议:"),g("div",null,"如果您确认该文件不是自己部署的业务所需文件，请隔离该文件，或直接删除。如果您确定为误报，请先忽略该告警。")],-1))]),_:1})])])])]),_:1},8,["modelValue","title"]),x(P,{title:"在线编辑",showFooter:"",modelValue:k(Le),"onUpdate:modelValue":l[4]||(l[4]=e=>S(Le)?Le.value=e:null),area:70,onConfirm:Ye},{default:q(()=>[g("div",he,[x(B,{modelValue:k(Ke),"onUpdate:modelValue":l[3]||(l[3]=e=>S(Ke)?Ke.value=e:null),class:"!h-[40rem]"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-c4f9ce13"]]);export{ge as default};
