import{_ as t}from"./index103.js?v=1756369731";import{_ as e}from"./index112.js?v=1756369731";import{u as s,bv as a,R as r,K as o,S as i,k as l}from"./utils-lib.js?v=1756369731";import{getRiskList as n}from"./site.js?v=1756369731";import{c as p,U as m,r as c,b4 as u,p as d,G as _,q as j,M as f,A as h,H as w,x as b,e as x,J as k}from"./base-lib.js?v=1756369731";import{u as g}from"./column.js?v=1756369731";import{k as v}from"./useController12.js?v=1756369731";import{aT as y}from"./store.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./validator.js?v=1756369731";import"./useStore4.js?v=1756369731";import"./useController6.js?v=1756369731";import"./files.js?v=1756369731";import"./store2.js?v=1756369731";import"./index101.js?v=1756369731";const C=p({__name:"risk-list",props:{compData:{default:()=>({isPopup:!1})}},setup(p){const C=p,{mainHeight:U}=s(),H=m(!1),M=c([]),q=c(0),A=c(C.compData.isPopup),D=(t,e)=>{y({path:t})},P=t=>{var e;let s="/www/server/panel/class/projectModel/content/source/",a=s+t.source_file;(null==(e=t.risk_type)?void 0:e.indexOf("_update"))>-1?((t,e)=>{"title_hash_update"!==t.risk_type&&"tail_hash_update"!==t.risk_type||(e="/www/server/panel/class/projectModel/content/hash/"+t.site_name+"/"),t.source_content_file;let s=e+t.new_content_file;D(s)})(t,s):D(a,t.content)},R=u({p:1,limit:20}),S=async()=>{await o({loading:H,request:n({...R}),data:{data:[Array,M],page:i(q)}})},G=[{label:"巡检时间",width:"150px",render:t=>{const e=a(t.time,"number",0);return x("span",null,[r(e)])}},{label:"URL",render:t=>x("span",{class:"bt-link",title:t.url,onClick:()=>window.open(t.url,"_blank","noopener,noreferrer")},[t.url])},{label:"关键词",prop:"content",width:"200px"},{label:"类型",prop:"risk_content",width:"200px"},{label:"风险位置",width:"150px",render:t=>v[t.risk_type]},g([{onClick:P,title:"详情"}])];return d(()=>S()),(s,a)=>{const r=l,o=e,i=t,n=_("bt-loading");return j(),f(i,{class:k({"p-[2rem]":b(A)})},{content:h(()=>[w(x(r,{ref:"table",column:b(G),data:b(M),description:"风险列表为空","max-height":b(A)?500:b(U)-300},null,8,["column","data","max-height"]),[[n,b(H)],[n,"正在加载风险列表，请稍后...","title"]])]),"footer-right":h(()=>[x(o,{total:b(q),page:b(R).p,"onUpdate:page":a[0]||(a[0]=t=>b(R).p=t),row:b(R).limit,"onUpdate:row":a[1]||(a[1]=t=>b(R).limit=t),onChange:S},null,8,["total","page","row"])]),_:1},8,["class"])}}});export{C as default};
