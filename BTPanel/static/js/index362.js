import{c as e,r as s,Z as o,p as t,q as a,v as r,H as l,I as n,x as i,e as u,C as m,F as c}from"./base-lib.js?v=1756369731";import{a2 as p,b as d}from"./utils-lib.js?v=1756369731";import{u as _}from"./use-socket-request.js?v=1756369731";import{u as v}from"./useStore4.js?v=1756369731";import{n as j,g as x}from"./index70.js?v=1756369731";import{_ as y,a as g,b}from"./traditional-project.vue_vue_type_script_setup_true_lang.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./site.js?v=1756369731";import"./index103.js?v=1756369731";import"./index130.js?v=1756369731";import"./index104.js?v=1756369731";import"./validator.js?v=1756369731";import"./column.js?v=1756369731";import"./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang.js?v=1756369731";import"./useController6.js?v=1756369731";import"./index141.js?v=1756369731";import"./index124.js?v=1756369731";import"./index.vue_vue_type_script_setup_true_lang13.js?v=1756369731";import"./index101.js?v=1756369731";import"./index140.js?v=1756369731";import"./ace.js?v=1756369731";const f=["innerHTML"],w=e({__name:"index",emits:["showFooterFun"],setup(e,{expose:w,emit:h}){const k=d(),F=h,{isRefreshList:H}=v(),P=s("nodeProject"),q=s(null),D=s(),M=s(!1),R=s("正在执行添加脚本...");o("nodeData",j);const{BtTabs:T,tabsRefs:C}=p({type:"card",value:P,options:[{label:"默认项目",name:"nodeProject",lazy:!0,render:y},{label:"PM2项目",name:"pmProject",lazy:!0,render:g},{label:"传统项目",name:"traditionalProject",lazy:!0,render:b}]}),L=async(e=!1)=>(j.value=await x(),e&&k.success("Node版本，刷新成功"),j.value);return o("getNodeData",L),t(()=>L),w({onConfirm:async e=>{const s=await C()[P.value].submit();if(s){let o={...s,mod_name:"nodejs",sub_mod_name:"com",def_name:"create",ws_callback:"create"};(async()=>{var e;null==(e=q.value)||e.socketDestroy();const{socketRequest:s,socketDestroy:o}=_("/ws_modsoc",!1);q.value={socketRequest:s,socketDestroy:o},new Promise((e,s)=>{e(q.value)})})(),q.value.socketRequest({params:o,onMessage:s=>(async(e,s)=>{var o;e.msg&&(R.value=R.value+"\n"+e.msg,(null==(o=D.value)?void 0:o.scrollHeight)&&(D.value.scrollTop=D.value.scrollHeight)),-1===e.code&&e.status?(k.success("添加成功"),s(),H.value=!0):[2,3,4,5].includes(e.code)&&!e.status&&(k.msg({message:e.msg,type:"error",duration:0,dangerouslyUseHTMLString:!0,showClose:!0}),5===e.code?(M.value=!1,s(),H.value=!0):(M.value=!1,F("showFooterFun",!0)))})(s,e)}),M.value=!0,F("showFooterFun",!1)}}}),(e,s)=>(a(),r(c,null,[l(u(i(T),{class:"p-2rem"},null,512),[[n,!i(M)]]),i(M)?(a(),r("pre",{key:0,ref_key:"installShow",ref:D,class:"whitespace-pre-wrap h-[40rem] overflow-auto mt-12px bg-[#333] p-12px text-white rounded-4px",innerHTML:i(R)},null,8,f)):m("",!0)],64))}});export{w as default};
