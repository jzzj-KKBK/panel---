!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},u=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,r,u,i){var a=r&&r.prototype instanceof c?r:c,s=Object.create(a.prototype);return o(s,"_invoke",function(n,r,o){var u,i,a,c=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return u=e,i=0,a=t,p.n=n,l}};function d(n,r){for(i=n,a=r,e=0;!f&&c&&!o&&e<s.length;e++){var o,u=s[e],d=p.p,m=u[2];n>3?(o=m===r)&&(a=u[(i=u[4])?5:(i=3,3)],u[4]=u[5]=t):u[0]<=d&&((o=n<2&&d<u[1])?(i=0,p.v=r,p.n=u[1]):d<m&&(o=n<3||u[0]>r||r>m)&&(u[4]=n,u[5]=r,p.n=m,i=0))}if(o||n>1)return l;throw f=!0,r}return function(o,s,m){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,m),i=s,a=m;(e=i<2?t:a)||!f;){u||(i?i<3?(i>1&&(p.n=-1),d(i,a)):p.n=a:p.v=a);try{if(c=2,u){if(i||(o="next"),e=u[o]){if(!(e=e.call(u,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,i<2&&(i=0)}else 1===i&&(e=u.return)&&e.call(u),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);u=t}else if((e=(f=p.n<0)?a:n.call(r,p))!==l)break}catch(e){u=t,i=1,a=e}finally{c=1}}return{value:e,done:f}}}(n,u,i),!0),s}var l={};function c(){}function s(){}function f(){}e=Object.getPrototypeOf;var p=[][u]?e(e([][u]())):(o(e={},u,function(){return this}),e),d=f.prototype=c.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,o(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=f,o(d,"constructor",f),o(f,"constructor",s),s.displayName="GeneratorFunction",o(f,i,"GeneratorFunction"),o(d),o(d,i,"Generator"),o(d,u,function(){return this}),o(d,"toString",function(){return"[object Generator]"}),(r=function(){return{w:a,m:m}})()}function o(t,e,n,r){var u=Object.defineProperty;try{u({},"",{})}catch(t){u=0}o=function(t,e,n,r){function i(e,n){o(t,e,function(t){return this._invoke(e,n,t)})}e?u?u(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},o(t,e,n,r)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach(function(e){a(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function a(e,n,r){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function l(t,e,n,r,o,u,i){try{var a=t[u](i),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var u=t.apply(e,n);function i(t){l(u,r,o,i,a,"next",t)}function a(t){l(u,r,o,i,a,"throw",t)}i(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./useController-legacy6.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./validator-legacy.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./column-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731"],function(t,n){"use strict";var o,u,a,l,s,f,p,d,m,y,v,b,g,h,j,_,w,O,S,P,x,V,E,T,k,R,A,C,D,U,G;return{setters:[function(t){o=t.M,u=t.K,a=t.at,l=t.j,s=t.W},function(t){f=t.r,p=t.g,d=t.k,m=t.c,y=t.p,v=t.G,b=t.H,g=t.x,h=t.q,j=t.v,_=t.e,w=t.A,O=t.B,S=t.M,P=t.C,x=t.a9,V=t.T,E=t.D,T=t.a7},function(t){k=t.batchPhpReferer,R=t.setSecurity,A=t.getSecurity},function(t){C=t.o},function(t){D=t.u},function(t){U=t.h,G=t.i},null,null,null],execute:function(){var n=D(),F=n.siteInfo,L=n.isRefreshList,H=f(),q=p(function(){var t,e;return Array.isArray(null===(t=H.value)||void 0===t?void 0:t.selectedList)&&(null===(e=H.value)||void 0===e||null===(e=e.selectedList)||void 0===e?void 0:e.length)>0}),I=f(!1),M=d({fix:"jpg,jpeg,gif,png,js,css",domains:"",return_rule:"404",http_status:!1,status:!1}),N=f(null),z=[{content:'【URL后缀】一般填写文件后缀,每个文件后缀使用","分隔,如: png,jpg'},{content:"【许可域名】允许作为来路的域名，每行一个域名,如: www.bt.cn"},{content:"【响应资源】可设置404/403等状态码，也可以设置一个有效资源，如：/security.png"},{content:"【允许空HTTP_REFERER请求】是否允许浏览器直接访问，若您的网站访问异常，可尝试开启此功能"}],B=function(t){if(!M.status)return o.error("请先启用防盗链!")},K=function(t){M.status=t,t||(M.http_status=!1)},W=function(){var t=c(r().m(function t(e){var n,o,a,l,c,s,f,p,d,m;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,N.value.validate();case 1:return o=i(i({},M),{},{domains:null===(n=M.domains)||void 0===n?void 0:n.replace(/\n/g,",")}),q.value?(a=H.value.config,l=a.enable,c=a.exclude,s=U(H.value.selectedList,c,l,{params:{project_type:"PHP"}}),o=i(i({},o),s)):(o.id=F.value.id,o.site_name=F.value.name),f=q.value?k:R,t.n=2,u({loading:"正在设置防盗链，请稍后...",request:f(o),message:!q.value});case 2:p=t.v,q.value?(d=G(p.data),m=d.data,C({resultData:m,title:"批量设置防盗链"}),L.value=!0,J(),e&&e()):$(H.value);case 3:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}(),$=function(){var t=c(r().m(function t(e){var n,o,u,i,l,c,s;return r().w(function(t){for(;;)switch(t.p=t.n){case 0:if(H.value=e||[],q.value&&J(),e){t.n=5;break}return n=F.value,o=n.id,u=n.name,t.p=1,I.value=!0,t.n=2,A({id:o,site_name:u});case 2:i=t.v,(l=i.data)&&(M.fix=l.fix||"jpg,jpeg,gif,png,js,css",M.domains=(null===(c=l.domains)||void 0===c||null===(c=c.toString())||void 0===c?void 0:c.replace(/,/g,"\n"))||"",M.return_rule=l.return_rule||"404",M.http_status=l.http_status||!1,M.status=l.status||!1),t.n=4;break;case 3:t.p=3,s=t.v,a(s);case 4:return t.p=4,I.value=!1,t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(e){return t.apply(this,arguments)}}(),J=function(){M.fix="jpg,jpeg,gif,png,js,css",M.domains="",M.return_rule="404",M.http_status=!1,M.status=!1},Q={fix:[{required:!0,message:"请输入url后缀",trigger:"blur"}],return_rule:[{required:!0,message:"请输入响应资源",trigger:"blur"}]},X={class:"p-[20px]"};t("default",m({__name:"index",props:{compData:{default:function(){}}},emits:["close"],setup:function(t,n){var r=n.expose,o=(n.emit,t),u=function(){$(o.compData)};return y(u),r({onConfirm:W,init:u}),function(t,n){var r=l,o=x,u=V,i=E,a=T,c=s,f=v("bt-loading");return b((h(),j("div",X,[_(a,{ref_key:"hotFormRef",ref:N,model:g(M),rules:g(Q)},{default:w(function(){return[_(o,{label:"URL后缀",prop:"fix"},{default:w(function(){return[_(r,{modelValue:g(M).fix,"onUpdate:modelValue":n[0]||(n[0]=function(t){return g(M).fix=t}),width:"30rem"},null,8,["modelValue"])]}),_:1}),_(o,{label:"许可域名"},{default:w(function(){return[_(r,{width:"30rem",modelValue:g(M).domains,"onUpdate:modelValue":n[1]||(n[1]=function(t){return g(M).domains=t}),type:"textarea",resize:"none",rows:8,placeholder:"默认添加主域名，可追加其他的允许域名，一行一个，可为空"},null,8,["modelValue"])]}),_:1}),_(o,{label:"响应资源",prop:"return_rule"},{default:w(function(){return[_(r,{width:"30rem",modelValue:g(M).return_rule,"onUpdate:modelValue":n[2]||(n[2]=function(t){return g(M).return_rule=t})},null,8,["modelValue"])]}),_:1}),_(o,{label:" "},{default:w(function(){return[_(u,{modelValue:g(M).status,"onUpdate:modelValue":n[3]||(n[3]=function(t){return g(M).status=t}),onChange:g(K)},{default:w(function(){return e(n[6]||(n[6]=[O("启用防盗链",-1)]))}),_:1},8,["modelValue","onChange"]),_(u,{disabled:!g(M).status,title:"".concat(g(M).status?"":"需开启防盗链"),modelValue:g(M).http_status,"onUpdate:modelValue":n[4]||(n[4]=function(t){return g(M).http_status=t}),onChange:g(B)},{default:w(function(){return e(n[7]||(n[7]=[O(" 允许空HTTP_REFERER请求 ",-1)]))}),_:1},8,["disabled","title","modelValue","onChange"])]}),_:1}),g(q)?P("",!0):(h(),S(o,{key:0,label:" "},{default:w(function(){return[_(i,{type:"primary",onClick:n[5]||(n[5]=function(t){return g(W)()})},{default:w(function(){return e(n[8]||(n[8]=[O("保存",-1)]))}),_:1})]}),_:1}))]}),_:1},8,["model","rules"]),g(q)?P("",!0):(h(),S(c,{key:0,options:g(z),class:"ml-[20px] mt-[20px]"},null,8,["options"]))])),[[f,g(I)]])}}}))}}})}();
