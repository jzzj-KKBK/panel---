import{u as e,K as a,R as s,L as t,l,_ as c,c as n,d as r,e as i}from"./utils-lib.js?v=1756369731";import{c as o,s as m,t as u,r as d,U as p,q as f,v,y as b,x as h,C as x,e as _,M as g,z as w,A as y,B as S,K as C,J as M,b7 as k,F as j,a_ as T,P as D,D as B,a$ as P,bw as z,ba as H,bv as E}from"./base-lib.js?v=1756369731";import{p as L}from"./firewall.js?v=1756369731";import{S as O}from"./useController5.js?v=1756369731";import{p as I}from"./validator.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./site.js?v=1756369731";import"./column.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore4.js?v=1756369731";import"./useController6.js?v=1756369731";import"./useMethod5.js?v=1756369731";const V={class:"p-[2rem]"},A={class:"head mb-[4rem]"},Z={class:"scan-header flex flex-row flex-wrap items-center justify-between"},q={class:"flex flex-row flex-wrap justify-center items-center"},F={key:0,class:"relative scan-header-cont"},K={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"},R={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},N=["innerHTML"],U={class:"scan-subtitle text-[1.6rem] mt-[1.2rem]"},W={class:"scan-header-cont justify-end relative"},J={class:"text-[1.5rem]"},X={class:"content"},Y={key:0,class:"info"},$={class:"webedit-con flex items-center justify-center"},G={class:"thumbnail-introduce mt-[0rem]"},Q={key:1,class:"scan"},ee={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[49rem] border-[#e8e8e8] flex items-center justify-center"},ae={class:"flex flex-column items-center"},se={key:1,class:"scan-dangerous"},te={class:"flex items-center"},le={class:"w-[26rem] flex items-center justify-start"},ce={class:"ml-[1.2rem]"},ne={class:"flex items-center justify-between w-full"},re={class:"flex items-center ml-[1.2rem]"},ie={class:"text-[#999] ml-[1.2rem]"},oe={class:"bg-[#f6f6f6] text-[#999] p-[2rem] ml-[1.2rem]"},me={class:"mt-[1.2rem] ml-[2rem]"},ue={class:"flex items-center"},de=i(o({__name:"index",props:{compData:{default:()=>({isSiteModule:!1})}},setup(i){const o=i,{scanData:de}=m(O()),{payment:pe}=e(),{authType:fe}=u(pe.value),ve=d(!0),be=d(!1),he=d({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),xe=d(["1"]),_e=p([]),ge={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},we=d("success"),ye=d(!1),Se=async()=>{if("ltd"!==fe.value)return I({sourceId:19});we.value="loading",he.value.scanTitle="正在扫描中，请稍后...";try{const{data:e}=await a({request:L(),loading:ye});if(he.value.scanTitle="扫描完成",he.value.scanTime="扫描时间：".concat(s(e.time)),he.value.scanCheckButton="重新检测",ve.value=!1,e.info.length?(be.value=!1,_e.value=e.info,we.value="danger",he.value.scanCheckButton="重新检测",he.value.scanTitle="全部【".concat(e.site_num,"个】网站存在风险项<span class='text-danger'>").concat(e.loophole_num,"</span>个")):(be.value=!0,he.value.scanTitle="当前网站没有风险项"),!1!==(null==e?void 0:e.status)&&!0===o.compData.isSiteModule){const{useSitePhpStore:a}=await t(()=>import("./useController5.js?v=1756369731").then(e=>e.w),__vite__mapDeps([]),import.meta.url),{scanData:s}=a();Object.assign(s.value,e)}}catch(e){we.value="success"}},Ce=()=>l({title:"设置自动扫描",area:54,component:()=>t(()=>import("./index457.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!0});return(()=>{const{loophole_num:e,site_num:a,time:t}=de.value;o.compData.isSiteModule&&(de.value.loophole_num>0?(we.value="danger",he.value.scanTitle="<span class='text-danger'>".concat(e,"</span>个高危网站漏洞待处理！ 总扫描网站数量").concat(a,"个"),he.value.scanTime="上一次扫描时间:".concat(s(t)),he.value.scanCheckButton="立即查看"):(he.value.scanTitle="未扫描到网站漏洞，总扫描网站数量".concat(a,"个"),he.value.scanTime="上一次扫描时间:".concat(s(t)),he.value.scanCheckButton="重新检测",we.value="success"))})(),(e,a)=>{const s=c,t=n,l=B,i=P,o=r,m=H,u=E,d=z;return f(),v("div",V,[b("div",A,[b("div",Z,[b("div",q,["loading"==h(we)?(f(),v("div",F,[h(ye)?(f(),v("div",K)):x("",!0),_(s,{icon:"scanning-scan",size:60,color:"#20a53a"})])):x("",!0),"success"==h(we)?(f(),g(s,{key:1,icon:"scanning-success",size:80,color:"#20a53a"})):x("",!0),"danger"==h(we)?(f(),g(s,{key:2,icon:"scanning-danger",size:80,color:"#ef0808"})):x("",!0),b("div",R,[b("div",{class:"scan-title text-[2rem] font-bold",innerHTML:h(he).scanTitle},null,8,N),b("div",U,w(h(he).scanTime),1)])]),b("div",W,[_(t,{class:"btlink setScanAlarm absolute top-[6rem] right-1rem",onClick:Ce},{default:y(()=>[...a[1]||(a[1]=[S(" 自动扫描>> ",-1)])]),_:1}),_(l,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==h(we)?"default":"primary",size:"large",onClick:Se},{default:y(()=>[b("span",J,w(h(he).scanCheckButton),1)]),_:1},8,["type"])])])]),_(i,{class:"!mt-0"}),b("div",X,[h(ve)?(f(),v("div",Y,[b("div",$,[_(o,{style:C(e.compData.isSiteModule?"width:40rem":""),src:e.compData.isSiteModule?"/preview/site_scanning.png":"/firewall/safe_detect_scanning.png",class:M(e.compData.isSiteModule?"!w-[34rem] mr-[4rem]":"max-w-[90rem] mr-[4rem]")},null,8,["style","src","class"]),b("div",G,[a[3]||(a[3]=b("span",{class:"text-[1.8rem] font-bold"},"漏洞扫描工具介绍：",-1)),b("ul",{class:M(["block leading-[3rem] mx-[2rem] list-square mt-[2rem]",e.compData.isSiteModule?"text-[1.2rem]":"text-[1.6rem]"])},[...a[2]||(a[2]=[k("<li data-v-fb3e28ca> 可识别多款开源CMS程序，支持如下： <br data-v-fb3e28ca> 迅睿CMS、pbootcms、苹果CMS、eyoucms、 <br data-v-fb3e28ca> 海洋CMS、ThinkCMF、zfaka、dedecms、 <br data-v-fb3e28ca> MetInfo、emlog、帝国CMS、discuz、 <br data-v-fb3e28ca> Thinkphp、Wordpress、Z-Blog、极致CMS、 <br data-v-fb3e28ca> ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-fb3e28ca> phpcms、likeshop、iCMS、WellCMS、 <br data-v-fb3e28ca> chanzhiEPS、PHPOK、LaySNS、骑士CMS、 <br data-v-fb3e28ca> openSNS、齐博CMS、ZZZCMS、prestashop、 <br data-v-fb3e28ca> ThinkphpSHOP、DouPHP、cmseasy、 <br data-v-fb3e28ca> piwigo、phpwind、行云海CMS </li><li data-v-fb3e28ca>可扫描网站中存在的漏洞</li><li data-v-fb3e28ca>提供修复/提供付费解决方案</li>",3)])],2)])])])):(f(),v("div",Q,[h(be)?(f(),v("div",ee,[b("div",ae,[_(o,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),a[4]||(a[4]=b("span",{class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(f(),v("div",se,[a[7]||(a[7]=b("div",{class:"flex items-center mb-[2rem] text-[#333]"},[b("span",{class:"w-[26rem]"},"网站"),b("span",null,"类型")],-1)),b("div",{class:M(e.compData.isSiteModule?"overflow-auto h-[42rem]":"")},[_(d,{modelValue:h(xe),"onUpdate:modelValue":a[0]||(a[0]=e=>D(xe)?xe.value=e:null),accordion:""},{default:y(()=>[(f(!0),v(j,null,T(h(_e),(e,s)=>(f(),g(u,{key:s},{title:y(()=>[b("div",te,[b("div",le,[_(m,{type:e.cms.length>0?"warning":"success",effect:"dark"},{default:y(()=>[S(w(e.cms.length)+"项 ",1)]),_:2},1032,["type"]),b("span",ce,w(e.name),1)]),b("span",null,w(e.cms_name+"--"+e.version_info),1),a[5]||(a[5]=b("div",{class:"text-[#666] text-[1.2rem] ml-[6rem]"},"无法自动修复,请在网站后台更新该软件版本。",-1))])]),default:y(()=>[_(d,{accordion:""},{default:y(()=>[(f(!0),v(j,null,T(e.cms,(e,s)=>(f(),g(u,{key:s},{title:y(()=>[b("div",ne,[b("div",re,[_(m,{type:ge[e.dangerous][0]},{default:y(()=>[S(w(ge[e.dangerous][1]),1)]),_:2},1032,["type"]),b("span",ie,w(e.ps),1)]),_(t,{class:"mb-[.2rem] mr-[1.6rem]"},{default:y(()=>[...a[6]||(a[6]=[S("详情",-1)])]),_:1})])]),default:y(()=>[b("div",oe,"修复建议："+w(e.repair),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])],2)]))])),b("div",me,[b("div",ue,[a[9]||(a[9]=S(" 如需支持其他cms程序，请发帖反馈： ",-1)),_(t,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:y(()=>[...a[8]||(a[8]=[S(" https://www.bt.cn/bbs/thread-89149-1-1.html ",-1)])]),_:1})])])])])}}}),[["__scopeId","data-v-fb3e28ca"]]);export{de as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
