import{u as e,o as t,L as a,n as l,l as o,k as i,b as n,q as s,K as r,_ as c}from"./utils-lib.js?v=1756369731";import{_ as d}from"./index120.js?v=1756369731";import{_ as p}from"./index104.js?v=1756369731";import{c as u,r as m,k as _,e as f,B as w,p as y,G as h,q as v,v as b,x as g,M as j,A as k,H as x,C as V,y as P,P as E,D as C,a9 as D,a7 as L}from"./base-lib.js?v=1756369731";import{_ as A}from"./index126.js?v=1756369731";import{d as O,u as S}from"./column.js?v=1756369731";import{getSingleSiteContentMonitorList as T,searchFiles as R,delContentMonitorInfo as I,scanning as U}from"./site.js?v=1756369731";import{u as q}from"./useStore4.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./index105.js?v=1756369731";const F={class:"p-[20px]"},B={class:"p-[20px]"},H=c(u({__name:"index",props:{compData:{type:null,required:!0,default:{}}},setup(c){const{siteInfo:u}=q(),H=n(),{payment:J}=e(),N=m([]),G=m(!1),K=_({word:""}),M=m([O(),{label:"违规词",prop:"key"}]),z=m([]),Q=m(!1),W=m(!1),X=m(!1),Y=m(),Z=_({title:"违规词检测-功能介绍",ps:"违规词检测能帮助检测网站内容中的合法及非法字段，并输出对应的检测结果，利用图表充分展示各个域名的风险历史、检测情况、敏感词排行等，并实时输出风险动态。",source:111,desc:["违规词内容检测","网页内容修改检测","输出检测报告"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_1.png"},{title:"监控列表",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_2.png"},{title:"检测历史",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_3.png"},{title:"风险列表",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_4.png"},{title:"检测报告",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_5.png"}]}),$=async()=>{if("ltd"===J.value.authType){G.value=!0;try{const e=await T({site_name:u.value.name});N.value=e.data}catch(e){}finally{G.value=!1}}},ee=async()=>{te({...u.value,id:!1})},te=e=>{t({title:"".concat(e.id?"编辑":"添加","监控").concat(e.id?"【".concat(e.name,"】"):""),area:68,showFooter:!0,compData:{...e,refreshEvent:$,isSite:!0},component:()=>a((()=>import("./add-monitor2.js?v=1756369731")),__vite__mapDeps([]),import.meta.url)})},ae=()=>{t({isAsync:!0,title:"自定义词库",area:[44,39],component:()=>a((()=>import("./own-thesaurus2.js?v=1756369731")),__vite__mapDeps([]),import.meta.url)})},le=()=>{t({isAsync:!0,title:"检测历史",area:80,component:()=>a((()=>import("./detect-history.js?v=1756369731")),__vite__mapDeps([]),import.meta.url),compData:{isPopup:!0,...u.value}})},oe=()=>{t({isAsync:!0,title:"风险列表",area:80,component:()=>a((()=>import("./risk-list.js?v=1756369731")),__vite__mapDeps([]),import.meta.url),compData:{isPopup:!0}})},ie=()=>{var e;null==(e=Y.value)||e.resetFields(),W.value=!1},ne=async()=>{let e=H.load("正在扫描，请稍后...");try{const e=await R({search:K.word,path:u.value.path});z.value=e.data.result.map((e=>({path:e.name,key:K.word}))),ie(),X.value=!0}catch(t){}finally{W.value=!1,e.close()}},se=m([{label:"监控名称",prop:"name",showOverflowTooltip:!0},{label:"网站/URL",prop:"url"},{label:"状态",prop:"content",render:e=>{if(1===e.crontab_status)return"正常"}},{label:"发送告警",prop:"send_msg",render:e=>1===e.send_msg?f("span",{class:"text-primary"},[w("已开启")]):"未开启"},{label:"检测频率",prop:"crontab_info.cycle",showOverflowTooltip:!0},S([{onClick:async e=>{try{const l=H.load("正在检测，请稍后..."),o=await U({data:JSON.stringify({id:e.id})}),i={name:e.name,id:e.id,path_info:o.data.path_info};l.close(),t({title:"检测日志",area:[64,50],btn:["停止检测"],component:()=>a((()=>import("./scan-details2.js?v=1756369731")),__vite__mapDeps([]),import.meta.url),compData:i,showFooter:!0})}catch(l){}},title:"检测"},{onClick:e=>{te(e)},title:"编辑"},{onClick:async e=>{await s({title:"删除违规词检测",content:"删除后无法继续监控该网站，是否继续？"}),r({loading:"正在删除，请稍后...",request:I({data:JSON.stringify({id:e.id})}),message:!0,success:e=>{e.status&&$()}})},title:"删除"}])]);return y((()=>{$()})),(e,t)=>{const a=C,n=A,s=l,r=o,c=D,u=L,m=i,_=p,y=d,O=h("bt-loading");return v(),b("div",null,["ltd"===g(J).authType?(v(),j(_,{key:0},{"header-left":k((()=>[f(a,{type:"primary",onClick:ee},{default:k((()=>t[4]||(t[4]=[w("添加监控")]))),_:1}),f(a,{type:"default",onClick:t[0]||(t[0]=e=>W.value=!0)},{default:k((()=>t[5]||(t[5]=[w(" 自定义扫描 ")]))),_:1}),f(a,{type:"default",onClick:ae},{default:k((()=>t[6]||(t[6]=[w(" 自定义词库 ")]))),_:1}),f(a,{type:"default",onClick:le},{default:k((()=>t[7]||(t[7]=[w(" 检测历史 ")]))),_:1}),f(a,{type:"default",onClick:oe},{default:k((()=>t[8]||(t[8]=[w("风险列表")]))),_:1})])),"header-right":k((()=>[f(n,{onRefresh:$})])),content:k((()=>[x((v(),j(s,{column:g(se),data:g(N)},{default:k((()=>[V(' <template #empty>\n            <div class="flex items-center justify-center">\n              您的列表为空，您可以\n              <BtLink @click="addEventListener">添加一个监控</BtLink>\n            </div>\n          </template> ')])),_:1},8,["column","data"])),[[O,g(G)]])])),popup:k((()=>[f(m,{title:"自定义扫描",modelValue:g(W),"onUpdate:modelValue":t[2]||(t[2]=e=>E(W)?W.value=e:null),area:42,onConfirm:ne,onCancel:ie,showFooter:""},{default:k((()=>[P("div",F,[f(u,{"label-position":"right",model:g(K),ref_key:"scanRef",ref:Y},{default:k((()=>[f(c,{label:"扫描违规词",prop:"word"},{default:k((()=>[f(r,{modelValue:g(K).word,"onUpdate:modelValue":t[1]||(t[1]=e=>g(K).word=e),placeholder:"请输入要扫描的词汇",width:"24rem"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"]),f(m,{title:"扫描结果",modelValue:g(X),"onUpdate:modelValue":t[3]||(t[3]=e=>E(X)?X.value=e:null),area:52},{default:k((()=>[P("div",B,[f(_,null,{content:k((()=>[x(f(s,{column:g(M),data:g(z),"max-height":400},null,8,["column","data"]),[[O,g(Q)]])])),_:1})])])),_:1},8,["modelValue"])])),_:1})):(v(),j(y,{key:1,data:g(Z),class:""},null,8,["data"]))])}}}),[["__file","/Users/chudong/project/linux-10/src/views/site/views/php-model/site-safe/violation-word-detection/index.vue"]]);export{H as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
