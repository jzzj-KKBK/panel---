import{ay as e,K as t,bk as a,am as n,l as s,L as r,bA as o,ai as l,A as i,R as c,bB as p,M as m,aQ as u,aS as d,ag as w}from"./utils-lib.js?v=1756369731";import{H as f,G as b,e as g,aB as k,r as h,o as _,aQ as v,an as y,B as x,ap as C,ao as D,b3 as P,ax as E,ba as j,i as O,S as T,al as V,ac as I,ab as A,D as S}from"./base-lib.js?v=1756369731";import{c as L,a as R,e as W,u as B}from"./column.js?v=1756369731";function N(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!O(e)}const{refreshActiveTable:z,refs:{cpuAndMemData:H}}=e(),q=e=>{const t=(e.p-1)*e.limit,a=t+e.limit;return o(t,a,e.list)},U=e=>{const t=e.prop||"ps";return{label:"备注",prop:t,width:e.width?e.width:200,isCustom:!e.noCustom,render:a=>{if(void 0===a[t])return f(g("div",{class:"loading"},null),[[b("bt-loading"),!0]]);const n={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return a[t]=a[t].replace(/&(lt|gt|nbsp|amp|quot);/gi,(e,t)=>n[t]),k("input",{type:"text",value:a[t],class:"bt-table-input w-full",title:"点击修改备注，失去焦点后自动保存",placeholder:e.noPlace?"":"".concat("点击编辑备注"),onBlur:n=>{if(a[t]===n.target.value)return!1;a[t]=n.target.value,e.edit?e.edit(a):K(a,e.table)}})}}},K=async({id:e,ps:n,remark:s},r)=>{await t({loading:"正在修改备注信息，请稍后...",request:a({id:e,table:r,ps:n||s||""}),message:!0})},M=e=>s({component:()=>r(()=>import("./index194.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:e,title:"创建容器",area:74,btn:"创建"}),J=e=>s({component:()=>r(()=>import("./real-monitor-dialog.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),title:"【".concat(e.name,"】实时监控"),area:100,compData:{row:e}}),F=e=>s({component:()=>r(()=>import("./container-rename.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{row:e,type:"dialog"},title:"重命名容器【".concat(e.name,"】"),area:40,btn:"保存"}),Q=async()=>{t({request:n({version:-1,product_type:10}),success:({data:e})=>{s({component:()=>r(()=>import("./index159.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),area:52,compData:{name:"Docker",type:10,id:e.msg[0].id,description:e.msg[0].question}})}})},G=(e,t)=>(l(t)||(t=""),s({component:()=>r(()=>import("./index195.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),title:"容器【".concat(e.name,"】详情"),area:[90,64],compData:{row:e,type:t}})),Y=e=>s({component:()=>r(()=>import("./container-terminal-dialog.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),title:"宝塔终端",area:[80,50],compData:{cmd:e}}),X=async e=>{if("running"!==e.status)return m.error("容器未运行");s({title:"shell类型",area:40,component:()=>r(()=>import("./shell-type-select.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{row:e,openTerminalLog:Y},btn:["确认"]})},Z=e=>s({component:()=>r(()=>import("./pull-mirror-dialog.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),title:"日志",area:64,compData:{isOther:e}}),$=e=>s({component:()=>r(()=>import("./index196.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),title:"添加Yaml模板",area:64,btn:"添加",compData:{callback:e}}),ee=async(e,t,a,n)=>{const{label:s,value:r}=n,o=async(e,t)=>{const{id:a}=e;if("delete"===r)return await d({data:JSON.stringify({id:a})});{const e={id:a,status:r};return await u({data:JSON.stringify(e)})}};await e({title:"批量".concat(s,"容器"),content:"批量".concat(s,"已选的容器，是否继续操作！"),column:[{label:"容器名",prop:"name"},L()],onConfirm:async()=>(await t(o),z(),!1)})},te=({terminalEvent:e,logDataEvent:a,deleteDataEvent:n,conDetailEvent:s,setStatusEvent:r,setStatusTitle:o,openContainerBackups:l,changeTaskTopEvent:m,statusFilterKey:u,moreEvent:d})=>[R(),W({event:(e,t)=>m(e,t),param:"is_top"}),{label:"容器名",prop:"name",render:e=>g("span",{class:"bt-link",onClick:()=>s(e)},[e.name])},{label:"容器ID",isCustom:!0,prop:"id",width:120,render:e=>g(v,{placement:"top"},{default:()=>g("div",{class:"w-[100px] h-full",onClick:()=>i({value:e.id})},[e.id.slice(0,12)]),content:()=>g("div",null,[e.id])})},{label:"备份",isCustom:!1,width:60,render:e=>e.hasOwnProperty("backup_count")?g("span",{class:"bt-link ".concat(e.backup_count>0?"":"!text-warning"),onClick:()=>l(e)},[e.backup_count>0?"有(".concat(e.backup_count,")"):"无备份"]):g("span",{class:"bt-link !text-warning",onClick:()=>l(e)},["无备份"])},{label:"状态",renderHeader(){const e=[{title:"全部",key:"all"},{title:"正在运行",key:"running"},{title:"暂停",key:"paused"},{title:"停止",key:"exited"}];return k("div",{class:"flex items-center flex-nowrap"},["",k(y,{onCommand:e=>o(e)},{default:()=>k("span",{class:"text-[1.2rem] flex items-center"},[[g("span",{class:"status-header-text"},[x("状态"),"all"===u.value?"":"(".concat(e.find(e=>e.key===u.value).title,")")])],k("i",{class:"svgtofont-el-arrow-down "})]),dropdown:()=>{let t;return g(D,null,N(t=e.map(e=>g(C,{command:e.key},{default:()=>[e.title]})))?t:{default:()=>[t]})}})])},prop:"status",isCustom:!0,width:120,render:e=>{let t=[],a=[];return"running"===e.status?(a=["运行中",k("span",{class:"svgtofont-icon-start text-[#20a53a]"})],t=[{title:"停止",key:"stop"},{title:"重启",key:"restart"},{title:"强制停止",key:"kill"},{title:"暂停",key:"pause"}]):"exited"===e.status?(a=["已停止",k("span",{class:"svgtofont-icon-stop text-[#ff0000]"},{})],t=[{title:"启动",key:"start"},{title:"重启",key:"restart"}]):(a=["已暂停",k("span",{class:"svgtofont-icon-stop text-[#ff0000]"},{})],t=[{title:"重启",key:"restart"},{title:"恢复",key:"unpause"},{title:"强制停止",key:"kill"}]),k(y,{onCommand:t=>r(e,t)},{default:()=>g("span",{class:("running"===e.status?"text-[#20a53a]":"text-[#ff0000]")+" flex items-center"},[a]),dropdown:()=>{let e;return g(D,null,N(e=t.map(e=>g(C,{key:e.key,command:e.key},{default:()=>[e.title]})))?e:{default:()=>[e]})}})}},{label:"镜像",isCustom:!0,prop:"image",minWidth:100},{label:"IP",isCustom:!1,prop:"ip",minWidth:60,render:e=>e.ip.length>0?e.ip[0]:""},{label:"IPV6",isCustom:!1,prop:"ipv6",minWidth:60,render:e=>e.ipv6.length>0?e.ipv6[0]:""},{label:"CPU / 内存",isCustom:!1,prop:"cpu_mem",columnKey:"cpu_mem",showOverflowTooltip:!1,render:e=>{const t=H.value[e.id];let a=Number(t.cpu_usage),n=Number(t.mem_percent);return a&&a>100&&(a=100),n&&n>100&&(n=100),"running"===e.status?void 0===t.cpu_usage||void 0===t.mem_percent?g("div",{class:"loading h-[4.6rem] flex items-center"},[x("正在获取中...")]):g(v,{placement:"top"},{default:()=>g("div",{class:"w-[100px]"},[g("div",{class:"flex items-center justify-between"},[g("span",{class:"w-[3rem] inline-block whitespace-nowrap"},[x("cpu：")]),g(P,{class:"w-[7rem] ml-[1rem]",percentage:a||0,"show-text":!1},null)]),g("div",{class:"flex items-center justify-between"},[g("span",{class:"w-[3rem] inline-block whitespace-nowrap"},[x("内存：")]),g(P,{class:"w-[7rem] ml-[1rem]",percentage:n||0,"show-text":!1},null)])]),content:()=>g("div",null,[x("CPU："),a,x("%"),g("br",null,null),x("内存："),n,x("%")])}):g("div",{class:"h-[4.6rem] flex items-center"},[x("--")])}},{label:"端口(主机--\x3e容器)",prop:"ports",isCustom:!0,minWidth:130,columnKey:"ports",showOverflowTooltip:!0,render:e=>{const t=Object.entries(e.ports)||[],a=[];let n=0;for(let s=0;s<t.length;s++){if(n>=10){a.push("......");break}const e=t[s];e[1]&&(a.push("".concat(e[1][0].HostIp||"0.0.0.0",":").concat(e[1][0].HostPort,"--\x3e").concat(e[0]," ")),n++)}return g("span",{key:e.id,class:"flex items-center whitespace-pre-wrap gap-4 min-h-[3rem]"},[a.map((e,t)=>e.startsWith("0.0.0.0:")?g(E,{trigger:"hover",placement:"bottom",width:"12.5rem","popper-class":"!min-w-[12.5rem]"},{reference:()=>g(j,{type:"success",size:"default",class:"mr-1 cursor-pointer bt-link"},{default:()=>[g("span",{class:"inline-flex items-center gap-x-1"},[g("i",{class:"svgtofont-el-link !text-[1.4rem] !text-primary"},null),e])]}),default:()=>g("div",{class:"-m-[12px]"},[g("div",{class:"px-[16px] py-[8px] cursor-pointer text-center hover:bg-[#f5f5f5]",onClick:()=>de(e,"http")},[x("HTTP协议访问")]),g("div",{class:"px-[16px] py-[8px] cursor-pointer text-center hover:bg-[#f5f5f5]",onClick:()=>de(e,"https")},[x("HTTPS协议访问")])])}):g(j,{type:"success",size:"default",class:"mr-1"},N(e)?e:{default:()=>[e]}))])}},{label:"创建时间",isCustom:!1,prop:"created_time",width:150,render:e=>c(e.created_time)},U({edit:async e=>{try{t({request:p({data:JSON.stringify({id:e.id,remark:e.remark})}),message:!0})}catch(a){}},noPlace:!0,noCustom:!0,prop:"remark",table:"containers",width:200}),B([{onClick:s,title:"管理"},{onClick:e,title:"终端"},{onClick:n,title:"删除"},{width:50,onClick:d,isMore:!0,menu:[{key:"log",title:"日志"},{key:"reName",title:"重命名"},{key:"realMonitor",title:"实时监控"},{key:"dir",title:"目录"}]}])],ae=()=>[R({key:"project_name"}),{label:"Compose模板名",prop:"project_name",minWidth:100},{label:"路径",prop:"conf_file",showOverflowTooltip:!0,minWidth:100},{label:"备注",prop:"remark",minWidth:100}],ne=({setPort:e,delPort:t})=>[{label:"本地端口",prop:"server",render:t=>g(T,{size:"small",modelValue:t.server,onInput:a=>e(a,t,"server"),placeholder:"例如：80"},null)},{label:"容器",prop:"con",render:t=>g(T,{size:"small",modelValue:t.con,onInput:a=>e(a,t,"con"),placeholder:"例如：80"},null)},{label:"对外暴露",prop:"output",width:100,render:t=>g(V,{size:"small",modelValue:t.output,onChange:a=>e(a,t,"output")},null),renderHeader:()=>{return e="允许外部访问会将端口映射出去，所有人都可以访问这个端口(不建议)",g("div",{class:"flex items-center"},[g("span",null,["对外暴露"]),g(v,{content:e,placement:"top"},{default:()=>[g("span",{class:"ml-4px bt-ico-ask"},["?"])]})]);var e}},{label:"协议",prop:"protocol ",width:220,render:a=>g("div",{class:"flex items-center"},[g(I,{modelValue:a.protocol,onChange:t=>e(t,a,"protocol")},{default:()=>[g(A,{value:"tcp"},{default:()=>[x("TCP")]}),g(A,{value:"udp"},{default:()=>[x("UDP")]})]}),g(S,{class:"!ml-[1rem] h-[2.8]",onClick:()=>t(a)},{default:()=>[g("i",{class:"svgtofont-el-delete"},null)]})])}],se=({changeNet:e,delNet:t,netOptions:a})=>[{label:"网络名称",prop:"network",minWidth:110,render:t=>g("div",{class:"h-[3rem]"},[g(w,{modelValue:t.network,class:"!w-[20rem]",options:a.value,onChange:a=>e(t,a,"network")},null)])},{label:"IPV4地址",prop:"con",width:150,render:t=>g(T,{size:"default",modelValue:t.ip4,"onUpdate:modelValue":e=>t.ip4=e,disabled:"bridge"==t.network||"none"==t.network||"host"==t.network,onBlur:a=>e(t,a.target.value,"ip4"),placeholder:"bridge"===t.network||"none"===t.network||"host"===t.network?"非自定义网卡":"例如：172.20.x.x"},null)},{label:"IPV6地址",prop:"protocol ",minWidth:100,render:a=>g("div",{class:"flex items-center"},[g(T,{size:"default",modelValue:a.ip6,"onUpdate:modelValue":e=>a.ip6=e,disabled:"bridge"==a.network||"none"==a.network||"host"==a.network,onBlur:t=>e(a,t.target.value,"ip6"),placeholder:"bridge"===a.network||"none"===a.network||"host"===a.network?"自定义网卡可以设置":"例如：2001:0db8::1"},null),g(S,{class:"!ml-[1rem] h-[2.8]",onClick:()=>t(a)},{default:()=>[g("i",{class:"svgtofont-el-delete"},null)]})])}],re=()=>new Promise((e,t)=>{const a=indexedDB.open("ImageCacheDB",1);a.onupgradeneeded=e=>{e.target.result.createObjectStore("images",{keyPath:"url"})},a.onsuccess=()=>e(a.result),a.onerror=()=>t(a.error)}),oe=async()=>{const e=await re();return new Promise((t,a)=>{const n=e.transaction("images","readwrite").objectStore("images").clear();n.onsuccess=()=>t(),n.onerror=()=>a(n.error)})},le=async e=>{let t=await(async e=>{const t=await re();return new Promise((a,n)=>{const s=t.transaction("images","readonly").objectStore("images").get(e);s.onsuccess=()=>a(s.result?s.result.data:null),s.onerror=()=>n(s.error)})})(e);if(t)return t;{const t=await(async e=>{const t=await fetch(e),a=t.headers.get("content-type");if(!a||!a.startsWith("image/"))return"/static/img/soft_ico/icon_plug.svg";const n=await t.blob();return new Promise((e,t)=>{const a=new FileReader;a.onloadend=()=>e(a.result),a.onerror=()=>e("/static/img/soft_ico/icon_plug.svg"),a.readAsDataURL(n)})})(e);return await(async(e,t)=>{const a=await re();return new Promise((n,s)=>{const r=a.transaction("images","readwrite").objectStore("images").put({url:e,data:t});r.onsuccess=()=>n(),r.onerror=()=>s(r.error)})})(e,t),t}},ie=h(!1),ce=h("docker-appstore"),{getDockerState:pe,refs:{settingData:me}}=e();_(pe,1e3);const ue=async()=>{s({component:()=>r(()=>import("./index197.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),title:"安装",area:64,btn:"确定"})},de=(e,t)=>{const a=window.vite_public_ip,n=e.split("--\x3e")[0].split(":")[1],s="".concat(t,"://").concat(a,":").concat(n);window.open(s,"_blank")};export{J as C,Q as N,M as a,q as b,oe as c,ie as d,te as e,U as f,le as g,ue as h,ne as i,se as j,$ as k,ae as l,ce as m,G as o,Z as p,F as r,X as t,ee as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
