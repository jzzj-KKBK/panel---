import{l as a,L as t,K as e,k as s,a0 as o,o as l}from"./utils-lib.js?v=1756369731";import{_ as n}from"./index103.js?v=1756369731";import{c as i,r,e as c,w as m,p,G as u,q as d,v as _,A as b,B as f,H as h,x as v,D as y}from"./base-lib.js?v=1756369731";import{a as j,d as k,h as w,u as q,c as g}from"./column.js?v=1756369731";import{getModulesList as x,deleteDatabase as C,backupSqliteData as D,deleteSqliteData as E}from"./database.js?v=1756369731";import{g as R}from"./useStore2.js?v=1756369731";import{i as L,o as T,h as A}from"./validator.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const I=i({__name:"index",setup(i){const{refs:{isRefreshTable:I},resetRefresh:O}=R(),P=r(),V=r(!1),H=r([]),S=async(a,t,e,s,o)=>{const{label:l,value:n}=s;await a({title:"批量".concat(l),content:"批量".concat(l,"已选数据库，是否继续操作！"),column:[{prop:"name",label:"数据库名"},g()],onConfirm:async()=>{const a=await(async()=>{const a={back:D,delete:E}[n],t=e.value.map(a=>({path:a.path,name:a.name})),s=A([],[],!1,{params:{database_list:t}});if(a)return await a(s)})();z();const{data:t}=L(a.data);T(t,{title:"".concat(l)}),o&&o()}})},W=()=>{a({title:"添加SQLite数据库",area:48,btn:!0,component:()=>t(()=>import("./add-sqlite.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},z=async()=>{try{const a=await e({request:x({},"sqlite"),loading:V});H.value=null==a?void 0:a.data}catch(a){}},B=[j({type:"page",key:"name"}),{label:"数据库名称",prop:"name",minWidth:90},{label:"备份",minWidth:180,isCustom:!0,render:e=>c("span",{class:"cursor-pointer",style:{color:e.backup_count>0?"#20a53a":"#f0ad4e"},onClick:()=>(e=>{a({title:"数据库备份详情【"+e.name+"】",area:70,compData:e,component:()=>t(()=>import("./back-sqlite.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})})(e)},[e.backup_count>0?"有备份(".concat(e.backup_count,")"):"点击备份"])},k({prop:"path"}),w({prop:"size",width:100}),q([{onClick:e=>{a({title:"管理",area:[114,65],compData:{...e,list:H.value},component:()=>t(()=>import("./index137.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},title:"管理"},{onClick:async a=>{try{await l({title:"删除数据库文件【"+(null==a?void 0:a.name)+"】",content:"删除选中的数据库文件后，该数据库文件将不在列表中显示，是否继续操作？"}),await e({request:C({path:a.path},"sqlite"),loading:"正在删除数据库,请稍后...",message:!0}),z()}catch(t){}},title:"删除"}])],G=[{label:"备份数据库",value:"back",event:S},{label:"删除数据库",value:"delete",event:S}];return m(()=>I.value,async a=>{a&&await z(),O()}),p(()=>{z()}),(a,t)=>{const e=y,l=s,i=o,r=n,m=u("bt-loading");return d(),_("div",null,[c(r,null,{"header-left":b(()=>[c(e,{type:"primary",onClick:W},{default:b(()=>[...t[0]||(t[0]=[f(" 添加数据库文件 ",-1)])]),_:1})]),content:b(()=>[h(c(l,{ref_key:"sqliteTableRef",ref:P,column:B,data:v(H)},null,8,["data"]),[[m,v(V)],[m,"正在加载数据库列表...","title"]])]),"footer-left":b(()=>[c(i,{"table-ref":v(P),options:G},null,8,["table-ref"])]),_:1})])}}});export{I as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
