import{c as e,r as a,p as o,q as r,M as l,A as t,e as s,x as d,a9 as p,S as m,a7 as i}from"./base-lib.js?v=1756369731";import{T as u,K as c,ag as _,j as n,W as f}from"./utils-lib.js?v=1756369731";import{a$ as b,E as v}from"./firewall.js?v=1756369731";import{g as P,a as D}from"./useMethod6.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./column.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore5.js?v=1756369731";import"./validator.js?v=1756369731";const w=e({__name:"add-port-transmit",props:{compData:{default:()=>{}}},setup(e,{expose:w}){const V=e,g=a(),T=a({protocol:V.compData.Protocol?V.compData.Protocol.toLowerCase():"tcp",s_ports:V.compData.S_Port?V.compData.S_Port:"",d_ports:V.compData.T_Port?V.compData.T_Port:"",d_address:V.compData.T_Address?V.compData.T_Address:"",id:V.compData.id?V.compData.id:"",brief:V.compData.brief?V.compData.brief:""}),h=[{content:"如果是本机端口转发，目标IP为：127.0.0.1"},{content:"如果目标IP不填写，默认则为本机端口转发!"}],j=[{label:"TCP",value:"tcp"},{label:"UDP",value:"udp"}],S=a(!!V.compData.id),A={s_ports:[{validator:(e,a,o)=>{a.length>0&&(u(a)||o(new Error("端口格式错误，可用范围：1-65535")),o()),o(new Error("请输入源端口"))},trigger:["blur","change"],required:!0}],d_ports:[{validator:(e,a,o)=>{a.length>0&&(u(a)||o(new Error("端口格式错误，可用范围：1-65535")),o()),o(new Error("请输入目标端口"))},trigger:["blur","change"],required:!0}]};return o(()=>{const e=V.compData;S.value=void 0!==e.id,T.value.protocol=e.Protocol?e.Protocol.toLowerCase():"tcp",T.value.s_ports=e.S_Port?e.S_Port:"",T.value.d_ports=e.T_Port?e.T_Port:"",T.value.d_address=e.T_Address?e.T_Address:"",T.value.id=e.id?e.id:""}),w({onConfirm:async e=>{await g.value.validate();const a={operation:"add",protocol:T.value.protocol,S_Port:T.value.s_ports,T_Port:T.value.d_ports,T_Address:T.value.d_address,brief:T.value.brief,id:T.value.id};S.value||delete a.id,""==a.T_Address&&(a.T_Address="127.0.0.1"),await c({loading:"正在设置端口转发，请稍后...",request:S.value?b({new_data:JSON.stringify(a),old_data:JSON.stringify(V.compData)}):v(a),message:!0}),V.compData.refreshFn(),e(),P(),D()}}),(e,a)=>{const o=_,u=p,c=n,b=m,v=f,P=i;return r(),l(P,{ref_key:"editIpRulesRef",ref:g,rules:A,model:d(T),class:"p-[2rem] addfrom"},{default:t(()=>[s(u,{label:"协议"},{default:t(()=>[s(o,{modelValue:d(T).protocol,"onUpdate:modelValue":a[0]||(a[0]=e=>d(T).protocol=e),options:j,class:"!w-[24rem]"},null,8,["modelValue"])]),_:1}),s(u,{label:"源端口",prop:"s_ports"},{default:t(()=>[s(c,{modelValue:d(T).s_ports,"onUpdate:modelValue":a[1]||(a[1]=e=>d(T).s_ports=e),type:"number",min:"1",max:"65535",width:"24rem",placeholder:"请输入源端口"},null,8,["modelValue"])]),_:1}),s(u,{label:"目标IP"},{default:t(()=>[s(c,{modelValue:d(T).d_address,"onUpdate:modelValue":a[2]||(a[2]=e=>d(T).d_address=e),width:"24rem",placeholder:"请输入目标IP地址",clearable:""},null,8,["modelValue"])]),_:1}),s(u,{label:"目标端口",prop:"d_ports"},{default:t(()=>[s(c,{modelValue:d(T).d_ports,"onUpdate:modelValue":a[3]||(a[3]=e=>d(T).d_ports=e),width:"24rem",placeholder:"请输入目标端口",clearable:""},null,8,["modelValue"])]),_:1}),s(u,{label:"备注"},{default:t(()=>[s(b,{modelValue:d(T).brief,"onUpdate:modelValue":a[4]||(a[4]=e=>d(T).brief=e),class:"!w-[24rem] special-input",placeholder:"可为空",clearable:""},null,8,["modelValue"])]),_:1}),s(v,{options:h,listStyle:"disc",class:"pl-[3.6rem] pt-[2rem]"})]),_:1},8,["model"])}}});export{w as default};
