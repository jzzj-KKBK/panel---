import{c as a,W as s,r as e,X as t,g as n,w as l,p as i,G as u,q as o,M as r,A as c,H as p,x as d,v,y as m,e as f,z as g,J as _,C as y,be as b,bf as h,D as x,ax as w}from"./base-lib.js?v=1756369731";import{aq as k,o as I,K as j,bz as q,d as C,_ as N,aL as z,V as R,e as B}from"./utils-lib.js?v=1756369731";import{_ as M}from"./index104.js?v=1756369731";import{l as W}from"./validator.js?v=1756369731";const A={class:"flex items-center justify-center"},D={class:"h-[2.2rem] w-[2.2rem] flex overflow-hidden justify-center items-center status-icon <2xl:hidden"},G={class:"<2xl:hidden"};var H=(a=>(a.stop="停止",a.start="启动",a.restart="重启",a.reload="重载",a))(H||{});const J=B(a({__name:"index",props:s({pluginInfo:{default:()=>({title:"",name:"defalut",status:!1,version:"",admin:!1,setup:!1,s_version:"",s_status:!1})},pluginName:{default:"defalut"},isRequest:{type:Boolean,default:!0}},{pluginInfo:{default:{title:"",name:"",status:!0,version:"",admin:!1,s_version:""}},pluginInfoModifiers:{}}),emits:["update:pluginInfo"],setup(a){const s=a,B=e(!1),J=e(!1),K=e(0),L=e(!1),T=t(a,"pluginInfo"),V=n(()=>H[T.value.s_status?"stop":"start"]);l(()=>s.pluginInfo,a=>{if(B.value=!1,!s.isRequest){if(R(a,"s_status"))T.value={...a};else{const{title_en:s,name:e,version:t,admin:n,s_version:l,status:i}=a;T.value={title:s,name:e,status:i,version:t,admin:n,s_version:l,s_status:i}}B.value=!0}},{immediate:!0,deep:!0});const X=()=>{W({name:T.value.name})},$=async a=>{try{const e=H[a],t=s.pluginInfo.s_version;await I({title:e+t,icon:"warning-filled",content:"你确定要".concat(e).concat(t,"服务，是否继续？")}),await j({loading:J,request:q({name:t,type:a}),message:!0,success:async()=>{await(async()=>{try{const a=["nginx","apache","openlitespeed"].includes(T.value.name)?"web":"pureftpd"===T.value.name?"pure-ftpd":T.value.name,{data:s}=await z({name:a});setTimeout(()=>{T.value=s,L.value=!0},100)}catch(a){T.value.status=!1}})(),L.value=!0}})}catch(e){}},E=()=>{K.value=document.body.clientWidth};return i(()=>{(s.pluginInfo.title||s.pluginName)&&s.isRequest&&(async()=>{try{J.value=!0;const{data:a}=await k({sName:s.pluginInfo.name||s.pluginName});T.value=a,L.value=!0}catch(a){T.value.s_status=!1,L.value=!0}finally{J.value=!1,B.value=!1}})(),E(),window.onresize=E}),(a,s)=>{const e=M,t=C,n=N,l=x,i=w,k=u("bt-loading");return o(),r(i,{placement:"top-start",width:"redis"===T.value.name?140:200,class:"","popper-class":"white-tips-popover",trigger:"hover"},{reference:c(()=>[p((o(),v("div",b(h(a.$attrs)),[d(B)?(o(),r(l,{key:0,type:T.value.s_status?"default":"danger",class:"plugin-status-btn",plain:"",onClick:X},{default:c(()=>[m("div",{class:_(["h-full inline-block flex items-center",T.value.s_status?"hover:text-primary":"hover:text-danger"])},[m("span",D,[f(t,{src:"/static/icons/soft/ico-".concat(T.value.name||a.pluginName||"defalut",".svg"),class:"inline-block",all:!0},null,8,["src"])]),m("span",null,g(T.value.title),1),m("span",G," "+g(T.value.version),1),f(n,{icon:"icon-"+(T.value.s_status?"start":"stop"),class:_(["ml-[4px]",T.value.s_status?"!text-primary":"!text-danger"])},null,8,["icon","class"])],2)]),_:1},8,["type"])):y("",!0)],16)),[[k,d(J)],[k,"small","size"]])]),default:c(()=>[m("div",A,[m("span",{class:"bt-link",onClick:s[0]||(s[0]=a=>$(T.value.s_status?"stop":"start"))},g(d(V)),1),f(e),m("span",{class:"bt-link",onClick:s[1]||(s[1]=a=>$("restart"))},"重启"),f(e),m("span",{class:"bt-link",onClick:s[2]||(s[2]=a=>$("reload"))},"重载"),"redis"!==T.value.name?(o(),r(e,{key:0})):y("",!0),"redis"!==T.value.name?(o(),v("span",{key:1,class:"bt-link",onClick:s[3]||(s[3]=a=>d(W)({name:T.value.name}))},"告警设置")):y("",!0)])]),_:1},8,["width"])}}}),[["__scopeId","data-v-bdc02221"]]);export{J as B};
