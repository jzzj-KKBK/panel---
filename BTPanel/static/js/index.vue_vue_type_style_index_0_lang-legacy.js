!function(){function e(e,t,i,r,n,s,o){try{var a=e[s](o),c=a.value}catch(e){return void i(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function t(t){return function(){var i=this,r=arguments;return new Promise(function(n,s){var o=t.apply(i,r);function a(t){e(o,n,s,a,c,"next",t)}function c(t){e(o,n,s,a,c,"throw",t)}a(void 0)})}}function i(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){n(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function n(e,t,i){return(t=k(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",n=i.toStringTag||"@@toStringTag";function a(i,r,n,s){var a=r&&r.prototype instanceof l?r:l,h=Object.create(a.prototype);return o(h,"_invoke",function(i,r,n){var s,o,a,l=0,h=n||[],u=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,i){return s=t,o=0,a=e,d.n=i,c}};function f(i,r){for(o=i,a=r,t=0;!u&&l&&!n&&t<h.length;t++){var n,s=h[t],f=d.p,v=s[2];i>3?(n=v===r)&&(a=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=e):s[0]<=f&&((n=i<2&&f<s[1])?(o=0,d.v=r,d.n=s[1]):f<v&&(n=i<3||s[0]>r||r>v)&&(s[4]=i,s[5]=r,d.n=v,o=0))}if(n||i>1)return c;throw u=!0,r}return function(n,h,v){if(l>1)throw TypeError("Generator is already running");for(u&&1===h&&f(h,v),o=h,a=v;(t=o<2?e:a)||!u;){s||(o?o<3?(o>1&&(d.n=-1),f(o,a)):d.n=a:d.v=a);try{if(l=2,s){if(o||(n="next"),t=s[n]){if(!(t=t.call(s,a)))throw TypeError("iterator result is not an object");if(!t.done)return t;a=t.value,o<2&&(o=0)}else 1===o&&(t=s.return)&&t.call(s),o<2&&(a=TypeError("The iterator does not provide a '"+n+"' method"),o=1);s=e}else if((t=(u=d.n<0)?a:i.call(r,d))!==c)break}catch(t){s=e,o=1,a=t}finally{l=1}}return{value:t,done:u}}}(i,n,s),!0),h}var c={};function l(){}function h(){}function u(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(o(t={},r,function(){return this}),t),f=u.prototype=l.prototype=Object.create(d);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,o(e,n,"GeneratorFunction")),e.prototype=Object.create(f),e}return h.prototype=u,o(f,"constructor",u),o(u,"constructor",h),h.displayName="GeneratorFunction",o(u,n,"GeneratorFunction"),o(f),o(f,n,"Generator"),o(f,r,function(){return this}),o(f,"toString",function(){return"[object Generator]"}),(s=function(){return{w:a,m:v}})()}function o(e,t,i,r){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}o=function(e,t,i,r){function s(t,i){o(e,t,function(e){return this._invoke(t,i,e)})}t?n?n(e,t,{value:i,enumerable:!r,configurable:!r,writable:!r}):e[t]=i:(s("next",0),s("throw",1),s("return",2))},o(e,t,i,r)}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function c(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,s,o,a=[],c=!0,l=!1;try{if(s=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(r=s.call(i)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){l=!0,n=e}finally{try{if(!c&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(l)throw n}}return a}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t,i,r){var n=u(_(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},u.apply(null,arguments)}function d(e,t,i){return t=_(t),function(e,t){if(t&&("object"==a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(e,v()?Reflect.construct(t,i||[],_(e).constructor):t.apply(e,i))}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(v=function(){return!!e})()}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function m(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=y(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function y(e,t){if(e){if("string"==typeof e)return S(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function w(e,t,i){return t&&b(e.prototype,t),i&&b(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}System.register(["./base-lib-legacy.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./add-host.vue_vue_type_script_setup_true_lang-legacy.js?v=1756369731","./useController-legacy2.js?v=1756369731"],function(e,i){"use strict";var n,o,u,_,y,S,b,k,L,x,E,R,D,A,M,T,B,O,P,I,H,F,W,N;return{setters:[function(e){n=e.c,o=e.r,u=e.k,_=e.w,y=e.p,S=e.a0,b=e.n,k=e.aD,L=e.a4,x=e.q,E=e.v,R=e.y,D=e.x,A=e.e,M=e.A,T=e.B,B=e.C,O=e.aW,P=e.D,I=e.az},function(e){H=e.ah},function(e){F=e._},function(e){W=e.u,N=e.i}],execute:function(){var U={exports:{}};!function(e){var t;self,e.exports=(t={},function(){var e=t;function i(e,t,i){return e.addEventListener(t,i),{dispose:function(){i&&e.removeEventListener(t,i)}}}Object.defineProperty(e,"__esModule",{value:!0}),e.AttachAddon=void 0,e.AttachAddon=function(){function e(t,i){C(this,e),this._disposables=[],this._socket=t,this._socket.binaryType="arraybuffer",this._bidirectional=!(i&&!1===i.bidirectional)}return w(e,[{key:"activate",value:function(e){var t=this;this._disposables.push(i(this._socket,"message",function(t){var i=t.data;e.write("string"==typeof i?i:new Uint8Array(i))})),this._bidirectional&&(this._disposables.push(e.onData(function(e){return t._sendData(e)})),this._disposables.push(e.onBinary(function(e){return t._sendBinary(e)}))),this._disposables.push(i(this._socket,"close",function(){return t.dispose()})),this._disposables.push(i(this._socket,"error",function(){return t.dispose()}))}},{key:"dispose",value:function(){var e,t=m(this._disposables);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(i){t.e(i)}finally{t.f()}}},{key:"_sendData",value:function(e){this._checkOpenSocket()&&this._socket.send(e)}},{key:"_sendBinary",value:function(e){if(this._checkOpenSocket()){for(var t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);this._socket.send(t)}}},{key:"_checkOpenSocket",value:function(){switch(this._socket.readyState){case WebSocket.OPEN:return!0;case WebSocket.CONNECTING:throw new Error("Attach addon was loaded before socket was open");case WebSocket.CLOSING:return!1;case WebSocket.CLOSED:throw new Error("Attach addon socket is closed");default:throw new Error("Unexpected socket state")}}}])}()}(),t)}(U);var j=U.exports,z={exports:{}};!function(e){self,e.exports=function(){var e={903:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var r=i(274),n=i(627),s=i(237),o=i(860),a=i(374),c=i(296),l=i(345),h=i(859),u=i(399),f=i(855),v=function(e){function t(e,i,n,s,o,a,u,f,v,_){var g;return C(this,t),(g=d(this,t))._terminal=e,g._container=i,g._alpha=o,g._themeService=a,g._bufferService=u,g._optionsService=f,g._decorationService=v,g._coreBrowserService=_,g._deviceCharWidth=0,g._deviceCharHeight=0,g._deviceCellWidth=0,g._deviceCellHeight=0,g._deviceCharLeft=0,g._deviceCharTop=0,g._selectionModel=(0,c.createSelectionRenderModel)(),g._bitmapGenerator=[],g._charAtlasDisposable=g.register(new h.MutableDisposable),g._onAddTextureAtlasCanvas=g.register(new l.EventEmitter),g.onAddTextureAtlasCanvas=g._onAddTextureAtlasCanvas.event,g._cellColorResolver=new r.CellColorResolver(g._terminal,g._optionsService,g._selectionModel,g._decorationService,g._coreBrowserService,g._themeService),g._canvas=g._coreBrowserService.mainDocument.createElement("canvas"),g._canvas.classList.add("xterm-".concat(n,"-layer")),g._canvas.style.zIndex=s.toString(),g._initCanvas(),g._container.appendChild(g._canvas),g._refreshCharAtlas(g._themeService.colors),g.register(g._themeService.onChangeColors(function(e){g._refreshCharAtlas(e),g.reset(),g.handleSelectionChanged(g._selectionModel.selectionStart,g._selectionModel.selectionEnd,g._selectionModel.columnSelectMode)})),g.register((0,h.toDisposable)(function(){g._canvas.remove()})),g}return g(t,e),w(t,[{key:"canvas",get:function(){return this._canvas}},{key:"cacheCanvas",get:function(){var e;return null===(e=this._charAtlas)||void 0===e?void 0:e.pages[0].canvas}},{key:"_initCanvas",value:function(){this._ctx=(0,a.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}},{key:"handleBlur",value:function(){}},{key:"handleFocus",value:function(){}},{key:"handleCursorMove",value:function(){}},{key:"handleGridChanged",value:function(e,t){}},{key:"handleSelectionChanged",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._selectionModel.update(this._terminal._core,e,t,i)}},{key:"_setTransparency",value:function(e){if(e!==this._alpha){var t=this._canvas;this._alpha=e,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,t),this._refreshCharAtlas(this._themeService.colors),this.handleGridChanged(0,this._bufferService.rows-1)}}},{key:"_refreshCharAtlas",value:function(e){if(!(this._deviceCharWidth<=0&&this._deviceCharHeight<=0)){this._charAtlas=(0,n.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,e,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlasDisposable.value=(0,l.forwardEvent)(this._charAtlas.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),this._charAtlas.warmUp();for(var t=0;t<this._charAtlas.pages.length;t++)this._bitmapGenerator[t]=new _(this._charAtlas.pages[t].canvas)}}},{key:"resize",value:function(e){this._deviceCellWidth=e.device.cell.width,this._deviceCellHeight=e.device.cell.height,this._deviceCharWidth=e.device.char.width,this._deviceCharHeight=e.device.char.height,this._deviceCharLeft=e.device.char.left,this._deviceCharTop=e.device.char.top,this._canvas.width=e.device.canvas.width,this._canvas.height=e.device.canvas.height,this._canvas.style.width="".concat(e.css.canvas.width,"px"),this._canvas.style.height="".concat(e.css.canvas.height,"px"),this._alpha||this._clearAll(),this._refreshCharAtlas(this._themeService.colors)}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._charAtlas)||void 0===e||e.clearTexture()}},{key:"_fillCells",value:function(e,t,i,r){this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,r*this._deviceCellHeight)}},{key:"_fillMiddleLineAtCells",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=Math.ceil(.5*this._deviceCellHeight);this._ctx.fillRect(e*this._deviceCellWidth,(t+1)*this._deviceCellHeight-r-this._coreBrowserService.dpr,i*this._deviceCellWidth,this._coreBrowserService.dpr)}},{key:"_fillBottomLineAtCells",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._ctx.fillRect(e*this._deviceCellWidth,(t+1)*this._deviceCellHeight+r-this._coreBrowserService.dpr-1,i*this._deviceCellWidth,this._coreBrowserService.dpr)}},{key:"_curlyUnderlineAtCell",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;var r=this._coreBrowserService.dpr;this._ctx.lineWidth=r;for(var n=0;n<i;n++){var s=(e+n)*this._deviceCellWidth,o=(e+n+.5)*this._deviceCellWidth,a=(e+n+1)*this._deviceCellWidth,c=(t+1)*this._deviceCellHeight-r-1,l=c-r,h=c+r;this._ctx.moveTo(s,c),this._ctx.bezierCurveTo(s,l,o,l,o,c),this._ctx.bezierCurveTo(o,h,a,h,a,c)}this._ctx.stroke(),this._ctx.restore()}},{key:"_dottedUnderlineAtCell",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;var r=this._coreBrowserService.dpr;this._ctx.lineWidth=r,this._ctx.setLineDash([2*r,r]);var n=e*this._deviceCellWidth,s=(t+1)*this._deviceCellHeight-r-1;this._ctx.moveTo(n,s);for(var o=0;o<i;o++){var a=(e+i+o)*this._deviceCellWidth;this._ctx.lineTo(a,s)}this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}},{key:"_dashedUnderlineAtCell",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;var r=this._coreBrowserService.dpr;this._ctx.lineWidth=r,this._ctx.setLineDash([4*r,3*r]);var n=e*this._deviceCellWidth,s=(e+i)*this._deviceCellWidth,o=(t+1)*this._deviceCellHeight-r-1;this._ctx.moveTo(n,o),this._ctx.lineTo(s,o),this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}},{key:"_fillLeftLineAtCell",value:function(e,t,i){this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,this._coreBrowserService.dpr*i,this._deviceCellHeight)}},{key:"_strokeRectAtCell",value:function(e,t,i,r){var n=this._coreBrowserService.dpr;this._ctx.lineWidth=n,this._ctx.strokeRect(e*this._deviceCellWidth+n/2,t*this._deviceCellHeight+n/2,i*this._deviceCellWidth-n,r*this._deviceCellHeight-n)}},{key:"_clearAll",value:function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}},{key:"_clearCells",value:function(e,t,i,r){this._alpha?this._ctx.clearRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,r*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,i*this._deviceCellWidth,r*this._deviceCellHeight))}},{key:"_fillCharTrueColor",value:function(e,t,i){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=s.TEXT_BASELINE,this._clipRow(i);var r=!1;!1!==this._optionsService.rawOptions.customGlyphs&&(r=(0,o.tryDrawCustomChar)(this._ctx,e.getChars(),t*this._deviceCellWidth,i*this._deviceCellHeight,this._deviceCellWidth,this._deviceCellHeight,this._optionsService.rawOptions.fontSize,this._coreBrowserService.dpr)),r||this._ctx.fillText(e.getChars(),t*this._deviceCellWidth+this._deviceCharLeft,i*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}},{key:"_drawChars",value:function(e,t,i){var r,n,s,o,c=e.getChars(),l=e.getCode(),h=e.getWidth();if(this._cellColorResolver.resolve(e,t,this._bufferService.buffer.ydisp+i,this._deviceCellWidth),this._charAtlas&&(o=c&&c.length>1?this._charAtlas.getRasterizedGlyphCombinedChar(c,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,!0):this._charAtlas.getRasterizedGlyph(e.getCode()||f.WHITESPACE_CELL_CODE,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,!0)).size.x&&o.size.y){this._ctx.save(),this._clipRow(i),this._bitmapGenerator[o.texturePage]&&this._charAtlas.pages[o.texturePage].canvas!==this._bitmapGenerator[o.texturePage].canvas&&(null!==(r=this._bitmapGenerator[o.texturePage])&&void 0!==r&&null!==(r=r.bitmap)&&void 0!==r&&r.close(),delete this._bitmapGenerator[o.texturePage]),this._charAtlas.pages[o.texturePage].version!==(null===(n=this._bitmapGenerator[o.texturePage])||void 0===n?void 0:n.version)&&(this._bitmapGenerator[o.texturePage]||(this._bitmapGenerator[o.texturePage]=new _(this._charAtlas.pages[o.texturePage].canvas)),this._bitmapGenerator[o.texturePage].refresh(),this._bitmapGenerator[o.texturePage].version=this._charAtlas.pages[o.texturePage].version);var u=o.size.x;this._optionsService.rawOptions.rescaleOverlappingGlyphs&&(0,a.allowRescaling)(l,h,o.size.x,this._deviceCellWidth)&&(u=this._deviceCellWidth-1),this._ctx.drawImage((null===(s=this._bitmapGenerator[o.texturePage])||void 0===s?void 0:s.bitmap)||this._charAtlas.pages[o.texturePage].canvas,o.texturePosition.x,o.texturePosition.y,o.size.x,o.size.y,t*this._deviceCellWidth+this._deviceCharLeft-o.offset.x,i*this._deviceCellHeight+this._deviceCharTop-o.offset.y,u,o.size.y),this._ctx.restore()}}},{key:"_clipRow",value:function(e){this._ctx.beginPath(),this._ctx.rect(0,e*this._deviceCellHeight,this._bufferService.cols*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}},{key:"_getFont",value:function(e,t){return"".concat(t?"italic":""," ").concat(e?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight," ").concat(this._optionsService.rawOptions.fontSize*this._coreBrowserService.dpr,"px ").concat(this._optionsService.rawOptions.fontFamily)}}])}(h.Disposable);t.BaseRenderLayer=v;var _=function(){function e(t){C(this,e),this.canvas=t,this._state=0,this._commitTimeout=void 0,this._bitmap=void 0,this.version=-1}return w(e,[{key:"bitmap",get:function(){return this._bitmap}},{key:"refresh",value:function(){var e,t=this;null!==(e=this._bitmap)&&void 0!==e&&e.close(),this._bitmap=void 0,u.isSafari||(void 0===this._commitTimeout&&(this._commitTimeout=window.setTimeout(function(){return t._generate()},100)),1===this._state&&(this._state=2))}},{key:"_generate",value:function(){var e,t=this;0===this._state&&(null!==(e=this._bitmap)&&void 0!==e&&e.close(),this._bitmap=void 0,this._state=1,window.createImageBitmap(this.canvas).then(function(e){2===t._state?t.refresh():t._bitmap=e,t._state=0}),this._commitTimeout&&(this._commitTimeout=void 0))}}])}()},949:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRenderer=void 0;var r=i(627),n=i(56),s=i(374),o=i(345),a=i(859),c=i(873),l=i(43),h=i(630),u=i(744),f=function(e){function t(e,i,f,v,_,g,p,y,S,b,w){var k;C(this,t),(k=d(this,t))._terminal=e,k._screenElement=i,k._bufferService=v,k._charSizeService=_,k._optionsService=g,k._coreBrowserService=S,k._themeService=w,k._observerDisposable=k.register(new a.MutableDisposable),k._onRequestRedraw=k.register(new o.EventEmitter),k.onRequestRedraw=k._onRequestRedraw.event,k._onChangeTextureAtlas=k.register(new o.EventEmitter),k.onChangeTextureAtlas=k._onChangeTextureAtlas.event,k._onAddTextureAtlasCanvas=k.register(new o.EventEmitter),k.onAddTextureAtlasCanvas=k._onAddTextureAtlasCanvas.event;var L=k._optionsService.rawOptions.allowTransparency;k._renderLayers=[new u.TextRenderLayer(k._terminal,k._screenElement,0,L,k._bufferService,k._optionsService,p,b,k._coreBrowserService,w),new h.SelectionRenderLayer(k._terminal,k._screenElement,1,k._bufferService,k._coreBrowserService,b,k._optionsService,w),new l.LinkRenderLayer(k._terminal,k._screenElement,2,f,k._bufferService,k._optionsService,b,k._coreBrowserService,w),new c.CursorRenderLayer(k._terminal,k._screenElement,3,k._onRequestRedraw,k._bufferService,k._optionsService,y,k._coreBrowserService,b,w)];var x,E=m(k._renderLayers);try{for(E.s();!(x=E.n()).done;){var R=x.value;(0,o.forwardEvent)(R.onAddTextureAtlasCanvas,k._onAddTextureAtlasCanvas)}}catch(D){E.e(D)}finally{E.f()}return k.dimensions=(0,s.createRenderDimensions)(),k._devicePixelRatio=k._coreBrowserService.dpr,k._updateDimensions(),k._observerDisposable.value=(0,n.observeDevicePixelDimensions)(k._renderLayers[0].canvas,k._coreBrowserService.window,function(e,t){return k._setCanvasDevicePixelDimensions(e,t)}),k.register(k._coreBrowserService.onWindowChange(function(e){k._observerDisposable.value=(0,n.observeDevicePixelDimensions)(k._renderLayers[0].canvas,e,function(e,t){return k._setCanvasDevicePixelDimensions(e,t)})})),k.register((0,a.toDisposable)(function(){var e,t=m(k._renderLayers);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(D){t.e(D)}finally{t.f()}(0,r.removeTerminalFromCache)(k._terminal)})),k}return g(t,e),w(t,[{key:"textureAtlas",get:function(){return this._renderLayers[0].cacheCanvas}},{key:"handleDevicePixelRatioChange",value:function(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._bufferService.cols,this._bufferService.rows))}},{key:"handleResize",value:function(e,t){this._updateDimensions();var i,r=m(this._renderLayers);try{for(r.s();!(i=r.n()).done;)i.value.resize(this.dimensions)}catch(n){r.e(n)}finally{r.f()}this._screenElement.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._screenElement.style.height="".concat(this.dimensions.css.canvas.height,"px")}},{key:"handleCharSizeChanged",value:function(){this.handleResize(this._bufferService.cols,this._bufferService.rows)}},{key:"handleBlur",value:function(){this._runOperation(function(e){return e.handleBlur()})}},{key:"handleFocus",value:function(){this._runOperation(function(e){return e.handleFocus()})}},{key:"handleSelectionChanged",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._runOperation(function(r){return r.handleSelectionChanged(e,t,i)}),this._themeService.colors.selectionForeground&&this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}},{key:"handleCursorMove",value:function(){this._runOperation(function(e){return e.handleCursorMove()})}},{key:"clear",value:function(){this._runOperation(function(e){return e.reset()})}},{key:"_runOperation",value:function(e){var t,i=m(this._renderLayers);try{for(i.s();!(t=i.n()).done;)e(t.value)}catch(r){i.e(r)}finally{i.f()}}},{key:"renderRows",value:function(e,t){var i,r=m(this._renderLayers);try{for(r.s();!(i=r.n()).done;)i.value.handleGridChanged(e,t)}catch(n){r.e(n)}finally{r.f()}}},{key:"clearTextureAtlas",value:function(){var e,t=m(this._renderLayers);try{for(t.s();!(e=t.n()).done;)e.value.clearTextureAtlas()}catch(i){t.e(i)}finally{t.f()}}},{key:"_updateDimensions",value:function(){if(this._charSizeService.hasValidSize){var e=this._coreBrowserService.dpr;this.dimensions.device.char.width=Math.floor(this._charSizeService.width*e),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=1===this._optionsService.rawOptions.lineHeight?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._bufferService.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._bufferService.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows,this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols}}},{key:"_setCanvasDevicePixelDimensions",value:function(e,t){this.dimensions.device.canvas.height=t,this.dimensions.device.canvas.width=e;var i,r=m(this._renderLayers);try{for(r.s();!(i=r.n()).done;)i.value.resize(this.dimensions)}catch(n){r.e(n)}finally{r.f()}this._requestRedrawViewport()}},{key:"_requestRedrawViewport",value:function(){this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}}])}(a.Disposable);t.CanvasRenderer=f},873:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CursorRenderLayer=void 0;var r=i(457),n=i(859),s=i(399),o=i(782),a=function(e){function t(e,i,r,s,a,c,l,h,u,v){var _;return C(this,t),(_=d(this,t,[e,i,"cursor",r,!0,v,a,c,u,h]))._onRequestRedraw=s,_._coreService=l,_._cursorBlinkStateManager=_.register(new n.MutableDisposable),_._cell=new o.CellData,_._state={x:0,y:0,isFocused:!1,style:"",width:0},_._cursorRenderers={bar:_._renderBarCursor.bind(f(_)),block:_._renderBlockCursor.bind(f(_)),underline:_._renderUnderlineCursor.bind(f(_)),outline:_._renderOutlineCursor.bind(f(_))},_.register(c.onOptionChange(function(){return _._handleOptionsChanged()})),_._handleOptionsChanged(),_}return g(t,e),w(t,[{key:"resize",value:function(e){h(t,"resize",this,3)([e]),this._state={x:0,y:0,isFocused:!1,style:"",width:0}}},{key:"reset",value:function(){var e;this._clearCursor(),null!==(e=this._cursorBlinkStateManager.value)&&void 0!==e&&e.restartBlinkAnimation(),this._handleOptionsChanged()}},{key:"handleBlur",value:function(){var e;null!==(e=this._cursorBlinkStateManager.value)&&void 0!==e&&e.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}},{key:"handleFocus",value:function(){var e;null!==(e=this._cursorBlinkStateManager.value)&&void 0!==e&&e.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}},{key:"_handleOptionsChanged",value:function(){var e=this;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager.value||(this._cursorBlinkStateManager.value=new r.CursorBlinkStateManager(function(){return e._render(!0)},this._coreBrowserService)):this._cursorBlinkStateManager.clear(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}},{key:"handleCursorMove",value:function(){var e;null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.restartBlinkAnimation()}},{key:"handleGridChanged",value:function(e,t){!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isPaused?this._render(!1):this._cursorBlinkStateManager.value.restartBlinkAnimation()}},{key:"_render",value:function(e){if(this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden){var t=this._bufferService.buffer.ybase+this._bufferService.buffer.y,i=t-this._bufferService.buffer.ydisp;if(i<0||i>=this._bufferService.rows)this._clearCursor();else{var r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(t).loadCell(r,this._cell),void 0!==this._cell.content){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css;var n=this._optionsService.rawOptions.cursorStyle,s=this._optionsService.rawOptions.cursorInactiveStyle;return s&&"none"!==s&&this._cursorRenderers[s](r,i,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=i,this._state.isFocused=!1,this._state.style=n,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible){if(this._state){if(this._state.x===r&&this._state.y===i&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](r,i,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=i,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}}else this._clearCursor()}},{key:"_clearCursor",value:function(){this._state&&(s.isFirefox||this._coreBrowserService.dpr<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})}},{key:"_renderBarCursor",value:function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillLeftLineAtCell(e,t,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()}},{key:"_renderBlockCursor",value:function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillCells(e,t,i.getWidth(),1),this._ctx.fillStyle=this._themeService.colors.cursorAccent.css,this._fillCharTrueColor(i,e,t),this._ctx.restore()}},{key:"_renderUnderlineCursor",value:function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillBottomLineAtCells(e,t),this._ctx.restore()}},{key:"_renderOutlineCursor",value:function(e,t,i){this._ctx.save(),this._ctx.strokeStyle=this._themeService.colors.cursor.css,this._strokeRectAtCell(e,t,i.getWidth(),1),this._ctx.restore()}}])}(i(903).BaseRenderLayer);t.CursorRenderLayer=a},574:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GridCache=void 0,t.GridCache=function(){function e(){C(this,e),this.cache=[]}return w(e,[{key:"resize",value:function(e,t){for(var i=0;i<e;i++){this.cache.length<=i&&this.cache.push([]);for(var r=this.cache[i].length;r<t;r++)this.cache[i].push(void 0);this.cache[i].length=t}this.cache.length=e}},{key:"clear",value:function(){for(var e=0;e<this.cache.length;e++)for(var t=0;t<this.cache[e].length;t++)this.cache[e][t]=void 0}}])}()},43:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var r=i(197),n=i(237),s=function(e){function t(e,i,r,n,s,o,a,c,l){var h;return C(this,t),(h=d(this,t,[e,i,"link",r,!0,l,s,o,a,c])).register(n.onShowLinkUnderline(function(e){return h._handleShowLinkUnderline(e)})),h.register(n.onHideLinkUnderline(function(e){return h._handleHideLinkUnderline(e)})),h}return g(t,e),w(t,[{key:"resize",value:function(e){h(t,"resize",this,3)([e]),this._state=void 0}},{key:"reset",value:function(){this._clearCurrentLink()}},{key:"_clearCurrentLink",value:function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}},{key:"_handleShowLinkUnderline",value:function(e){if(e.fg===n.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:e.fg&&(0,r.is256Color)(e.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[e.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this._fillBottomLineAtCells(0,t,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e}},{key:"_handleHideLinkUnderline",value:function(e){this._clearCurrentLink()}}])}(i(903).BaseRenderLayer);t.LinkRenderLayer=s},630:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRenderLayer=void 0;var r=function(e){function t(e,i,r,n,s,o,a,c){var l;return C(this,t),(l=d(this,t,[e,i,"selection",r,!0,c,n,a,o,s]))._clearState(),l}return g(t,e),w(t,[{key:"_clearState",value:function(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}}},{key:"resize",value:function(e){h(t,"resize",this,3)([e]),this._selectionModel.selectionStart&&this._selectionModel.selectionEnd&&(this._clearState(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode))}},{key:"reset",value:function(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())}},{key:"handleBlur",value:function(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}},{key:"handleFocus",value:function(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}},{key:"handleSelectionChanged",value:function(e,i,r){h(t,"handleSelectionChanged",this,3)([e,i,r]),this._redrawSelection(e,i,r)}},{key:"_redrawSelection",value:function(e,t,i){if(this._didStateChange(e,t,i,this._bufferService.buffer.ydisp))if(this._clearAll(),e&&t){var r=e[1]-this._bufferService.buffer.ydisp,n=t[1]-this._bufferService.buffer.ydisp,s=Math.max(r,0),o=Math.min(n,this._bufferService.rows-1);if(s>=this._bufferService.rows||o<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=(this._coreBrowserService.isFocused?this._themeService.colors.selectionBackgroundTransparent:this._themeService.colors.selectionInactiveBackgroundTransparent).css,i){var a=e[0],c=t[0]-a,l=o-s+1;this._fillCells(a,s,c,l)}else{var h=r===s?e[0]:0,u=s===n?t[0]:this._bufferService.cols;this._fillCells(h,s,u-h,1);var d=Math.max(o-s-1,0);if(this._fillCells(0,s+1,this._bufferService.cols,d),s!==o){var f=n===o?t[0]:this._bufferService.cols;this._fillCells(0,o,f,1)}}this._state.start=[e[0],e[1]],this._state.end=[t[0],t[1]],this._state.columnSelectMode=i,this._state.ydisp=this._bufferService.buffer.ydisp}}else this._clearState()}},{key:"_didStateChange",value:function(e,t,i,r){return!this._areCoordinatesEqual(e,this._state.start)||!this._areCoordinatesEqual(t,this._state.end)||i!==this._state.columnSelectMode||r!==this._state.ydisp}},{key:"_areCoordinatesEqual",value:function(e,t){return!(!e||!t)&&e[0]===t[0]&&e[1]===t[1]}}])}(i(903).BaseRenderLayer);t.SelectionRenderLayer=r},744:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.TextRenderLayer=void 0;var r=i(577),n=i(147),s=i(782),o=i(855),a=i(903),c=i(574),l=function(e){function t(e,i,r,n,o,a,l,h,u,f){var v;return C(this,t),(v=d(this,t,[e,i,"text",r,n,f,o,a,h,u]))._characterJoinerService=l,v._characterWidth=0,v._characterFont="",v._characterOverlapCache={},v._workCell=new s.CellData,v._state=new c.GridCache,v.register(a.onSpecificOptionChange("allowTransparency",function(e){return v._setTransparency(e)})),v}return g(t,e),w(t,[{key:"resize",value:function(e){h(t,"resize",this,3)([e]);var i=this._getFont(!1,!1);this._characterWidth===e.device.char.width&&this._characterFont===i||(this._characterWidth=e.device.char.width,this._characterFont=i,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)}},{key:"reset",value:function(){this._state.clear(),this._clearAll()}},{key:"_forEachCell",value:function(e,t,i){for(var n=e;n<=t;n++)for(var s=n+this._bufferService.buffer.ydisp,a=this._bufferService.buffer.lines.get(s),c=this._characterJoinerService.getJoinedCharacters(s),l=0;l<this._bufferService.cols;l++){a.loadCell(l,this._workCell);var h=this._workCell,u=!1,d=l;if(0!==h.getWidth()){if(c.length>0&&l===c[0][0]){u=!0;var f=c.shift();h=new r.JoinedCellData(this._workCell,a.translateToString(!0,f[0],f[1]),f[1]-f[0]),d=f[1]-1}!u&&this._isOverlapping(h)&&d<a.length-1&&a.getCodePoint(d+1)===o.NULL_CELL_CODE&&(h.content&=-12582913,h.content|=2<<22),i(h,l,n),l=d}}}},{key:"_drawBackground",value:function(e,t){var i=this,r=this._ctx,s=this._bufferService.cols,o=0,a=0,c=null;r.save(),this._forEachCell(e,t,function(e,t,l){var h=null;e.isInverse()?h=e.isFgDefault()?i._themeService.colors.foreground.css:e.isFgRGB()?"rgb(".concat(n.AttributeData.toColorRGB(e.getFgColor()).join(","),")"):i._themeService.colors.ansi[e.getFgColor()].css:e.isBgRGB()?h="rgb(".concat(n.AttributeData.toColorRGB(e.getBgColor()).join(","),")"):e.isBgPalette()&&(h=i._themeService.colors.ansi[e.getBgColor()].css);var u=!1;i._decorationService.forEachDecorationAtCell(t,i._bufferService.buffer.ydisp+l,void 0,function(e){"top"!==e.options.layer&&u||(e.backgroundColorRGB&&(h=e.backgroundColorRGB.css),u="top"===e.options.layer)}),null===c&&(o=t,a=l),l!==a?(r.fillStyle=c||"",i._fillCells(o,a,s-o,1),o=t,a=l):c!==h&&(r.fillStyle=c||"",i._fillCells(o,a,t-o,1),o=t,a=l),c=h}),null!==c&&(r.fillStyle=c,this._fillCells(o,a,s-o,1)),r.restore()}},{key:"_drawForeground",value:function(e,t){var i=this;this._forEachCell(e,t,function(e,t,r){return i._drawChars(e,t,r)})}},{key:"handleGridChanged",value:function(e,t){0!==this._state.cache.length&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,e,this._bufferService.cols,t-e+1),this._drawBackground(e,t),this._drawForeground(e,t))}},{key:"_isOverlapping",value:function(e){if(1!==e.getWidth())return!1;if(e.getCode()<256)return!1;var t=e.getChars();if(this._characterOverlapCache.hasOwnProperty(t))return this._characterOverlapCache[t];this._ctx.save(),this._ctx.font=this._characterFont;var i=Math.floor(this._ctx.measureText(t).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[t]=i,i}}])}(a.BaseRenderLayer);t.TextRenderLayer=l},274:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CellColorResolver=void 0;var r,n=i(855),s=i(160),o=i(374),a=0,c=0,l=!1,h=!1,u=!1,d=0;t.CellColorResolver=function(){function e(t,i,r,n,s,o){C(this,e),this._terminal=t,this._optionService=i,this._selectionRenderModel=r,this._decorationService=n,this._coreBrowserService=s,this._themeService=o,this.result={fg:0,bg:0,ext:0}}return w(e,[{key:"resolve",value:function(e,t,i,f){if(this.result.bg=e.bg,this.result.fg=e.fg,this.result.ext=268435456&e.bg?e.extended.ext:0,c=0,a=0,h=!1,l=!1,u=!1,r=this._themeService.colors,d=0,e.getCode()!==n.NULL_CELL_CODE&&4===e.extended.underlineStyle){var v=Math.max(1,Math.floor(this._optionService.rawOptions.fontSize*this._coreBrowserService.dpr/15));d=t*f%(2*Math.round(v))}if(this._decorationService.forEachDecorationAtCell(t,i,"bottom",function(e){e.backgroundColorRGB&&(c=e.backgroundColorRGB.rgba>>8&16777215,h=!0),e.foregroundColorRGB&&(a=e.foregroundColorRGB.rgba>>8&16777215,l=!0)}),u=this._selectionRenderModel.isCellSelected(this._terminal,t,i)){if(67108864&this.result.fg||50331648&this.result.bg){if(67108864&this.result.fg)switch(50331648&this.result.fg){case 16777216:case 33554432:c=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:c=(16777215&this.result.fg)<<8|255;break;default:c=this._themeService.colors.foreground.rgba}else switch(50331648&this.result.bg){case 16777216:case 33554432:c=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:c=(16777215&this.result.bg)<<8|255}c=s.rgba.blend(c,4294967040&(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}else c=(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba>>8&16777215;if(h=!0,r.selectionForeground&&(a=r.selectionForeground.rgba>>8&16777215,l=!0),(0,o.treatGlyphAsBackgroundColor)(e.getCode())){if(67108864&this.result.fg&&!(50331648&this.result.bg))a=(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba>>8&16777215;else{if(67108864&this.result.fg)switch(50331648&this.result.bg){case 16777216:case 33554432:a=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:a=(16777215&this.result.bg)<<8|255}else switch(50331648&this.result.fg){case 16777216:case 33554432:a=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:a=(16777215&this.result.fg)<<8|255;break;default:a=this._themeService.colors.foreground.rgba}a=s.rgba.blend(a,4294967040&(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}l=!0}}this._decorationService.forEachDecorationAtCell(t,i,"top",function(e){e.backgroundColorRGB&&(c=e.backgroundColorRGB.rgba>>8&16777215,h=!0),e.foregroundColorRGB&&(a=e.foregroundColorRGB.rgba>>8&16777215,l=!0)}),h&&(c=u?-16777216&e.bg&-134217729|c|50331648:-16777216&e.bg|c|50331648),l&&(a=-16777216&e.fg&-67108865|a|50331648),67108864&this.result.fg&&(h&&!l&&(a=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&r.background.rgba>>8|50331648,l=!0),!h&&l&&(c=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&r.foreground.rgba>>8|50331648,h=!0)),r=void 0,this.result.bg=h?c:this.result.bg,this.result.fg=l?a:this.result.fg,this.result.ext&=536870911,this.result.ext|=d<<29&3758096384}}])}()},627:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireTextureAtlas=void 0;var r=i(509),n=i(197),s=[];t.acquireTextureAtlas=function(e,t,i,o,a,c,l,h){for(var u=(0,n.generateConfig)(o,a,c,l,t,i,h),d=0;d<s.length;d++){var f=s[d],v=f.ownedBy.indexOf(e);if(v>=0){if((0,n.configEquals)(f.config,u))return f.atlas;1===f.ownedBy.length?(f.atlas.dispose(),s.splice(d,1)):f.ownedBy.splice(v,1);break}}for(var _=0;_<s.length;_++){var g=s[_];if((0,n.configEquals)(g.config,u))return g.ownedBy.push(e),g.atlas}var p=e._core,m={atlas:new r.TextureAtlas(document,u,p.unicodeService),config:u,ownedBy:[e]};return s.push(m),m.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<s.length;t++){var i=s[t].ownedBy.indexOf(e);if(-1!==i){1===s[t].ownedBy.length?(s[t].atlas.dispose(),s.splice(t,1)):s[t].ownedBy.splice(i,1);break}}}},197:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var r=i(160);t.generateConfig=function(e,t,i,n,s,o,a){var c={foreground:o.foreground,background:o.background,cursor:r.NULL_COLOR,cursorAccent:r.NULL_COLOR,selectionForeground:r.NULL_COLOR,selectionBackgroundTransparent:r.NULL_COLOR,selectionBackgroundOpaque:r.NULL_COLOR,selectionInactiveBackgroundTransparent:r.NULL_COLOR,selectionInactiveBackgroundOpaque:r.NULL_COLOR,ansi:o.ansi.slice(),contrastCache:o.contrastCache,halfContrastCache:o.halfContrastCache};return{customGlyphs:s.customGlyphs,devicePixelRatio:a,letterSpacing:s.letterSpacing,lineHeight:s.lineHeight,deviceCellWidth:e,deviceCellHeight:t,deviceCharWidth:i,deviceCharHeight:n,fontFamily:s.fontFamily,fontSize:s.fontSize,fontWeight:s.fontWeight,fontWeightBold:s.fontWeightBold,allowTransparency:s.allowTransparency,drawBoldTextInBrightColors:s.drawBoldTextInBrightColors,minimumContrastRatio:s.minimumContrastRatio,colors:c}},t.configEquals=function(e,t){for(var i=0;i<e.colors.ansi.length;i++)if(e.colors.ansi[i].rgba!==t.colors.ansi[i].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.customGlyphs===t.customGlyphs&&e.lineHeight===t.lineHeight&&e.letterSpacing===t.letterSpacing&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.deviceCharWidth===t.deviceCharWidth&&e.deviceCharHeight===t.deviceCharHeight&&e.drawBoldTextInBrightColors===t.drawBoldTextInBrightColors&&e.minimumContrastRatio===t.minimumContrastRatio&&e.colors.foreground.rgba===t.colors.foreground.rgba&&e.colors.background.rgba===t.colors.background.rgba},t.is256Color=function(e){return 16777216==(50331648&e)||33554432==(50331648&e)}},237:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var r=i(399);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=r.isFirefox||r.isLegacyEdge?"bottom":"ideographic"},457:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CursorBlinkStateManager=void 0,t.CursorBlinkStateManager=function(){function e(t,i){C(this,e),this._renderCallback=t,this._coreBrowserService=i,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}return w(e,[{key:"isPaused",get:function(){return!(this._blinkStartTimeout||this._blinkInterval)}},{key:"dispose",value:function(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"restartBlinkAnimation",value:function(){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0})))}},{key:"_restartInterval",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);if(e._animationTimeRestarted=void 0,t>0)return void e._restartInterval(t)}e.isCursorVisible=!1,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0}),e._blinkInterval=e._coreBrowserService.window.setInterval(function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);return e._animationTimeRestarted=void 0,void e._restartInterval(t)}e.isCursorVisible=!e.isCursorVisible,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=void 0})},600)},t)}},{key:"pause",value:function(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"resume",value:function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}])}()},860:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.powerlineDefinitions=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var r=i(374);t.blockElementDefinitions={"▀":[{x:0,y:0,w:8,h:4}],"▁":[{x:0,y:7,w:8,h:1}],"▂":[{x:0,y:6,w:8,h:2}],"▃":[{x:0,y:5,w:8,h:3}],"▄":[{x:0,y:4,w:8,h:4}],"▅":[{x:0,y:3,w:8,h:5}],"▆":[{x:0,y:2,w:8,h:6}],"▇":[{x:0,y:1,w:8,h:7}],"█":[{x:0,y:0,w:8,h:8}],"▉":[{x:0,y:0,w:7,h:8}],"▊":[{x:0,y:0,w:6,h:8}],"▋":[{x:0,y:0,w:5,h:8}],"▌":[{x:0,y:0,w:4,h:8}],"▍":[{x:0,y:0,w:3,h:8}],"▎":[{x:0,y:0,w:2,h:8}],"▏":[{x:0,y:0,w:1,h:8}],"▐":[{x:4,y:0,w:4,h:8}],"▔":[{x:0,y:0,w:8,h:1}],"▕":[{x:7,y:0,w:1,h:8}],"▖":[{x:0,y:4,w:4,h:4}],"▗":[{x:4,y:4,w:4,h:4}],"▘":[{x:0,y:0,w:4,h:4}],"▙":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"▚":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"▛":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"▜":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"▝":[{x:4,y:0,w:4,h:4}],"▞":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"▟":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"🭰":[{x:1,y:0,w:1,h:8}],"🭱":[{x:2,y:0,w:1,h:8}],"🭲":[{x:3,y:0,w:1,h:8}],"🭳":[{x:4,y:0,w:1,h:8}],"🭴":[{x:5,y:0,w:1,h:8}],"🭵":[{x:6,y:0,w:1,h:8}],"🭶":[{x:0,y:1,w:8,h:1}],"🭷":[{x:0,y:2,w:8,h:1}],"🭸":[{x:0,y:3,w:8,h:1}],"🭹":[{x:0,y:4,w:8,h:1}],"🭺":[{x:0,y:5,w:8,h:1}],"🭻":[{x:0,y:6,w:8,h:1}],"🭼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🭽":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🮀":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮁":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮂":[{x:0,y:0,w:8,h:2}],"🮃":[{x:0,y:0,w:8,h:3}],"🮄":[{x:0,y:0,w:8,h:5}],"🮅":[{x:0,y:0,w:8,h:6}],"🮆":[{x:0,y:0,w:8,h:7}],"🮇":[{x:6,y:0,w:2,h:8}],"🮈":[{x:5,y:0,w:3,h:8}],"🮉":[{x:3,y:0,w:5,h:8}],"🮊":[{x:2,y:0,w:6,h:8}],"🮋":[{x:1,y:0,w:7,h:8}],"🮕":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"🮖":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"🮗":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var n={"░":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"▒":[[1,0],[0,0],[0,1],[0,0]],"▓":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"─":{1:"M0,.5 L1,.5"},"━":{3:"M0,.5 L1,.5"},"│":{1:"M.5,0 L.5,1"},"┃":{3:"M.5,0 L.5,1"},"┌":{1:"M0.5,1 L.5,.5 L1,.5"},"┏":{3:"M0.5,1 L.5,.5 L1,.5"},"┐":{1:"M0,.5 L.5,.5 L.5,1"},"┓":{3:"M0,.5 L.5,.5 L.5,1"},"└":{1:"M.5,0 L.5,.5 L1,.5"},"┗":{3:"M.5,0 L.5,.5 L1,.5"},"┘":{1:"M.5,0 L.5,.5 L0,.5"},"┛":{3:"M.5,0 L.5,.5 L0,.5"},"├":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"┣":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"┤":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"┫":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"┬":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"┳":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"┴":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"┻":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"┼":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"╋":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"╴":{1:"M.5,.5 L0,.5"},"╸":{3:"M.5,.5 L0,.5"},"╵":{1:"M.5,.5 L.5,0"},"╹":{3:"M.5,.5 L.5,0"},"╶":{1:"M.5,.5 L1,.5"},"╺":{3:"M.5,.5 L1,.5"},"╷":{1:"M.5,.5 L.5,1"},"╻":{3:"M.5,.5 L.5,1"},"═":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"║":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"╒":{1:function(e,t){return"M.5,1 L.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"╓":{1:function(e,t){return"M".concat(.5-e,",1 L").concat(.5-e,",.5 L1,.5 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"╔":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"╕":{1:function(e,t){return"M0,".concat(.5-t," L.5,").concat(.5-t," L.5,1 M0,").concat(.5+t," L.5,").concat(.5+t)}},"╖":{1:function(e,t){return"M".concat(.5+e,",1 L").concat(.5+e,",.5 L0,.5 M").concat(.5-e,",.5 L").concat(.5-e,",1")}},"╗":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",1")}},"╘":{1:function(e,t){return"M.5,0 L.5,".concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5-t," L1,").concat(.5-t)}},"╙":{1:function(e,t){return"M1,.5 L".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"╚":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0 M1,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",0")}},"╛":{1:function(e,t){return"M0,".concat(.5+t," L.5,").concat(.5+t," L.5,0 M0,").concat(.5-t," L.5,").concat(.5-t)}},"╜":{1:function(e,t){return"M0,.5 L".concat(.5+e,",.5 L").concat(.5+e,",0 M").concat(.5-e,",.5 L").concat(.5-e,",0")}},"╝":{1:function(e,t){return"M0,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M0,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",0")}},"╞":{1:function(e,t){return"M.5,0 L.5,1 M.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"╟":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1 M").concat(.5+e,",.5 L1,.5")}},"╠":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"╡":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L.5,").concat(.5-t," M0,").concat(.5+t," L.5,").concat(.5+t)}},"╢":{1:function(e,t){return"M0,.5 L".concat(.5-e,",.5 M").concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"╣":{1:function(e,t){return"M".concat(.5+e,",0 L").concat(.5+e,",1 M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0")}},"╤":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5+t," L.5,1")}},"╥":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",1 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"╦":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"╧":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t," M0,").concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"╨":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"╩":{1:function(e,t){return"M0,".concat(.5+t," L1,").concat(.5+t," M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"╪":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"╫":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"╬":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"╱":{1:"M1,0 L0,1"},"╲":{1:"M0,0 L1,1"},"╳":{1:"M1,0 L0,1 M0,0 L1,1"},"╼":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"╽":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"╾":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"╿":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"┍":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"┎":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"┑":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"┒":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"┕":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"┖":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"┙":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"┚":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"┝":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"┞":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"┟":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"┠":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"┡":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"┢":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"┥":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"┦":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"┧":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"┨":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"┩":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"┪":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"┭":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┮":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"┯":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"┰":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"┱":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"┲":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"┵":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┶":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"┷":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"┸":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"┹":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"┺":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"┽":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┾":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"┿":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"╀":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"╁":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"╂":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"╃":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"╄":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"╅":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"╆":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"╇":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"╈":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"╉":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"╊":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"╌":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"╍":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"┄":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"┅":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"┈":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"┉":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"╎":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"╏":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"┆":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"┇":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"┊":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"┋":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"╭":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,1,.5")}},"╮":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,0,.5")}},"╯":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,0,.5")}},"╰":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,1,.5")}}},t.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},t.powerlineDefinitions[""]=t.powerlineDefinitions[""],t.powerlineDefinitions[""]=t.powerlineDefinitions[""],t.tryDrawCustomChar=function(e,i,o,h,u,d,f,v){var _=t.blockElementDefinitions[i];if(_)return function(e,t,i,r,n,s){for(var o=0;o<t.length;o++){var a=t[o],c=n/8,l=s/8;e.fillRect(i+a.x*c,r+a.y*l,a.w*c,a.h*l)}}(e,_,o,h,u,d),!0;var g=n[i];if(g)return function(e,t,i,n,o,a){var c=s.get(t);c||(c=new Map,s.set(t,c));var h=e.fillStyle;if("string"!=typeof h)throw new Error('Unexpected fillStyle type "'.concat(h,'"'));var u=c.get(h);if(!u){var d=t[0].length,f=t.length,v=e.canvas.ownerDocument.createElement("canvas");v.width=d,v.height=f;var _,g,p,m,y=(0,r.throwIfFalsy)(v.getContext("2d")),S=new ImageData(d,f);if(h.startsWith("#"))_=parseInt(h.slice(1,3),16),g=parseInt(h.slice(3,5),16),p=parseInt(h.slice(5,7),16),m=h.length>7&&parseInt(h.slice(7,9),16)||1;else{if(!h.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'.concat(h,'" when drawing pattern glyph'));var C=h.substring(5,h.length-1).split(",").map(function(e){return parseFloat(e)}),b=l(C,4);_=b[0],g=b[1],p=b[2],m=b[3]}for(var w=0;w<f;w++)for(var k=0;k<d;k++)S.data[4*(w*d+k)]=_,S.data[4*(w*d+k)+1]=g,S.data[4*(w*d+k)+2]=p,S.data[4*(w*d+k)+3]=t[w][k]*(255*m);y.putImageData(S,0,0),u=(0,r.throwIfFalsy)(e.createPattern(v,null)),c.set(h,u)}e.fillStyle=u,e.fillRect(i,n,o,a)}(e,g,o,h,u,d),!0;var p=t.boxDrawingDefinitions[i];if(p)return function(e,t,i,r,n,s,o){e.strokeStyle=e.fillStyle;for(var h=0,u=Object.entries(t);h<u.length;h++){var d=l(u[h],2),f=d[0],v=d[1];e.beginPath(),e.lineWidth=o*Number.parseInt(f);var _,g=m(("function"==typeof v?v(.15,.15/s*n):v).split(" "));try{for(g.s();!(_=g.n()).done;){var p=_.value,y=p[0],S=a[y];if(S){var C=p.substring(1).split(",");C[0]&&C[1]&&S(e,c(C,n,s,i,r,!0,o))}}}catch(b){g.e(b)}finally{g.f()}e.stroke(),e.closePath()}}(e,p,o,h,u,d,v),!0;var y=t.powerlineDefinitions[i];return!!y&&(function(e,t,i,r,n,s,o,l){var h=new Path2D;h.rect(i,r,n,s),e.clip(h),e.beginPath();var u=o/12;e.lineWidth=l*u;var d,f=m(t.d.split(" "));try{for(f.s();!(d=f.n()).done;){var v,_,g=d.value,p=g[0],y=a[p];if(y){var S=g.substring(1).split(",");S[0]&&S[1]&&y(e,c(S,n,s,i,r,!1,l,(null!==(v=t.leftPadding)&&void 0!==v?v:0)*(u/2),(null!==(_=t.rightPadding)&&void 0!==_?_:0)*(u/2)))}}}catch(C){f.e(C)}finally{f.f()}1===t.type?(e.strokeStyle=e.fillStyle,e.stroke()):e.fill(),e.closePath()}(e,y,o,h,u,d,f,v),!0)};var s=new Map;function o(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),i)}var a={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}};function c(e,t,i,r,n,s,a){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=e.map(function(e){return parseFloat(e)||parseInt(e)});if(h.length<2)throw new Error("Too few arguments for instruction");for(var u=0;u<h.length;u+=2)h[u]*=t-c*a-l*a,s&&0!==h[u]&&(h[u]=o(Math.round(h[u]+.5)-.5,t,0)),h[u]+=r+c*a;for(var d=1;d<h.length;d+=2)h[d]*=i,s&&0!==h[d]&&(h[d]=o(Math.round(h[d]+.5)-.5,i,0)),h[d]+=n;return h}},56:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.observeDevicePixelDimensions=void 0;var r=i(859);t.observeDevicePixelDimensions=function(e,t,i){var n=new t.ResizeObserver(function(t){var r,s=t.find(function(t){return t.target===e});if(s){if(!("devicePixelContentBoxSize"in s))return null!==(r=n)&&void 0!==r&&r.disconnect(),void(n=void 0);var o=s.devicePixelContentBoxSize[0].inlineSize,a=s.devicePixelContentBoxSize[0].blockSize;o>0&&a>0&&i(o,a)}});try{n.observe(e,{box:["device-pixel-content-box"]})}catch(s){n.disconnect(),n=void 0}return(0,r.toDisposable)(function(){var e;return null===(e=n)||void 0===e?void 0:e.disconnect()})}},374:function(e,t){function i(e){return 57508<=e&&e<=57558}function r(e){return e>=128512&&e<=128591||e>=127744&&e<=128511||e>=128640&&e<=128767||e>=9728&&e<=9983||e>=9984&&e<=10175||e>=65024&&e<=65039||e>=129280&&e<=129535||e>=127462&&e<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.isEmoji=r,t.allowRescaling=function(e,t,n,s){return 1===t&&n>Math.ceil(1.5*s)&&void 0!==e&&e>255&&!r(e)&&!i(e)&&!function(e){return 57344<=e&&e<=63743}(e)},t.treatGlyphAsBackgroundColor=function(e){return i(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(e-(2*Math.round(t)-i))%(2*Math.round(t))}},296:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;var i=function(){function e(){C(this,e),this.clear()}return w(e,[{key:"clear",value:function(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}},{key:"update",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.selectionStart=t,this.selectionEnd=i,t&&i&&(t[0]!==i[0]||t[1]!==i[1])){var n=e.buffers.active.ydisp,s=t[1]-n,o=i[1]-n,a=Math.max(s,0),c=Math.min(o,e.rows-1);a>=e.rows||c<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=r,this.viewportStartRow=s,this.viewportEndRow=o,this.viewportCappedStartRow=a,this.viewportCappedEndRow=c,this.startCol=t[0],this.endCol=i[0])}else this.clear()}},{key:"isCellSelected",value:function(e,t,i){return!!this.hasSelection&&(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol)}}])}();t.createSelectionRenderModel=function(){return new i}},509:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;var r,n=i(237),s=i(860),o=i(374),a=i(160),h=i(345),u=i(485),d=i(385),f=i(147),v=i(855),_={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},g=function(){function e(t,i,r){C(this,e),this._document=t,this._config=i,this._unicodeService=r,this._didWarmUp=!1,this._cacheMap=new u.FourKeyMap,this._cacheMapCombined=new u.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new f.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new h.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new h.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=S(t,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,o.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}return w(e,[{key:"pages",get:function(){return this._pages}},{key:"dispose",value:function(){var e,t=m(this.pages);try{for(t.s();!(e=t.n()).done;)e.value.canvas.remove()}catch(i){t.e(i)}finally{t.f()}this._onAddTextureAtlasCanvas.dispose()}},{key:"warmUp",value:function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}},{key:"_doWarmUp",value:function(){for(var e=this,t=new d.IdleTaskQueue,i=function(i){t.enqueue(function(){if(!e._cacheMap.get(i,v.DEFAULT_COLOR,v.DEFAULT_COLOR,v.DEFAULT_EXT)){var t=e._drawToCache(i,v.DEFAULT_COLOR,v.DEFAULT_COLOR,v.DEFAULT_EXT);e._cacheMap.set(i,v.DEFAULT_COLOR,v.DEFAULT_COLOR,v.DEFAULT_EXT,t)}})},r=33;r<126;r++)i(r)}},{key:"beginFrame",value:function(){return this._requestClearModel}},{key:"clearTexture",value:function(){if(0!==this._pages[0].currentRow.x||0!==this._pages[0].currentRow.y){var e,t=m(this._pages);try{for(t.s();!(e=t.n()).done;)e.value.clear()}catch(i){t.e(i)}finally{t.f()}this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}},{key:"_createNewPage",value:function(){if(e.maxAtlasPages&&this._pages.length>=Math.max(4,e.maxAtlasPages)){for(var t=this._pages.filter(function(t){return 2*t.canvas.width<=(e.maxTextureSize||4096)}).sort(function(e,t){return t.canvas.width!==e.canvas.width?t.canvas.width-e.canvas.width:t.percentageUsed-e.percentageUsed}),i=-1,r=0,n=0;n<t.length;n++)if(t[n].canvas.width!==r)i=n,r=t[n].canvas.width;else if(n-i==3)break;var s=t.slice(i,i+4),o=s.map(function(e){return e.glyphs[0].texturePage}).sort(function(e,t){return e>t?1:-1}),a=this.pages.length-s.length,c=this._mergePages(s,a);c.version++;for(var l=o.length-1;l>=0;l--)this._deletePage(o[l]);this.pages.push(c),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(c.canvas)}var h=new p(this._document,this._textureSize);return this._pages.push(h),this._activePages.push(h),this._onAddTextureAtlasCanvas.fire(h.canvas),h}},{key:"_mergePages",value:function(e,t){var i,r=2*e[0].canvas.width,n=new p(this._document,r,e),s=m(e.entries());try{for(s.s();!(i=s.n()).done;){var o=l(i.value,2),a=o[0],c=o[1],h=a*c.canvas.width%r,u=Math.floor(a/2)*c.canvas.height;n.ctx.drawImage(c.canvas,h,u);var d,f=m(c.glyphs);try{for(f.s();!(d=f.n()).done;){var v=d.value;v.texturePage=t,v.sizeClipSpace.x=v.size.x/r,v.sizeClipSpace.y=v.size.y/r,v.texturePosition.x+=h,v.texturePosition.y+=u,v.texturePositionClipSpace.x=v.texturePosition.x/r,v.texturePositionClipSpace.y=v.texturePosition.y/r}}catch(g){f.e(g)}finally{f.f()}this._onRemoveTextureAtlasCanvas.fire(c.canvas);var _=this._activePages.indexOf(c);-1!==_&&this._activePages.splice(_,1)}}catch(g){s.e(g)}finally{s.f()}return n}},{key:"_deletePage",value:function(e){this._pages.splice(e,1);for(var t=e;t<this._pages.length;t++){var i,r=this._pages[t],n=m(r.glyphs);try{for(n.s();!(i=n.n()).done;)i.value.texturePage--}catch(s){n.e(s)}finally{n.f()}r.version++}}},{key:"getRasterizedGlyphCombinedChar",value:function(e,t,i,r,n){return this._getFromCacheMap(this._cacheMapCombined,e,t,i,r,n)}},{key:"getRasterizedGlyph",value:function(e,t,i,r,n){return this._getFromCacheMap(this._cacheMap,e,t,i,r,n)}},{key:"_getFromCacheMap",value:function(e,t,i,n,s){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return(r=e.get(t,i,n,s))||(r=this._drawToCache(t,i,n,s,o),e.set(t,i,n,s,r)),r}},{key:"_getColorFromAnsiIndex",value:function(e){if(e>=this._config.colors.ansi.length)throw new Error("No color found for idx "+e);return this._config.colors.ansi[e]}},{key:"_getBackgroundColor",value:function(e,t,i,r){if(this._config.allowTransparency)return a.NULL_COLOR;var n;switch(e){case 16777216:case 33554432:n=this._getColorFromAnsiIndex(t);break;case 50331648:var s=f.AttributeData.toColorRGB(t);n=a.channels.toColor(s[0],s[1],s[2]);break;default:n=i?a.color.opaque(this._config.colors.foreground):this._config.colors.background}return n}},{key:"_getForegroundColor",value:function(e,t,i,r,s,o,c,l,h,u){var d,v=this._getMinimumContrastColor(e,t,i,r,s,o,c,h,l,u);if(v)return v;switch(s){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&h&&o<8&&(o+=8),d=this._getColorFromAnsiIndex(o);break;case 50331648:var _=f.AttributeData.toColorRGB(o);d=a.channels.toColor(_[0],_[1],_[2]);break;default:d=c?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(d=a.color.opaque(d)),l&&(d=a.color.multiplyOpacity(d,n.DIM_OPACITY)),d}},{key:"_resolveBackgroundRgba",value:function(e,t,i){switch(e){case 16777216:case 33554432:return this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return i?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}},{key:"_resolveForegroundRgba",value:function(e,t,i,r){switch(e){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&r&&t<8&&(t+=8),this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return i?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}},{key:"_getMinimumContrastColor",value:function(e,t,i,r,n,s,o,c,l,h){if(1!==this._config.minimumContrastRatio&&!h){var u=this._getContrastCache(l),d=u.getColor(e,r);if(void 0!==d)return d||void 0;var f=this._resolveBackgroundRgba(t,i,o),v=this._resolveForegroundRgba(n,s,o,c),_=a.rgba.ensureContrastRatio(f,v,this._config.minimumContrastRatio/(l?2:1));if(_){var g=a.channels.toColor(_>>24&255,_>>16&255,_>>8&255);return u.setColor(e,r,g),g}u.setColor(e,r,null)}}},{key:"_getContrastCache",value:function(e){return e?this._config.colors.halfContrastCache:this._config.colors.contrastCache}},{key:"_drawToCache",value:function(t,i,r,a){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l="number"==typeof t?String.fromCharCode(t):t,h=Math.min(this._config.deviceCellWidth*Math.max(l.length,2)+4,this._textureSize);this._tmpCanvas.width<h&&(this._tmpCanvas.width=h);var u=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<u&&(this._tmpCanvas.height=u),this._tmpCtx.save(),this._workAttributeData.fg=r,this._workAttributeData.bg=i,this._workAttributeData.extended.ext=a,this._workAttributeData.isInvisible())return _;var d=!!this._workAttributeData.isBold(),v=!!this._workAttributeData.isInverse(),g=!!this._workAttributeData.isDim(),p=!!this._workAttributeData.isItalic(),S=!!this._workAttributeData.isUnderline(),C=!!this._workAttributeData.isStrikethrough(),b=!!this._workAttributeData.isOverline(),w=this._workAttributeData.getFgColor(),k=this._workAttributeData.getFgColorMode(),L=this._workAttributeData.getBgColor(),x=this._workAttributeData.getBgColorMode();if(v){var E=w;w=L,L=E;var R=k;k=x,x=R}var D=this._getBackgroundColor(x,L,v,g);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=D.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";var A=d?this._config.fontWeightBold:this._config.fontWeight,M=p?"italic":"";this._tmpCtx.font="".concat(M," ").concat(A," ").concat(this._config.fontSize*this._config.devicePixelRatio,"px ").concat(this._config.fontFamily),this._tmpCtx.textBaseline=n.TEXT_BASELINE;var T=1===l.length&&(0,o.isPowerlineGlyph)(l.charCodeAt(0)),B=1===l.length&&(0,o.isRestrictedPowerlineGlyph)(l.charCodeAt(0)),O=this._getForegroundColor(i,x,L,r,k,w,v,g,d,(0,o.treatGlyphAsBackgroundColor)(l.charCodeAt(0)));this._tmpCtx.fillStyle=O.css;var P=B?0:4,I=!1;!1!==this._config.customGlyphs&&(I=(0,s.tryDrawCustomChar)(this._tmpCtx,l,P,P,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));var H,F=!T;if(H="number"==typeof t?this._unicodeService.wcwidth(t):this._unicodeService.getStringCellWidth(t),S){this._tmpCtx.save();var W=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),N=W%2==1?.5:0;if(this._tmpCtx.lineWidth=W,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())F=!1,this._tmpCtx.strokeStyle="rgb(".concat(f.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(","),")");else{F=!1;var U=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&U<8&&(U+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(U).css}this._tmpCtx.beginPath();for(var j=P,z=Math.ceil(P+this._config.deviceCharHeight)-N-(c?2*W:0),q=z+W,V=z+2*W,G=this._workAttributeData.getUnderlineVariantOffset(),K=0;K<H;K++){this._tmpCtx.save();var X=j+K*this._config.deviceCellWidth,J=j+(K+1)*this._config.deviceCellWidth,Y=X+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(X,z),this._tmpCtx.lineTo(J,z),this._tmpCtx.moveTo(X,V),this._tmpCtx.lineTo(J,V);break;case 3:var Z=W<=1?V:Math.ceil(P+this._config.deviceCharHeight-W/2)-N,$=W<=1?z:Math.ceil(P+this._config.deviceCharHeight+W/2)-N,Q=new Path2D;Q.rect(X,z,this._config.deviceCellWidth,V-z),this._tmpCtx.clip(Q),this._tmpCtx.moveTo(X-this._config.deviceCellWidth/2,q),this._tmpCtx.bezierCurveTo(X-this._config.deviceCellWidth/2,$,X,$,X,q),this._tmpCtx.bezierCurveTo(X,Z,Y,Z,Y,q),this._tmpCtx.bezierCurveTo(Y,$,J,$,J,q),this._tmpCtx.bezierCurveTo(J,Z,J+this._config.deviceCellWidth/2,Z,J+this._config.deviceCellWidth/2,q);break;case 4:var ee=0===G?0:G>=W?2*W-G:W-G;0==!(G>=W)||0===ee?(this._tmpCtx.setLineDash([Math.round(W),Math.round(W)]),this._tmpCtx.moveTo(X+ee,z),this._tmpCtx.lineTo(J,z)):(this._tmpCtx.setLineDash([Math.round(W),Math.round(W)]),this._tmpCtx.moveTo(X,z),this._tmpCtx.lineTo(X+ee,z),this._tmpCtx.moveTo(X+ee+W,z),this._tmpCtx.lineTo(J,z)),G=(0,o.computeNextVariantOffset)(J-X,W,G);break;case 5:var te=.6,ie=.3,re=J-X,ne=Math.floor(te*re),se=Math.floor(ie*re),oe=re-ne-se;this._tmpCtx.setLineDash([ne,se,oe]),this._tmpCtx.moveTo(X,z),this._tmpCtx.lineTo(J,z);break;default:this._tmpCtx.moveTo(X,z),this._tmpCtx.lineTo(J,z)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!I&&this._config.fontSize>=12&&!this._config.allowTransparency&&" "!==l){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";var ae=this._tmpCtx.measureText(l);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in ae&&ae.actualBoundingBoxDescent>0){this._tmpCtx.save();var ce=new Path2D;ce.rect(j,z-Math.ceil(W/2),this._config.deviceCellWidth*H,V-z+Math.ceil(W/2)),this._tmpCtx.clip(ce),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=D.css,this._tmpCtx.strokeText(l,P,P+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(b){var le=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),he=le%2==1?.5:0;this._tmpCtx.lineWidth=le,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(P,P+he),this._tmpCtx.lineTo(P+this._config.deviceCharWidth*H,P+he),this._tmpCtx.stroke()}if(I||this._tmpCtx.fillText(l,P,P+this._config.deviceCharHeight),"_"===l&&!this._config.allowTransparency){var ue=y(this._tmpCtx.getImageData(P,P,this._config.deviceCellWidth,this._config.deviceCellHeight),D,O,F);if(ue)for(var de=1;de<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=D.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(l,P,P+this._config.deviceCharHeight-de),ue=y(this._tmpCtx.getImageData(P,P,this._config.deviceCellWidth,this._config.deviceCellHeight),D,O,F));de++);}if(C){var fe=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),ve=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=fe,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(P,P+Math.floor(this._config.deviceCharHeight/2)-ve),this._tmpCtx.lineTo(P+this._config.deviceCharWidth*H,P+Math.floor(this._config.deviceCharHeight/2)-ve),this._tmpCtx.stroke()}this._tmpCtx.restore();var _e,ge=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);if(_e=this._config.allowTransparency?function(e){for(var t=0;t<e.data.length;t+=4)if(e.data[t+3]>0)return!1;return!0}(ge):y(ge,D,O,F),_e)return _;for(var pe,me,ye=this._findGlyphBoundingBox(ge,this._workBoundingBox,h,B,I,P);;){if(0===this._activePages.length){var Se=this._createNewPage();pe=Se,(me=Se.currentRow).height=ye.size.y;break}me=(pe=this._activePages[this._activePages.length-1]).currentRow;var Ce,be=m(this._activePages);try{for(be.s();!(Ce=be.n()).done;){var we=Ce.value;ye.size.y<=we.currentRow.height&&(pe=we,me=we.currentRow)}}catch(Oe){be.e(Oe)}finally{be.f()}for(var ke=this._activePages.length-1;ke>=0;ke--){var Le,xe=m(this._activePages[ke].fixedRows);try{for(xe.s();!(Le=xe.n()).done;){var Ee=Le.value;Ee.height<=me.height&&ye.size.y<=Ee.height&&(pe=this._activePages[ke],me=Ee)}}catch(Oe){xe.e(Oe)}finally{xe.f()}}if(me.y+ye.size.y>=pe.canvas.height||me.height>ye.size.y+2){var Re=!1;if(pe.currentRow.y+pe.currentRow.height+ye.size.y>=pe.canvas.height){var De,Ae=void 0,Me=m(this._activePages);try{for(Me.s();!(De=Me.n()).done;){var Te=De.value;if(Te.currentRow.y+Te.currentRow.height+ye.size.y<Te.canvas.height){Ae=Te;break}}}catch(Oe){Me.e(Oe)}finally{Me.f()}if(Ae)pe=Ae;else if(e.maxAtlasPages&&this._pages.length>=e.maxAtlasPages&&me.y+ye.size.y<=pe.canvas.height&&me.height>=ye.size.y&&me.x+ye.size.x<=pe.canvas.width)Re=!0;else{var Be=this._createNewPage();pe=Be,(me=Be.currentRow).height=ye.size.y,Re=!0}}Re||(pe.currentRow.height>0&&pe.fixedRows.push(pe.currentRow),me={x:0,y:pe.currentRow.y+pe.currentRow.height,height:ye.size.y},pe.fixedRows.push(me),pe.currentRow={x:0,y:me.y+me.height,height:0})}if(me.x+ye.size.x<=pe.canvas.width)break;me===pe.currentRow?(me.x=0,me.y+=me.height,me.height=0):pe.fixedRows.splice(pe.fixedRows.indexOf(me),1)}return ye.texturePage=this._pages.indexOf(pe),ye.texturePosition.x=me.x,ye.texturePosition.y=me.y,ye.texturePositionClipSpace.x=me.x/pe.canvas.width,ye.texturePositionClipSpace.y=me.y/pe.canvas.height,ye.sizeClipSpace.x/=pe.canvas.width,ye.sizeClipSpace.y/=pe.canvas.height,me.height=Math.max(me.height,ye.size.y),me.x+=ye.size.x,pe.ctx.putImageData(ge,ye.texturePosition.x-this._workBoundingBox.left,ye.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,ye.size.x,ye.size.y),pe.addGlyph(ye),pe.version++,ye}},{key:"_findGlyphBoundingBox",value:function(e,t,i,r,n,s){t.top=0;for(var o=r?this._config.deviceCellHeight:this._tmpCanvas.height,a=r?this._config.deviceCellWidth:i,c=!1,l=0;l<o;l++){for(var h=0;h<a;h++){var u=l*this._tmpCanvas.width*4+4*h+3;if(0!==e.data[u]){t.top=l,c=!0;break}}if(c)break}t.left=0,c=!1;for(var d=0;d<s+a;d++){for(var f=0;f<o;f++){var v=f*this._tmpCanvas.width*4+4*d+3;if(0!==e.data[v]){t.left=d,c=!0;break}}if(c)break}t.right=a,c=!1;for(var _=s+a-1;_>=s;_--){for(var g=0;g<o;g++){var p=g*this._tmpCanvas.width*4+4*_+3;if(0!==e.data[p]){t.right=_,c=!0;break}}if(c)break}t.bottom=o,c=!1;for(var m=o-1;m>=0;m--){for(var y=0;y<a;y++){var S=m*this._tmpCanvas.width*4+4*y+3;if(0!==e.data[S]){t.bottom=m,c=!0;break}}if(c)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:t.right-t.left+1,y:t.bottom-t.top+1},sizeClipSpace:{x:t.right-t.left+1,y:t.bottom-t.top+1},offset:{x:-t.left+s+(r||n?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-t.top+s+(r||n?1===this._config.lineHeight?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}])}();t.TextureAtlas=g;var p=function(){function e(t,i,r){if(C(this,e),this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],r){var n,s=m(r);try{for(s.s();!(n=s.n()).done;){var a,l=n.value;(a=this._glyphs).push.apply(a,c(l.glyphs)),this._usedPixels+=l._usedPixels}}catch(h){s.e(h)}finally{s.f()}}this.canvas=S(t,i,i),this.ctx=(0,o.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}return w(e,[{key:"percentageUsed",get:function(){return this._usedPixels/(this.canvas.width*this.canvas.height)}},{key:"glyphs",get:function(){return this._glyphs}},{key:"addGlyph",value:function(e){this._glyphs.push(e),this._usedPixels+=e.size.x*e.size.y}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}])}();function y(e,t,i,r){for(var n=t.rgba>>>24,s=t.rgba>>>16&255,o=t.rgba>>>8&255,a=i.rgba>>>24,c=i.rgba>>>16&255,l=i.rgba>>>8&255,h=Math.floor((Math.abs(n-a)+Math.abs(s-c)+Math.abs(o-l))/12),u=!0,d=0;d<e.data.length;d+=4)e.data[d]===n&&e.data[d+1]===s&&e.data[d+2]===o||r&&Math.abs(e.data[d]-n)+Math.abs(e.data[d+1]-s)+Math.abs(e.data[d+2]-o)<h?e.data[d+3]=0:u=!1;return u}function S(e,t,i){var r=e.createElement("canvas");return r.width=t,r.height=i,r}},577:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;var s=i(147),o=i(855),c=i(782),l=i(97),h=function(e){function t(e,i,r){var n;return C(this,t),(n=d(this,t)).content=0,n.combinedData="",n.fg=e.fg,n.bg=e.bg,n.combinedData=i,n._width=r,n}return g(t,e),w(t,[{key:"isCombined",value:function(){return 2097152}},{key:"getWidth",value:function(){return this._width}},{key:"getChars",value:function(){return this.combinedData}},{key:"getCode",value:function(){return 2097151}},{key:"setFromCharData",value:function(e){throw new Error("not implemented")}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}])}(s.AttributeData);t.JoinedCellData=h;var u=t.CharacterJoinerService=function(){function e(t){C(this,e),this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new c.CellData}return w(e,[{key:"register",value:function(e){var t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id}},{key:"deregister",value:function(e){for(var t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1}},{key:"getJoinedCharacters",value:function(e){if(0===this._characterJoiners.length)return[];var t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];for(var i=[],r=t.translateToString(!0),n=0,s=0,a=0,c=t.getFg(0),l=t.getBg(0),h=0;h<t.getTrimmedLength();h++)if(t.loadCell(h,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==c||this._workCell.bg!==l){if(h-n>1)for(var u=this._getJoinedRanges(r,a,s,t,n),d=0;d<u.length;d++)i.push(u[d]);n=h,a=s,c=this._workCell.fg,l=this._workCell.bg}s+=this._workCell.getChars().length||o.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-n>1)for(var f=this._getJoinedRanges(r,a,s,t,n),v=0;v<f.length;v++)i.push(f[v]);return i}},{key:"_getJoinedRanges",value:function(t,i,r,n,s){var o=t.substring(i,r),a=[];try{a=this._characterJoiners[0].handler(o)}catch(u){}for(var c=1;c<this._characterJoiners.length;c++)try{for(var l=this._characterJoiners[c].handler(o),h=0;h<l.length;h++)e._mergeRanges(a,l[h])}catch(d){}return this._stringRangesToCellRanges(a,n,s),a}},{key:"_stringRangesToCellRanges",value:function(e,t,i){var r=0,n=!1,s=0,a=e[r];if(a){for(var c=i;c<this._bufferService.cols;c++){var l=t.getWidth(c),h=t.getString(c).length||o.WHITESPACE_CELL_CHAR.length;if(0!==l){if(!n&&a[0]<=s&&(a[0]=c,n=!0),a[1]<=s){if(a[1]=c,!(a=e[++r]))break;a[0]<=s?(a[0]=c,n=!0):n=!1}s+=h}}a&&(a[1]=this._bufferService.cols)}}}],[{key:"_mergeRanges",value:function(e,t){for(var i=!1,r=0;r<e.length;r++){var n=e[r];if(i){if(t[1]<=n[0])return e[r-1][1]=t[1],e;if(t[1]<=n[1])return e[r-1][1]=Math.max(t[1],n[1]),e.splice(r,1),e;e.splice(r,1),r--}else{if(t[1]<=n[0])return e.splice(r,0,t),e;if(t[1]<=n[1])return n[0]=Math.min(t[0],n[0]),e;t[0]<n[1]&&(n[0]=Math.min(t[0],n[0]),i=!0)}}return i?e[e.length-1][1]=t[1]:e.push(t),e}}])}();t.CharacterJoinerService=u=r([n(0,l.IBufferService)],u)},160:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;var i,r,n,s,o,a=0,c=0,h=0,u=0;function d(e){var t=e.toString(16);return t.length<2?"0"+t:t}function f(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,i,r){return void 0!==r?"#".concat(d(e)).concat(d(t)).concat(d(i)).concat(d(r)):"#".concat(d(e)).concat(d(t)).concat(d(i))},e.toRgba=function(e,t,i){return(e<<24|t<<16|i<<8|(arguments.length>3&&void 0!==arguments[3]?arguments[3]:255))>>>0},e.toColor=function(t,i,r,n){return{css:e.toCss(t,i,r,n),rgba:e.toRgba(t,i,r,n)}}}(i||(t.channels=i={})),function(e){function t(e,t){var r;return u=Math.round(255*t),r=l(o.toChannels(e.rgba),3),a=r[0],c=r[1],h=r[2],{css:i.toCss(a,c,h,u),rgba:i.toRgba(a,c,h,u)}}e.blend=function(e,t){if(1==(u=(255&t.rgba)/255))return{css:t.css,rgba:t.rgba};var r=t.rgba>>24&255,n=t.rgba>>16&255,s=t.rgba>>8&255,o=e.rgba>>24&255,l=e.rgba>>16&255,d=e.rgba>>8&255;return a=o+Math.round((r-o)*u),c=l+Math.round((n-l)*u),h=d+Math.round((s-d)*u),{css:i.toCss(a,c,h),rgba:i.toRgba(a,c,h)}},e.isOpaque=function(e){return!(255&~e.rgba)},e.ensureContrastRatio=function(e,t,r){var n=o.ensureContrastRatio(e.rgba,t.rgba,r);if(n)return i.toColor(n>>24&255,n>>16&255,n>>8&255)},e.opaque=function(e){var t,r=(255|e.rgba)>>>0;return t=l(o.toChannels(r),3),a=t[0],c=t[1],h=t[2],{css:i.toCss(a,c,h),rgba:r}},e.opacity=t,e.multiplyOpacity=function(e,i){return t(e,(u=255&e.rgba)*i/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(r||(t.color=r={})),function(e){var t,r;try{var n=document.createElement("canvas");n.width=1,n.height=1;var s=n.getContext("2d",{willReadFrequently:!0});s&&((t=s).globalCompositeOperation="copy",r=t.createLinearGradient(0,0,1,1))}catch(o){}e.toColor=function(e){var n;if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return a=parseInt(e.slice(1,2).repeat(2),16),c=parseInt(e.slice(2,3).repeat(2),16),h=parseInt(e.slice(3,4).repeat(2),16),i.toColor(a,c,h);case 5:return a=parseInt(e.slice(1,2).repeat(2),16),c=parseInt(e.slice(2,3).repeat(2),16),h=parseInt(e.slice(3,4).repeat(2),16),u=parseInt(e.slice(4,5).repeat(2),16),i.toColor(a,c,h,u);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var s=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(s)return a=parseInt(s[1]),c=parseInt(s[2]),h=parseInt(s[3]),u=Math.round(255*(void 0===s[5]?1:parseFloat(s[5]))),i.toColor(a,c,h,u);if(!t||!r)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=r,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),n=l(t.getImageData(0,0,1,1).data,4),a=n[0],c=n[1],h=n[2],255!==(u=n[3]))throw new Error("css.toColor: Unsupported css format");return{rgba:i.toRgba(a,c,h,u),css:e}}}(n||(t.css=n={})),function(e){function t(e,t,i){var r=e/255,n=t/255,s=i/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(s||(t.rgb=s={})),function(e){function t(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));h<i&&(a>0||c>0||l>0);)a-=Math.max(0,Math.ceil(.1*a)),c-=Math.max(0,Math.ceil(.1*c)),l-=Math.max(0,Math.ceil(.1*l)),h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}function r(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));h<i&&(a<255||c<255||l<255);)a=Math.min(255,a+Math.ceil(.1*(255-a))),c=Math.min(255,c+Math.ceil(.1*(255-c))),l=Math.min(255,l+Math.ceil(.1*(255-l))),h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}e.blend=function(e,t){if(1==(u=(255&t)/255))return t;var r=t>>24&255,n=t>>16&255,s=t>>8&255,o=e>>24&255,l=e>>16&255,d=e>>8&255;return a=o+Math.round((r-o)*u),c=l+Math.round((n-l)*u),h=d+Math.round((s-d)*u),i.toRgba(a,c,h)},e.ensureContrastRatio=function(e,i,n){var o=s.relativeLuminance(e>>8),a=s.relativeLuminance(i>>8);if(f(o,a)<n){if(a<o){var c=t(e,i,n),l=f(o,s.relativeLuminance(c>>8));if(l<n){var h=r(e,i,n);return l>f(o,s.relativeLuminance(h>>8))?c:h}return c}var u=r(e,i,n),d=f(o,s.relativeLuminance(u>>8));if(d<n){var v=t(e,i,n);return d>f(o,s.relativeLuminance(v>>8))?u:v}return u}},e.reduceLuminance=t,e.increaseLuminance=r,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}}(o||(t.rgba=o={})),t.toPaddedHex=d,t.contrastRatio=f},345:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=function(){function e(){C(this,e),this._listeners=[],this._disposed=!1}return w(e,[{key:"event",get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]===t)return void e._listeners.splice(i,1)}}}),this._event}},{key:"fire",value:function(e,t){for(var i=[],r=0;r<this._listeners.length;r++)i.push(this._listeners[r]);for(var n=0;n<i.length;n++)i[n].call(void 0,e,t)}},{key:"dispose",value:function(){this.clearListeners(),this._disposed=!0}},{key:"clearListeners",value:function(){this._listeners&&(this._listeners.length=0)}}])}(),t.forwardEvent=function(e,t){return e(function(e){return t.fire(e)})},t.runAndSubscribe=function(e,t){return t(void 0),e(function(e){return t(e)})}},859:function(e,t){function i(e){var t,i=m(e);try{for(i.s();!(t=i.n()).done;)t.value.dispose()}catch(r){i.e(r)}finally{i.f()}e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=function(){function e(){C(this,e),this._disposables=[],this._isDisposed=!1}return w(e,[{key:"dispose",value:function(){this._isDisposed=!0;var e,t=m(this._disposables);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(i){t.e(i)}finally{t.f()}this._disposables.length=0}},{key:"register",value:function(e){return this._disposables.push(e),e}},{key:"unregister",value:function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}}])}(),t.MutableDisposable=function(){function e(){C(this,e),this._isDisposed=!1}return w(e,[{key:"value",get:function(){return this._isDisposed?void 0:this._value},set:function(e){var t;this._isDisposed||e===this._value||(null!==(t=this._value)&&void 0!==t&&t.dispose(),this._value=e)}},{key:"clear",value:function(){this.value=void 0}},{key:"dispose",value:function(){var e;this._isDisposed=!0,null!==(e=this._value)&&void 0!==e&&e.dispose(),this._value=void 0}}])}(),t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return i(e)}}}},485:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;var i=function(){function e(){C(this,e),this._data={}}return w(e,[{key:"set",value:function(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}},{key:"get",value:function(e,t){return this._data[e]?this._data[e][t]:void 0}},{key:"clear",value:function(){this._data={}}}])}();t.TwoKeyMap=i,t.FourKeyMap=function(){function e(){C(this,e),this._data=new i}return w(e,[{key:"set",value:function(e,t,r,n,s){this._data.get(e,t)||this._data.set(e,t,new i),this._data.get(e,t).set(r,n,s)}},{key:"get",value:function(e,t,i,r){var n;return null===(n=this._data.get(e,t))||void 0===n?void 0:n.get(i,r)}},{key:"clear",value:function(){this._data.clear()}}])}()},399:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"!=typeof process&&"title"in process;var i=t.isNode?"node":navigator.userAgent,r=t.isNode?"node":navigator.platform;t.isFirefox=i.includes("Firefox"),t.isLegacyEdge=i.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(i),t.getSafariVersion=function(){if(!t.isSafari)return 0;var e=i.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(r),t.isIpad="iPad"===r,t.isIphone="iPhone"===r,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(r),t.isLinux=r.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(i)},385:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;var r=i(399),n=function(){function e(){C(this,e),this._tasks=[],this._i=0}return w(e,[{key:"enqueue",value:function(e){this._tasks.push(e),this._start()}},{key:"flush",value:function(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}},{key:"clear",value:function(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}},{key:"_start",value:function(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}},{key:"_process",value:function(e){this._idleCallback=void 0;var t=0,i=0;for(e.timeRemaining();this._i<this._tasks.length;)if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),1.5*(i=Math.max(t,i))>e.timeRemaining())return void this._start();this.clear()}}])}(),s=function(e){function t(){return C(this,t),d(this,t,arguments)}return g(t,e),w(t,[{key:"_requestCallback",value:function(e){var t=this;return setTimeout(function(){return e(t._createDeadline(16))})}},{key:"_cancelCallback",value:function(e){clearTimeout(e)}},{key:"_createDeadline",value:function(e){var t=Date.now()+e;return{timeRemaining:function(){return Math.max(0,t-Date.now())}}}}])}(n);t.PriorityTaskQueue=s,t.IdleTaskQueue=!r.isNode&&"requestIdleCallback"in window?function(e){function t(){return C(this,t),d(this,t,arguments)}return g(t,e),w(t,[{key:"_requestCallback",value:function(e){return requestIdleCallback(e)}},{key:"_cancelCallback",value:function(e){cancelIdleCallback(e)}}])}(n):s,t.DebouncedIdleTask=function(){function e(){C(this,e),this._queue=new t.IdleTaskQueue}return w(e,[{key:"set",value:function(e){this._queue.clear(),this._queue.enqueue(e)}},{key:"flush",value:function(){this._queue.flush()}}])}()},147:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var i=function(){function e(){C(this,e),this.fg=0,this.bg=0,this.extended=new r}return w(e,[{key:"clone",value:function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}},{key:"isInverse",value:function(){return 67108864&this.fg}},{key:"isBold",value:function(){return 134217728&this.fg}},{key:"isUnderline",value:function(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}},{key:"isBlink",value:function(){return 536870912&this.fg}},{key:"isInvisible",value:function(){return 1073741824&this.fg}},{key:"isItalic",value:function(){return 67108864&this.bg}},{key:"isDim",value:function(){return 134217728&this.bg}},{key:"isStrikethrough",value:function(){return 2147483648&this.fg}},{key:"isProtected",value:function(){return 536870912&this.bg}},{key:"isOverline",value:function(){return 1073741824&this.bg}},{key:"getFgColorMode",value:function(){return 50331648&this.fg}},{key:"getBgColorMode",value:function(){return 50331648&this.bg}},{key:"isFgRGB",value:function(){return!(50331648&~this.fg)}},{key:"isBgRGB",value:function(){return!(50331648&~this.bg)}},{key:"isFgPalette",value:function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}},{key:"isBgPalette",value:function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}},{key:"isFgDefault",value:function(){return!(50331648&this.fg)}},{key:"isBgDefault",value:function(){return!(50331648&this.bg)}},{key:"isAttributeDefault",value:function(){return 0===this.fg&&0===this.bg}},{key:"getFgColor",value:function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}},{key:"getBgColor",value:function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}},{key:"hasExtendedAttrs",value:function(){return 268435456&this.bg}},{key:"updateExtended",value:function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}},{key:"getUnderlineColor",value:function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}},{key:"getUnderlineColorMode",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}},{key:"isUnderlineColorRGB",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&~this.extended.underlineColor):this.isFgRGB()}},{key:"isUnderlineColorPalette",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}},{key:"isUnderlineColorDefault",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&this.extended.underlineColor):this.isFgDefault()}},{key:"getUnderlineStyle",value:function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}},{key:"getUnderlineVariantOffset",value:function(){return this.extended.underlineVariantOffset}}],[{key:"toColorRGB",value:function(e){return[e>>>16&255,e>>>8&255,255&e]}},{key:"fromColorRGB",value:function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}}])}();t.AttributeData=i;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;C(this,e),this._ext=0,this._urlId=0,this._ext=t,this._urlId=i}return w(e,[{key:"ext",get:function(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext},set:function(e){this._ext=e}},{key:"underlineStyle",get:function(){return this._urlId?5:(469762048&this._ext)>>26},set:function(e){this._ext&=-469762049,this._ext|=e<<26&469762048}},{key:"underlineColor",get:function(){return 67108863&this._ext},set:function(e){this._ext&=-67108864,this._ext|=67108863&e}},{key:"urlId",get:function(){return this._urlId},set:function(e){this._urlId=e}},{key:"underlineVariantOffset",get:function(){var e=(3758096384&this._ext)>>29;return e<0?4294967288^e:e},set:function(e){this._ext&=536870911,this._ext|=e<<29&3758096384}},{key:"clone",value:function(){return new e(this._ext,this._urlId)}},{key:"isEmpty",value:function(){return 0===this.underlineStyle&&0===this._urlId}}])}();t.ExtendedAttrs=r},782:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var r=i(133),n=i(855),s=i(147),o=function(e){function t(){var e;return C(this,t),(e=d(this,t,arguments)).content=0,e.fg=0,e.bg=0,e.extended=new s.ExtendedAttrs,e.combinedData="",e}return g(t,e),w(t,[{key:"isCombined",value:function(){return 2097152&this.content}},{key:"getWidth",value:function(){return this.content>>22}},{key:"getChars",value:function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,r.stringFromCodePoint)(2097151&this.content):""}},{key:"getCode",value:function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}},{key:"setFromCharData",value:function(e){this.fg=e[n.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[n.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[n.CHAR_DATA_CHAR_INDEX].length){var i=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var r=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(i-55296)+r-56320+65536|e[n.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[n.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[n.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[n.CHAR_DATA_WIDTH_INDEX]<<22)}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}],[{key:"fromCharData",value:function(e){var i=new t;return i.setFromCharData(e),i}}])}(s.AttributeData);t.CellData=o},855:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},133:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,r="",n=t;n<i;++n){var s=e[n];s>65535?(s-=65536,r+=String.fromCharCode(55296+(s>>10))+String.fromCharCode(s%1024+56320)):r+=String.fromCharCode(s)}return r},t.StringToUtf32=function(){function e(){C(this,e),this._interim=0}return w(e,[{key:"clear",value:function(){this._interim=0}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r=0,n=0;if(this._interim){var s=e.charCodeAt(n++);56320<=s&&s<=57343?t[r++]=1024*(this._interim-55296)+s-56320+65536:(t[r++]=this._interim,t[r++]=s),this._interim=0}for(var o=n;o<i;++o){var a=e.charCodeAt(o);if(55296<=a&&a<=56319){if(++o>=i)return this._interim=a,r;var c=e.charCodeAt(o);56320<=c&&c<=57343?t[r++]=1024*(a-55296)+c-56320+65536:(t[r++]=a,t[r++]=c)}else 65279!==a&&(t[r++]=a)}return r}}])}(),t.Utf8ToUtf32=function(){function e(){C(this,e),this.interim=new Uint8Array(3)}return w(e,[{key:"clear",value:function(){this.interim.fill(0)}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r,n,s,o,a=0,c=0,l=0;if(this.interim[0]){var h=!1,u=this.interim[0];u&=192==(224&u)?31:224==(240&u)?15:7;for(var d,f=0;(d=63&this.interim[++f])&&f<4;)u<<=6,u|=d;for(var v=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,_=v-f;l<_;){if(l>=i)return 0;if(128!=(192&(d=e[l++]))){l--,h=!0;break}this.interim[f++]=d,u<<=6,u|=63&d}h||(2===v?u<128?l--:t[a++]=u:3===v?u<2048||u>=55296&&u<=57343||65279===u||(t[a++]=u):u<65536||u>1114111||(t[a++]=u)),this.interim.fill(0)}for(var g=i-4,p=l;p<i;){for(;!(!(p<g)||128&(r=e[p])||128&(n=e[p+1])||128&(s=e[p+2])||128&(o=e[p+3]));)t[a++]=r,t[a++]=n,t[a++]=s,t[a++]=o,p+=4;if((r=e[p++])<128)t[a++]=r;else if(192==(224&r)){if(p>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[p++]))){p--;continue}if((c=(31&r)<<6|63&n)<128){p--;continue}t[a++]=c}else if(224==(240&r)){if(p>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(s=e[p++]))){p--;continue}if((c=(15&r)<<12|(63&n)<<6|63&s)<2048||c>=55296&&c<=57343||65279===c)continue;t[a++]=c}else if(240==(248&r)){if(p>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(s=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,this.interim[2]=s,a;if(128!=(192&(o=e[p++]))){p--;continue}if((c=(7&r)<<18|(63&n)<<12|(63&s)<<6|63&o)<65536||c>1114111)continue;t[a++]=c}}return a}}])}()},776:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;var s,o=i(859),l=i(97),h={trace:l.LogLevelEnum.TRACE,debug:l.LogLevelEnum.DEBUG,info:l.LogLevelEnum.INFO,warn:l.LogLevelEnum.WARN,error:l.LogLevelEnum.ERROR,off:l.LogLevelEnum.OFF},u=t.LogService=function(e){function t(e){var i;return C(this,t),(i=d(this,t))._optionsService=e,i._logLevel=l.LogLevelEnum.OFF,i._updateLogLevel(),i.register(i._optionsService.onSpecificOptionChange("logLevel",function(){return i._updateLogLevel()})),s=f(i),i}return g(t,e),w(t,[{key:"logLevel",get:function(){return this._logLevel}},{key:"_updateLogLevel",value:function(){this._logLevel=h[this._optionsService.rawOptions.logLevel]}},{key:"_evalLazyOptionalParams",value:function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}},{key:"_log",value:function(e,t,i){this._evalLazyOptionalParams(i),e.call.apply(e,[console,(this._optionsService.options.logger?"":"xterm.js: ")+t].concat(c(i)))}},{key:"trace",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.TRACE&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.trace.bind(this._optionsService.options.logger))&&void 0!==t?t:console.log,e,n)}},{key:"debug",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.DEBUG&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.debug.bind(this._optionsService.options.logger))&&void 0!==t?t:console.log,e,n)}},{key:"info",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.INFO&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.info.bind(this._optionsService.options.logger))&&void 0!==t?t:console.info,e,n)}},{key:"warn",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.WARN&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.warn.bind(this._optionsService.options.logger))&&void 0!==t?t:console.warn,e,n)}},{key:"error",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.ERROR&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.error.bind(this._optionsService.options.logger))&&void 0!==t?t:console.error,e,n)}}])}(o.Disposable);t.LogService=u=r([n(0,l.IOptionsService)],u),t.setTraceLogger=function(e){s=e},t.traceCall=function(e,t,i){if("function"!=typeof i.value)throw new Error("not supported");var r=i.value;i.value=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(s.logLevel!==l.LogLevelEnum.TRACE)return r.apply(this,t);s.trace("GlyphRenderer#".concat(r.name,"(").concat(t.map(function(e){return JSON.stringify(e)}).join(", "),")"));var n=r.apply(this,t);return s.trace("GlyphRenderer#".concat(r.name," return"),n),n}}},726:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;var i="di$target",r="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[r]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var n=function(e,t,s){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,n){t[i]===t?t[r].push({id:e,index:n}):(t[r]=[{id:e,index:n}],t[i]=t)}(n,e,s)};return n.toString=function(){return e},t.serviceRegistry.set(e,n),n}},97:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var r,n=i(726);t.IBufferService=(0,n.createDecorator)("BufferService"),t.ICoreMouseService=(0,n.createDecorator)("CoreMouseService"),t.ICoreService=(0,n.createDecorator)("CoreService"),t.ICharsetService=(0,n.createDecorator)("CharsetService"),t.IInstantiationService=(0,n.createDecorator)("InstantiationService"),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.OFF=5]="OFF"}(r||(t.LogLevelEnum=r={})),t.ILogService=(0,n.createDecorator)("LogService"),t.IOptionsService=(0,n.createDecorator)("OptionsService"),t.IOscLinkService=(0,n.createDecorator)("OscLinkService"),t.IUnicodeService=(0,n.createDecorator)("UnicodeService"),t.IDecorationService=(0,n.createDecorator)("DecorationService")}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}var r={};return function(){var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasAddon=void 0;var t=i(345),n=i(859),s=i(776),o=i(949),a=function(e){function i(){var e;return C(this,i),(e=d(this,i,arguments))._onChangeTextureAtlas=e.register(new t.EventEmitter),e.onChangeTextureAtlas=e._onChangeTextureAtlas.event,e._onAddTextureAtlasCanvas=e.register(new t.EventEmitter),e.onAddTextureAtlasCanvas=e._onAddTextureAtlasCanvas.event,e}return g(i,e),w(i,[{key:"textureAtlas",get:function(){var e;return null===(e=this._renderer)||void 0===e?void 0:e.textureAtlas}},{key:"activate",value:function(e){var i=this,r=e._core;if(e.element){this._terminal=e;var a=r.coreService,c=r.optionsService,l=r.screenElement,h=r.linkifier,u=r,d=u._bufferService,f=u._renderService,v=u._characterJoinerService,_=u._charSizeService,g=u._coreBrowserService,p=u._decorationService,m=u._logService,y=u._themeService;(0,s.setTraceLogger)(m),this._renderer=new o.CanvasRenderer(e,l,h,d,_,c,v,a,g,p,y),this.register((0,t.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,t.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),f.setRenderer(this._renderer),f.handleResize(d.cols,d.rows),this.register((0,n.toDisposable)(function(){var t;f.setRenderer(i._terminal._core._createRenderer()),f.handleResize(e.cols,e.rows),null!==(t=i._renderer)&&void 0!==t&&t.dispose(),i._renderer=void 0}))}else this.register(r.onWillOpen(function(){return i.activate(e)}))}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._renderer)||void 0===e||e.clearTextureAtlas()}}])}(n.Disposable);e.CanvasAddon=a}(),r}()}(z);var q=z.exports,V={exports:{}};!function(e){var t,i;self,e.exports=(t=i={},Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,void(t.FitAddon=function(){function e(){C(this,e)}return w(e,[{key:"activate",value:function(e){this._terminal=e}},{key:"dispose",value:function(){}},{key:"fit",value:function(){var e=this.proposeDimensions();if(e&&this._terminal&&!isNaN(e.cols)&&!isNaN(e.rows)){var t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}}},{key:"proposeDimensions",value:function(){if(this._terminal&&this._terminal.element&&this._terminal.element.parentElement){var e=this._terminal._core,t=e._renderService.dimensions;if(0!==t.css.cell.width&&0!==t.css.cell.height){var i=0===this._terminal.options.scrollback?0:e.viewport.scrollBarWidth,r=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(r.getPropertyValue("height")),s=Math.max(0,parseInt(r.getPropertyValue("width"))),o=window.getComputedStyle(this._terminal.element),a=n-(parseInt(o.getPropertyValue("padding-top"))+parseInt(o.getPropertyValue("padding-bottom"))),c=s-(parseInt(o.getPropertyValue("padding-right"))+parseInt(o.getPropertyValue("padding-left")))-i;return{cols:Math.max(2,Math.floor(c/t.css.cell.width)),rows:Math.max(1,Math.floor(a/t.css.cell.height))}}}}}])}()),i)}(V);var G=V.exports,K={exports:{}};!function(e){self,e.exports=function(){var e={6:function(e,t){function i(e){try{var t=new URL(e),i=t.password&&t.username?"".concat(t.protocol,"//").concat(t.username,":").concat(t.password,"@").concat(t.host):t.username?"".concat(t.protocol,"//").concat(t.username,"@").concat(t.host):"".concat(t.protocol,"//").concat(t.host);return e.toLocaleLowerCase().startsWith(i.toLocaleLowerCase())}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.LinkComputer=t.WebLinkProvider=void 0,t.WebLinkProvider=function(){function e(t,i,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};C(this,e),this._terminal=t,this._regex=i,this._handler=r,this._options=n}return w(e,[{key:"provideLinks",value:function(e,t){var i=r.computeLink(e,this._regex,this._terminal,this._handler);t(this._addCallbacks(i))}},{key:"_addCallbacks",value:function(e){var t=this;return e.map(function(e){return e.leave=t._options.leave,e.hover=function(i,r){if(t._options.hover){var n=e.range;t._options.hover(i,r,n)}},e})}}])}();var r=function(){function e(){C(this,e)}return w(e,null,[{key:"computeLink",value:function(t,r,n,s){for(var o,a=new RegExp(r.source,(r.flags||"")+"g"),c=l(e._getWindowedLineStrings(t-1,n),2),h=c[0],u=c[1],d=h.join(""),f=[];o=a.exec(d);){var v=o[0];if(i(v)){var _=l(e._mapStrIdx(n,u,0,o.index),2),g=_[0],p=_[1],m=l(e._mapStrIdx(n,g,p,v.length),2),y=m[0],S=m[1];if(-1!==g&&-1!==p&&-1!==y&&-1!==S){var C={start:{x:p+1,y:g+1},end:{x:S,y:y+1}};f.push({range:C,text:v,activate:s})}}}return f}},{key:"_getWindowedLineStrings",value:function(e,t){var i,r=e,n=e,s=0,o="",a=[];if(i=t.buffer.active.getLine(e)){var c=i.translateToString(!0);if(i.isWrapped&&" "!==c[0]){for(s=0;(i=t.buffer.active.getLine(--r))&&s<2048&&(s+=(o=i.translateToString(!0)).length,a.push(o),i.isWrapped&&-1===o.indexOf(" ")););a.reverse()}for(a.push(c),s=0;(i=t.buffer.active.getLine(++n))&&i.isWrapped&&s<2048&&(s+=(o=i.translateToString(!0)).length,a.push(o),-1===o.indexOf(" ")););}return[a,r]}},{key:"_mapStrIdx",value:function(e,t,i,r){for(var n=e.buffer.active,s=n.getNullCell(),o=i;r;){var a=n.getLine(t);if(!a)return[-1,-1];for(var c=o;c<a.length;++c){a.getCell(c,s);var l=s.getChars();if(s.getWidth()&&(r-=l.length||1,c===a.length-1&&""===l)){var h=n.getLine(t+1);h&&h.isWrapped&&(h.getCell(0,s),2===s.getWidth()&&(r+=1))}if(r<0)return[t,c]}t++,o=0}return[t,o]}}])}();t.LinkComputer=r}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,i),s.exports}var r={};return function(){var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.WebLinksAddon=void 0;var t=i(6),n=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function s(e,t){var i=window.open();if(i){try{i.opener=null}catch(r){}i.location.href=t}}e.WebLinksAddon=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};C(this,e),this._handler=t,this._options=i}return w(e,[{key:"activate",value:function(e){this._terminal=e;var i=this._options,r=i.urlRegex||n;this._linkProvider=this._terminal.registerLinkProvider(new t.WebLinkProvider(this._terminal,r,this._handler,i))}},{key:"dispose",value:function(){var e;null===(e=this._linkProvider)||void 0===e||e.dispose()}}])}()}(),r}()}(K);var X=K.exports,J={exports:{}};!function(e){globalThis,e.exports=function(){var e={4567:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;var s=i(9042),o=i(9924),c=i(844),l=i(4725),h=i(2585),u=i(3656),f=t.AccessibilityManager=function(e){function t(e,i,r,n){var s;C(this,t),(s=d(this,t))._terminal=e,s._coreBrowserService=r,s._renderService=n,s._rowColumns=new WeakMap,s._liveRegionLineCount=0,s._charsToConsume=[],s._charsToAnnounce="",s._accessibilityContainer=s._coreBrowserService.mainDocument.createElement("div"),s._accessibilityContainer.classList.add("xterm-accessibility"),s._rowContainer=s._coreBrowserService.mainDocument.createElement("div"),s._rowContainer.setAttribute("role","list"),s._rowContainer.classList.add("xterm-accessibility-tree"),s._rowElements=[];for(var a=0;a<s._terminal.rows;a++)s._rowElements[a]=s._createAccessibilityTreeNode(),s._rowContainer.appendChild(s._rowElements[a]);if(s._topBoundaryFocusListener=function(e){return s._handleBoundaryFocus(e,0)},s._bottomBoundaryFocusListener=function(e){return s._handleBoundaryFocus(e,1)},s._rowElements[0].addEventListener("focus",s._topBoundaryFocusListener),s._rowElements[s._rowElements.length-1].addEventListener("focus",s._bottomBoundaryFocusListener),s._refreshRowsDimensions(),s._accessibilityContainer.appendChild(s._rowContainer),s._liveRegion=s._coreBrowserService.mainDocument.createElement("div"),s._liveRegion.classList.add("live-region"),s._liveRegion.setAttribute("aria-live","assertive"),s._accessibilityContainer.appendChild(s._liveRegion),s._liveRegionDebouncer=s.register(new o.TimeBasedDebouncer(s._renderRows.bind(s))),!s._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");return s._terminal.element.insertAdjacentElement("afterbegin",s._accessibilityContainer),s.register(s._terminal.onResize(function(e){return s._handleResize(e.rows)})),s.register(s._terminal.onRender(function(e){return s._refreshRows(e.start,e.end)})),s.register(s._terminal.onScroll(function(){return s._refreshRows()})),s.register(s._terminal.onA11yChar(function(e){return s._handleChar(e)})),s.register(s._terminal.onLineFeed(function(){return s._handleChar("\n")})),s.register(s._terminal.onA11yTab(function(e){return s._handleTab(e)})),s.register(s._terminal.onKey(function(e){return s._handleKey(e.key)})),s.register(s._terminal.onBlur(function(){return s._clearLiveRegion()})),s.register(s._renderService.onDimensionsChange(function(){return s._refreshRowsDimensions()})),s.register((0,u.addDisposableDomListener)(document,"selectionchange",function(){return s._handleSelectionChange()})),s.register(s._coreBrowserService.onDprChange(function(){return s._refreshRowsDimensions()})),s._refreshRows(),s.register((0,c.toDisposable)(function(){s._accessibilityContainer.remove(),s._rowElements.length=0})),s}return g(t,e),w(t,[{key:"_handleTab",value:function(e){for(var t=0;t<e;t++)this._handleChar(" ")}},{key:"_handleChar",value:function(e){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=s.tooMuchOutput)))}},{key:"_clearLiveRegion",value:function(){this._liveRegion.textContent="",this._liveRegionLineCount=0}},{key:"_handleKey",value:function(e){this._clearLiveRegion(),/[\0-\x1F\x7F-\x9F]/.test(e)||this._charsToConsume.push(e)}},{key:"_refreshRows",value:function(e,t){this._liveRegionDebouncer.refresh(e,t,this._terminal.rows)}},{key:"_renderRows",value:function(e,t){for(var i=this._terminal.buffer,r=i.lines.length.toString(),n=e;n<=t;n++){var s=i.lines.get(i.ydisp+n),o=[],a=(null==s?void 0:s.translateToString(!0,void 0,void 0,o))||"",c=(i.ydisp+n+1).toString(),l=this._rowElements[n];l&&(0===a.length?(l.innerText=" ",this._rowColumns.set(l,[0,1])):(l.textContent=a,this._rowColumns.set(l,o)),l.setAttribute("aria-posinset",c),l.setAttribute("aria-setsize",r))}this._announceCharacters()}},{key:"_announceCharacters",value:function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}},{key:"_handleBoundaryFocus",value:function(e,t){var i=e.target,r=this._rowElements[0===t?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")!==(0===t?"1":"".concat(this._terminal.buffer.lines.length))&&e.relatedTarget===r){var n,s;if(0===t?(n=i,s=this._rowElements.pop(),this._rowContainer.removeChild(s)):(n=this._rowElements.shift(),s=i,this._rowContainer.removeChild(n)),n.removeEventListener("focus",this._topBoundaryFocusListener),s.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){var o=this._createAccessibilityTreeNode();this._rowElements.unshift(o),this._rowContainer.insertAdjacentElement("afterbegin",o)}else{var a=this._createAccessibilityTreeNode();this._rowElements.push(a),this._rowContainer.appendChild(a)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}}},{key:"_handleSelectionChange",value:function(){var e,t,i,r=this;if(0!==this._rowElements.length){var n=document.getSelection();if(n)if(n.isCollapsed)this._rowContainer.contains(n.anchorNode)&&this._terminal.clearSelection();else if(n.anchorNode&&n.focusNode){var s={node:n.anchorNode,offset:n.anchorOffset},o={node:n.focusNode,offset:n.focusOffset};if((s.node.compareDocumentPosition(o.node)&Node.DOCUMENT_POSITION_PRECEDING||s.node===o.node&&s.offset>o.offset)&&(s=(e=[o,s])[0],o=e[1]),s.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(s={node:this._rowElements[0].childNodes[0],offset:0}),this._rowContainer.contains(s.node)){var a=this._rowElements.slice(-1)[0];if(o.node.compareDocumentPosition(a)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(o={node:a,offset:null!==(t=null===(i=a.textContent)||void 0===i?void 0:i.length)&&void 0!==t?t:0}),this._rowContainer.contains(o.node)){var c=function(e){var t=e.node,i=e.offset,n=t instanceof Text?t.parentNode:t,s=parseInt(null==n?void 0:n.getAttribute("aria-posinset"),10)-1;if(isNaN(s))return null;var o=r._rowColumns.get(n);if(!o)return null;var a=i<o.length?o[i]:o.slice(-1)[0]+1;return a>=r._terminal.cols&&(++s,a=0),{row:s,column:a}},l=c(s),h=c(o);if(l&&h){if(l.row>h.row||l.row===h.row&&l.column>=h.column)throw new Error("invalid range");this._terminal.select(l.column,l.row,(h.row-l.row)*this._terminal.cols-l.column+h.column)}}}}}}},{key:"_handleResize",value:function(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}},{key:"_createAccessibilityTreeNode",value:function(){var e=this._coreBrowserService.mainDocument.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}},{key:"_refreshRowsDimensions",value:function(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width="".concat(this._renderService.dimensions.css.canvas.width,"px"),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(var e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}}},{key:"_refreshRowDimensions",value:function(e){e.style.height="".concat(this._renderService.dimensions.css.cell.height,"px")}}])}(c.Disposable);t.AccessibilityManager=f=r([n(1,h.IInstantiationService),n(2,l.ICoreBrowserService),n(3,l.IRenderService)],f)},3614:function(e,t){function i(e){return e.replace(/\r?\n/g,"\r")}function r(e,t){return t?"[200~"+e+"[201~":e}function n(e,t,n,s){e=r(e=i(e),n.decPrivateModes.bracketedPasteMode&&!0!==s.rawOptions.ignoreBracketedPasteMode),n.triggerDataEvent(e,!0),t.value=""}function s(e,t,i){var r=i.getBoundingClientRect(),n=e.clientX-r.left-10,s=e.clientY-r.top-10;t.style.width="20px",t.style.height="20px",t.style.left="".concat(n,"px"),t.style.top="".concat(s,"px"),t.style.zIndex="1000",t.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=i,t.bracketTextForPaste=r,t.copyHandler=function(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()},t.handlePasteEvent=function(e,t,i,r){e.stopPropagation(),e.clipboardData&&n(e.clipboardData.getData("text/plain"),t,i,r)},t.paste=n,t.moveTextAreaUnderMouseCursor=s,t.rightClickHandler=function(e,t,i,r,n){s(e,t,i),n&&r.rightClickSelect(e),t.value=r.selectionText,t.select()}},7239:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;var r=i(1505);t.ColorContrastCache=function(){function e(){C(this,e),this._color=new r.TwoKeyMap,this._css=new r.TwoKeyMap}return w(e,[{key:"setCss",value:function(e,t,i){this._css.set(e,t,i)}},{key:"getCss",value:function(e,t){return this._css.get(e,t)}},{key:"setColor",value:function(e,t,i){this._color.set(e,t,i)}},{key:"getColor",value:function(e,t){return this._color.get(e,t)}},{key:"clear",value:function(){this._color.clear(),this._css.clear()}}])}()},3656:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,r){e.addEventListener(t,i,r);var n=!1;return{dispose:function(){n||(n=!0,e.removeEventListener(t,i,r))}}}},3551:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier=void 0;var s=i(3656),o=i(8460),c=i(844),h=i(2585),u=i(4725),v=t.Linkifier=function(e){function t(e,i,r,n,a){var l;return C(this,t),(l=d(this,t))._element=e,l._mouseService=i,l._renderService=r,l._bufferService=n,l._linkProviderService=a,l._linkCacheDisposables=[],l._isMouseOut=!0,l._wasResized=!1,l._activeLine=-1,l._onShowLinkUnderline=l.register(new o.EventEmitter),l.onShowLinkUnderline=l._onShowLinkUnderline.event,l._onHideLinkUnderline=l.register(new o.EventEmitter),l.onHideLinkUnderline=l._onHideLinkUnderline.event,l.register((0,c.getDisposeArrayDisposable)(l._linkCacheDisposables)),l.register((0,c.toDisposable)(function(){var e;l._lastMouseEvent=void 0,null===(e=l._activeProviderReplies)||void 0===e||e.clear()})),l.register(l._bufferService.onResize(function(){l._clearCurrentLink(),l._wasResized=!0})),l.register((0,s.addDisposableDomListener)(l._element,"mouseleave",function(){l._isMouseOut=!0,l._clearCurrentLink()})),l.register((0,s.addDisposableDomListener)(l._element,"mousemove",l._handleMouseMove.bind(f(l)))),l.register((0,s.addDisposableDomListener)(l._element,"mousedown",l._handleMouseDown.bind(f(l)))),l.register((0,s.addDisposableDomListener)(l._element,"mouseup",l._handleMouseUp.bind(f(l)))),l}return g(t,e),w(t,[{key:"currentLink",get:function(){return this._currentLink}},{key:"_handleMouseMove",value:function(e){this._lastMouseEvent=e;var t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(t){this._isMouseOut=!1;for(var i=e.composedPath(),r=0;r<i.length;r++){var n=i[r];if(n.classList.contains("xterm"))break;if(n.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._handleHover(t),this._lastBufferCell=t)}}},{key:"_handleHover",value:function(e){if(this._activeLine!==e.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(e,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}},{key:"_askForLink",value:function(e,t){var i,r=this;this._activeProviderReplies&&t||(null!==(i=this._activeProviderReplies)&&void 0!==i&&i.forEach(function(e){null==e||e.forEach(function(e){e.link.dispose&&e.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);var n,s=!1,o=m(this._linkProviderService.linkProviders.entries());try{var a=function(){var i,o=l(n.value,2),a=o[0],c=o[1];t?(null===(i=r._activeProviderReplies)||void 0===i?void 0:i.get(a))&&(s=r._checkLinkProviderResult(a,e,s)):c.provideLinks(e.y,function(t){var i,n;if(!r._isMouseOut){var o=null==t?void 0:t.map(function(e){return{link:e}});null!==(i=r._activeProviderReplies)&&void 0!==i&&i.set(a,o),s=r._checkLinkProviderResult(a,e,s),(null===(n=r._activeProviderReplies)||void 0===n?void 0:n.size)===r._linkProviderService.linkProviders.length&&r._removeIntersectingLinks(e.y,r._activeProviderReplies)}})};for(o.s();!(n=o.n()).done;)a()}catch(c){o.e(c)}finally{o.f()}}},{key:"_removeIntersectingLinks",value:function(e,t){for(var i=new Set,r=0;r<t.size;r++){var n=t.get(r);if(n)for(var s=0;s<n.length;s++)for(var o=n[s],a=o.link.range.start.y<e?0:o.link.range.start.x,c=o.link.range.end.y>e?this._bufferService.cols:o.link.range.end.x,l=a;l<=c;l++){if(i.has(l)){n.splice(s--,1);break}i.add(l)}}}},{key:"_checkLinkProviderResult",value:function(e,t,i){var r=this;if(!this._activeProviderReplies)return i;for(var n=this._activeProviderReplies.get(e),s=!1,o=0;o<e;o++)this._activeProviderReplies.has(o)&&!this._activeProviderReplies.get(o)||(s=!0);if(!s&&n){var a=n.find(function(e){return r._linkAtPosition(e.link,t)});a&&(i=!0,this._handleNewLink(a))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!i)for(var c=0;c<this._activeProviderReplies.size;c++){var l,h=null===(l=this._activeProviderReplies.get(c))||void 0===l?void 0:l.find(function(e){return r._linkAtPosition(e.link,t)});if(h){i=!0,this._handleNewLink(h);break}}return i}},{key:"_handleMouseDown",value:function(){this._mouseDownLink=this._currentLink}},{key:"_handleMouseUp",value:function(e){if(this._currentLink){var t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}}},{key:"_clearCurrentLink",value:function(e,t){this._currentLink&&this._lastMouseEvent&&(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,c.disposeArray)(this._linkCacheDisposables))}},{key:"_handleNewLink",value:function(e){var t=this;if(this._lastMouseEvent){var i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(e.link,i)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:void 0===e.link.decorations||e.link.decorations.underline,pointerCursor:void 0===e.link.decorations||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:function(){var e;return null===(e=t._currentLink)||void 0===e||null===(e=e.state)||void 0===e?void 0:e.decorations.pointerCursor},set:function(e){var i;(null===(i=t._currentLink)||void 0===i?void 0:i.state)&&t._currentLink.state.decorations.pointerCursor!==e&&(t._currentLink.state.decorations.pointerCursor=e,t._currentLink.state.isHovered&&t._element.classList.toggle("xterm-cursor-pointer",e))}},underline:{get:function(){var e;return null===(e=t._currentLink)||void 0===e||null===(e=e.state)||void 0===e?void 0:e.decorations.underline},set:function(i){var r,n;(null===(r=t._currentLink)||void 0===r?void 0:r.state)&&(null===(n=t._currentLink)||void 0===n||null===(n=n.state)||void 0===n?void 0:n.decorations.underline)!==i&&(t._currentLink.state.decorations.underline=i,t._currentLink.state.isHovered&&t._fireUnderlineEvent(e.link,i))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(function(e){if(t._currentLink){var i=0===e.start?0:e.start+1+t._bufferService.buffer.ydisp,r=t._bufferService.buffer.ydisp+1+e.end;if(t._currentLink.link.range.start.y>=i&&t._currentLink.link.range.end.y<=r&&(t._clearCurrentLink(i,r),t._lastMouseEvent)){var n=t._positionFromMouseEvent(t._lastMouseEvent,t._element,t._mouseService);n&&t._askForLink(n,!1)}}})))}}},{key:"_linkHover",value:function(e,t,i){var r;null!==(r=this._currentLink)&&void 0!==r&&r.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(i,t.text)}},{key:"_fireUnderlineEvent",value:function(e,t){var i=e.range,r=this._bufferService.buffer.ydisp,n=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-r-1,i.end.x,i.end.y-r-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(n)}},{key:"_linkLeave",value:function(e,t,i){var r;null!==(r=this._currentLink)&&void 0!==r&&r.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(i,t.text)}},{key:"_linkAtPosition",value:function(e,t){var i=e.range.start.y*this._bufferService.cols+e.range.start.x,r=e.range.end.y*this._bufferService.cols+e.range.end.x,n=t.y*this._bufferService.cols+t.x;return i<=n&&n<=r}},{key:"_positionFromMouseEvent",value:function(e,t,i){var r=i.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}}},{key:"_createLinkUnderlineEvent",value:function(e,t,i,r,n){return{x1:e,y1:t,x2:i,y2:r,cols:this._bufferService.cols,fg:n}}}])}(c.Disposable);t.Linkifier=v=r([n(1,u.IMouseService),n(2,u.IRenderService),n(3,h.IBufferService),n(4,u.ILinkProviderService)],v)},9042:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;var s=i(511),o=i(2585),c=t.OscLinkProvider=function(){function e(t,i,r){C(this,e),this._bufferService=t,this._optionsService=i,this._oscLinkService=r}return w(e,[{key:"provideLinks",value:function(e,t){var i=this,r=this._bufferService.buffer.lines.get(e-1);if(r){for(var n=[],o=this._optionsService.rawOptions.linkHandler,a=new s.CellData,c=r.getTrimmedLength(),h=-1,u=-1,d=!1,f=function(){if(-1!==u||r.hasContent(v)){if(r.loadCell(v,a),a.hasExtendedAttrs()&&a.extended.urlId){if(-1===u)return u=v,h=a.extended.urlId,1;d=a.extended.urlId!==h}else-1!==u&&(d=!0);if(d||-1!==u&&v===c-1){var t,s=null===(t=i._oscLinkService.getLinkData(h))||void 0===t?void 0:t.uri;if(s){var f={start:{x:u+1,y:e},end:{x:v+(d||v!==c-1?0:1),y:e}},_=!1;if(null==o||!o.allowNonHttpProtocols)try{var g=new URL(s);["http:","https:"].includes(g.protocol)||(_=!0)}catch(e){_=!0}_||n.push({text:s,range:f,activate:function(e,t){return o?o.activate(e,t,f):l(0,t)},hover:function(e,t){var i;return null==o||null===(i=o.hover)||void 0===i?void 0:i.call(o,e,t,f)},leave:function(e,t){var i;return null==o||null===(i=o.leave)||void 0===i?void 0:i.call(o,e,t,f)}})}d=!1,a.hasExtendedAttrs()&&a.extended.urlId?(u=v,h=a.extended.urlId):(u=-1,h=-1)}}},v=0;v<c;v++)f();t(n)}else t(void 0)}}])}();function l(e,t){if(confirm("Do you want to navigate to ".concat(t,"?\n\nWARNING: This link could potentially be dangerous"))){var i=window.open();if(i){try{i.opener=null}catch(r){}i.location.href=t}}}t.OscLinkProvider=c=r([n(0,o.IBufferService),n(1,o.IOptionsService),n(2,o.IOscLinkService)],c)},6193:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=function(){function e(t,i){C(this,e),this._renderCallback=t,this._coreBrowserService=i,this._refreshCallbacks=[]}return w(e,[{key:"dispose",value:function(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"addRefreshCallback",value:function(e){var t=this;return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){return t._innerRefresh()})),this._animationFrame}},{key:"refresh",value:function(e,t,i){var r=this;this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){return r._innerRefresh()}))}},{key:"_innerRefresh",value:function(){if(this._animationFrame=void 0,void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}else this._runRefreshCallbacks()}},{key:"_runRefreshCallbacks",value:function(){var e,t=m(this._refreshCallbacks);try{for(t.s();!(e=t.n()).done;)(0,e.value)(0)}catch(i){t.e(i)}finally{t.f()}this._refreshCallbacks=[]}}])}()},3236:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;var r=i(3614),n=i(3656),s=i(3551),o=i(9042),a=i(3730),l=i(1680),u=i(3107),f=i(5744),v=i(2950),_=i(1296),p=i(428),y=i(4269),S=i(5114),b=i(8934),k=i(3230),L=i(9312),x=i(4725),E=i(6731),R=i(8055),D=i(8969),A=i(8460),M=i(844),T=i(6114),B=i(8437),O=i(2584),P=i(7399),I=i(5941),H=i(9074),F=i(2585),W=i(5435),N=i(4567),U=i(779),j=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C(this,t),(e=d(this,t,[i])).browser=T,e._keyDownHandled=!1,e._keyDownSeen=!1,e._keyPressHandled=!1,e._unprocessedDeadKey=!1,e._accessibilityManager=e.register(new M.MutableDisposable),e._onCursorMove=e.register(new A.EventEmitter),e.onCursorMove=e._onCursorMove.event,e._onKey=e.register(new A.EventEmitter),e.onKey=e._onKey.event,e._onRender=e.register(new A.EventEmitter),e.onRender=e._onRender.event,e._onSelectionChange=e.register(new A.EventEmitter),e.onSelectionChange=e._onSelectionChange.event,e._onTitleChange=e.register(new A.EventEmitter),e.onTitleChange=e._onTitleChange.event,e._onBell=e.register(new A.EventEmitter),e.onBell=e._onBell.event,e._onFocus=e.register(new A.EventEmitter),e._onBlur=e.register(new A.EventEmitter),e._onA11yCharEmitter=e.register(new A.EventEmitter),e._onA11yTabEmitter=e.register(new A.EventEmitter),e._onWillOpen=e.register(new A.EventEmitter),e._setup(),e._decorationService=e._instantiationService.createInstance(H.DecorationService),e._instantiationService.setService(F.IDecorationService,e._decorationService),e._linkProviderService=e._instantiationService.createInstance(U.LinkProviderService),e._instantiationService.setService(x.ILinkProviderService,e._linkProviderService),e._linkProviderService.registerLinkProvider(e._instantiationService.createInstance(a.OscLinkProvider)),e.register(e._inputHandler.onRequestBell(function(){return e._onBell.fire()})),e.register(e._inputHandler.onRequestRefreshRows(function(t,i){return e.refresh(t,i)})),e.register(e._inputHandler.onRequestSendFocus(function(){return e._reportFocus()})),e.register(e._inputHandler.onRequestReset(function(){return e.reset()})),e.register(e._inputHandler.onRequestWindowsOptionsReport(function(t){return e._reportWindowsOptions(t)})),e.register(e._inputHandler.onColor(function(t){return e._handleColorEvent(t)})),e.register((0,A.forwardEvent)(e._inputHandler.onCursorMove,e._onCursorMove)),e.register((0,A.forwardEvent)(e._inputHandler.onTitleChange,e._onTitleChange)),e.register((0,A.forwardEvent)(e._inputHandler.onA11yChar,e._onA11yCharEmitter)),e.register((0,A.forwardEvent)(e._inputHandler.onA11yTab,e._onA11yTabEmitter)),e.register(e._bufferService.onResize(function(t){return e._afterResize(t.cols,t.rows)})),e.register((0,M.toDisposable)(function(){var t;e._customKeyEventHandler=void 0,null===(t=e.element)||void 0===t||null===(t=t.parentNode)||void 0===t||t.removeChild(e.element)})),e}return g(t,e),w(t,[{key:"onFocus",get:function(){return this._onFocus.event}},{key:"onBlur",get:function(){return this._onBlur.event}},{key:"onA11yChar",get:function(){return this._onA11yCharEmitter.event}},{key:"onA11yTab",get:function(){return this._onA11yTabEmitter.event}},{key:"onWillOpen",get:function(){return this._onWillOpen.event}},{key:"_handleColorEvent",value:function(e){var t=this;if(this._themeService){var i,r=m(e);try{var n=function(){var e,r=i.value,n="";switch(r.index){case 256:e="foreground",n="10";break;case 257:e="background",n="11";break;case 258:e="cursor",n="12";break;default:e="ansi",n="4;"+r.index}switch(r.type){case 0:var s=R.color.toColorRGB("ansi"===e?t._themeService.colors.ansi[r.index]:t._themeService.colors[e]);t.coreService.triggerDataEvent("".concat(O.C0.ESC,"]").concat(n,";").concat((0,I.toRgbString)(s)).concat(O.C1_ESCAPED.ST));break;case 1:if("ansi"===e)t._themeService.modifyColors(function(e){var t;return e.ansi[r.index]=(t=R.channels).toColor.apply(t,c(r.color))});else{var o=e;t._themeService.modifyColors(function(e){var t;return e[o]=(t=R.channels).toColor.apply(t,c(r.color))})}break;case 2:t._themeService.restoreColor(r.index)}};for(r.s();!(i=r.n()).done;)n()}catch(s){r.e(s)}finally{r.f()}}}},{key:"_setup",value:function(){h(t,"_setup",this,3)([]),this._customKeyEventHandler=void 0}},{key:"buffer",get:function(){return this.buffers.active}},{key:"focus",value:function(){this.textarea&&this.textarea.focus({preventScroll:!0})}},{key:"_handleScreenReaderModeOptionChange",value:function(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(N.AccessibilityManager,this)):this._accessibilityManager.clear()}},{key:"_handleTextAreaFocus",value:function(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(O.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}},{key:"blur",value:function(){var e;return null===(e=this.textarea)||void 0===e?void 0:e.blur()}},{key:"_handleTextAreaBlur",value:function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(O.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}},{key:"_syncTextArea",value:function(){if(this.textarea&&this.buffer.isCursorInViewport&&!this._compositionHelper.isComposing&&this._renderService){var e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(t){var i=Math.min(this.buffer.x,this.cols-1),r=this._renderService.dimensions.css.cell.height,n=t.getWidth(i),s=this._renderService.dimensions.css.cell.width*n,o=this.buffer.y*this._renderService.dimensions.css.cell.height,a=i*this._renderService.dimensions.css.cell.width;this.textarea.style.left=a+"px",this.textarea.style.top=o+"px",this.textarea.style.width=s+"px",this.textarea.style.height=r+"px",this.textarea.style.lineHeight=r+"px",this.textarea.style.zIndex="-5"}}}},{key:"_initGlobal",value:function(){var e=this;this._bindKeys(),this.register((0,n.addDisposableDomListener)(this.element,"copy",function(t){e.hasSelection()&&(0,r.copyHandler)(t,e._selectionService)}));var t=function(t){return(0,r.handlePasteEvent)(t,e.textarea,e.coreService,e.optionsService)};this.register((0,n.addDisposableDomListener)(this.textarea,"paste",t)),this.register((0,n.addDisposableDomListener)(this.element,"paste",t)),T.isFirefox?this.register((0,n.addDisposableDomListener)(this.element,"mousedown",function(t){2===t.button&&(0,r.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)})):this.register((0,n.addDisposableDomListener)(this.element,"contextmenu",function(t){(0,r.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)})),T.isLinux&&this.register((0,n.addDisposableDomListener)(this.element,"auxclick",function(t){1===t.button&&(0,r.moveTextAreaUnderMouseCursor)(t,e.textarea,e.screenElement)}))}},{key:"_bindKeys",value:function(){var e=this;this.register((0,n.addDisposableDomListener)(this.textarea,"keyup",function(t){return e._keyUp(t)},!0)),this.register((0,n.addDisposableDomListener)(this.textarea,"keydown",function(t){return e._keyDown(t)},!0)),this.register((0,n.addDisposableDomListener)(this.textarea,"keypress",function(t){return e._keyPress(t)},!0)),this.register((0,n.addDisposableDomListener)(this.textarea,"compositionstart",function(){return e._compositionHelper.compositionstart()})),this.register((0,n.addDisposableDomListener)(this.textarea,"compositionupdate",function(t){return e._compositionHelper.compositionupdate(t)})),this.register((0,n.addDisposableDomListener)(this.textarea,"compositionend",function(){return e._compositionHelper.compositionend()})),this.register((0,n.addDisposableDomListener)(this.textarea,"input",function(t){return e._inputEvent(t)},!0)),this.register(this.onRender(function(){return e._compositionHelper.updateCompositionElements()}))}},{key:"open",value:function(e){var t,i,r,a=this;if(!e)throw new Error("Terminal requires a parent element.");if(e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),null!==(t=this.element)&&void 0!==t&&t.ownerDocument.defaultView&&this._coreBrowserService)this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView);else{this._document=e.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);var c=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),c.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,n.addDisposableDomListener)(this.screenElement,"mousemove",function(e){return a.updateCursorStyle(e)})),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),c.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",o.promptLabel),T.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(S.CoreBrowserService,this.textarea,null!==(i=e.ownerDocument.defaultView)&&void 0!==i?i:window,(null!==(r=this._document)&&void 0!==r?r:"undefined"!=typeof window)?window.document:null)),this._instantiationService.setService(x.ICoreBrowserService,this._coreBrowserService),this.register((0,n.addDisposableDomListener)(this.textarea,"focus",function(e){return a._handleTextAreaFocus(e)})),this.register((0,n.addDisposableDomListener)(this.textarea,"blur",function(){return a._handleTextAreaBlur()})),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(p.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(x.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(E.ThemeService),this._instantiationService.setService(x.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(y.CharacterJoinerService),this._instantiationService.setService(x.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(k.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(x.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(function(e){return a._onRender.fire(e)})),this.onResize(function(e){return a._renderService.resize(e.cols,e.rows)}),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(v.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(b.MouseService),this._instantiationService.setService(x.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(s.Linkifier,this.screenElement)),this.element.appendChild(c);try{this._onWillOpen.fire(this.element)}catch(h){}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(l.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(function(e){return a.scrollLines(e.amount,e.suppressScrollEvent,1)}),this.register(this._inputHandler.onRequestSyncScrollBar(function(){return a.viewport.syncScrollArea()})),this.register(this.viewport),this.register(this.onCursorMove(function(){a._renderService.handleCursorMove(),a._syncTextArea()})),this.register(this.onResize(function(){return a._renderService.handleResize(a.cols,a.rows)})),this.register(this.onBlur(function(){return a._renderService.handleBlur()})),this.register(this.onFocus(function(){return a._renderService.handleFocus()})),this.register(this._renderService.onDimensionsChange(function(){return a.viewport.syncScrollArea()})),this._selectionService=this.register(this._instantiationService.createInstance(L.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(x.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(function(e){return a.scrollLines(e.amount,e.suppressScrollEvent)})),this.register(this._selectionService.onSelectionChange(function(){return a._onSelectionChange.fire()})),this.register(this._selectionService.onRequestRedraw(function(e){return a._renderService.handleSelectionChanged(e.start,e.end,e.columnSelectMode)})),this.register(this._selectionService.onLinuxMouseSelection(function(e){a.textarea.value=e,a.textarea.focus(),a.textarea.select()})),this.register(this._onScroll.event(function(e){a.viewport.syncScrollArea(),a._selectionService.refresh()})),this.register((0,n.addDisposableDomListener)(this._viewportElement,"scroll",function(){return a._selectionService.refresh()})),this.register(this._instantiationService.createInstance(u.BufferDecorationRenderer,this.screenElement)),this.register((0,n.addDisposableDomListener)(this.element,"mousedown",function(e){return a._selectionService.handleMouseDown(e)})),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(N.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",function(e){return a._handleScreenReaderModeOptionChange(e)})),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(f.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",function(e){!a._overviewRulerRenderer&&e&&a._viewportElement&&a.screenElement&&(a._overviewRulerRenderer=a.register(a._instantiationService.createInstance(f.OverviewRulerRenderer,a._viewportElement,a.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}}},{key:"_createRenderer",value:function(){return this._instantiationService.createInstance(_.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}},{key:"bindMouse",value:function(){var e=this,t=this,i=this.element;function r(e){var i,r,n=t._mouseService.getMouseReportCoords(e,t.screenElement);if(!n)return!1;switch(e.overrideType||e.type){case"mousemove":r=32,void 0===e.buttons?(i=3,void 0!==e.button&&(i=e.button<3?e.button:3)):i=1&e.buttons?0:4&e.buttons?1:2&e.buttons?2:3;break;case"mouseup":r=0,i=e.button<3?e.button:3;break;case"mousedown":r=1,i=e.button<3?e.button:3;break;case"wheel":if(t._customWheelEventHandler&&!1===t._customWheelEventHandler(e))return!1;if(0===t.viewport.getLinesScrolled(e))return!1;r=e.deltaY<0?0:1,i=4;break;default:return!1}return!(void 0===r||void 0===i||i>4)&&t.coreMouseService.triggerMouseEvent({col:n.col,row:n.row,x:n.x,y:n.y,button:i,action:r,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey})}var s={mouseup:null,wheel:null,mousedrag:null,mousemove:null},o={mouseup:function(t){return r(t),t.buttons||(e._document.removeEventListener("mouseup",s.mouseup),s.mousedrag&&e._document.removeEventListener("mousemove",s.mousedrag)),e.cancel(t)},wheel:function(t){return r(t),e.cancel(t,!0)},mousedrag:function(e){e.buttons&&r(e)},mousemove:function(e){e.buttons||r(e)}};this.register(this.coreMouseService.onProtocolChange(function(t){t?("debug"===e.optionsService.rawOptions.logLevel&&e._logService.debug("Binding to mouse events:",e.coreMouseService.explainEvents(t)),e.element.classList.add("enable-mouse-events"),e._selectionService.disable()):(e._logService.debug("Unbinding from mouse events."),e.element.classList.remove("enable-mouse-events"),e._selectionService.enable()),8&t?s.mousemove||(i.addEventListener("mousemove",o.mousemove),s.mousemove=o.mousemove):(i.removeEventListener("mousemove",s.mousemove),s.mousemove=null),16&t?s.wheel||(i.addEventListener("wheel",o.wheel,{passive:!1}),s.wheel=o.wheel):(i.removeEventListener("wheel",s.wheel),s.wheel=null),2&t?s.mouseup||(s.mouseup=o.mouseup):(e._document.removeEventListener("mouseup",s.mouseup),s.mouseup=null),4&t?s.mousedrag||(s.mousedrag=o.mousedrag):(e._document.removeEventListener("mousemove",s.mousedrag),s.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,n.addDisposableDomListener)(i,"mousedown",function(t){if(t.preventDefault(),e.focus(),e.coreMouseService.areMouseEventsActive&&!e._selectionService.shouldForceSelection(t))return r(t),s.mouseup&&e._document.addEventListener("mouseup",s.mouseup),s.mousedrag&&e._document.addEventListener("mousemove",s.mousedrag),e.cancel(t)})),this.register((0,n.addDisposableDomListener)(i,"wheel",function(t){if(!s.wheel){if(e._customWheelEventHandler&&!1===e._customWheelEventHandler(t))return!1;if(!e.buffer.hasScrollback){var i=e.viewport.getLinesScrolled(t);if(0===i)return;for(var r=O.C0.ESC+(e.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(t.deltaY<0?"A":"B"),n="",o=0;o<Math.abs(i);o++)n+=r;return e.coreService.triggerDataEvent(n,!0),e.cancel(t,!0)}return e.viewport.handleWheel(t)?e.cancel(t):void 0}},{passive:!1})),this.register((0,n.addDisposableDomListener)(i,"touchstart",function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.handleTouchStart(t),e.cancel(t)},{passive:!0})),this.register((0,n.addDisposableDomListener)(i,"touchmove",function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.handleTouchMove(t)?void 0:e.cancel(t)},{passive:!1}))}},{key:"refresh",value:function(e,t){var i;null===(i=this._renderService)||void 0===i||i.refreshRows(e,t)}},{key:"updateCursorStyle",value:function(e){var t;null!==(t=this._selectionService)&&void 0!==t&&t.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}},{key:"_showCursor",value:function(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}},{key:"scrollLines",value:function(e,i){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;1===n?(h(t,"scrollLines",this,3)([e,i,n]),this.refresh(0,this.rows-1)):null===(r=this.viewport)||void 0===r||r.scrollLines(e)}},{key:"paste",value:function(e){(0,r.paste)(e,this.textarea,this.coreService,this.optionsService)}},{key:"attachCustomKeyEventHandler",value:function(e){this._customKeyEventHandler=e}},{key:"attachCustomWheelEventHandler",value:function(e){this._customWheelEventHandler=e}},{key:"registerLinkProvider",value:function(e){return this._linkProviderService.registerLinkProvider(e)}},{key:"registerCharacterJoiner",value:function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");var t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}},{key:"deregisterCharacterJoiner",value:function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}},{key:"markers",get:function(){return this.buffer.markers}},{key:"registerMarker",value:function(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}},{key:"registerDecoration",value:function(e){return this._decorationService.registerDecoration(e)}},{key:"hasSelection",value:function(){return!!this._selectionService&&this._selectionService.hasSelection}},{key:"select",value:function(e,t,i){this._selectionService.setSelection(e,t,i)}},{key:"getSelection",value:function(){return this._selectionService?this._selectionService.selectionText:""}},{key:"getSelectionPosition",value:function(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}},{key:"clearSelection",value:function(){var e;null===(e=this._selectionService)||void 0===e||e.clearSelection()}},{key:"selectAll",value:function(){var e;null===(e=this._selectionService)||void 0===e||e.selectAll()}},{key:"selectLines",value:function(e,t){var i;null===(i=this._selectionService)||void 0===i||i.selectLines(e,t)}},{key:"_keyDown",value:function(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;var t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;t||"Dead"!==e.key&&"AltGraph"!==e.key||(this._unprocessedDeadKey=!0);var i=(0,P.evaluateKeyboardEvent)(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===i.type||2===i.type){var r=this.rows-1;return this.scrollLines(2===i.type?-r:r),this.cancel(e,!0)}return 1===i.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(i.cancel&&this.cancel(e,!0),!i.key||!!(e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&1===e.key.length&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(i.key!==O.C0.ETX&&i.key!==O.C0.CR||(this.textarea.value=""),this._onKey.fire({key:i.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(i.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey?this.cancel(e,!0):void(this._keyDownHandled=!0))))}},{key:"_isThirdLevelShift",value:function(e,t){var i=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return"keypress"===t.type?i:i&&(!t.keyCode||t.keyCode>47)}},{key:"_keyUp",value:function(e){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e)||(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}},{key:"_keyPress",value:function(e){var t;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}},{key:"_inputEvent",value:function(e){if(e.data&&"insertText"===e.inputType&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;var t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}},{key:"resize",value:function(e,i){e!==this.cols||i!==this.rows?h(t,"resize",this,3)([e,i]):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}},{key:"_afterResize",value:function(e,t){var i,r;null!==(i=this._charSizeService)&&void 0!==i&&i.measure(),null===(r=this.viewport)||void 0===r||r.syncScrollArea(!0)}},{key:"clear",value:function(){if(0!==this.buffer.ybase||0!==this.buffer.y){var e;this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var t=1;t<this.rows;t++)this.buffer.lines.push(this.buffer.getBlankLine(B.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),null!==(e=this.viewport)&&void 0!==e&&e.reset(),this.refresh(0,this.rows-1)}}},{key:"reset",value:function(){var e,i;this.options.rows=this.rows,this.options.cols=this.cols;var r=this._customKeyEventHandler;this._setup(),h(t,"reset",this,3)([]),null!==(e=this._selectionService)&&void 0!==e&&e.reset(),this._decorationService.reset(),null!==(i=this.viewport)&&void 0!==i&&i.reset(),this._customKeyEventHandler=r,this.refresh(0,this.rows-1)}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._renderService)||void 0===e||e.clearTextureAtlas()}},{key:"_reportFocus",value:function(){var e;null!==(e=this.element)&&void 0!==e&&e.classList.contains("focus")?this.coreService.triggerDataEvent(O.C0.ESC+"[I"):this.coreService.triggerDataEvent(O.C0.ESC+"[O")}},{key:"_reportWindowsOptions",value:function(e){if(this._renderService)switch(e){case W.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:var t=this._renderService.dimensions.css.canvas.width.toFixed(0),i=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent("".concat(O.C0.ESC,"[4;").concat(i,";").concat(t,"t"));break;case W.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:var r=this._renderService.dimensions.css.cell.width.toFixed(0),n=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent("".concat(O.C0.ESC,"[6;").concat(n,";").concat(r,"t"))}}},{key:"cancel",value:function(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1}}])}(D.CoreTerminal);t.Terminal=j},9924:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;C(this,e),this._renderCallback=t,this._debounceThresholdMS=i,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}return w(e,[{key:"dispose",value:function(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}},{key:"refresh",value:function(e,t,i){var r=this;this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t;var n=Date.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){var s=n-this._lastRefreshMs,o=this._debounceThresholdMS-s;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(function(){r._lastRefreshMs=Date.now(),r._innerRefresh(),r._additionalRefreshRequested=!1,r._refreshTimeoutID=void 0},o)}}},{key:"_innerRefresh",value:function(){if(void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}}}])}()},1680:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var s=i(3656),o=i(4725),c=i(8460),l=i(844),h=i(2585),u=t.Viewport=function(e){function t(e,i,r,n,o,a,l,h){var u;return C(this,t),(u=d(this,t))._viewportElement=e,u._scrollArea=i,u._bufferService=r,u._optionsService=n,u._charSizeService=o,u._renderService=a,u._coreBrowserService=l,u.scrollBarWidth=0,u._currentRowHeight=0,u._currentDeviceCellHeight=0,u._lastRecordedBufferLength=0,u._lastRecordedViewportHeight=0,u._lastRecordedBufferHeight=0,u._lastTouchY=0,u._lastScrollTop=0,u._wheelPartialScroll=0,u._refreshAnimationFrame=null,u._ignoreNextScrollEvent=!1,u._smoothScrollState={startTime:0,origin:-1,target:-1},u._onRequestScrollLines=u.register(new c.EventEmitter),u.onRequestScrollLines=u._onRequestScrollLines.event,u.scrollBarWidth=u._viewportElement.offsetWidth-u._scrollArea.offsetWidth||15,u.register((0,s.addDisposableDomListener)(u._viewportElement,"scroll",u._handleScroll.bind(f(u)))),u._activeBuffer=u._bufferService.buffer,u.register(u._bufferService.buffers.onBufferActivate(function(e){return u._activeBuffer=e.activeBuffer})),u._renderDimensions=u._renderService.dimensions,u.register(u._renderService.onDimensionsChange(function(e){return u._renderDimensions=e})),u._handleThemeChange(h.colors),u.register(h.onChangeColors(function(e){return u._handleThemeChange(e)})),u.register(u._optionsService.onSpecificOptionChange("scrollback",function(){return u.syncScrollArea()})),setTimeout(function(){return u.syncScrollArea()}),u}return g(t,e),w(t,[{key:"_handleThemeChange",value:function(e){this._viewportElement.style.backgroundColor=e.background.css}},{key:"reset",value:function(){var e=this;this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(function(){return e.syncScrollArea()})}},{key:"_refresh",value:function(e){var t=this;if(e)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){return t._innerRefresh()}))}},{key:"_innerRefresh",value:function(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null}},{key:"syncScrollArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}},{key:"_handleScroll",value:function(e){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});var t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:t,suppressScrollEvent:!0})}}},{key:"_smoothScroll",value:function(){var e=this;if(!this._isDisposed&&-1!==this._smoothScrollState.origin&&-1!==this._smoothScrollState.target){var t=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(t*(this._smoothScrollState.target-this._smoothScrollState.origin)),t<1?this._coreBrowserService.window.requestAnimationFrame(function(){return e._smoothScroll()}):this._clearSmoothScrollState()}}},{key:"_smoothScrollPercent",value:function(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}},{key:"_clearSmoothScrollState",value:function(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}},{key:"_bubbleScroll",value:function(e,t){var i=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&i<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}},{key:"handleWheel",value:function(e){var t=this._getPixelsScrolled(e);return 0!==t&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,-1===this._smoothScrollState.target?this._smoothScrollState.target=this._viewportElement.scrollTop+t:this._smoothScrollState.target+=t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}},{key:"scrollLines",value:function(e){if(0!==e)if(this._optionsService.rawOptions.smoothScrollDuration){var t=e*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:e,suppressScrollEvent:!1})}},{key:"_getPixelsScrolled",value:function(e){if(0===e.deltaY||e.shiftKey)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t}},{key:"getBufferElements",value:function(e,t){for(var i,r="",n=[],s=null!=t?t:this._bufferService.buffer.lines.length,o=this._bufferService.buffer.lines,a=e;a<s;a++){var c,l=o.get(a);if(l){var h=null===(c=o.get(a+1))||void 0===c?void 0:c.isWrapped;if(r+=l.translateToString(!h),!h||a===o.length-1){var u=document.createElement("div");u.textContent=r,n.push(u),r.length>0&&(i=u),r=""}}}return{bufferElements:n,cursorElement:i}}},{key:"getLinesScrolled",value:function(e){if(0===e.deltaY||e.shiftKey)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t}},{key:"_applyScrollModifier",value:function(e,t){var i=this._optionsService.rawOptions.fastScrollModifier;return"alt"===i&&t.altKey||"ctrl"===i&&t.ctrlKey||"shift"===i&&t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}},{key:"handleTouchStart",value:function(e){this._lastTouchY=e.touches[0].pageY}},{key:"handleTouchMove",value:function(e){var t=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}}])}(l.Disposable);t.Viewport=u=r([n(2,h.IBufferService),n(3,h.IOptionsService),n(4,o.ICharSizeService),n(5,o.IRenderService),n(6,o.ICoreBrowserService),n(7,o.IThemeService)],u)},3107:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;var s=i(4725),o=i(844),c=i(2585),l=t.BufferDecorationRenderer=function(e){function t(e,i,r,n,s){var a;return C(this,t),(a=d(this,t))._screenElement=e,a._bufferService=i,a._coreBrowserService=r,a._decorationService=n,a._renderService=s,a._decorationElements=new Map,a._altBufferIsActive=!1,a._dimensionsChanged=!1,a._container=document.createElement("div"),a._container.classList.add("xterm-decoration-container"),a._screenElement.appendChild(a._container),a.register(a._renderService.onRenderedViewportChange(function(){return a._doRefreshDecorations()})),a.register(a._renderService.onDimensionsChange(function(){a._dimensionsChanged=!0,a._queueRefresh()})),a.register(a._coreBrowserService.onDprChange(function(){return a._queueRefresh()})),a.register(a._bufferService.buffers.onBufferActivate(function(){a._altBufferIsActive=a._bufferService.buffer===a._bufferService.buffers.alt})),a.register(a._decorationService.onDecorationRegistered(function(){return a._queueRefresh()})),a.register(a._decorationService.onDecorationRemoved(function(e){return a._removeDecoration(e)})),a.register((0,o.toDisposable)(function(){a._container.remove(),a._decorationElements.clear()})),a}return g(t,e),w(t,[{key:"_queueRefresh",value:function(){var e=this;void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback(function(){e._doRefreshDecorations(),e._animationFrame=void 0}))}},{key:"_doRefreshDecorations",value:function(){var e,t=m(this._decorationService.decorations);try{for(t.s();!(e=t.n()).done;){var i=e.value;this._renderDecoration(i)}}catch(r){t.e(r)}finally{t.f()}this._dimensionsChanged=!1}},{key:"_renderDecoration",value:function(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}},{key:"_createElement",value:function(e){var t,i,r=this._coreBrowserService.mainDocument.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer","top"===(null==e||null===(t=e.options)||void 0===t?void 0:t.layer)),r.style.width="".concat(Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width),"px"),r.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",r.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",r.style.lineHeight="".concat(this._renderService.dimensions.css.cell.height,"px");var n=null!==(i=e.options.x)&&void 0!==i?i:0;return n&&n>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(e,r),r}},{key:"_refreshStyle",value:function(e){var t=this,i=e.marker.line-this._bufferService.buffers.active.ydisp;if(i<0||i>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{var r=this._decorationElements.get(e);r||(r=this._createElement(e),e.element=r,this._decorationElements.set(e,r),this._container.appendChild(r),e.onDispose(function(){t._decorationElements.delete(e),r.remove()})),r.style.top=i*this._renderService.dimensions.css.cell.height+"px",r.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(r)}}},{key:"_refreshXPosition",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.element;if(i){var r=null!==(t=e.options.x)&&void 0!==t?t:0;"right"===(e.options.anchor||"left")?i.style.right=r?r*this._renderService.dimensions.css.cell.width+"px":"":i.style.left=r?r*this._renderService.dimensions.css.cell.width+"px":""}}},{key:"_removeDecoration",value:function(e){var t;null!==(t=this._decorationElements.get(e))&&void 0!==t&&t.remove(),this._decorationElements.delete(e),e.dispose()}}])}(o.Disposable);t.BufferDecorationRenderer=l=r([n(1,c.IBufferService),n(2,s.ICoreBrowserService),n(3,c.IDecorationService),n(4,s.IRenderService)],l)},5871:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=function(){function e(){C(this,e),this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}return w(e,[{key:"zones",get:function(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}},{key:"clear",value:function(){this._zones.length=0,this._zonePoolIndex=0}},{key:"addDecoration",value:function(e){if(e.options.overviewRulerOptions){var t,i=m(this._zones);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.color===e.options.overviewRulerOptions.color&&r.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(r,e.marker.line))return;if(this._lineAdjacentToZone(r,e.marker.line,e.options.overviewRulerOptions.position))return void this._addLineToZone(r,e.marker.line)}}}catch(n){i.e(n)}finally{i.f()}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}},{key:"setPadding",value:function(e){this._linePadding=e}},{key:"_lineIntersectsZone",value:function(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}},{key:"_lineAdjacentToZone",value:function(e,t,i){return t>=e.startBufferLine-this._linePadding[i||"full"]&&t<=e.endBufferLine+this._linePadding[i||"full"]}},{key:"_addLineToZone",value:function(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}}])}()},5744:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;var s=i(5871),o=i(4725),c=i(844),l=i(2585),h={full:0,left:0,center:0,right:0},u={full:0,left:0,center:0,right:0},f={full:0,left:0,center:0,right:0},v=t.OverviewRulerRenderer=function(e){function t(e,i,r,n,o,a,l){var h,u;C(this,t),(u=d(this,t))._viewportElement=e,u._screenElement=i,u._bufferService=r,u._decorationService=n,u._renderService=o,u._optionsService=a,u._coreBrowserService=l,u._colorZoneStore=new s.ColorZoneStore,u._shouldUpdateDimensions=!0,u._shouldUpdateAnchor=!0,u._lastKnownBufferLength=0,u._canvas=u._coreBrowserService.mainDocument.createElement("canvas"),u._canvas.classList.add("xterm-decoration-overview-ruler"),u._refreshCanvasDimensions(),null===(h=u._viewportElement.parentElement)||void 0===h||h.insertBefore(u._canvas,u._viewportElement);var f=u._canvas.getContext("2d");if(!f)throw new Error("Ctx cannot be null");return u._ctx=f,u._registerDecorationListeners(),u._registerBufferChangeListeners(),u._registerDimensionChangeListeners(),u.register((0,c.toDisposable)(function(){var e;null===(e=u._canvas)||void 0===e||e.remove()})),u}return g(t,e),w(t,[{key:"_width",get:function(){return this._optionsService.options.overviewRulerWidth||0}},{key:"_registerDecorationListeners",value:function(){var e=this;this.register(this._decorationService.onDecorationRegistered(function(){return e._queueRefresh(void 0,!0)})),this.register(this._decorationService.onDecorationRemoved(function(){return e._queueRefresh(void 0,!0)}))}},{key:"_registerBufferChangeListeners",value:function(){var e=this;this.register(this._renderService.onRenderedViewportChange(function(){return e._queueRefresh()})),this.register(this._bufferService.buffers.onBufferActivate(function(){e._canvas.style.display=e._bufferService.buffer===e._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(function(){e._lastKnownBufferLength!==e._bufferService.buffers.normal.lines.length&&(e._refreshDrawHeightConstants(),e._refreshColorZonePadding())}))}},{key:"_registerDimensionChangeListeners",value:function(){var e=this;this.register(this._renderService.onRender(function(){e._containerHeight&&e._containerHeight===e._screenElement.clientHeight||(e._queueRefresh(!0),e._containerHeight=e._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",function(){return e._queueRefresh(!0)})),this.register(this._coreBrowserService.onDprChange(function(){return e._queueRefresh(!0)})),this._queueRefresh(!0)}},{key:"_refreshDrawConstants",value:function(){var e=Math.floor(this._canvas.width/3),t=Math.ceil(this._canvas.width/3);u.full=this._canvas.width,u.left=e,u.center=t,u.right=e,this._refreshDrawHeightConstants(),f.full=0,f.left=0,f.center=u.left,f.right=u.left+u.center}},{key:"_refreshDrawHeightConstants",value:function(){h.full=Math.round(2*this._coreBrowserService.dpr);var e=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(e,12),6)*this._coreBrowserService.dpr);h.left=t,h.center=t,h.right=t}},{key:"_refreshColorZonePadding",value:function(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}},{key:"_refreshCanvasDimensions",value:function(){this._canvas.style.width="".concat(this._width,"px"),this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height="".concat(this._screenElement.clientHeight,"px"),this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}},{key:"_refreshDecorations",value:function(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();var e,t=m(this._decorationService.decorations);try{for(t.s();!(e=t.n()).done;){var i=e.value;this._colorZoneStore.addDecoration(i)}}catch(h){t.e(h)}finally{t.f()}this._ctx.lineWidth=1;var r,n=this._colorZoneStore.zones,s=m(n);try{for(s.s();!(r=s.n()).done;){var o=r.value;"full"!==o.position&&this._renderColorZone(o)}}catch(h){s.e(h)}finally{s.f()}var a,c=m(n);try{for(c.s();!(a=c.n()).done;){var l=a.value;"full"===l.position&&this._renderColorZone(l)}}catch(h){c.e(h)}finally{c.f()}this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}},{key:"_renderColorZone",value:function(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(f[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-h[e.position||"full"]/2),u[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+h[e.position||"full"]))}},{key:"_queueRefresh",value:function(e,t){var i=this;this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){i._refreshDecorations(),i._animationFrame=void 0}))}}])}(c.Disposable);t.OverviewRulerRenderer=v=r([n(2,l.IBufferService),n(3,l.IDecorationService),n(4,o.IRenderService),n(5,l.IOptionsService),n(6,o.ICoreBrowserService)],v)},2950:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;var s=i(4725),o=i(2585),c=i(2584),l=t.CompositionHelper=function(){function e(t,i,r,n,s,o){C(this,e),this._textarea=t,this._compositionView=i,this._bufferService=r,this._optionsService=n,this._coreService=s,this._renderService=o,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}return w(e,[{key:"isComposing",get:function(){return this._isComposing}},{key:"compositionstart",value:function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}},{key:"compositionupdate",value:function(e){var t=this;this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout(function(){t._compositionPosition.end=t._textarea.value.length},0)}},{key:"compositionend",value:function(){this._finalizeComposition(!0)}},{key:"keydown",value:function(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)}},{key:"_finalizeComposition",value:function(e){var t=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){var i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(function(){var e;t._isSendingComposition&&(t._isSendingComposition=!1,i.start+=t._dataAlreadySent.length,(e=t._isComposing?t._textarea.value.substring(i.start,i.end):t._textarea.value.substring(i.start)).length>0&&t._coreService.triggerDataEvent(e,!0))},0)}else{this._isSendingComposition=!1;var r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(r,!0)}}},{key:"_handleAnyTextareaChanges",value:function(){var e=this,t=this._textarea.value;setTimeout(function(){if(!e._isComposing){var i=e._textarea.value,r=i.replace(t,"");e._dataAlreadySent=r,i.length>t.length?e._coreService.triggerDataEvent(r,!0):i.length<t.length?e._coreService.triggerDataEvent("".concat(c.C0.DEL),!0):i.length===t.length&&i!==t&&e._coreService.triggerDataEvent(i,!0)}},0)}},{key:"updateCompositionElements",value:function(e){var t=this;if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){var i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),r=this._renderService.dimensions.css.cell.height,n=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,s=i*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=n+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var o=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=n+"px",this._textarea.style.width=Math.max(o.width,1)+"px",this._textarea.style.height=Math.max(o.height,1)+"px",this._textarea.style.lineHeight=o.height+"px"}e||setTimeout(function(){return t.updateCompositionElements(!0)},0)}}}])}();t.CompositionHelper=l=r([n(2,o.IBufferService),n(3,o.IOptionsService),n(4,o.ICoreService),n(5,s.IRenderService)],l)},9806:function(e,t){function i(e,t,i){var r=i.getBoundingClientRect(),n=e.getComputedStyle(i),s=parseInt(n.getPropertyValue("padding-left")),o=parseInt(n.getPropertyValue("padding-top"));return[t.clientX-r.left-s,t.clientY-r.top-o]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=i,t.getCoords=function(e,t,r,n,s,o,a,c,l){if(o){var h=i(e,t,r);return h?(h[0]=Math.ceil((h[0]+(l?a/2:0))/a),h[1]=Math.ceil(h[1]/c),h[0]=Math.min(Math.max(h[0],1),n+(l?1:0)),h[1]=Math.min(Math.max(h[1],1),s),h):void 0}}},9504:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;var r=i(2584);function n(e,t,i,r){var n=e-s(e,i),a=t-s(t,i),h=Math.abs(n-a)-function(e,t,i){for(var r=0,n=e-s(e,i),a=t-s(t,i),c=0;c<Math.abs(n-a);c++){var l="A"===o(e,t)?-1:1,h=i.buffer.lines.get(n+l*c);(null==h?void 0:h.isWrapped)&&r++}return r}(e,t,i);return l(h,c(o(e,t),r))}function s(e,t){for(var i,r=0,n=t.buffer.lines.get(e),s=null===(i=n)||void 0===i?void 0:i.isWrapped;s&&e>=0&&e<t.rows;){var o;r++,s=null===(o=n=t.buffer.lines.get(--e))||void 0===o?void 0:o.isWrapped}return r}function o(e,t){return e>t?"A":"B"}function a(e,t,i,r,n,s){for(var o=e,a=t,c="";o!==i||a!==r;)o+=n?1:-1,n&&o>s.cols-1?(c+=s.buffer.translateBufferLineToString(a,!1,e,o),o=0,e=0,a++):!n&&o<0&&(c+=s.buffer.translateBufferLineToString(a,!1,0,e+1),e=o=s.cols-1,a--);return c+s.buffer.translateBufferLineToString(a,!1,e,o)}function c(e,t){var i=t?"O":"[";return r.C0.ESC+i+e}function l(e,t){e=Math.floor(e);for(var i="",r=0;r<e;r++)i+=t;return i}t.moveToCellSequence=function(e,t,i,r){var o,h=i.buffer.x,u=i.buffer.y;if(!i.buffer.hasScrollback)return function(e,t,i,r,o,h){return 0===n(t,r,o,h).length?"":l(a(e,t,e,t-s(t,o),!1,o).length,c("D",h))}(h,u,0,t,i,r)+n(u,t,i,r)+function(e,t,i,r,o,h){var u;u=n(t,r,o,h).length>0?r-s(r,o):t;var d=r,f=function(e,t,i,r,o,a){var c;return c=n(i,r,o,a).length>0?r-s(r,o):t,e<i&&c<=r||e>=i&&c<r?"C":"D"}(e,t,i,r,o,h);return l(a(e,u,i,d,"C"===f,o).length,c(f,h))}(h,u,e,t,i,r);if(u===t)return o=h>e?"D":"C",l(Math.abs(h-e),c(o,r));o=u>t?"D":"C";var d=Math.abs(u-t);return l(function(e,t){return t.cols-e}(u>t?e:h,i)+(d-1)*i.cols+1+((u>t?h:e)-1),c(o,r))}},1296:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;var s=i(3787),o=i(2550),h=i(2223),u=i(6171),f=i(6052),v=i(4725),_=i(8055),p=i(8460),y=i(844),S=i(2585),b="xterm-dom-renderer-owner-",k="xterm-rows",L="xterm-fg-",x="xterm-bg-",E="xterm-focus",R="xterm-selection",D=1,A=t.DomRenderer=function(e){function t(e,i,r,n,a,c,l,h,v,_,g,m,S){var w;return C(this,t),(w=d(this,t))._terminal=e,w._document=i,w._element=r,w._screenElement=n,w._viewportElement=a,w._helperContainer=c,w._linkifier2=l,w._charSizeService=v,w._optionsService=_,w._bufferService=g,w._coreBrowserService=m,w._themeService=S,w._terminalClass=D++,w._rowElements=[],w._selectionRenderModel=(0,f.createSelectionRenderModel)(),w.onRequestRedraw=w.register(new p.EventEmitter).event,w._rowContainer=w._document.createElement("div"),w._rowContainer.classList.add(k),w._rowContainer.style.lineHeight="normal",w._rowContainer.setAttribute("aria-hidden","true"),w._refreshRowElements(w._bufferService.cols,w._bufferService.rows),w._selectionContainer=w._document.createElement("div"),w._selectionContainer.classList.add(R),w._selectionContainer.setAttribute("aria-hidden","true"),w.dimensions=(0,u.createRenderDimensions)(),w._updateDimensions(),w.register(w._optionsService.onOptionChange(function(){return w._handleOptionsChanged()})),w.register(w._themeService.onChangeColors(function(e){return w._injectCss(e)})),w._injectCss(w._themeService.colors),w._rowFactory=h.createInstance(s.DomRendererRowFactory,document),w._element.classList.add(b+w._terminalClass),w._screenElement.appendChild(w._rowContainer),w._screenElement.appendChild(w._selectionContainer),w.register(w._linkifier2.onShowLinkUnderline(function(e){return w._handleLinkHover(e)})),w.register(w._linkifier2.onHideLinkUnderline(function(e){return w._handleLinkLeave(e)})),w.register((0,y.toDisposable)(function(){w._element.classList.remove(b+w._terminalClass),w._rowContainer.remove(),w._selectionContainer.remove(),w._widthCache.dispose(),w._themeStyleElement.remove(),w._dimensionsStyleElement.remove()})),w._widthCache=new o.WidthCache(w._document,w._helperContainer),w._widthCache.setFont(w._optionsService.rawOptions.fontFamily,w._optionsService.rawOptions.fontSize,w._optionsService.rawOptions.fontWeight,w._optionsService.rawOptions.fontWeightBold),w._setDefaultSpacing(),w}return g(t,e),w(t,[{key:"_updateDimensions",value:function(){var e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;var t,i=m(this._rowElements);try{for(i.s();!(t=i.n()).done;){var r=t.value;r.style.width="".concat(this.dimensions.css.canvas.width,"px"),r.style.height="".concat(this.dimensions.css.cell.height,"px"),r.style.lineHeight="".concat(this.dimensions.css.cell.height,"px"),r.style.overflow="hidden"}}catch(s){i.e(s)}finally{i.f()}this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));var n="".concat(this._terminalSelector," .").concat(k," span { display: inline-block; height: 100%; vertical-align: top;}");this._dimensionsStyleElement.textContent=n,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._screenElement.style.height="".concat(this.dimensions.css.canvas.height,"px")}},{key:"_injectCss",value:function(e){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));var t="".concat(this._terminalSelector," .").concat(k," { color: ").concat(e.foreground.css,"; font-family: ").concat(this._optionsService.rawOptions.fontFamily,"; font-size: ").concat(this._optionsService.rawOptions.fontSize,"px; font-kerning: none; white-space: pre}");t+="".concat(this._terminalSelector," .").concat(k," .xterm-dim { color: ").concat(_.color.multiplyOpacity(e.foreground,.5).css,";}"),t+="".concat(this._terminalSelector," span:not(.xterm-bold) { font-weight: ").concat(this._optionsService.rawOptions.fontWeight,";}").concat(this._terminalSelector," span.xterm-bold { font-weight: ").concat(this._optionsService.rawOptions.fontWeightBold,";}").concat(this._terminalSelector," span.xterm-italic { font-style: italic;}");var i="blink_underline_".concat(this._terminalClass),r="blink_bar_".concat(this._terminalClass),n="blink_block_".concat(this._terminalClass);t+="@keyframes ".concat(i," { 50% {  border-bottom-style: hidden; }}"),t+="@keyframes ".concat(r," { 50% {  box-shadow: none; }}"),t+="@keyframes ".concat(n," { 0% {  background-color: ").concat(e.cursor.css,";  color: ").concat(e.cursorAccent.css,"; } 50% {  background-color: inherit;  color: ").concat(e.cursor.css,"; }}"),t+="".concat(this._terminalSelector," .").concat(k,".").concat(E," .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ").concat(i," 1s step-end infinite;}").concat(this._terminalSelector," .").concat(k,".").concat(E," .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ").concat(r," 1s step-end infinite;}").concat(this._terminalSelector," .").concat(k,".").concat(E," .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ").concat(n," 1s step-end infinite;}").concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-block { background-color: ").concat(e.cursor.css,"; color: ").concat(e.cursorAccent.css,";}").concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ").concat(e.cursor.css," !important; color: ").concat(e.cursorAccent.css," !important;}").concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-outline { outline: 1px solid ").concat(e.cursor.css,"; outline-offset: -1px;}").concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-bar { box-shadow: ").concat(this._optionsService.rawOptions.cursorWidth,"px 0 0 ").concat(e.cursor.css," inset;}").concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ").concat(e.cursor.css,"; border-bottom-style: solid; height: calc(100% - 1px);}"),t+="".concat(this._terminalSelector," .").concat(R," { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}").concat(this._terminalSelector,".focus .").concat(R," div { position: absolute; background-color: ").concat(e.selectionBackgroundOpaque.css,";}").concat(this._terminalSelector," .").concat(R," div { position: absolute; background-color: ").concat(e.selectionInactiveBackgroundOpaque.css,";}");var s,o=m(e.ansi.entries());try{for(o.s();!(s=o.n()).done;){var a=l(s.value,2),c=a[0],u=a[1];t+="".concat(this._terminalSelector," .").concat(L).concat(c," { color: ").concat(u.css,"; }").concat(this._terminalSelector," .").concat(L).concat(c,".xterm-dim { color: ").concat(_.color.multiplyOpacity(u,.5).css,"; }").concat(this._terminalSelector," .").concat(x).concat(c," { background-color: ").concat(u.css,"; }")}}catch(d){o.e(d)}finally{o.f()}t+="".concat(this._terminalSelector," .").concat(L).concat(h.INVERTED_DEFAULT_COLOR," { color: ").concat(_.color.opaque(e.background).css,"; }").concat(this._terminalSelector," .").concat(L).concat(h.INVERTED_DEFAULT_COLOR,".xterm-dim { color: ").concat(_.color.multiplyOpacity(_.color.opaque(e.background),.5).css,"; }").concat(this._terminalSelector," .").concat(x).concat(h.INVERTED_DEFAULT_COLOR," { background-color: ").concat(e.foreground.css,"; }"),this._themeStyleElement.textContent=t}},{key:"_setDefaultSpacing",value:function(){var e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing="".concat(e,"px"),this._rowFactory.defaultSpacing=e}},{key:"handleDevicePixelRatioChange",value:function(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}},{key:"_refreshRowElements",value:function(e,t){for(var i=this._rowElements.length;i<=t;i++){var r=this._document.createElement("div");this._rowContainer.appendChild(r),this._rowElements.push(r)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}},{key:"handleResize",value:function(e,t){this._refreshRowElements(e,t),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}},{key:"handleCharSizeChanged",value:function(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}},{key:"handleBlur",value:function(){this._rowContainer.classList.remove(E),this.renderRows(0,this._bufferService.rows-1)}},{key:"handleFocus",value:function(){this._rowContainer.classList.add(E),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}},{key:"handleSelectionChanged",value:function(e,t,i){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,t,i),this.renderRows(0,this._bufferService.rows-1),e&&t){this._selectionRenderModel.update(this._terminal,e,t,i);var r=this._selectionRenderModel.viewportStartRow,n=this._selectionRenderModel.viewportEndRow,s=this._selectionRenderModel.viewportCappedStartRow,o=this._selectionRenderModel.viewportCappedEndRow;if(!(s>=this._bufferService.rows||o<0)){var a=this._document.createDocumentFragment();if(i){var c=e[0]>t[0];a.appendChild(this._createSelectionElement(s,c?t[0]:e[0],c?e[0]:t[0],o-s+1))}else{var l=r===s?e[0]:0,h=s===n?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(s,l,h));var u=o-s-1;if(a.appendChild(this._createSelectionElement(s+1,0,this._bufferService.cols,u)),s!==o){var d=n===o?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(o,0,d))}}this._selectionContainer.appendChild(a)}}}},{key:"_createSelectionElement",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=this._document.createElement("div"),s=t*this.dimensions.css.cell.width,o=this.dimensions.css.cell.width*(i-t);return s+o>this.dimensions.css.canvas.width&&(o=this.dimensions.css.canvas.width-s),n.style.height=r*this.dimensions.css.cell.height+"px",n.style.top=e*this.dimensions.css.cell.height+"px",n.style.left="".concat(s,"px"),n.style.width="".concat(o,"px"),n}},{key:"handleCursorMove",value:function(){}},{key:"_handleOptionsChanged",value:function(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}},{key:"clear",value:function(){var e,t=m(this._rowElements);try{for(t.s();!(e=t.n()).done;)e.value.replaceChildren()}catch(i){t.e(i)}finally{t.f()}}},{key:"renderRows",value:function(e,t){for(var i=this._bufferService.buffer,r=i.ybase+i.y,n=Math.min(i.x,this._bufferService.cols-1),s=this._optionsService.rawOptions.cursorBlink,o=this._optionsService.rawOptions.cursorStyle,a=this._optionsService.rawOptions.cursorInactiveStyle,l=e;l<=t;l++){var h=l+i.ydisp,u=this._rowElements[l],d=i.lines.get(h);if(!u||!d)break;u.replaceChildren.apply(u,c(this._rowFactory.createRow(d,h,h===r,o,a,n,s,this.dimensions.css.cell.width,this._widthCache,-1,-1)))}}},{key:"_terminalSelector",get:function(){return".".concat(b).concat(this._terminalClass)}},{key:"_handleLinkHover",value:function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}},{key:"_handleLinkLeave",value:function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}},{key:"_setCellUnderline",value:function(e,t,i,r,n,s){i<0&&(e=0),r<0&&(t=0);var o=this._bufferService.rows-1;i=Math.max(Math.min(i,o),0),r=Math.max(Math.min(r,o),0),n=Math.min(n,this._bufferService.cols);for(var a=this._bufferService.buffer,l=a.ybase+a.y,h=Math.min(a.x,n-1),u=this._optionsService.rawOptions.cursorBlink,d=this._optionsService.rawOptions.cursorStyle,f=this._optionsService.rawOptions.cursorInactiveStyle,v=i;v<=r;++v){var _=v+a.ydisp,g=this._rowElements[v],p=a.lines.get(_);if(!g||!p)break;g.replaceChildren.apply(g,c(this._rowFactory.createRow(p,_,_===l,d,f,h,u,this.dimensions.css.cell.width,this._widthCache,s?v===i?e:0:-1,s?(v===r?t:n)-1:-1)))}}}])}(y.Disposable);t.DomRenderer=A=r([n(7,S.IInstantiationService),n(8,v.ICharSizeService),n(9,S.IOptionsService),n(10,S.IBufferService),n(11,v.ICoreBrowserService),n(12,v.IThemeService)],A)},3787:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=void 0;var s=i(2223),o=i(643),c=i(511),l=i(2585),h=i(8055),u=i(4725),d=i(4269),f=i(6171),v=i(3734),_=t.DomRendererRowFactory=function(){function e(t,i,r,n,s,o,a){C(this,e),this._document=t,this._characterJoinerService=i,this._optionsService=r,this._coreBrowserService=n,this._coreService=s,this._decorationService=o,this._themeService=a,this._workCell=new c.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}return w(e,[{key:"handleSelectionChanged",value:function(e,t,i){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=i}},{key:"createRow",value:function(e,t,i,r,n,a,c,l,u,f,_){var p,m=this,y=[],S=this._characterJoinerService.getJoinedCharacters(t),C=this._themeService.colors,b=e.getNoBgTrimmedLength();i&&b<a+1&&(b=a+1);for(var w=0,k="",L=0,x=0,E=0,R=!1,D=0,A=!1,M=0,T=[],B=-1!==f&&-1!==_,O=function(b){e.loadCell(b,m._workCell);var O=m._workCell.getWidth();if(0===O)return P=b,0;var I=!1,H=b,F=m._workCell;if(S.length>0&&b===S[0][0]){I=!0;var W=S.shift();F=new d.JoinedCellData(m._workCell,e.translateToString(!0,W[0],W[1]),W[1]-W[0]),H=W[1]-1,O=F.getWidth()}var N=m._isCellInSelection(b,t),U=i&&b===a,j=B&&b>=f&&b<=_,z=!1;m._decorationService.forEachDecorationAtCell(b,t,void 0,function(e){z=!0});var q=F.getChars()||o.WHITESPACE_CELL_CHAR;if(" "===q&&(F.isUnderline()||F.isOverline())&&(q=" "),M=O*l-u.get(q,F.isBold(),F.isItalic()),p){if(w&&(N&&A||!N&&!A&&F.bg===L)&&(N&&A&&C.selectionForeground||F.fg===x)&&F.extended.ext===E&&j===R&&M===D&&!U&&!I&&!z)return F.isInvisible()?k+=o.WHITESPACE_CELL_CHAR:k+=q,w++,P=b,0;w&&(p.textContent=k),p=m._document.createElement("span"),w=0,k=""}else p=m._document.createElement("span");if(L=F.bg,x=F.fg,E=F.extended.ext,R=j,D=M,A=N,I&&a>=b&&a<=H&&(a=b),!m._coreService.isCursorHidden&&U&&m._coreService.isCursorInitialized)if(T.push("xterm-cursor"),m._coreBrowserService.isFocused)c&&T.push("xterm-cursor-blink"),T.push("bar"===r?"xterm-cursor-bar":"underline"===r?"xterm-cursor-underline":"xterm-cursor-block");else if(n)switch(n){case"outline":T.push("xterm-cursor-outline");break;case"block":T.push("xterm-cursor-block");break;case"bar":T.push("xterm-cursor-bar");break;case"underline":T.push("xterm-cursor-underline")}if(F.isBold()&&T.push("xterm-bold"),F.isItalic()&&T.push("xterm-italic"),F.isDim()&&T.push("xterm-dim"),k=F.isInvisible()?o.WHITESPACE_CELL_CHAR:F.getChars()||o.WHITESPACE_CELL_CHAR,F.isUnderline()&&(T.push("xterm-underline-".concat(F.extended.underlineStyle))," "===k&&(k=" "),!F.isUnderlineColorDefault()))if(F.isUnderlineColorRGB())p.style.textDecorationColor="rgb(".concat(v.AttributeData.toColorRGB(F.getUnderlineColor()).join(","),")");else{var V=F.getUnderlineColor();m._optionsService.rawOptions.drawBoldTextInBrightColors&&F.isBold()&&V<8&&(V+=8),p.style.textDecorationColor=C.ansi[V].css}F.isOverline()&&(T.push("xterm-overline")," "===k&&(k=" ")),F.isStrikethrough()&&T.push("xterm-strikethrough"),j&&(p.style.textDecoration="underline");var G=F.getFgColor(),K=F.getFgColorMode(),X=F.getBgColor(),J=F.getBgColorMode(),Y=!!F.isInverse();if(Y){var Z=G;G=X,X=Z;var $=K;K=J,J=$}var Q,ee,te,ie=!1;switch(m._decorationService.forEachDecorationAtCell(b,t,void 0,function(e){"top"!==e.options.layer&&ie||(e.backgroundColorRGB&&(J=50331648,X=e.backgroundColorRGB.rgba>>8&16777215,Q=e.backgroundColorRGB),e.foregroundColorRGB&&(K=50331648,G=e.foregroundColorRGB.rgba>>8&16777215,ee=e.foregroundColorRGB),ie="top"===e.options.layer)}),!ie&&N&&(Q=m._coreBrowserService.isFocused?C.selectionBackgroundOpaque:C.selectionInactiveBackgroundOpaque,X=Q.rgba>>8&16777215,J=50331648,ie=!0,C.selectionForeground&&(K=50331648,G=C.selectionForeground.rgba>>8&16777215,ee=C.selectionForeground)),ie&&T.push("xterm-decoration-top"),J){case 16777216:case 33554432:te=C.ansi[X],T.push("xterm-bg-".concat(X));break;case 50331648:te=h.channels.toColor(X>>16,X>>8&255,255&X),m._addStyle(p,"background-color:#".concat(g((X>>>0).toString(16),"0",6)));break;default:Y?(te=C.foreground,T.push("xterm-bg-".concat(s.INVERTED_DEFAULT_COLOR))):te=C.background}switch(Q||F.isDim()&&(Q=h.color.multiplyOpacity(te,.5)),K){case 16777216:case 33554432:F.isBold()&&G<8&&m._optionsService.rawOptions.drawBoldTextInBrightColors&&(G+=8),m._applyMinimumContrast(p,te,C.ansi[G],F,Q,void 0)||T.push("xterm-fg-".concat(G));break;case 50331648:var re=h.channels.toColor(G>>16&255,G>>8&255,255&G);m._applyMinimumContrast(p,te,re,F,Q,ee)||m._addStyle(p,"color:#".concat(g(G.toString(16),"0",6)));break;default:m._applyMinimumContrast(p,te,C.foreground,F,Q,ee)||Y&&T.push("xterm-fg-".concat(s.INVERTED_DEFAULT_COLOR))}T.length&&(p.className=T.join(" "),T.length=0),U||I||z?p.textContent=k:w++,M!==m.defaultSpacing&&(p.style.letterSpacing="".concat(M,"px")),y.push(p),P=b=H},P=0;P<b;P++)O(P);return p&&w&&(p.textContent=k),y}},{key:"_applyMinimumContrast",value:function(e,t,i,r,n,s){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,f.treatGlyphAsBackgroundColor)(r.getCode()))return!1;var o,a=this._getContrastCache(r);if(n||s||(o=a.getColor(t.rgba,i.rgba)),void 0===o){var c=this._optionsService.rawOptions.minimumContrastRatio/(r.isDim()?2:1);o=h.color.ensureContrastRatio(n||t,s||i,c),a.setColor((n||t).rgba,(s||i).rgba,null!=o?o:null)}return!!o&&(this._addStyle(e,"color:".concat(o.css)),!0)}},{key:"_getContrastCache",value:function(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}},{key:"_addStyle",value:function(e,t){e.setAttribute("style","".concat(e.getAttribute("style")||"").concat(t,";"))}},{key:"_isCellInSelection",value:function(e,t){var i=this._selectionStart,r=this._selectionEnd;return!(!i||!r)&&(this._columnSelectMode?i[0]<=r[0]?e>=i[0]&&t>=i[1]&&e<r[0]&&t<=r[1]:e<i[0]&&t>=i[1]&&e>=r[0]&&t<=r[1]:t>i[1]&&t<r[1]||i[1]===r[1]&&t===i[1]&&e>=i[0]&&e<r[0]||i[1]<r[1]&&t===r[1]&&e<r[0]||i[1]<r[1]&&t===i[1]&&e>=i[0])}}])}();function g(e,t,i){for(;e.length<i;)e=t+e;return e}t.DomRendererRowFactory=_=r([n(1,u.ICharacterJoinerService),n(2,l.IOptionsService),n(3,u.ICoreBrowserService),n(4,l.ICoreService),n(5,l.IDecorationService),n(6,u.IThemeService)],_)},2550:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidthCache=void 0,t.WidthCache=function(){function e(t,i){C(this,e),this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=t.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";var r=t.createElement("span");r.classList.add("xterm-char-measure-element");var n=t.createElement("span");n.classList.add("xterm-char-measure-element"),n.style.fontWeight="bold";var s=t.createElement("span");s.classList.add("xterm-char-measure-element"),s.style.fontStyle="italic";var o=t.createElement("span");o.classList.add("xterm-char-measure-element"),o.style.fontWeight="bold",o.style.fontStyle="italic",this._measureElements=[r,n,s,o],this._container.appendChild(r),this._container.appendChild(n),this._container.appendChild(s),this._container.appendChild(o),i.appendChild(this._container),this.clear()}return w(e,[{key:"dispose",value:function(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}},{key:"clear",value:function(){this._flat.fill(-9999),this._holey=new Map}},{key:"setFont",value:function(e,t,i,r){e===this._font&&t===this._fontSize&&i===this._weight&&r===this._weightBold||(this._font=e,this._fontSize=t,this._weight=i,this._weightBold=r,this._container.style.fontFamily=this._font,this._container.style.fontSize="".concat(this._fontSize,"px"),this._measureElements[0].style.fontWeight="".concat(i),this._measureElements[1].style.fontWeight="".concat(r),this._measureElements[2].style.fontWeight="".concat(i),this._measureElements[3].style.fontWeight="".concat(r),this.clear())}},{key:"get",value:function(e,t,i){var r=0;if(!t&&!i&&1===e.length&&(r=e.charCodeAt(0))<256){if(-9999!==this._flat[r])return this._flat[r];var n=this._measure(e,0);return n>0&&(this._flat[r]=n),n}var s=e;t&&(s+="B"),i&&(s+="I");var o=this._holey.get(s);if(void 0===o){var a=0;t&&(a|=1),i&&(a|=2),(o=this._measure(e,a))>0&&this._holey.set(s,o)}return o}},{key:"_measure",value:function(e,t){var i=this._measureElements[t];return i.textContent=e.repeat(32),i.offsetWidth/32}}])}()},2223:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var r=i(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=r.isFirefox||r.isLegacyEdge?"bottom":"ideographic"},6171:function(e,t){function i(e){return 57508<=e&&e<=57558}function r(e){return e>=128512&&e<=128591||e>=127744&&e<=128511||e>=128640&&e<=128767||e>=9728&&e<=9983||e>=9984&&e<=10175||e>=65024&&e<=65039||e>=129280&&e<=129535||e>=127462&&e<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.isEmoji=r,t.allowRescaling=function(e,t,n,s){return 1===t&&n>Math.ceil(1.5*s)&&void 0!==e&&e>255&&!r(e)&&!i(e)&&!function(e){return 57344<=e&&e<=63743}(e)},t.treatGlyphAsBackgroundColor=function(e){return i(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(e-(2*Math.round(t)-i))%(2*Math.round(t))}},6052:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;var i=function(){function e(){C(this,e),this.clear()}return w(e,[{key:"clear",value:function(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}},{key:"update",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.selectionStart=t,this.selectionEnd=i,t&&i&&(t[0]!==i[0]||t[1]!==i[1])){var n=e.buffers.active.ydisp,s=t[1]-n,o=i[1]-n,a=Math.max(s,0),c=Math.min(o,e.rows-1);a>=e.rows||c<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=r,this.viewportStartRow=s,this.viewportEndRow=o,this.viewportCappedStartRow=a,this.viewportCappedEndRow=c,this.startCol=t[0],this.endCol=i[0])}else this.clear()}},{key:"isCellSelected",value:function(e,t,i){return!!this.hasSelection&&(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol)}}])}();t.createSelectionRenderModel=function(){return new i}},456:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=function(){function e(t){C(this,e),this._bufferService=t,this.isSelectAllActive=!1,this.selectionStartLength=0}return w(e,[{key:"clearSelection",value:function(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}},{key:"finalSelectionStart",get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}},{key:"finalSelectionEnd",get:function(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){var e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){var t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[Math.max(t,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}},{key:"areSelectionValuesReversed",value:function(){var e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])}},{key:"handleTrim",value:function(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}])}()},428:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;var s=i(2585),o=i(8460),c=i(844),l=t.CharSizeService=function(e){function t(e,i,r){var n;C(this,t),(n=d(this,t))._optionsService=r,n.width=0,n.height=0,n._onCharSizeChange=n.register(new o.EventEmitter),n.onCharSizeChange=n._onCharSizeChange.event;try{n._measureStrategy=n.register(new f(n._optionsService))}catch(s){n._measureStrategy=n.register(new u(e,i,n._optionsService))}return n.register(n._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],function(){return n.measure()})),n}return g(t,e),w(t,[{key:"hasValidSize",get:function(){return this.width>0&&this.height>0}},{key:"measure",value:function(){var e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}}])}(c.Disposable);t.CharSizeService=l=r([n(2,s.IOptionsService)],l);var h=function(e){function t(){var e;return C(this,t),(e=d(this,t,arguments))._result={width:0,height:0},e}return g(t,e),w(t,[{key:"_validateAndSet",value:function(e,t){void 0!==e&&e>0&&void 0!==t&&t>0&&(this._result.width=e,this._result.height=t)}}])}(c.Disposable),u=function(e){function t(e,i,r){var n;return C(this,t),(n=d(this,t))._document=e,n._parentElement=i,n._optionsService=r,n._measureElement=n._document.createElement("span"),n._measureElement.classList.add("xterm-char-measure-element"),n._measureElement.textContent="W".repeat(32),n._measureElement.setAttribute("aria-hidden","true"),n._measureElement.style.whiteSpace="pre",n._measureElement.style.fontKerning="none",n._parentElement.appendChild(n._measureElement),n}return g(t,e),w(t,[{key:"measure",value:function(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize="".concat(this._optionsService.rawOptions.fontSize,"px"),this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}])}(h),f=function(e){function t(e){var i;C(this,t),(i=d(this,t))._optionsService=e,i._canvas=new OffscreenCanvas(100,100),i._ctx=i._canvas.getContext("2d");var r=i._ctx.measureText("W");if(!("width"in r&&"fontBoundingBoxAscent"in r&&"fontBoundingBoxDescent"in r))throw new Error("Required font metrics not supported");return i}return g(t,e),w(t,[{key:"measure",value:function(){this._ctx.font="".concat(this._optionsService.rawOptions.fontSize,"px ").concat(this._optionsService.rawOptions.fontFamily);var e=this._ctx.measureText("W");return this._validateAndSet(e.width,e.fontBoundingBoxAscent+e.fontBoundingBoxDescent),this._result}}])}(h)},4269:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;var s=i(3734),o=i(643),c=i(511),l=i(2585),h=function(e){function t(e,i,r){var n;return C(this,t),(n=d(this,t)).content=0,n.combinedData="",n.fg=e.fg,n.bg=e.bg,n.combinedData=i,n._width=r,n}return g(t,e),w(t,[{key:"isCombined",value:function(){return 2097152}},{key:"getWidth",value:function(){return this._width}},{key:"getChars",value:function(){return this.combinedData}},{key:"getCode",value:function(){return 2097151}},{key:"setFromCharData",value:function(e){throw new Error("not implemented")}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}])}(s.AttributeData);t.JoinedCellData=h;var u=t.CharacterJoinerService=function(){function e(t){C(this,e),this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new c.CellData}return w(e,[{key:"register",value:function(e){var t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id}},{key:"deregister",value:function(e){for(var t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1}},{key:"getJoinedCharacters",value:function(e){if(0===this._characterJoiners.length)return[];var t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];for(var i=[],r=t.translateToString(!0),n=0,s=0,a=0,c=t.getFg(0),l=t.getBg(0),h=0;h<t.getTrimmedLength();h++)if(t.loadCell(h,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==c||this._workCell.bg!==l){if(h-n>1)for(var u=this._getJoinedRanges(r,a,s,t,n),d=0;d<u.length;d++)i.push(u[d]);n=h,a=s,c=this._workCell.fg,l=this._workCell.bg}s+=this._workCell.getChars().length||o.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-n>1)for(var f=this._getJoinedRanges(r,a,s,t,n),v=0;v<f.length;v++)i.push(f[v]);return i}},{key:"_getJoinedRanges",value:function(t,i,r,n,s){var o=t.substring(i,r),a=[];try{a=this._characterJoiners[0].handler(o)}catch(u){}for(var c=1;c<this._characterJoiners.length;c++)try{for(var l=this._characterJoiners[c].handler(o),h=0;h<l.length;h++)e._mergeRanges(a,l[h])}catch(d){}return this._stringRangesToCellRanges(a,n,s),a}},{key:"_stringRangesToCellRanges",value:function(e,t,i){var r=0,n=!1,s=0,a=e[r];if(a){for(var c=i;c<this._bufferService.cols;c++){var l=t.getWidth(c),h=t.getString(c).length||o.WHITESPACE_CELL_CHAR.length;if(0!==l){if(!n&&a[0]<=s&&(a[0]=c,n=!0),a[1]<=s){if(a[1]=c,!(a=e[++r]))break;a[0]<=s?(a[0]=c,n=!0):n=!1}s+=h}}a&&(a[1]=this._bufferService.cols)}}}],[{key:"_mergeRanges",value:function(e,t){for(var i=!1,r=0;r<e.length;r++){var n=e[r];if(i){if(t[1]<=n[0])return e[r-1][1]=t[1],e;if(t[1]<=n[1])return e[r-1][1]=Math.max(t[1],n[1]),e.splice(r,1),e;e.splice(r,1),r--}else{if(t[1]<=n[0])return e.splice(r,0,t),e;if(t[1]<=n[1])return n[0]=Math.min(t[0],n[0]),e;t[0]<n[1]&&(n[0]=Math.min(t[0],n[0]),i=!0)}}return i?e[e.length-1][1]=t[1]:e.push(t),e}}])}();t.CharacterJoinerService=u=r([n(0,l.IBufferService)],u)},5114:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;var r=i(844),n=i(8460),s=i(3656),o=function(e){function t(e,i,r){var s;return C(this,t),(s=d(this,t))._textarea=e,s._window=i,s.mainDocument=r,s._isFocused=!1,s._cachedIsFocused=void 0,s._screenDprMonitor=new a(s._window),s._onDprChange=s.register(new n.EventEmitter),s.onDprChange=s._onDprChange.event,s._onWindowChange=s.register(new n.EventEmitter),s.onWindowChange=s._onWindowChange.event,s.register(s.onWindowChange(function(e){return s._screenDprMonitor.setWindow(e)})),s.register((0,n.forwardEvent)(s._screenDprMonitor.onDprChange,s._onDprChange)),s._textarea.addEventListener("focus",function(){return s._isFocused=!0}),s._textarea.addEventListener("blur",function(){return s._isFocused=!1}),s}return g(t,e),w(t,[{key:"window",get:function(){return this._window},set:function(e){this._window!==e&&(this._window=e,this._onWindowChange.fire(this._window))}},{key:"dpr",get:function(){return this.window.devicePixelRatio}},{key:"isFocused",get:function(){var e=this;return void 0===this._cachedIsFocused&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(function(){return e._cachedIsFocused=void 0})),this._cachedIsFocused}}])}(r.Disposable);t.CoreBrowserService=o;var a=function(e){function t(e){var i;return C(this,t),(i=d(this,t))._parentWindow=e,i._windowResizeListener=i.register(new r.MutableDisposable),i._onDprChange=i.register(new n.EventEmitter),i.onDprChange=i._onDprChange.event,i._outerListener=function(){return i._setDprAndFireIfDiffers()},i._currentDevicePixelRatio=i._parentWindow.devicePixelRatio,i._updateDpr(),i._setWindowResizeListener(),i.register((0,r.toDisposable)(function(){return i.clearListener()})),i}return g(t,e),w(t,[{key:"setWindow",value:function(e){this._parentWindow=e,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}},{key:"_setWindowResizeListener",value:function(){var e=this;this._windowResizeListener.value=(0,s.addDisposableDomListener)(this._parentWindow,"resize",function(){return e._setDprAndFireIfDiffers()})}},{key:"_setDprAndFireIfDiffers",value:function(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}},{key:"_updateDpr",value:function(){var e;this._outerListener&&(null!==(e=this._resolutionMediaMatchList)&&void 0!==e&&e.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia("screen and (resolution: ".concat(this._parentWindow.devicePixelRatio,"dppx)")),this._resolutionMediaMatchList.addListener(this._outerListener))}},{key:"clearListener",value:function(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}])}(r.Disposable)},779:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.LinkProviderService=void 0;var r=i(844),n=function(e){function t(){var e;return C(this,t),(e=d(this,t)).linkProviders=[],e.register((0,r.toDisposable)(function(){return e.linkProviders.length=0})),e}return g(t,e),w(t,[{key:"registerLinkProvider",value:function(e){var t=this;return this.linkProviders.push(e),{dispose:function(){var i=t.linkProviders.indexOf(e);-1!==i&&t.linkProviders.splice(i,1)}}}}])}(r.Disposable);t.LinkProviderService=n},8934:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;var s=i(4725),o=i(9806),c=t.MouseService=function(){function e(t,i){C(this,e),this._renderService=t,this._charSizeService=i}return w(e,[{key:"getCoords",value:function(e,t,i,r,n){return(0,o.getCoords)(window,e,t,i,r,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,n)}},{key:"getMouseReportCoords",value:function(e,t){var i=(0,o.getCoordsRelativeToElement)(window,e,t);if(this._charSizeService.hasValidSize)return i[0]=Math.min(Math.max(i[0],0),this._renderService.dimensions.css.canvas.width-1),i[1]=Math.min(Math.max(i[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}}])}();t.MouseService=c=r([n(0,s.IRenderService),n(1,s.ICharSizeService)],c)},3230:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;var s=i(6193),o=i(4725),c=i(8460),l=i(844),h=i(7226),u=i(2585),f=t.RenderService=function(e){function t(e,i,r,n,o,a,u,f){var v;return C(this,t),(v=d(this,t))._rowCount=e,v._charSizeService=n,v._renderer=v.register(new l.MutableDisposable),v._pausedResizeTask=new h.DebouncedIdleTask,v._observerDisposable=v.register(new l.MutableDisposable),v._isPaused=!1,v._needsFullRefresh=!1,v._isNextRenderRedrawOnly=!0,v._needsSelectionRefresh=!1,v._canvasWidth=0,v._canvasHeight=0,v._selectionState={start:void 0,end:void 0,columnSelectMode:!1},v._onDimensionsChange=v.register(new c.EventEmitter),v.onDimensionsChange=v._onDimensionsChange.event,v._onRenderedViewportChange=v.register(new c.EventEmitter),v.onRenderedViewportChange=v._onRenderedViewportChange.event,v._onRender=v.register(new c.EventEmitter),v.onRender=v._onRender.event,v._onRefreshRequest=v.register(new c.EventEmitter),v.onRefreshRequest=v._onRefreshRequest.event,v._renderDebouncer=new s.RenderDebouncer(function(e,t){return v._renderRows(e,t)},u),v.register(v._renderDebouncer),v.register(u.onDprChange(function(){return v.handleDevicePixelRatioChange()})),v.register(a.onResize(function(){return v._fullRefresh()})),v.register(a.buffers.onBufferActivate(function(){var e;return null===(e=v._renderer.value)||void 0===e?void 0:e.clear()})),v.register(r.onOptionChange(function(){return v._handleOptionsChanged()})),v.register(v._charSizeService.onCharSizeChange(function(){return v.handleCharSizeChanged()})),v.register(o.onDecorationRegistered(function(){return v._fullRefresh()})),v.register(o.onDecorationRemoved(function(){return v._fullRefresh()})),v.register(r.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],function(){v.clear(),v.handleResize(a.cols,a.rows),v._fullRefresh()})),v.register(r.onMultipleOptionChange(["cursorBlink","cursorStyle"],function(){return v.refreshRows(a.buffer.y,a.buffer.y,!0)})),v.register(f.onChangeColors(function(){return v._fullRefresh()})),v._registerIntersectionObserver(u.window,i),v.register(u.onWindowChange(function(e){return v._registerIntersectionObserver(e,i)})),v}return g(t,e),w(t,[{key:"dimensions",get:function(){return this._renderer.value.dimensions}},{key:"_registerIntersectionObserver",value:function(e,t){var i=this;if("IntersectionObserver"in e){var r=new e.IntersectionObserver(function(e){return i._handleIntersectionChange(e[e.length-1])},{threshold:0});r.observe(t),this._observerDisposable.value=(0,l.toDisposable)(function(){return r.disconnect()})}}},{key:"_handleIntersectionChange",value:function(e){this._isPaused=void 0===e.isIntersecting?0===e.intersectionRatio:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}},{key:"refreshRows",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isPaused?this._needsFullRefresh=!0:(i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount))}},{key:"_renderRows",value:function(e,t){this._renderer.value&&(e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.value.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0)}},{key:"resize",value:function(e,t){this._rowCount=t,this._fireOnCanvasResize()}},{key:"_handleOptionsChanged",value:function(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}},{key:"_fireOnCanvasResize",value:function(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}},{key:"hasRenderer",value:function(){return!!this._renderer.value}},{key:"setRenderer",value:function(e){var t=this;this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw(function(e){return t.refreshRows(e.start,e.end,!0)}),this._needsSelectionRefresh=!0,this._fullRefresh())}},{key:"addRefreshCallback",value:function(e){return this._renderDebouncer.addRefreshCallback(e)}},{key:"_fullRefresh",value:function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}},{key:"clearTextureAtlas",value:function(){var e,t;this._renderer.value&&(null!==(e=(t=this._renderer.value).clearTextureAtlas)&&void 0!==e&&e.call(t),this._fullRefresh())}},{key:"handleDevicePixelRatioChange",value:function(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}},{key:"handleResize",value:function(e,t){var i=this;this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(function(){var r;return null===(r=i._renderer.value)||void 0===r?void 0:r.handleResize(e,t)}):this._renderer.value.handleResize(e,t),this._fullRefresh())}},{key:"handleCharSizeChanged",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleCharSizeChanged()}},{key:"handleBlur",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleBlur()}},{key:"handleFocus",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleFocus()}},{key:"handleSelectionChanged",value:function(e,t,i){var r;this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=i,null===(r=this._renderer.value)||void 0===r||r.handleSelectionChanged(e,t,i)}},{key:"handleCursorMove",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleCursorMove()}},{key:"clear",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.clear()}}])}(l.Disposable);t.RenderService=f=r([n(2,u.IOptionsService),n(3,o.ICharSizeService),n(4,u.IDecorationService),n(5,u.IBufferService),n(6,o.ICoreBrowserService),n(7,o.IThemeService)],f)},9312:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;var s=i(9806),o=i(9504),c=i(456),l=i(4725),h=i(8460),u=i(844),f=i(6114),v=i(4841),_=i(511),p=i(2585),m=String.fromCharCode(160),y=new RegExp(m,"g"),S=t.SelectionService=function(e){function t(e,i,r,n,s,o,a,l,f){var v;return C(this,t),(v=d(this,t))._element=e,v._screenElement=i,v._linkifier=r,v._bufferService=n,v._coreService=s,v._mouseService=o,v._optionsService=a,v._renderService=l,v._coreBrowserService=f,v._dragScrollAmount=0,v._enabled=!0,v._workCell=new _.CellData,v._mouseDownTimeStamp=0,v._oldHasSelection=!1,v._oldSelectionStart=void 0,v._oldSelectionEnd=void 0,v._onLinuxMouseSelection=v.register(new h.EventEmitter),v.onLinuxMouseSelection=v._onLinuxMouseSelection.event,v._onRedrawRequest=v.register(new h.EventEmitter),v.onRequestRedraw=v._onRedrawRequest.event,v._onSelectionChange=v.register(new h.EventEmitter),v.onSelectionChange=v._onSelectionChange.event,v._onRequestScrollLines=v.register(new h.EventEmitter),v.onRequestScrollLines=v._onRequestScrollLines.event,v._mouseMoveListener=function(e){return v._handleMouseMove(e)},v._mouseUpListener=function(e){return v._handleMouseUp(e)},v._coreService.onUserInput(function(){v.hasSelection&&v.clearSelection()}),v._trimListener=v._bufferService.buffer.lines.onTrim(function(e){return v._handleTrim(e)}),v.register(v._bufferService.buffers.onBufferActivate(function(e){return v._handleBufferActivate(e)})),v.enable(),v._model=new c.SelectionModel(v._bufferService),v._activeSelectionMode=0,v.register((0,u.toDisposable)(function(){v._removeMouseDownListeners()})),v}return g(t,e),w(t,[{key:"reset",value:function(){this.clearSelection()}},{key:"disable",value:function(){this.clearSelection(),this._enabled=!1}},{key:"enable",value:function(){this._enabled=!0}},{key:"selectionStart",get:function(){return this._model.finalSelectionStart}},{key:"selectionEnd",get:function(){return this._model.finalSelectionEnd}},{key:"hasSelection",get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])}},{key:"selectionText",get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";var i=this._bufferService.buffer,r=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";for(var n=e[0]<t[0]?e[0]:t[0],s=e[0]<t[0]?t[0]:e[0],o=e[1];o<=t[1];o++){var a=i.translateBufferLineToString(o,!0,n,s);r.push(a)}}else{var c=e[1]===t[1]?t[0]:void 0;r.push(i.translateBufferLineToString(e[1],!0,e[0],c));for(var l=e[1]+1;l<=t[1]-1;l++){var h=i.lines.get(l),u=i.translateBufferLineToString(l,!0);null!=h&&h.isWrapped?r[r.length-1]+=u:r.push(u)}if(e[1]!==t[1]){var d=i.lines.get(t[1]),v=i.translateBufferLineToString(t[1],!0,0,t[0]);d&&d.isWrapped?r[r.length-1]+=v:r.push(v)}}return r.map(function(e){return e.replace(y," ")}).join(f.isWindows?"\r\n":"\n")}},{key:"clearSelection",value:function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}},{key:"refresh",value:function(e){var t=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(function(){return t._refresh()})),f.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}},{key:"_refresh",value:function(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})}},{key:"_isClickInSelection",value:function(e){var t=this._getMouseBufferCoords(e),i=this._model.finalSelectionStart,r=this._model.finalSelectionEnd;return!!(i&&r&&t)&&this._areCoordsInSelection(t,i,r)}},{key:"isCellInSelection",value:function(e,t){var i=this._model.finalSelectionStart,r=this._model.finalSelectionEnd;return!(!i||!r)&&this._areCoordsInSelection([e,t],i,r)}},{key:"_areCoordsInSelection",value:function(e,t,i){return e[1]>t[1]&&e[1]<i[1]||t[1]===i[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<i[0]||t[1]<i[1]&&e[1]===i[1]&&e[0]<i[0]||t[1]<i[1]&&e[1]===t[1]&&e[0]>=t[0]}},{key:"_selectWordAtCursor",value:function(e,t){var i,r=null===(i=this._linkifier.currentLink)||void 0===i||null===(i=i.link)||void 0===i?void 0:i.range;if(r)return this._model.selectionStart=[r.start.x-1,r.start.y-1],this._model.selectionStartLength=(0,v.getRangeLength)(r,this._bufferService.cols),this._model.selectionEnd=void 0,!0;var n=this._getMouseBufferCoords(e);return!!n&&(this._selectWordAt(n,t),this._model.selectionEnd=void 0,!0)}},{key:"selectAll",value:function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}},{key:"selectLines",value:function(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}},{key:"_handleTrim",value:function(e){this._model.handleTrim(e)&&this.refresh()}},{key:"_getMouseBufferCoords",value:function(e){var t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}},{key:"_getMouseEventScrollAmount",value:function(e){var t=(0,s.getCoordsRelativeToElement)(this._coreBrowserService.window,e,this._screenElement)[1],i=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=i?0:(t>i&&(t-=i),t=Math.min(Math.max(t,-50),50),(t/=50)/Math.abs(t)+Math.round(14*t))}},{key:"shouldForceSelection",value:function(e){return f.isMac?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}},{key:"handleMouseDown",value:function(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):1===e.detail?this._handleSingleClick(e):2===e.detail?this._handleDoubleClick(e):3===e.detail&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}},{key:"_addMouseDownListeners",value:function(){var e=this;this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(function(){return e._dragScroll()},50)}},{key:"_removeMouseDownListeners",value:function(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}},{key:"_handleIncrementalClick",value:function(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}},{key:"_handleSingleClick",value:function(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),this._model.selectionStart){this._model.selectionEnd=void 0;var t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}}},{key:"_handleDoubleClick",value:function(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}},{key:"_handleTripleClick",value:function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}},{key:"shouldColumnSelect",value:function(e){return e.altKey&&!(f.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}},{key:"_handleMouseMove",value:function(e){if(e.stopImmediatePropagation(),this._model.selectionStart){var t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),this._model.selectionEnd){2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));var i=this._bufferService.buffer;if(this._model.selectionEnd[1]<i.lines.length){var r=i.lines.get(this._model.selectionEnd[1]);r&&0===r.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)}else this.refresh(!0)}}},{key:"_dragScroll",value:function(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});var e=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}},{key:"_handleMouseUp",value:function(e){var t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){var i=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(i&&void 0!==i[0]&&void 0!==i[1]){var r=(0,o.moveToCellSequence)(i[0]-1,i[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(r,!0)}}}else this._fireEventIfSelectionChanged()}},{key:"_fireEventIfSelectionChanged",value:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,i=!(!e||!t||e[0]===t[0]&&e[1]===t[1]);i?e&&t&&(this._oldSelectionStart&&this._oldSelectionEnd&&e[0]===this._oldSelectionStart[0]&&e[1]===this._oldSelectionStart[1]&&t[0]===this._oldSelectionEnd[0]&&t[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(e,t,i)):this._oldHasSelection&&this._fireOnSelectionChange(e,t,i)}},{key:"_fireOnSelectionChange",value:function(e,t,i){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=i,this._onSelectionChange.fire()}},{key:"_handleBufferActivate",value:function(e){var t=this;this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim(function(e){return t._handleTrim(e)})}},{key:"_convertViewportColToCharacterIndex",value:function(e,t){for(var i=t,r=0;t>=r;r++){var n=e.loadCell(r,this._workCell).getChars().length;0===this._workCell.getWidth()?i--:n>1&&t!==r&&(i+=n-1)}return i}},{key:"setSelection",value:function(e,t,i){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=i,this.refresh(),this._fireEventIfSelectionChanged()}},{key:"rightClickSelect",value:function(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}},{key:"_getWordAt",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!(e[0]>=this._bufferService.cols)){var n=this._bufferService.buffer,s=n.lines.get(e[1]);if(s){var o=n.translateBufferLineToString(e[1],!1),a=this._convertViewportColToCharacterIndex(s,e[0]),c=a,l=e[0]-a,h=0,u=0,d=0,f=0;if(" "===o.charAt(a)){for(;a>0&&" "===o.charAt(a-1);)a--;for(;c<o.length&&" "===o.charAt(c+1);)c++}else{var v=e[0],_=e[0];0===s.getWidth(v)&&(h++,v--),2===s.getWidth(_)&&(u++,_++);var g=s.getString(_).length;for(g>1&&(f+=g-1,c+=g-1);v>0&&a>0&&!this._isCharWordSeparator(s.loadCell(v-1,this._workCell));){s.loadCell(v-1,this._workCell);var p=this._workCell.getChars().length;0===this._workCell.getWidth()?(h++,v--):p>1&&(d+=p-1,a-=p-1),a--,v--}for(;_<s.length&&c+1<o.length&&!this._isCharWordSeparator(s.loadCell(_+1,this._workCell));){s.loadCell(_+1,this._workCell);var m=this._workCell.getChars().length;2===this._workCell.getWidth()?(u++,_++):m>1&&(f+=m-1,c+=m-1),c++,_++}}c++;var y=a+l-h+d,S=Math.min(this._bufferService.cols,c-a+h+u-d-f);if(t||""!==o.slice(a,c).trim()){if(i&&0===y&&32!==s.getCodePoint(0)){var C=n.lines.get(e[1]-1);if(C&&s.isWrapped&&32!==C.getCodePoint(this._bufferService.cols-1)){var b=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(b){var w=this._bufferService.cols-b.start;y-=w,S+=w}}}if(r&&y+S===this._bufferService.cols&&32!==s.getCodePoint(this._bufferService.cols-1)){var k=n.lines.get(e[1]+1);if(null!=k&&k.isWrapped&&32!==k.getCodePoint(0)){var L=this._getWordAt([0,e[1]+1],!1,!1,!0);L&&(S+=L.length)}}return{start:y,length:S}}}}}},{key:"_selectWordAt",value:function(e,t){var i=this._getWordAt(e,t);if(i){for(;i.start<0;)i.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[i.start,e[1]],this._model.selectionStartLength=i.length}}},{key:"_selectToWordAt",value:function(e){var t=this._getWordAt(e,!0);if(t){for(var i=e[1];t.start<0;)t.start+=this._bufferService.cols,i--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,i++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,i]}}},{key:"_isCharWordSeparator",value:function(e){return 0!==e.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}},{key:"_selectLineAt",value:function(e){var t=this._bufferService.buffer.getWrappedRangeForLine(e),i={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,v.getRangeLength)(i,this._bufferService.cols)}}])}(u.Disposable);t.SelectionService=S=r([n(3,p.IBufferService),n(4,p.ICoreService),n(5,l.IMouseService),n(6,p.IOptionsService),n(7,l.IRenderService),n(8,l.ICoreBrowserService)],S)},4725:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ILinkProviderService=t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;var r=i(8343);t.ICharSizeService=(0,r.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,r.createDecorator)("CoreBrowserService"),t.IMouseService=(0,r.createDecorator)("MouseService"),t.IRenderService=(0,r.createDecorator)("RenderService"),t.ISelectionService=(0,r.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,r.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,r.createDecorator)("ThemeService"),t.ILinkProviderService=(0,r.createDecorator)("LinkProviderService")},6731:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;var s=i(7239),o=i(8055),c=i(8460),l=i(844),h=i(2585),u=o.css.toColor("#ffffff"),f=o.css.toColor("#000000"),v=o.css.toColor("#ffffff"),_=o.css.toColor("#000000"),p={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze(function(){for(var e=[o.css.toColor("#2e3436"),o.css.toColor("#cc0000"),o.css.toColor("#4e9a06"),o.css.toColor("#c4a000"),o.css.toColor("#3465a4"),o.css.toColor("#75507b"),o.css.toColor("#06989a"),o.css.toColor("#d3d7cf"),o.css.toColor("#555753"),o.css.toColor("#ef2929"),o.css.toColor("#8ae234"),o.css.toColor("#fce94f"),o.css.toColor("#729fcf"),o.css.toColor("#ad7fa8"),o.css.toColor("#34e2e2"),o.css.toColor("#eeeeec")],t=[0,95,135,175,215,255],i=0;i<216;i++){var r=t[i/36%6|0],n=t[i/6%6|0],s=t[i%6];e.push({css:o.channels.toCss(r,n,s),rgba:o.channels.toRgba(r,n,s)})}for(var a=0;a<24;a++){var c=8+10*a;e.push({css:o.channels.toCss(c,c,c),rgba:o.channels.toRgba(c,c,c)})}return e}());var m=t.ThemeService=function(e){function i(e){var r;return C(this,i),(r=d(this,i))._optionsService=e,r._contrastCache=new s.ColorContrastCache,r._halfContrastCache=new s.ColorContrastCache,r._onChangeColors=r.register(new c.EventEmitter),r.onChangeColors=r._onChangeColors.event,r._colors={foreground:u,background:f,cursor:v,cursorAccent:_,selectionForeground:void 0,selectionBackgroundTransparent:p,selectionBackgroundOpaque:o.color.blend(f,p),selectionInactiveBackgroundTransparent:p,selectionInactiveBackgroundOpaque:o.color.blend(f,p),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:r._contrastCache,halfContrastCache:r._halfContrastCache},r._updateRestoreColors(),r._setTheme(r._optionsService.rawOptions.theme),r.register(r._optionsService.onSpecificOptionChange("minimumContrastRatio",function(){return r._contrastCache.clear()})),r.register(r._optionsService.onSpecificOptionChange("theme",function(){return r._setTheme(r._optionsService.rawOptions.theme)})),r}return g(i,e),w(i,[{key:"colors",get:function(){return this._colors}},{key:"_setTheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this._colors;if(i.foreground=y(e.foreground,u),i.background=y(e.background,f),i.cursor=y(e.cursor,v),i.cursorAccent=y(e.cursorAccent,_),i.selectionBackgroundTransparent=y(e.selectionBackground,p),i.selectionBackgroundOpaque=o.color.blend(i.background,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundTransparent=y(e.selectionInactiveBackground,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundOpaque=o.color.blend(i.background,i.selectionInactiveBackgroundTransparent),i.selectionForeground=e.selectionForeground?y(e.selectionForeground,o.NULL_COLOR):void 0,i.selectionForeground===o.NULL_COLOR&&(i.selectionForeground=void 0),o.color.isOpaque(i.selectionBackgroundTransparent)){var r=.3;i.selectionBackgroundTransparent=o.color.opacity(i.selectionBackgroundTransparent,r)}if(o.color.isOpaque(i.selectionInactiveBackgroundTransparent)){var n=.3;i.selectionInactiveBackgroundTransparent=o.color.opacity(i.selectionInactiveBackgroundTransparent,n)}if(i.ansi=t.DEFAULT_ANSI_COLORS.slice(),i.ansi[0]=y(e.black,t.DEFAULT_ANSI_COLORS[0]),i.ansi[1]=y(e.red,t.DEFAULT_ANSI_COLORS[1]),i.ansi[2]=y(e.green,t.DEFAULT_ANSI_COLORS[2]),i.ansi[3]=y(e.yellow,t.DEFAULT_ANSI_COLORS[3]),i.ansi[4]=y(e.blue,t.DEFAULT_ANSI_COLORS[4]),i.ansi[5]=y(e.magenta,t.DEFAULT_ANSI_COLORS[5]),i.ansi[6]=y(e.cyan,t.DEFAULT_ANSI_COLORS[6]),i.ansi[7]=y(e.white,t.DEFAULT_ANSI_COLORS[7]),i.ansi[8]=y(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),i.ansi[9]=y(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),i.ansi[10]=y(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),i.ansi[11]=y(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),i.ansi[12]=y(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),i.ansi[13]=y(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),i.ansi[14]=y(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),i.ansi[15]=y(e.brightWhite,t.DEFAULT_ANSI_COLORS[15]),e.extendedAnsi)for(var s=Math.min(i.ansi.length-16,e.extendedAnsi.length),a=0;a<s;a++)i.ansi[a+16]=y(e.extendedAnsi[a],t.DEFAULT_ANSI_COLORS[a+16]);this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}},{key:"restoreColor",value:function(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}},{key:"_restoreColor",value:function(e){if(void 0!==e)switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}else for(var t=0;t<this._restoreColors.ansi.length;++t)this._colors.ansi[t]=this._restoreColors.ansi[t]}},{key:"modifyColors",value:function(e){e(this._colors),this._onChangeColors.fire(this.colors)}},{key:"_updateRestoreColors",value:function(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}}])}(l.Disposable);function y(e,t){if(void 0!==e)try{return o.css.toColor(e)}catch(i){}return t}t.ThemeService=m=r([n(0,h.IOptionsService)],m)},6349:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;var r=i(8460),n=function(e){function t(e){var i;return C(this,t),(i=d(this,t))._maxLength=e,i.onDeleteEmitter=i.register(new r.EventEmitter),i.onDelete=i.onDeleteEmitter.event,i.onInsertEmitter=i.register(new r.EventEmitter),i.onInsert=i.onInsertEmitter.event,i.onTrimEmitter=i.register(new r.EventEmitter),i.onTrim=i.onTrimEmitter.event,i._array=new Array(i._maxLength),i._startIndex=0,i._length=0,i}return g(t,e),w(t,[{key:"maxLength",get:function(){return this._maxLength},set:function(e){if(this._maxLength!==e){for(var t=new Array(e),i=0;i<Math.min(e,this.length);i++)t[i]=this._array[this._getCyclicIndex(i)];this._array=t,this._maxLength=e,this._startIndex=0}}},{key:"length",get:function(){return this._length},set:function(e){if(e>this._length)for(var t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}},{key:"get",value:function(e){return this._array[this._getCyclicIndex(e)]}},{key:"set",value:function(e,t){this._array[this._getCyclicIndex(e)]=t}},{key:"push",value:function(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}},{key:"recycle",value:function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}},{key:"isFull",get:function(){return this._length===this._maxLength}},{key:"pop",value:function(){return this._array[this._getCyclicIndex(this._length---1)]}},{key:"splice",value:function(e,t){if(t){for(var i=e;i<this._length-t;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(var r=this._length-1;r>=e;r--)this._array[this._getCyclicIndex(r+(arguments.length<=2?0:arguments.length-2))]=this._array[this._getCyclicIndex(r)];for(var n=0;n<(arguments.length<=2?0:arguments.length-2);n++)this._array[this._getCyclicIndex(e+n)]=n+2<2||arguments.length<=n+2?void 0:arguments[n+2];if((arguments.length<=2?0:arguments.length-2)&&this.onInsertEmitter.fire({index:e,amount:arguments.length<=2?0:arguments.length-2}),this._length+(arguments.length<=2?0:arguments.length-2)>this._maxLength){var s=this._length+(arguments.length<=2?0:arguments.length-2)-this._maxLength;this._startIndex+=s,this._length=this._maxLength,this.onTrimEmitter.fire(s)}else this._length+=arguments.length<=2?0:arguments.length-2}},{key:"trimStart",value:function(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}},{key:"shiftElements",value:function(e,t,i){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(var r=t-1;r>=0;r--)this.set(e+r+i,this.get(e+r));var n=e+t+i-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(var s=0;s<t;s++)this.set(e+s+i,this.get(e+s))}}},{key:"_getCyclicIndex",value:function(e){return(this._startIndex+e)%this._maxLength}}])}(i(844).Disposable);t.CircularList=n},1439:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("object"!=a(t))return t;var r=Array.isArray(t)?[]:{};for(var n in t)r[n]=i<=1?t[n]:t[n]&&e(t[n],i-1);return r}},8055:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;var i,r,n,s,o,a=0,c=0,h=0,u=0;function d(e){var t=e.toString(16);return t.length<2?"0"+t:t}function f(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,i,r){return void 0!==r?"#".concat(d(e)).concat(d(t)).concat(d(i)).concat(d(r)):"#".concat(d(e)).concat(d(t)).concat(d(i))},e.toRgba=function(e,t,i){return(e<<24|t<<16|i<<8|(arguments.length>3&&void 0!==arguments[3]?arguments[3]:255))>>>0},e.toColor=function(t,i,r,n){return{css:e.toCss(t,i,r,n),rgba:e.toRgba(t,i,r,n)}}}(i||(t.channels=i={})),function(e){function t(e,t){var r;return u=Math.round(255*t),r=l(o.toChannels(e.rgba),3),a=r[0],c=r[1],h=r[2],{css:i.toCss(a,c,h,u),rgba:i.toRgba(a,c,h,u)}}e.blend=function(e,t){if(1==(u=(255&t.rgba)/255))return{css:t.css,rgba:t.rgba};var r=t.rgba>>24&255,n=t.rgba>>16&255,s=t.rgba>>8&255,o=e.rgba>>24&255,l=e.rgba>>16&255,d=e.rgba>>8&255;return a=o+Math.round((r-o)*u),c=l+Math.round((n-l)*u),h=d+Math.round((s-d)*u),{css:i.toCss(a,c,h),rgba:i.toRgba(a,c,h)}},e.isOpaque=function(e){return!(255&~e.rgba)},e.ensureContrastRatio=function(e,t,r){var n=o.ensureContrastRatio(e.rgba,t.rgba,r);if(n)return i.toColor(n>>24&255,n>>16&255,n>>8&255)},e.opaque=function(e){var t,r=(255|e.rgba)>>>0;return t=l(o.toChannels(r),3),a=t[0],c=t[1],h=t[2],{css:i.toCss(a,c,h),rgba:r}},e.opacity=t,e.multiplyOpacity=function(e,i){return t(e,(u=255&e.rgba)*i/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(r||(t.color=r={})),function(e){var t,r;try{var n=document.createElement("canvas");n.width=1,n.height=1;var s=n.getContext("2d",{willReadFrequently:!0});s&&((t=s).globalCompositeOperation="copy",r=t.createLinearGradient(0,0,1,1))}catch(o){}e.toColor=function(e){var n;if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return a=parseInt(e.slice(1,2).repeat(2),16),c=parseInt(e.slice(2,3).repeat(2),16),h=parseInt(e.slice(3,4).repeat(2),16),i.toColor(a,c,h);case 5:return a=parseInt(e.slice(1,2).repeat(2),16),c=parseInt(e.slice(2,3).repeat(2),16),h=parseInt(e.slice(3,4).repeat(2),16),u=parseInt(e.slice(4,5).repeat(2),16),i.toColor(a,c,h,u);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var s=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(s)return a=parseInt(s[1]),c=parseInt(s[2]),h=parseInt(s[3]),u=Math.round(255*(void 0===s[5]?1:parseFloat(s[5]))),i.toColor(a,c,h,u);if(!t||!r)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=r,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),n=l(t.getImageData(0,0,1,1).data,4),a=n[0],c=n[1],h=n[2],255!==(u=n[3]))throw new Error("css.toColor: Unsupported css format");return{rgba:i.toRgba(a,c,h,u),css:e}}}(n||(t.css=n={})),function(e){function t(e,t,i){var r=e/255,n=t/255,s=i/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(s||(t.rgb=s={})),function(e){function t(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));h<i&&(a>0||c>0||l>0);)a-=Math.max(0,Math.ceil(.1*a)),c-=Math.max(0,Math.ceil(.1*c)),l-=Math.max(0,Math.ceil(.1*l)),h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}function r(e,t,i){for(var r=e>>24&255,n=e>>16&255,o=e>>8&255,a=t>>24&255,c=t>>16&255,l=t>>8&255,h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));h<i&&(a<255||c<255||l<255);)a=Math.min(255,a+Math.ceil(.1*(255-a))),c=Math.min(255,c+Math.ceil(.1*(255-c))),l=Math.min(255,l+Math.ceil(.1*(255-l))),h=f(s.relativeLuminance2(a,c,l),s.relativeLuminance2(r,n,o));return(a<<24|c<<16|l<<8|255)>>>0}e.blend=function(e,t){if(1==(u=(255&t)/255))return t;var r=t>>24&255,n=t>>16&255,s=t>>8&255,o=e>>24&255,l=e>>16&255,d=e>>8&255;return a=o+Math.round((r-o)*u),c=l+Math.round((n-l)*u),h=d+Math.round((s-d)*u),i.toRgba(a,c,h)},e.ensureContrastRatio=function(e,i,n){var o=s.relativeLuminance(e>>8),a=s.relativeLuminance(i>>8);if(f(o,a)<n){if(a<o){var c=t(e,i,n),l=f(o,s.relativeLuminance(c>>8));if(l<n){var h=r(e,i,n);return l>f(o,s.relativeLuminance(h>>8))?c:h}return c}var u=r(e,i,n),d=f(o,s.relativeLuminance(u>>8));if(d<n){var v=t(e,i,n);return d>f(o,s.relativeLuminance(v>>8))?u:v}return u}},e.reduceLuminance=t,e.increaseLuminance=r,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]}}(o||(t.rgba=o={})),t.toPaddedHex=d,t.contrastRatio=f},8969:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;var r=i(844),n=i(2585),s=i(4348),o=i(7866),a=i(744),c=i(7302),l=i(6975),h=i(8460),u=i(1753),f=i(1480),v=i(7994),_=i(9282),p=i(5435),m=i(5981),y=i(2660),S=!1,b=function(e){function t(e){var i;return C(this,t),(i=d(this,t))._windowsWrappingHeuristics=i.register(new r.MutableDisposable),i._onBinary=i.register(new h.EventEmitter),i.onBinary=i._onBinary.event,i._onData=i.register(new h.EventEmitter),i.onData=i._onData.event,i._onLineFeed=i.register(new h.EventEmitter),i.onLineFeed=i._onLineFeed.event,i._onResize=i.register(new h.EventEmitter),i.onResize=i._onResize.event,i._onWriteParsed=i.register(new h.EventEmitter),i.onWriteParsed=i._onWriteParsed.event,i._onScroll=i.register(new h.EventEmitter),i._instantiationService=new s.InstantiationService,i.optionsService=i.register(new c.OptionsService(e)),i._instantiationService.setService(n.IOptionsService,i.optionsService),i._bufferService=i.register(i._instantiationService.createInstance(a.BufferService)),i._instantiationService.setService(n.IBufferService,i._bufferService),i._logService=i.register(i._instantiationService.createInstance(o.LogService)),i._instantiationService.setService(n.ILogService,i._logService),i.coreService=i.register(i._instantiationService.createInstance(l.CoreService)),i._instantiationService.setService(n.ICoreService,i.coreService),i.coreMouseService=i.register(i._instantiationService.createInstance(u.CoreMouseService)),i._instantiationService.setService(n.ICoreMouseService,i.coreMouseService),i.unicodeService=i.register(i._instantiationService.createInstance(f.UnicodeService)),i._instantiationService.setService(n.IUnicodeService,i.unicodeService),i._charsetService=i._instantiationService.createInstance(v.CharsetService),i._instantiationService.setService(n.ICharsetService,i._charsetService),i._oscLinkService=i._instantiationService.createInstance(y.OscLinkService),i._instantiationService.setService(n.IOscLinkService,i._oscLinkService),i._inputHandler=i.register(new p.InputHandler(i._bufferService,i._charsetService,i.coreService,i._logService,i.optionsService,i._oscLinkService,i.coreMouseService,i.unicodeService)),i.register((0,h.forwardEvent)(i._inputHandler.onLineFeed,i._onLineFeed)),i.register(i._inputHandler),i.register((0,h.forwardEvent)(i._bufferService.onResize,i._onResize)),i.register((0,h.forwardEvent)(i.coreService.onData,i._onData)),i.register((0,h.forwardEvent)(i.coreService.onBinary,i._onBinary)),i.register(i.coreService.onRequestScrollToBottom(function(){return i.scrollToBottom()})),i.register(i.coreService.onUserInput(function(){return i._writeBuffer.handleUserInput()})),i.register(i.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],function(){return i._handleWindowsPtyOptionChange()})),i.register(i._bufferService.onScroll(function(e){i._onScroll.fire({position:i._bufferService.buffer.ydisp,source:0}),i._inputHandler.markRangeDirty(i._bufferService.buffer.scrollTop,i._bufferService.buffer.scrollBottom)})),i.register(i._inputHandler.onScroll(function(e){i._onScroll.fire({position:i._bufferService.buffer.ydisp,source:0}),i._inputHandler.markRangeDirty(i._bufferService.buffer.scrollTop,i._bufferService.buffer.scrollBottom)})),i._writeBuffer=i.register(new m.WriteBuffer(function(e,t){return i._inputHandler.parse(e,t)})),i.register((0,h.forwardEvent)(i._writeBuffer.onWriteParsed,i._onWriteParsed)),i}return g(t,e),w(t,[{key:"onScroll",get:function(){var e=this;return this._onScrollApi||(this._onScrollApi=this.register(new h.EventEmitter),this._onScroll.event(function(t){var i;null===(i=e._onScrollApi)||void 0===i||i.fire(t.position)})),this._onScrollApi.event}},{key:"cols",get:function(){return this._bufferService.cols}},{key:"rows",get:function(){return this._bufferService.rows}},{key:"buffers",get:function(){return this._bufferService.buffers}},{key:"options",get:function(){return this.optionsService.options},set:function(e){for(var t in e)this.optionsService.options[t]=e[t]}},{key:"write",value:function(e,t){this._writeBuffer.write(e,t)}},{key:"writeSync",value:function(e,t){this._logService.logLevel<=n.LogLevelEnum.WARN&&!S&&(this._logService.warn("writeSync is unreliable and will be removed soon."),S=!0),this._writeBuffer.writeSync(e,t)}},{key:"input",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.coreService.triggerDataEvent(e,t)}},{key:"resize",value:function(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,a.MINIMUM_COLS),t=Math.max(t,a.MINIMUM_ROWS),this._bufferService.resize(e,t))}},{key:"scroll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._bufferService.scroll(e,t)}},{key:"scrollLines",value:function(e,t,i){this._bufferService.scrollLines(e,t,i)}},{key:"scrollPages",value:function(e){this.scrollLines(e*(this.rows-1))}},{key:"scrollToTop",value:function(){this.scrollLines(-this._bufferService.buffer.ydisp)}},{key:"scrollToBottom",value:function(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}},{key:"scrollToLine",value:function(e){var t=e-this._bufferService.buffer.ydisp;0!==t&&this.scrollLines(t)}},{key:"registerEscHandler",value:function(e,t){return this._inputHandler.registerEscHandler(e,t)}},{key:"registerDcsHandler",value:function(e,t){return this._inputHandler.registerDcsHandler(e,t)}},{key:"registerCsiHandler",value:function(e,t){return this._inputHandler.registerCsiHandler(e,t)}},{key:"registerOscHandler",value:function(e,t){return this._inputHandler.registerOscHandler(e,t)}},{key:"_setup",value:function(){this._handleWindowsPtyOptionChange()}},{key:"reset",value:function(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}},{key:"_handleWindowsPtyOptionChange",value:function(){var e=!1,t=this.optionsService.rawOptions.windowsPty;t&&void 0!==t.buildNumber&&void 0!==t.buildNumber?e=!!("conpty"===t.backend&&t.buildNumber<21376):this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}},{key:"_enableWindowsWrappingHeuristics",value:function(){var e=this;if(!this._windowsWrappingHeuristics.value){var t=[];t.push(this.onLineFeed(_.updateWindowsModeWrappedState.bind(null,this._bufferService))),t.push(this.registerCsiHandler({final:"H"},function(){return(0,_.updateWindowsModeWrappedState)(e._bufferService),!1})),this._windowsWrappingHeuristics.value=(0,r.toDisposable)(function(){for(var e=0,i=t;e<i.length;e++)i[e].dispose()})}}}])}(r.Disposable);t.CoreTerminal=b},8460:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=function(){function e(){C(this,e),this._listeners=[],this._disposed=!1}return w(e,[{key:"event",get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]===t)return void e._listeners.splice(i,1)}}}),this._event}},{key:"fire",value:function(e,t){for(var i=[],r=0;r<this._listeners.length;r++)i.push(this._listeners[r]);for(var n=0;n<i.length;n++)i[n].call(void 0,e,t)}},{key:"dispose",value:function(){this.clearListeners(),this._disposed=!0}},{key:"clearListeners",value:function(){this._listeners&&(this._listeners.length=0)}}])}(),t.forwardEvent=function(e,t){return e(function(e){return t.fire(e)})},t.runAndSubscribe=function(e,t){return t(void 0),e(function(e){return t(e)})}},5435:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;var s,o=i(2584),c=i(7116),l=i(2015),h=i(844),u=i(482),f=i(8437),v=i(8460),_=i(643),p=i(511),m=i(3734),y=i(2585),S=i(1480),b=i(6242),k=i(6351),L=i(5941),x={"(":0,")":1,"*":2,"+":3,"-":1,".":2},E=131072;function R(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}!function(e){e[e.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",e[e.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(s||(t.WindowsOptionsReportType=s={}));var D=0,A=function(e){function t(e,i,r,n,s,a,h,_){var g,m=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new l.EscapeSequenceParser;C(this,t),(g=d(this,t))._bufferService=e,g._charsetService=i,g._coreService=r,g._logService=n,g._optionsService=s,g._oscLinkService=a,g._coreMouseService=h,g._unicodeService=_,g._parser=m,g._parseBuffer=new Uint32Array(4096),g._stringDecoder=new u.StringToUtf32,g._utf8Decoder=new u.Utf8ToUtf32,g._workCell=new p.CellData,g._windowTitle="",g._iconName="",g._windowTitleStack=[],g._iconNameStack=[],g._curAttrData=f.DEFAULT_ATTR_DATA.clone(),g._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone(),g._onRequestBell=g.register(new v.EventEmitter),g.onRequestBell=g._onRequestBell.event,g._onRequestRefreshRows=g.register(new v.EventEmitter),g.onRequestRefreshRows=g._onRequestRefreshRows.event,g._onRequestReset=g.register(new v.EventEmitter),g.onRequestReset=g._onRequestReset.event,g._onRequestSendFocus=g.register(new v.EventEmitter),g.onRequestSendFocus=g._onRequestSendFocus.event,g._onRequestSyncScrollBar=g.register(new v.EventEmitter),g.onRequestSyncScrollBar=g._onRequestSyncScrollBar.event,g._onRequestWindowsOptionsReport=g.register(new v.EventEmitter),g.onRequestWindowsOptionsReport=g._onRequestWindowsOptionsReport.event,g._onA11yChar=g.register(new v.EventEmitter),g.onA11yChar=g._onA11yChar.event,g._onA11yTab=g.register(new v.EventEmitter),g.onA11yTab=g._onA11yTab.event,g._onCursorMove=g.register(new v.EventEmitter),g.onCursorMove=g._onCursorMove.event,g._onLineFeed=g.register(new v.EventEmitter),g.onLineFeed=g._onLineFeed.event,g._onScroll=g.register(new v.EventEmitter),g.onScroll=g._onScroll.event,g._onTitleChange=g.register(new v.EventEmitter),g.onTitleChange=g._onTitleChange.event,g._onColor=g.register(new v.EventEmitter),g.onColor=g._onColor.event,g._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},g._specialColors=[256,257,258],g.register(g._parser),g._dirtyRowTracker=new M(g._bufferService),g._activeBuffer=g._bufferService.buffer,g.register(g._bufferService.buffers.onBufferActivate(function(e){return g._activeBuffer=e.activeBuffer})),g._parser.setCsiHandlerFallback(function(e,t){g._logService.debug("Unknown CSI code: ",{identifier:g._parser.identToString(e),params:t.toArray()})}),g._parser.setEscHandlerFallback(function(e){g._logService.debug("Unknown ESC code: ",{identifier:g._parser.identToString(e)})}),g._parser.setExecuteHandlerFallback(function(e){g._logService.debug("Unknown EXECUTE code: ",{code:e})}),g._parser.setOscHandlerFallback(function(e,t,i){g._logService.debug("Unknown OSC code: ",{identifier:e,action:t,data:i})}),g._parser.setDcsHandlerFallback(function(e,t,i){"HOOK"===t&&(i=i.toArray()),g._logService.debug("Unknown DCS code: ",{identifier:g._parser.identToString(e),action:t,payload:i})}),g._parser.setPrintHandler(function(e,t,i){return g.print(e,t,i)}),g._parser.registerCsiHandler({final:"@"},function(e){return g.insertChars(e)}),g._parser.registerCsiHandler({intermediates:" ",final:"@"},function(e){return g.scrollLeft(e)}),g._parser.registerCsiHandler({final:"A"},function(e){return g.cursorUp(e)}),g._parser.registerCsiHandler({intermediates:" ",final:"A"},function(e){return g.scrollRight(e)}),g._parser.registerCsiHandler({final:"B"},function(e){return g.cursorDown(e)}),g._parser.registerCsiHandler({final:"C"},function(e){return g.cursorForward(e)}),g._parser.registerCsiHandler({final:"D"},function(e){return g.cursorBackward(e)}),g._parser.registerCsiHandler({final:"E"},function(e){return g.cursorNextLine(e)}),g._parser.registerCsiHandler({final:"F"},function(e){return g.cursorPrecedingLine(e)}),g._parser.registerCsiHandler({final:"G"},function(e){return g.cursorCharAbsolute(e)}),g._parser.registerCsiHandler({final:"H"},function(e){return g.cursorPosition(e)}),g._parser.registerCsiHandler({final:"I"},function(e){return g.cursorForwardTab(e)}),g._parser.registerCsiHandler({final:"J"},function(e){return g.eraseInDisplay(e,!1)}),g._parser.registerCsiHandler({prefix:"?",final:"J"},function(e){return g.eraseInDisplay(e,!0)}),g._parser.registerCsiHandler({final:"K"},function(e){return g.eraseInLine(e,!1)}),g._parser.registerCsiHandler({prefix:"?",final:"K"},function(e){return g.eraseInLine(e,!0)}),g._parser.registerCsiHandler({final:"L"},function(e){return g.insertLines(e)}),g._parser.registerCsiHandler({final:"M"},function(e){return g.deleteLines(e)}),g._parser.registerCsiHandler({final:"P"},function(e){return g.deleteChars(e)}),g._parser.registerCsiHandler({final:"S"},function(e){return g.scrollUp(e)}),g._parser.registerCsiHandler({final:"T"},function(e){return g.scrollDown(e)}),g._parser.registerCsiHandler({final:"X"},function(e){return g.eraseChars(e)}),g._parser.registerCsiHandler({final:"Z"},function(e){return g.cursorBackwardTab(e)}),g._parser.registerCsiHandler({final:"`"},function(e){return g.charPosAbsolute(e)}),g._parser.registerCsiHandler({final:"a"},function(e){return g.hPositionRelative(e)}),g._parser.registerCsiHandler({final:"b"},function(e){return g.repeatPrecedingCharacter(e)}),g._parser.registerCsiHandler({final:"c"},function(e){return g.sendDeviceAttributesPrimary(e)}),g._parser.registerCsiHandler({prefix:">",final:"c"},function(e){return g.sendDeviceAttributesSecondary(e)}),g._parser.registerCsiHandler({final:"d"},function(e){return g.linePosAbsolute(e)}),g._parser.registerCsiHandler({final:"e"},function(e){return g.vPositionRelative(e)}),g._parser.registerCsiHandler({final:"f"},function(e){return g.hVPosition(e)}),g._parser.registerCsiHandler({final:"g"},function(e){return g.tabClear(e)}),g._parser.registerCsiHandler({final:"h"},function(e){return g.setMode(e)}),g._parser.registerCsiHandler({prefix:"?",final:"h"},function(e){return g.setModePrivate(e)}),g._parser.registerCsiHandler({final:"l"},function(e){return g.resetMode(e)}),g._parser.registerCsiHandler({prefix:"?",final:"l"},function(e){return g.resetModePrivate(e)}),g._parser.registerCsiHandler({final:"m"},function(e){return g.charAttributes(e)}),g._parser.registerCsiHandler({final:"n"},function(e){return g.deviceStatus(e)}),g._parser.registerCsiHandler({prefix:"?",final:"n"},function(e){return g.deviceStatusPrivate(e)}),g._parser.registerCsiHandler({intermediates:"!",final:"p"},function(e){return g.softReset(e)}),g._parser.registerCsiHandler({intermediates:" ",final:"q"},function(e){return g.setCursorStyle(e)}),g._parser.registerCsiHandler({final:"r"},function(e){return g.setScrollRegion(e)}),g._parser.registerCsiHandler({final:"s"},function(e){return g.saveCursor(e)}),g._parser.registerCsiHandler({final:"t"},function(e){return g.windowOptions(e)}),g._parser.registerCsiHandler({final:"u"},function(e){return g.restoreCursor(e)}),g._parser.registerCsiHandler({intermediates:"'",final:"}"},function(e){return g.insertColumns(e)}),g._parser.registerCsiHandler({intermediates:"'",final:"~"},function(e){return g.deleteColumns(e)}),g._parser.registerCsiHandler({intermediates:'"',final:"q"},function(e){return g.selectProtected(e)}),g._parser.registerCsiHandler({intermediates:"$",final:"p"},function(e){return g.requestMode(e,!0)}),g._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},function(e){return g.requestMode(e,!1)}),g._parser.setExecuteHandler(o.C0.BEL,function(){return g.bell()}),g._parser.setExecuteHandler(o.C0.LF,function(){return g.lineFeed()}),g._parser.setExecuteHandler(o.C0.VT,function(){return g.lineFeed()}),g._parser.setExecuteHandler(o.C0.FF,function(){return g.lineFeed()}),g._parser.setExecuteHandler(o.C0.CR,function(){return g.carriageReturn()}),g._parser.setExecuteHandler(o.C0.BS,function(){return g.backspace()}),g._parser.setExecuteHandler(o.C0.HT,function(){return g.tab()}),g._parser.setExecuteHandler(o.C0.SO,function(){return g.shiftOut()}),g._parser.setExecuteHandler(o.C0.SI,function(){return g.shiftIn()}),g._parser.setExecuteHandler(o.C1.IND,function(){return g.index()}),g._parser.setExecuteHandler(o.C1.NEL,function(){return g.nextLine()}),g._parser.setExecuteHandler(o.C1.HTS,function(){return g.tabSet()}),g._parser.registerOscHandler(0,new b.OscHandler(function(e){return g.setTitle(e),g.setIconName(e),!0})),g._parser.registerOscHandler(1,new b.OscHandler(function(e){return g.setIconName(e)})),g._parser.registerOscHandler(2,new b.OscHandler(function(e){return g.setTitle(e)})),g._parser.registerOscHandler(4,new b.OscHandler(function(e){return g.setOrReportIndexedColor(e)})),g._parser.registerOscHandler(8,new b.OscHandler(function(e){return g.setHyperlink(e)})),g._parser.registerOscHandler(10,new b.OscHandler(function(e){return g.setOrReportFgColor(e)})),g._parser.registerOscHandler(11,new b.OscHandler(function(e){return g.setOrReportBgColor(e)})),g._parser.registerOscHandler(12,new b.OscHandler(function(e){return g.setOrReportCursorColor(e)})),g._parser.registerOscHandler(104,new b.OscHandler(function(e){return g.restoreIndexedColor(e)})),g._parser.registerOscHandler(110,new b.OscHandler(function(e){return g.restoreFgColor(e)})),g._parser.registerOscHandler(111,new b.OscHandler(function(e){return g.restoreBgColor(e)})),g._parser.registerOscHandler(112,new b.OscHandler(function(e){return g.restoreCursorColor(e)})),g._parser.registerEscHandler({final:"7"},function(){return g.saveCursor()}),g._parser.registerEscHandler({final:"8"},function(){return g.restoreCursor()}),g._parser.registerEscHandler({final:"D"},function(){return g.index()}),g._parser.registerEscHandler({final:"E"},function(){return g.nextLine()}),g._parser.registerEscHandler({final:"H"},function(){return g.tabSet()}),g._parser.registerEscHandler({final:"M"},function(){return g.reverseIndex()}),g._parser.registerEscHandler({final:"="},function(){return g.keypadApplicationMode()}),g._parser.registerEscHandler({final:">"},function(){return g.keypadNumericMode()}),g._parser.registerEscHandler({final:"c"},function(){return g.fullReset()}),g._parser.registerEscHandler({final:"n"},function(){return g.setgLevel(2)}),g._parser.registerEscHandler({final:"o"},function(){return g.setgLevel(3)}),g._parser.registerEscHandler({final:"|"},function(){return g.setgLevel(3)}),g._parser.registerEscHandler({final:"}"},function(){return g.setgLevel(2)}),g._parser.registerEscHandler({final:"~"},function(){return g.setgLevel(1)}),g._parser.registerEscHandler({intermediates:"%",final:"@"},function(){return g.selectDefaultCharset()}),g._parser.registerEscHandler({intermediates:"%",final:"G"},function(){return g.selectDefaultCharset()});var y=function(e){g._parser.registerEscHandler({intermediates:"(",final:e},function(){return g.selectCharset("("+e)}),g._parser.registerEscHandler({intermediates:")",final:e},function(){return g.selectCharset(")"+e)}),g._parser.registerEscHandler({intermediates:"*",final:e},function(){return g.selectCharset("*"+e)}),g._parser.registerEscHandler({intermediates:"+",final:e},function(){return g.selectCharset("+"+e)}),g._parser.registerEscHandler({intermediates:"-",final:e},function(){return g.selectCharset("-"+e)}),g._parser.registerEscHandler({intermediates:".",final:e},function(){return g.selectCharset("."+e)}),g._parser.registerEscHandler({intermediates:"/",final:e},function(){return g.selectCharset("/"+e)})};for(var S in c.CHARSETS)y(S);return g._parser.registerEscHandler({intermediates:"#",final:"8"},function(){return g.screenAlignmentPattern()}),g._parser.setErrorHandler(function(e){return g._logService.error("Parsing error: ",e),e}),g._parser.registerDcsHandler({intermediates:"$",final:"q"},new k.DcsHandler(function(e,t){return g.requestStatusString(e,t)})),g}return g(t,e),w(t,[{key:"getAttrData",value:function(){return this._curAttrData}},{key:"_preserveStack",value:function(e,t,i,r){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=i,this._parseStack.position=r}},{key:"_logSlowResolvingAsync",value:function(e){this._logService.logLevel<=y.LogLevelEnum.WARN&&Promise.race([e,new Promise(function(e,t){return setTimeout(function(){return t("#SLOW_TIMEOUT")},5e3)})]).catch(function(e){if("#SLOW_TIMEOUT"!==e)throw e})}},{key:"_getCurrentLinkId",value:function(){return this._curAttrData.extended.urlId}},{key:"parse",value:function(e,t){var i,r=this._activeBuffer.x,n=this._activeBuffer.y,s=0,o=this._parseStack.paused;if(o){if(i=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(i),i;r=this._parseStack.cursorStartX,n=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>E&&(s=this._parseStack.position+E)}if(this._logService.logLevel<=y.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+' "'.concat("string"==typeof e?e:Array.prototype.map.call(e,function(e){return String.fromCharCode(e)}).join(""),'"'),"string"==typeof e?e.split("").map(function(e){return e.charCodeAt(0)}):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<E&&(this._parseBuffer=new Uint32Array(Math.min(e.length,E))),o||this._dirtyRowTracker.clearRange(),e.length>E)for(var a=s;a<e.length;a+=E){var c=a+E<e.length?a+E:e.length,l="string"==typeof e?this._stringDecoder.decode(e.substring(a,c),this._parseBuffer):this._utf8Decoder.decode(e.subarray(a,c),this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,l))return this._preserveStack(r,n,l,a),this._logSlowResolvingAsync(i),i}else if(!o){var h="string"==typeof e?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,h))return this._preserveStack(r,n,h,0),this._logSlowResolvingAsync(i),i}this._activeBuffer.x===r&&this._activeBuffer.y===n||this._onCursorMove.fire();var u=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),d=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);d<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(d,this._bufferService.rows-1),Math.min(u,this._bufferService.rows-1))}},{key:"print",value:function(e,t,i){var r,n,s=this._charsetService.charset,o=this._optionsService.rawOptions.screenReaderMode,a=this._bufferService.cols,c=this._coreService.decPrivateModes.wraparound,l=this._coreService.modes.insertMode,h=this._curAttrData,d=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&i-t>0&&2===d.getWidth(this._activeBuffer.x-1)&&d.setCellFromCodepoint(this._activeBuffer.x-1,0,1,h);for(var v=this._parser.precedingJoinState,g=t;g<i;++g){if((r=e[g])<127&&s){var p=s[String.fromCharCode(r)];p&&(r=p.charCodeAt(0))}var m=this._unicodeService.charProperties(r,v);n=S.UnicodeService.extractWidth(m);var y=S.UnicodeService.extractShouldJoin(m),C=y?S.UnicodeService.extractWidth(v):0;if(v=m,o&&this._onA11yChar.fire((0,u.stringFromCodePoint)(r)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+n-C>a)if(c){var b=d,w=this._activeBuffer.x-C;for(this._activeBuffer.x=C,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),d=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),C>0&&d instanceof f.BufferLine&&d.copyCellsFrom(b,w,0,C,!1);w<a;)b.setCellFromCodepoint(w++,0,1,h)}else if(this._activeBuffer.x=a-1,2===n)continue;if(y&&this._activeBuffer.x){var k=d.getWidth(this._activeBuffer.x-1)?1:2;d.addCodepointToCell(this._activeBuffer.x-k,r,n);for(var L=n-C;--L>=0;)d.setCellFromCodepoint(this._activeBuffer.x++,0,0,h)}else if(l&&(d.insertCells(this._activeBuffer.x,n-C,this._activeBuffer.getNullCell(h)),2===d.getWidth(a-1)&&d.setCellFromCodepoint(a-1,_.NULL_CELL_CODE,_.NULL_CELL_WIDTH,h)),d.setCellFromCodepoint(this._activeBuffer.x++,r,n,h),n>0)for(;--n;)d.setCellFromCodepoint(this._activeBuffer.x++,0,0,h)}this._parser.precedingJoinState=v,this._activeBuffer.x<a&&i-t>0&&0===d.getWidth(this._activeBuffer.x)&&!d.hasContent(this._activeBuffer.x)&&d.setCellFromCodepoint(this._activeBuffer.x,0,1,h),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}},{key:"registerCsiHandler",value:function(e,t){var i=this;return"t"!==e.final||e.prefix||e.intermediates?this._parser.registerCsiHandler(e,t):this._parser.registerCsiHandler(e,function(e){return!R(e.params[0],i._optionsService.rawOptions.windowOptions)||t(e)})}},{key:"registerDcsHandler",value:function(e,t){return this._parser.registerDcsHandler(e,new k.DcsHandler(t))}},{key:"registerEscHandler",value:function(e,t){return this._parser.registerEscHandler(e,t)}},{key:"registerOscHandler",value:function(e,t){return this._parser.registerOscHandler(e,new b.OscHandler(t))}},{key:"bell",value:function(){return this._onRequestBell.fire(),!0}},{key:"lineFeed",value:function(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}},{key:"carriageReturn",value:function(){return this._activeBuffer.x=0,!0}},{key:"backspace",value:function(){var e;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&null!==(e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))&&void 0!==e&&e.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);t.hasWidth(this._activeBuffer.x)&&!t.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}},{key:"tab",value:function(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;var e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}},{key:"shiftOut",value:function(){return this._charsetService.setgLevel(1),!0}},{key:"shiftIn",value:function(){return this._charsetService.setgLevel(0),!0}},{key:"_restrictCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._bufferService.cols-1;this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}},{key:"_setCursor",value:function(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}},{key:"_moveCursor",value:function(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}},{key:"cursorUp",value:function(e){var t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}},{key:"cursorDown",value:function(e){var t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}},{key:"cursorForward",value:function(e){return this._moveCursor(e.params[0]||1,0),!0}},{key:"cursorBackward",value:function(e){return this._moveCursor(-(e.params[0]||1),0),!0}},{key:"cursorNextLine",value:function(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}},{key:"cursorPrecedingLine",value:function(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}},{key:"cursorCharAbsolute",value:function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}},{key:"cursorPosition",value:function(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}},{key:"charPosAbsolute",value:function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}},{key:"hPositionRelative",value:function(e){return this._moveCursor(e.params[0]||1,0),!0}},{key:"linePosAbsolute",value:function(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}},{key:"vPositionRelative",value:function(e){return this._moveCursor(0,e.params[0]||1),!0}},{key:"hVPosition",value:function(e){return this.cursorPosition(e),!0}},{key:"tabClear",value:function(e){var t=e.params[0];return 0===t?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===t&&(this._activeBuffer.tabs={}),!0}},{key:"cursorForwardTab",value:function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}},{key:"cursorBackwardTab",value:function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}},{key:"selectProtected",value:function(e){var t=e.params[0];return 1===t&&(this._curAttrData.bg|=536870912),2!==t&&0!==t||(this._curAttrData.bg&=-536870913),!0}},{key:"_eraseInBufferLine",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);s.replaceCells(t,i,this._activeBuffer.getNullCell(this._eraseAttrData()),n),r&&(s.isWrapped=!1)}},{key:"_resetBufferLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i&&(i.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),i.isWrapped=!1)}},{key:"eraseInDisplay",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:for(t=this._activeBuffer.y,this._dirtyRowTracker.markDirty(t),this._eraseInBufferLine(t++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,i);t<this._bufferService.rows;t++)this._resetBufferLine(t,i);this._dirtyRowTracker.markDirty(t);break;case 1:for(t=this._activeBuffer.y,this._dirtyRowTracker.markDirty(t),this._eraseInBufferLine(t,0,this._activeBuffer.x+1,!0,i),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(t+1).isWrapped=!1);t--;)this._resetBufferLine(t,i);this._dirtyRowTracker.markDirty(0);break;case 2:for(t=this._bufferService.rows,this._dirtyRowTracker.markDirty(t-1);t--;)this._resetBufferLine(t,i);this._dirtyRowTracker.markDirty(0);break;case 3:var r=this._activeBuffer.lines.length-this._bufferService.rows;r>0&&(this._activeBuffer.lines.trimStart(r),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-r,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-r,0),this._onScroll.fire(0))}return!0}},{key:"eraseInLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}},{key:"insertLines",value:function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var i=this._activeBuffer.ybase+this._activeBuffer.y,r=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-r+1;t--;)this._activeBuffer.lines.splice(n-1,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}},{key:"deleteLines",value:function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;var i,r=this._activeBuffer.ybase+this._activeBuffer.y;for(i=this._bufferService.rows-1-this._activeBuffer.scrollBottom,i=this._bufferService.rows-1+this._activeBuffer.ybase-i;t--;)this._activeBuffer.lines.splice(r,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}},{key:"insertChars",value:function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}},{key:"deleteChars",value:function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}},{key:"scrollUp",value:function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"scrollDown",value:function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(f.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"scrollLeft",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"scrollRight",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"insertColumns",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"deleteColumns",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"eraseChars",value:function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}},{key:"repeatPrecedingCharacter",value:function(e){var t=this._parser.precedingJoinState;if(!t)return!0;for(var i=e.params[0]||1,r=S.UnicodeService.extractWidth(t),n=this._activeBuffer.x-r,s=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(n),o=new Uint32Array(s.length*i),a=0,c=0;c<s.length;){var l=s.codePointAt(c)||0;o[a++]=l,c+=l>65535?2:1}for(var h=a,u=1;u<i;++u)o.copyWithin(h,0,a),h+=a;return this.print(o,0,h),!0}},{key:"sendDeviceAttributesPrimary",value:function(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(o.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(o.C0.ESC+"[?6c")),!0}},{key:"sendDeviceAttributesSecondary",value:function(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(o.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(o.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(o.C0.ESC+"[>83;40003;0c")),!0}},{key:"_is",value:function(e){return 0===(this._optionsService.rawOptions.termName+"").indexOf(e)}},{key:"setMode",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}},{key:"setModePrivate",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,c.DEFAULT_CHARSET),this._charsetService.setgCharset(1,c.DEFAULT_CHARSET),this._charsetService.setgCharset(2,c.DEFAULT_CHARSET),this._charsetService.setgCharset(3,c.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}},{key:"resetMode",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}},{key:"resetModePrivate",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===e.params[t]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}},{key:"requestMode",value:function(e,t){var i,r,n=this._coreService.decPrivateModes,s=this._coreMouseService,a=s.activeProtocol,c=s.activeEncoding,l=this._coreService,h=this._bufferService,u=h.buffers,d=h.cols,f=u.active,v=u.alt,_=this._optionsService.rawOptions,g=function(e){return e?1:2},p=e.params[0];return i=p,r=t?2===p?4:4===p?g(l.modes.insertMode):12===p?3:20===p?g(_.convertEol):0:1===p?g(n.applicationCursorKeys):3===p?_.windowOptions.setWinLines?80===d?2:132===d?1:0:0:6===p?g(n.origin):7===p?g(n.wraparound):8===p?3:9===p?g("X10"===a):12===p?g(_.cursorBlink):25===p?g(!l.isCursorHidden):45===p?g(n.reverseWraparound):66===p?g(n.applicationKeypad):67===p?4:1e3===p?g("VT200"===a):1002===p?g("DRAG"===a):1003===p?g("ANY"===a):1004===p?g(n.sendFocus):1005===p?4:1006===p?g("SGR"===c):1015===p?4:1016===p?g("SGR_PIXELS"===c):1048===p?1:47===p||1047===p||1049===p?g(f===v):2004===p?g(n.bracketedPasteMode):0,l.triggerDataEvent("".concat(o.C0.ESC,"[").concat(t?"":"?").concat(i,";").concat(r,"$y")),!0}},{key:"_updateAttrColor",value:function(e,t,i,r,n){return 2===t?(e|=50331648,e&=-16777216,e|=m.AttributeData.fromColorRGB([i,r,n])):5===t&&(e&=-50331904,e|=33554432|255&i),e}},{key:"_extractColor",value:function(e,t,i){var r=[0,0,-1,0,0,0],n=0,s=0;do{if(r[s+n]=e.params[t+s],e.hasSubParams(t+s)){var o=e.getSubParams(t+s),a=0;do{5===r[1]&&(n=1),r[s+a+1+n]=o[a]}while(++a<o.length&&a+s+1+n<r.length);break}if(5===r[1]&&s+n>=2||2===r[1]&&s+n>=5)break;r[1]&&(n=1)}while(++s+t<e.length&&s+n<r.length);for(var c=2;c<r.length;++c)-1===r[c]&&(r[c]=0);switch(r[0]){case 38:i.fg=this._updateAttrColor(i.fg,r[1],r[3],r[4],r[5]);break;case 48:i.bg=this._updateAttrColor(i.bg,r[1],r[3],r[4],r[5]);break;case 58:i.extended=i.extended.clone(),i.extended.underlineColor=this._updateAttrColor(i.extended.underlineColor,r[1],r[3],r[4],r[5])}return s}},{key:"_processUnderline",value:function(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,0===e&&(t.fg&=-268435457),t.updateExtended()}},{key:"_processSGR0",value:function(e){e.fg=f.DEFAULT_ATTR_DATA.fg,e.bg=f.DEFAULT_ATTR_DATA.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}},{key:"charAttributes",value:function(e){if(1===e.length&&0===e.params[0])return this._processSGR0(this._curAttrData),!0;for(var t,i=e.length,r=this._curAttrData,n=0;n<i;n++)(t=e.params[n])>=30&&t<=37?(r.fg&=-50331904,r.fg|=16777216|t-30):t>=40&&t<=47?(r.bg&=-50331904,r.bg|=16777216|t-40):t>=90&&t<=97?(r.fg&=-50331904,r.fg|=16777224|t-90):t>=100&&t<=107?(r.bg&=-50331904,r.bg|=16777224|t-100):0===t?this._processSGR0(r):1===t?r.fg|=134217728:3===t?r.bg|=67108864:4===t?(r.fg|=268435456,this._processUnderline(e.hasSubParams(n)?e.getSubParams(n)[0]:1,r)):5===t?r.fg|=536870912:7===t?r.fg|=67108864:8===t?r.fg|=1073741824:9===t?r.fg|=2147483648:2===t?r.bg|=134217728:21===t?this._processUnderline(2,r):22===t?(r.fg&=-134217729,r.bg&=-134217729):23===t?r.bg&=-67108865:24===t?(r.fg&=-268435457,this._processUnderline(0,r)):25===t?r.fg&=-536870913:27===t?r.fg&=-67108865:28===t?r.fg&=-1073741825:29===t?r.fg&=2147483647:39===t?(r.fg&=-67108864,r.fg|=16777215&f.DEFAULT_ATTR_DATA.fg):49===t?(r.bg&=-67108864,r.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):38===t||48===t||58===t?n+=this._extractColor(e,n,r):53===t?r.bg|=1073741824:55===t?r.bg&=-1073741825:59===t?(r.extended=r.extended.clone(),r.extended.underlineColor=-1,r.updateExtended()):100===t?(r.fg&=-67108864,r.fg|=16777215&f.DEFAULT_ATTR_DATA.fg,r.bg&=-67108864,r.bg|=16777215&f.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",t);return!0}},{key:"deviceStatus",value:function(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent("".concat(o.C0.ESC,"[0n"));break;case 6:var t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent("".concat(o.C0.ESC,"[").concat(t,";").concat(i,"R"))}return!0}},{key:"deviceStatusPrivate",value:function(e){if(6===e.params[0]){var t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent("".concat(o.C0.ESC,"[?").concat(t,";").concat(i,"R"))}return!0}},{key:"softReset",value:function(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}},{key:"setCursorStyle",value:function(e){var t=e.params[0]||1;switch(t){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}var i=t%2==1;return this._optionsService.options.cursorBlink=i,!0}},{key:"setScrollRegion",value:function(e){var t,i=e.params[0]||1;return(e.length<2||(t=e.params[1])>this._bufferService.rows||0===t)&&(t=this._bufferService.rows),t>i&&(this._activeBuffer.scrollTop=i-1,this._activeBuffer.scrollBottom=t-1,this._setCursor(0,0)),!0}},{key:"windowOptions",value:function(e){if(!R(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;var t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:2!==t&&this._onRequestWindowsOptionsReport.fire(s.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(s.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent("".concat(o.C0.ESC,"[8;").concat(this._bufferService.rows,";").concat(this._bufferService.cols,"t"));break;case 22:0!==t&&2!==t||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==t&&1!==t||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==t&&2!==t||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==t&&1!==t||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}},{key:"saveCursor",value:function(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}},{key:"restoreCursor",value:function(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}},{key:"setTitle",value:function(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}},{key:"setIconName",value:function(e){return this._iconName=e,!0}},{key:"setOrReportIndexedColor",value:function(e){for(var t=[],i=e.split(";");i.length>1;){var r=i.shift(),n=i.shift();if(/^\d+$/.exec(r)){var s=parseInt(r);if(T(s))if("?"===n)t.push({type:0,index:s});else{var o=(0,L.parseColor)(n);o&&t.push({type:1,index:s,color:o})}}}return t.length&&this._onColor.fire(t),!0}},{key:"setHyperlink",value:function(e){var t=e.split(";");return!(t.length<2)&&(t[1]?this._createHyperlink(t[0],t[1]):!t[0]&&this._finishHyperlink())}},{key:"_createHyperlink",value:function(e,t){this._getCurrentLinkId()&&this._finishHyperlink();var i,r=e.split(":"),n=r.findIndex(function(e){return e.startsWith("id=")});return-1!==n&&(i=r[n].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:i,uri:t}),this._curAttrData.updateExtended(),!0}},{key:"_finishHyperlink",value:function(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}},{key:"_setOrReportSpecialColor",value:function(e,t){for(var i=e.split(";"),r=0;r<i.length&&!(t>=this._specialColors.length);++r,++t)if("?"===i[r])this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{var n=(0,L.parseColor)(i[r]);n&&this._onColor.fire([{type:1,index:this._specialColors[t],color:n}])}return!0}},{key:"setOrReportFgColor",value:function(e){return this._setOrReportSpecialColor(e,0)}},{key:"setOrReportBgColor",value:function(e){return this._setOrReportSpecialColor(e,1)}},{key:"setOrReportCursorColor",value:function(e){return this._setOrReportSpecialColor(e,2)}},{key:"restoreIndexedColor",value:function(e){if(!e)return this._onColor.fire([{type:2}]),!0;for(var t=[],i=e.split(";"),r=0;r<i.length;++r)if(/^\d+$/.exec(i[r])){var n=parseInt(i[r]);T(n)&&t.push({type:2,index:n})}return t.length&&this._onColor.fire(t),!0}},{key:"restoreFgColor",value:function(e){return this._onColor.fire([{type:2,index:256}]),!0}},{key:"restoreBgColor",value:function(e){return this._onColor.fire([{type:2,index:257}]),!0}},{key:"restoreCursorColor",value:function(e){return this._onColor.fire([{type:2,index:258}]),!0}},{key:"nextLine",value:function(){return this._activeBuffer.x=0,this.index(),!0}},{key:"keypadApplicationMode",value:function(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}},{key:"keypadNumericMode",value:function(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}},{key:"selectDefaultCharset",value:function(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,c.DEFAULT_CHARSET),!0}},{key:"selectCharset",value:function(e){return 2!==e.length?(this.selectDefaultCharset(),!0):("/"===e[0]||this._charsetService.setgCharset(x[e[0]],c.CHARSETS[e[1]]||c.DEFAULT_CHARSET),!0)}},{key:"index",value:function(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}},{key:"tabSet",value:function(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}},{key:"reverseIndex",value:function(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){var e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}},{key:"fullReset",value:function(){return this._parser.reset(),this._onRequestReset.fire(),!0}},{key:"reset",value:function(){this._curAttrData=f.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=f.DEFAULT_ATTR_DATA.clone()}},{key:"_eraseAttrData",value:function(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}},{key:"setgLevel",value:function(e){return this._charsetService.setgLevel(e),!0}},{key:"screenAlignmentPattern",value:function(){var e=new p.CellData;e.content=1<<22|"E".charCodeAt(0),e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(var t=0;t<this._bufferService.rows;++t){var i=this._activeBuffer.ybase+this._activeBuffer.y+t,r=this._activeBuffer.lines.get(i);r&&(r.fill(e),r.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}},{key:"requestStatusString",value:function(e,t){var i=this,r=this._bufferService.buffer,n=this._optionsService.rawOptions;return function(e){return i._coreService.triggerDataEvent("".concat(o.C0.ESC).concat(e).concat(o.C0.ESC,"\\")),!0}('"q'===e?"P1$r".concat(this._curAttrData.isProtected()?1:0,'"q'):'"p'===e?'P1$r61;1"p':"r"===e?"P1$r".concat(r.scrollTop+1,";").concat(r.scrollBottom+1,"r"):"m"===e?"P1$r0m":" q"===e?"P1$r".concat({block:2,underline:4,bar:6}[n.cursorStyle]-(n.cursorBlink?1:0)," q"):"P0$r")}},{key:"markRangeDirty",value:function(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}}])}(h.Disposable);t.InputHandler=A;var M=function(){function e(t){C(this,e),this._bufferService=t,this.clearRange()}return w(e,[{key:"clearRange",value:function(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}},{key:"markDirty",value:function(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}},{key:"markRangeDirty",value:function(e,t){e>t&&(D=e,e=t,t=D),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}},{key:"markAllDirty",value:function(){this.markRangeDirty(0,this._bufferService.rows-1)}}])}();function T(e){return 0<=e&&e<256}M=r([n(0,y.IBufferService)],M)},844:function(e,t){function i(e){var t,i=m(e);try{for(i.s();!(t=i.n()).done;)t.value.dispose()}catch(r){i.e(r)}finally{i.f()}e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=function(){function e(){C(this,e),this._disposables=[],this._isDisposed=!1}return w(e,[{key:"dispose",value:function(){this._isDisposed=!0;var e,t=m(this._disposables);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(i){t.e(i)}finally{t.f()}this._disposables.length=0}},{key:"register",value:function(e){return this._disposables.push(e),e}},{key:"unregister",value:function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}}])}(),t.MutableDisposable=function(){function e(){C(this,e),this._isDisposed=!1}return w(e,[{key:"value",get:function(){return this._isDisposed?void 0:this._value},set:function(e){var t;this._isDisposed||e===this._value||(null!==(t=this._value)&&void 0!==t&&t.dispose(),this._value=e)}},{key:"clear",value:function(){this.value=void 0}},{key:"dispose",value:function(){var e;this._isDisposed=!0,null!==(e=this._value)&&void 0!==e&&e.dispose(),this._value=void 0}}])}(),t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return i(e)}}}},1505:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;var i=function(){function e(){C(this,e),this._data={}}return w(e,[{key:"set",value:function(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}},{key:"get",value:function(e,t){return this._data[e]?this._data[e][t]:void 0}},{key:"clear",value:function(){this._data={}}}])}();t.TwoKeyMap=i,t.FourKeyMap=function(){function e(){C(this,e),this._data=new i}return w(e,[{key:"set",value:function(e,t,r,n,s){this._data.get(e,t)||this._data.set(e,t,new i),this._data.get(e,t).set(r,n,s)}},{key:"get",value:function(e,t,i,r){var n;return null===(n=this._data.get(e,t))||void 0===n?void 0:n.get(i,r)}},{key:"clear",value:function(){this._data.clear()}}])}()},6114:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"!=typeof process&&"title"in process;var i=t.isNode?"node":navigator.userAgent,r=t.isNode?"node":navigator.platform;t.isFirefox=i.includes("Firefox"),t.isLegacyEdge=i.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(i),t.getSafariVersion=function(){if(!t.isSafari)return 0;var e=i.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(r),t.isIpad="iPad"===r,t.isIphone="iPhone"===r,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(r),t.isLinux=r.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(i)},6106:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;var i=0;t.SortedList=function(){function e(t){C(this,e),this._getKey=t,this._array=[]}return w(e,[{key:"clear",value:function(){this._array.length=0}},{key:"insert",value:function(e){0!==this._array.length?(i=this._search(this._getKey(e)),this._array.splice(i,0,e)):this._array.push(e)}},{key:"delete",value:function(e){if(0===this._array.length)return!1;var t=this._getKey(e);if(void 0===t)return!1;if(-1===(i=this._search(t)))return!1;if(this._getKey(this._array[i])!==t)return!1;do{if(this._array[i]===e)return this._array.splice(i,1),!0}while(++i<this._array.length&&this._getKey(this._array[i])===t);return!1}},{key:"getKeyIterator",value:s().m(function e(t){return s().w(function(e){for(;;)switch(e.n){case 0:if(0===this._array.length||(i=this._search(t))<0||i>=this._array.length||this._getKey(this._array[i])!==t){e.n=3;break}case 1:return e.n=2,this._array[i];case 2:if(++i<this._array.length&&this._getKey(this._array[i])===t){e.n=1;break}case 3:return e.a(2)}},e,this)})},{key:"forEachByKey",value:function(e,t){if(0!==this._array.length&&!((i=this._search(e))<0||i>=this._array.length)&&this._getKey(this._array[i])===e)do{t(this._array[i])}while(++i<this._array.length&&this._getKey(this._array[i])===e)}},{key:"values",value:function(){return c(this._array).values()}},{key:"_search",value:function(e){for(var t=0,i=this._array.length-1;i>=t;){var r=t+i>>1,n=this._getKey(this._array[r]);if(n>e)i=r-1;else{if(!(n<e)){for(;r>0&&this._getKey(this._array[r-1])===e;)r--;return r}t=r+1}}return t}}])}()},7226:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;var r=i(6114),n=function(){function e(){C(this,e),this._tasks=[],this._i=0}return w(e,[{key:"enqueue",value:function(e){this._tasks.push(e),this._start()}},{key:"flush",value:function(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}},{key:"clear",value:function(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}},{key:"_start",value:function(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}},{key:"_process",value:function(e){this._idleCallback=void 0;var t=0,i=0;for(e.timeRemaining();this._i<this._tasks.length;)if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),1.5*(i=Math.max(t,i))>e.timeRemaining())return void this._start();this.clear()}}])}(),s=function(e){function t(){return C(this,t),d(this,t,arguments)}return g(t,e),w(t,[{key:"_requestCallback",value:function(e){var t=this;return setTimeout(function(){return e(t._createDeadline(16))})}},{key:"_cancelCallback",value:function(e){clearTimeout(e)}},{key:"_createDeadline",value:function(e){var t=Date.now()+e;return{timeRemaining:function(){return Math.max(0,t-Date.now())}}}}])}(n);t.PriorityTaskQueue=s,t.IdleTaskQueue=!r.isNode&&"requestIdleCallback"in window?function(e){function t(){return C(this,t),d(this,t,arguments)}return g(t,e),w(t,[{key:"_requestCallback",value:function(e){return requestIdleCallback(e)}},{key:"_cancelCallback",value:function(e){cancelIdleCallback(e)}}])}(n):s,t.DebouncedIdleTask=function(){function e(){C(this,e),this._queue=new t.IdleTaskQueue}return w(e,[{key:"set",value:function(e){this._queue.clear(),this._queue.enqueue(e)}},{key:"flush",value:function(){this._queue.flush()}}])}()},9282:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;var r=i(643);t.updateWindowsModeWrappedState=function(e){var t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1),i=null==t?void 0:t.get(e.cols-1),n=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);n&&i&&(n.isWrapped=i[r.CHAR_DATA_CODE_INDEX]!==r.NULL_CELL_CODE&&i[r.CHAR_DATA_CODE_INDEX]!==r.WHITESPACE_CELL_CODE)}},3734:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var i=function(){function e(){C(this,e),this.fg=0,this.bg=0,this.extended=new r}return w(e,[{key:"clone",value:function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}},{key:"isInverse",value:function(){return 67108864&this.fg}},{key:"isBold",value:function(){return 134217728&this.fg}},{key:"isUnderline",value:function(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}},{key:"isBlink",value:function(){return 536870912&this.fg}},{key:"isInvisible",value:function(){return 1073741824&this.fg}},{key:"isItalic",value:function(){return 67108864&this.bg}},{key:"isDim",value:function(){return 134217728&this.bg}},{key:"isStrikethrough",value:function(){return 2147483648&this.fg}},{key:"isProtected",value:function(){return 536870912&this.bg}},{key:"isOverline",value:function(){return 1073741824&this.bg}},{key:"getFgColorMode",value:function(){return 50331648&this.fg}},{key:"getBgColorMode",value:function(){return 50331648&this.bg}},{key:"isFgRGB",value:function(){return!(50331648&~this.fg)}},{key:"isBgRGB",value:function(){return!(50331648&~this.bg)}},{key:"isFgPalette",value:function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}},{key:"isBgPalette",value:function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}},{key:"isFgDefault",value:function(){return!(50331648&this.fg)}},{key:"isBgDefault",value:function(){return!(50331648&this.bg)}},{key:"isAttributeDefault",value:function(){return 0===this.fg&&0===this.bg}},{key:"getFgColor",value:function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}},{key:"getBgColor",value:function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}},{key:"hasExtendedAttrs",value:function(){return 268435456&this.bg}},{key:"updateExtended",value:function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}},{key:"getUnderlineColor",value:function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}},{key:"getUnderlineColorMode",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}},{key:"isUnderlineColorRGB",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&~this.extended.underlineColor):this.isFgRGB()}},{key:"isUnderlineColorPalette",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}},{key:"isUnderlineColorDefault",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&this.extended.underlineColor):this.isFgDefault()}},{key:"getUnderlineStyle",value:function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}},{key:"getUnderlineVariantOffset",value:function(){return this.extended.underlineVariantOffset}}],[{key:"toColorRGB",value:function(e){return[e>>>16&255,e>>>8&255,255&e]}},{key:"fromColorRGB",value:function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}}])}();t.AttributeData=i;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;C(this,e),this._ext=0,this._urlId=0,this._ext=t,this._urlId=i}return w(e,[{key:"ext",get:function(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext},set:function(e){this._ext=e}},{key:"underlineStyle",get:function(){return this._urlId?5:(469762048&this._ext)>>26},set:function(e){this._ext&=-469762049,this._ext|=e<<26&469762048}},{key:"underlineColor",get:function(){return 67108863&this._ext},set:function(e){this._ext&=-67108864,this._ext|=67108863&e}},{key:"urlId",get:function(){return this._urlId},set:function(e){this._urlId=e}},{key:"underlineVariantOffset",get:function(){var e=(3758096384&this._ext)>>29;return e<0?4294967288^e:e},set:function(e){this._ext&=536870911,this._ext|=e<<29&3758096384}},{key:"clone",value:function(){return new e(this._ext,this._urlId)}},{key:"isEmpty",value:function(){return 0===this.underlineStyle&&0===this._urlId}}])}();t.ExtendedAttrs=r},9092:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;var r=i(6349),n=i(7226),s=i(3734),o=i(8437),a=i(4634),c=i(511),l=i(643),h=i(4863),u=i(7116);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=function(){function e(t,i,s){C(this,e),this._hasScrollback=t,this._optionsService=i,this._bufferService=s,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=o.DEFAULT_ATTR_DATA.clone(),this.savedCharset=u.DEFAULT_CHARSET,this.markers=[],this._nullCell=c.CellData.fromCharData([0,l.NULL_CELL_CHAR,l.NULL_CELL_WIDTH,l.NULL_CELL_CODE]),this._whitespaceCell=c.CellData.fromCharData([0,l.WHITESPACE_CELL_CHAR,l.WHITESPACE_CELL_WIDTH,l.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new n.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new r.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}return w(e,[{key:"getNullCell",value:function(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new s.ExtendedAttrs),this._nullCell}},{key:"getWhitespaceCell",value:function(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new s.ExtendedAttrs),this._whitespaceCell}},{key:"getBlankLine",value:function(e,t){return new o.BufferLine(this._bufferService.cols,this.getNullCell(e),t)}},{key:"hasScrollback",get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows}},{key:"isCursorInViewport",get:function(){var e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}},{key:"_getCorrectBufferLength",value:function(e){if(!this._hasScrollback)return e;var i=e+this._optionsService.rawOptions.scrollback;return i>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:i}},{key:"fillViewportRows",value:function(e){if(0===this.lines.length){void 0===e&&(e=o.DEFAULT_ATTR_DATA);for(var t=this._rows;t--;)this.lines.push(this.getBlankLine(e))}}},{key:"clear",value:function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new r.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}},{key:"resize",value:function(e,t){var i=this,r=this.getNullCell(o.DEFAULT_ATTR_DATA),n=0,s=this._getCorrectBufferLength(t);if(s>this.lines.maxLength&&(this.lines.maxLength=s),this.lines.length>0){if(this._cols<e)for(var a=0;a<this.lines.length;a++)n+=+this.lines.get(a).resize(e,r);var c=0;if(this._rows<t)for(var l=this._rows;l<t;l++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||void 0!==this._optionsService.rawOptions.windowsPty.backend||void 0!==this._optionsService.rawOptions.windowsPty.buildNumber?this.lines.push(new o.BufferLine(e,r)):this.ybase>0&&this.lines.length<=this.ybase+this.y+c+1?(this.ybase--,c++,this.ydisp>0&&this.ydisp--):this.lines.push(new o.BufferLine(e,r)));else for(var h=this._rows;h>t;h--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(s<this.lines.maxLength){var u=this.lines.length-s;u>0&&(this.lines.trimStart(u),this.ybase=Math.max(this.ybase-u,0),this.ydisp=Math.max(this.ydisp-u,0),this.savedY=Math.max(this.savedY-u,0)),this.lines.maxLength=s}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),c&&(this.y+=c),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(var d=0;d<this.lines.length;d++)n+=+this.lines.get(d).resize(e,r);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),n>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(function(){return i._batchedMemoryCleanup()}))}},{key:"_batchedMemoryCleanup",value:function(){var e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);for(var t=0;this._memoryCleanupPosition<this.lines.length;)if((t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory())>100)return!0;return e}},{key:"_isReflowEnabled",get:function(){var e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&"conpty"===e.backend&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}},{key:"_reflow",value:function(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}},{key:"_reflowLarger",value:function(e,t){var i=(0,a.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(o.DEFAULT_ATTR_DATA));if(i.length>0){var r=(0,a.reflowLargerCreateNewLayout)(this.lines,i);(0,a.reflowLargerApplyNewLayout)(this.lines,r.layout),this._reflowLargerAdjustViewport(e,t,r.countRemoved)}}},{key:"_reflowLargerAdjustViewport",value:function(e,t,i){for(var r=this.getNullCell(o.DEFAULT_ATTR_DATA),n=i;n-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new o.BufferLine(e,r))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)}},{key:"_reflowSmaller",value:function(e,t){for(var i=this.getNullCell(o.DEFAULT_ATTR_DATA),r=[],n=0,s=this.lines.length-1;s>=0;s--){var c=this.lines.get(s);if(!(!c||!c.isWrapped&&c.getTrimmedLength()<=e)){for(var l=[c];c.isWrapped&&s>0;)c=this.lines.get(--s),l.unshift(c);var h=this.ybase+this.y;if(!(h>=s&&h<s+l.length)){var u=l[l.length-1].getTrimmedLength(),d=(0,a.reflowSmallerGetNewLineLengths)(l,this._cols,e),f=d.length-l.length,v=void 0;v=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+f):Math.max(0,this.lines.length-this.lines.maxLength+f);for(var _=[],g=0;g<f;g++){var p=this.getBlankLine(o.DEFAULT_ATTR_DATA,!0);_.push(p)}_.length>0&&(r.push({start:s+l.length+n,newLines:_}),n+=_.length),l.push.apply(l,_);var m=d.length-1,y=d[m];0===y&&(y=d[--m]);for(var S=l.length-f-1,C=u;S>=0;){var b=Math.min(C,y);if(void 0===l[m])break;if(l[m].copyCellsFrom(l[S],C-b,y-b,b,!0),0===(y-=b)&&(y=d[--m]),0===(C-=b)){S--;var w=Math.max(S,0);C=(0,a.getWrappedLineTrimmedLength)(l,w,this._cols)}}for(var k=0;k<l.length;k++)d[k]<e&&l[k].setCell(d[k],i);for(var L=f-v;L-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+n)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+f,this.ybase+t-1)}}}if(r.length>0){for(var x=[],E=[],R=0;R<this.lines.length;R++)E.push(this.lines.get(R));var D=this.lines.length,A=D-1,M=0,T=r[M];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+n);for(var B=0,O=Math.min(this.lines.maxLength-1,D+n-1);O>=0;O--)if(T&&T.start>A+B){for(var P=T.newLines.length-1;P>=0;P--)this.lines.set(O--,T.newLines[P]);O++,x.push({index:A+1,amount:T.newLines.length}),B+=T.newLines.length,T=r[++M]}else this.lines.set(O,E[A--]);for(var I=0,H=x.length-1;H>=0;H--)x[H].index+=I,this.lines.onInsertEmitter.fire(x[H]),I+=x[H].amount;var F=Math.max(0,D+n-this.lines.maxLength);F>0&&this.lines.onTrimEmitter.fire(F)}}},{key:"translateBufferLineToString",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,n=this.lines.get(e);return n?n.translateToString(t,i,r):""}},{key:"getWrappedRangeForLine",value:function(e){for(var t=e,i=e;t>0&&this.lines.get(t).isWrapped;)t--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:t,last:i}}},{key:"setupTabStops",value:function(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}},{key:"prevStop",value:function(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}},{key:"nextStop",value:function(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}},{key:"clearMarkers",value:function(e){this._isClearing=!0;for(var t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}},{key:"clearAllMarkers",value:function(){this._isClearing=!0;for(var e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1}},{key:"addMarker",value:function(e){var t=this,i=new h.Marker(e);return this.markers.push(i),i.register(this.lines.onTrim(function(e){i.line-=e,i.line<0&&i.dispose()})),i.register(this.lines.onInsert(function(e){i.line>=e.index&&(i.line+=e.amount)})),i.register(this.lines.onDelete(function(e){i.line>=e.index&&i.line<e.index+e.amount&&i.dispose(),i.line>e.index&&(i.line-=e.amount)})),i.register(i.onDispose(function(){return t._removeMarker(i)})),i}},{key:"_removeMarker",value:function(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}}])}()},8437:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;var r=i(3734),n=i(511),s=i(643),o=i(482);t.DEFAULT_ATTR_DATA=Object.freeze(new r.AttributeData);var a=0,c=function(){function e(t,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];C(this,e),this.isWrapped=r,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);for(var o=i||n.CellData.fromCharData([0,s.NULL_CELL_CHAR,s.NULL_CELL_WIDTH,s.NULL_CELL_CODE]),a=0;a<t;++a)this.setCell(a,o);this.length=t}return w(e,[{key:"get",value:function(e){var t=this._data[3*e+0],i=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:i?(0,o.stringFromCodePoint)(i):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):i]}},{key:"set",value:function(e,t){this._data[3*e+1]=t[s.CHAR_DATA_ATTR_INDEX],t[s.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[s.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[s.CHAR_DATA_WIDTH_INDEX]<<22}},{key:"getWidth",value:function(e){return this._data[3*e+0]>>22}},{key:"hasWidth",value:function(e){return 12582912&this._data[3*e+0]}},{key:"getFg",value:function(e){return this._data[3*e+1]}},{key:"getBg",value:function(e){return this._data[3*e+2]}},{key:"hasContent",value:function(e){return 4194303&this._data[3*e+0]}},{key:"getCodePoint",value:function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t}},{key:"isCombined",value:function(e){return 2097152&this._data[3*e+0]}},{key:"getString",value:function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?(0,o.stringFromCodePoint)(2097151&t):""}},{key:"isProtected",value:function(e){return 536870912&this._data[3*e+2]}},{key:"loadCell",value:function(e,t){return a=3*e,t.content=this._data[a+0],t.fg=this._data[a+1],t.bg=this._data[a+2],2097152&t.content&&(t.combinedData=this._combined[e]),268435456&t.bg&&(t.extended=this._extendedAttrs[e]),t}},{key:"setCell",value:function(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[e]=t.extended),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg}},{key:"setCellFromCodepoint",value:function(e,t,i,r){268435456&r.bg&&(this._extendedAttrs[e]=r.extended),this._data[3*e+0]=t|i<<22,this._data[3*e+1]=r.fg,this._data[3*e+2]=r.bg}},{key:"addCodepointToCell",value:function(e,t,i){var r=this._data[3*e+0];2097152&r?this._combined[e]+=(0,o.stringFromCodePoint)(t):2097151&r?(this._combined[e]=(0,o.stringFromCodePoint)(2097151&r)+(0,o.stringFromCodePoint)(t),r&=-2097152,r|=2097152):r=t|1<<22,i&&(r&=-12582913,r|=i<<22),this._data[3*e+0]=r}},{key:"insertCells",value:function(e,t,i){if((e%=this.length)&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length-e){for(var r=new n.CellData,s=this.length-e-t-1;s>=0;--s)this.setCell(e+t+s,this.loadCell(e+s,r));for(var o=0;o<t;++o)this.setCell(e+o,i)}else for(var a=e;a<this.length;++a)this.setCell(a,i);2===this.getWidth(this.length-1)&&this.setCellFromCodepoint(this.length-1,0,1,i)}},{key:"deleteCells",value:function(e,t,i){if(e%=this.length,t<this.length-e){for(var r=new n.CellData,s=0;s<this.length-e-t;++s)this.setCell(e+s,this.loadCell(e+t+s,r));for(var o=this.length-t;o<this.length;++o)this.setCell(o,i)}else for(var a=e;a<this.length;++a)this.setCell(a,i);e&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),0!==this.getWidth(e)||this.hasContent(e)||this.setCellFromCodepoint(e,0,1,i)}},{key:"replaceCells",value:function(e,t,i){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3])for(e&&2===this.getWidth(e-1)&&!this.isProtected(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length&&2===this.getWidth(t-1)&&!this.isProtected(t)&&this.setCellFromCodepoint(t,0,1,i);e<t&&e<this.length;)this.isProtected(e)||this.setCell(e,i),e++;else for(e&&2===this.getWidth(e-1)&&this.setCellFromCodepoint(e-1,0,1,i),t<this.length&&2===this.getWidth(t-1)&&this.setCellFromCodepoint(t,0,1,i);e<t&&e<this.length;)this.setCell(e++,i)}},{key:"resize",value:function(e,t){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;var i=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*i)this._data=new Uint32Array(this._data.buffer,0,i);else{var r=new Uint32Array(i);r.set(this._data),this._data=r}for(var n=this.length;n<e;++n)this.setCell(n,t)}else{this._data=this._data.subarray(0,i);for(var s=Object.keys(this._combined),o=0;o<s.length;o++){var a=parseInt(s[o],10);a>=e&&delete this._combined[a]}for(var c=Object.keys(this._extendedAttrs),l=0;l<c.length;l++){var h=parseInt(c[l],10);h>=e&&delete this._extendedAttrs[h]}}return this.length=e,4*i*2<this._data.buffer.byteLength}},{key:"cleanupMemory",value:function(){if(4*this._data.length*2<this._data.buffer.byteLength){var e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}},{key:"fill",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])for(var t=0;t<this.length;++t)this.isProtected(t)||this.setCell(t,e);else{this._combined={},this._extendedAttrs={};for(var i=0;i<this.length;++i)this.setCell(i,e)}}},{key:"copyFrom",value:function(e){for(var t in this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={},e._combined)this._combined[t]=e._combined[t];for(var i in this._extendedAttrs={},e._extendedAttrs)this._extendedAttrs[i]=e._extendedAttrs[i];this.isWrapped=e.isWrapped}},{key:"clone",value:function(){var t=new e(0);for(var i in t._data=new Uint32Array(this._data),t.length=this.length,this._combined)t._combined[i]=this._combined[i];for(var r in this._extendedAttrs)t._extendedAttrs[r]=this._extendedAttrs[r];return t.isWrapped=this.isWrapped,t}},{key:"getTrimmedLength",value:function(){for(var e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}},{key:"getNoBgTrimmedLength",value:function(){for(var e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0]||50331648&this._data[3*e+2])return e+(this._data[3*e+0]>>22);return 0}},{key:"copyCellsFrom",value:function(e,t,i,r,n){var s=e._data;if(n)for(var o=r-1;o>=0;o--){for(var a=0;a<3;a++)this._data[3*(i+o)+a]=s[3*(t+o)+a];268435456&s[3*(t+o)+2]&&(this._extendedAttrs[i+o]=e._extendedAttrs[t+o])}else for(var c=0;c<r;c++){for(var l=0;l<3;l++)this._data[3*(i+c)+l]=s[3*(t+c)+l];268435456&s[3*(t+c)+2]&&(this._extendedAttrs[i+c]=e._extendedAttrs[t+c])}for(var h=Object.keys(e._combined),u=0;u<h.length;u++){var d=parseInt(h[u],10);d>=t&&(this._combined[d-t+i]=e._combined[d])}}},{key:"translateToString",value:function(e,t,i,r){t=null!=t?t:0,i=null!=i?i:this.length,e&&(i=Math.min(i,this.getTrimmedLength())),r&&(r.length=0);for(var n="";t<i;){var a=this._data[3*t+0],c=2097151&a,l=2097152&a?this._combined[t]:c?(0,o.stringFromCodePoint)(c):s.WHITESPACE_CELL_CHAR;if(n+=l,r)for(var h=0;h<l.length;++h)r.push(t);t+=a>>22||1}return r&&r.push(t),n}}])}();t.BufferLine=c},4841:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(e,t){if(e.start.y>e.end.y)throw new Error("Buffer range end (".concat(e.end.x,", ").concat(e.end.y,") cannot be before start (").concat(e.start.x,", ").concat(e.start.y,")"));return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}},4634:function(e,t){function i(e,t,i){if(t===e.length-1)return e[t].getTrimmedLength();var r=!e[t].hasContent(i-1)&&1===e[t].getWidth(i-1),n=2===e[t+1].getWidth(0);return r&&n?i-1:i}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(e,t,r,n,s){for(var o=[],a=0;a<e.length-1;a++){var c=a,l=e.get(++c);if(l.isWrapped){for(var h=[e.get(a)];c<e.length&&l.isWrapped;)h.push(l),l=e.get(++c);if(n>=a&&n<c)a+=h.length-1;else{for(var u=0,d=i(h,u,t),f=1,v=0;f<h.length;){var _=i(h,f,t),g=_-v,p=r-d,m=Math.min(g,p);h[u].copyCellsFrom(h[f],v,d,m,!1),(d+=m)===r&&(u++,d=0),(v+=m)===_&&(f++,v=0),0===d&&0!==u&&2===h[u-1].getWidth(r-1)&&(h[u].copyCellsFrom(h[u-1],r-1,d++,1,!1),h[u-1].setCell(r-1,s))}h[u].replaceCells(d,r,s);for(var y=0,S=h.length-1;S>0&&(S>u||0===h[S].getTrimmedLength());S--)y++;y>0&&(o.push(a+h.length-y),o.push(y)),a+=h.length-1}}}return o},t.reflowLargerCreateNewLayout=function(e,t){for(var i=[],r=0,n=t[r],s=0,o=0;o<e.length;o++)if(n===o){var a=t[++r];e.onDeleteEmitter.fire({index:o-s,amount:a}),o+=a-1,s+=a,n=t[++r]}else i.push(o);return{layout:i,countRemoved:s}},t.reflowLargerApplyNewLayout=function(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.get(t[r]));for(var n=0;n<i.length;n++)e.set(n,i[n]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,r){for(var n=[],s=e.map(function(r,n){return i(e,n,t)}).reduce(function(e,t){return e+t}),o=0,a=0,c=0;c<s;){if(s-c<r){n.push(s-c);break}o+=r;var l=i(e,a,t);o>l&&(o-=l,a++);var h=2===e[a].getWidth(o-1);h&&o--;var u=h?r-1:r;n.push(u),c+=u}return n},t.getWrappedLineTrimmedLength=i},5295:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;var r=i(8460),n=i(844),s=i(9092),o=function(e){function t(e,i){var n;return C(this,t),(n=d(this,t))._optionsService=e,n._bufferService=i,n._onBufferActivate=n.register(new r.EventEmitter),n.onBufferActivate=n._onBufferActivate.event,n.reset(),n.register(n._optionsService.onSpecificOptionChange("scrollback",function(){return n.resize(n._bufferService.cols,n._bufferService.rows)})),n.register(n._optionsService.onSpecificOptionChange("tabStopWidth",function(){return n.setupTabStops()})),n}return g(t,e),w(t,[{key:"reset",value:function(){this._normal=new s.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new s.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}},{key:"alt",get:function(){return this._alt}},{key:"active",get:function(){return this._activeBuffer}},{key:"normal",get:function(){return this._normal}},{key:"activateNormalBuffer",value:function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}},{key:"activateAltBuffer",value:function(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}},{key:"resize",value:function(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}},{key:"setupTabStops",value:function(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}}])}(n.Disposable);t.BufferSet=o},511:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var r=i(482),n=i(643),s=i(3734),o=function(e){function t(){var e;return C(this,t),(e=d(this,t,arguments)).content=0,e.fg=0,e.bg=0,e.extended=new s.ExtendedAttrs,e.combinedData="",e}return g(t,e),w(t,[{key:"isCombined",value:function(){return 2097152&this.content}},{key:"getWidth",value:function(){return this.content>>22}},{key:"getChars",value:function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,r.stringFromCodePoint)(2097151&this.content):""}},{key:"getCode",value:function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}},{key:"setFromCharData",value:function(e){this.fg=e[n.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[n.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[n.CHAR_DATA_CHAR_INDEX].length){var i=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var r=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(i-55296)+r-56320+65536|e[n.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[n.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[n.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[n.CHAR_DATA_WIDTH_INDEX]<<22)}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}],[{key:"fromCharData",value:function(e){var i=new t;return i.setFromCharData(e),i}}])}(s.AttributeData);t.CellData=o},643:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;var r=i(8460),n=i(844),s=function(){function e(t){C(this,e),this.line=t,this.isDisposed=!1,this._disposables=[],this._id=e._nextId++,this._onDispose=this.register(new r.EventEmitter),this.onDispose=this._onDispose.event}return w(e,[{key:"id",get:function(){return this._id}},{key:"dispose",value:function(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,n.disposeArray)(this._disposables),this._disposables.length=0)}},{key:"register",value:function(e){return this._disposables.push(e),e}}])}();t.Marker=s,s._nextId=1},7116:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},t.CHARSETS.A={"#":"£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},t.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},t.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},t.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},t.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},t.CHARSETS.H=t.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:function(e,t){var i,r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(e){e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="",e.BS="\b",e.HT="\t",e.LF="\n",e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""}(i||(t.C0=i={})),function(e){e.PAD="",e.HOP="",e.BPH="",e.NBH="",e.IND="",e.NEL="",e.SSA="",e.ESA="",e.HTS="",e.HTJ="",e.VTS="",e.PLD="",e.PLU="",e.RI="",e.SS2="",e.SS3="",e.DCS="",e.PU1="",e.PU2="",e.STS="",e.CCH="",e.MW="",e.SPA="",e.EPA="",e.SOS="",e.SGCI="",e.SCI="",e.CSI="",e.ST="",e.OSC="",e.PM="",e.APC=""}(r||(t.C1=r={})),function(e){e.ST="".concat(i.ESC,"\\")}(n||(t.C1_ESCAPED=n={}))},7399:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;var r=i(2584),n={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,i,s){var o={type:0,cancel:!1,key:void 0},a=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?o.key=t?r.C0.ESC+"OA":r.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?o.key=t?r.C0.ESC+"OD":r.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?o.key=t?r.C0.ESC+"OC":r.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(o.key=t?r.C0.ESC+"OB":r.C0.ESC+"[B");break;case 8:o.key=e.ctrlKey?"\b":r.C0.DEL,e.altKey&&(o.key=r.C0.ESC+o.key);break;case 9:if(e.shiftKey){o.key=r.C0.ESC+"[Z";break}o.key=r.C0.HT,o.cancel=!0;break;case 13:o.key=e.altKey?r.C0.ESC+r.C0.CR:r.C0.CR,o.cancel=!0;break;case 27:o.key=r.C0.ESC,e.altKey&&(o.key=r.C0.ESC+r.C0.ESC),o.cancel=!0;break;case 37:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"D",o.key===r.C0.ESC+"[1;3D"&&(o.key=r.C0.ESC+(i?"b":"[1;5D"))):o.key=t?r.C0.ESC+"OD":r.C0.ESC+"[D";break;case 39:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"C",o.key===r.C0.ESC+"[1;3C"&&(o.key=r.C0.ESC+(i?"f":"[1;5C"))):o.key=t?r.C0.ESC+"OC":r.C0.ESC+"[C";break;case 38:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"A",i||o.key!==r.C0.ESC+"[1;3A"||(o.key=r.C0.ESC+"[1;5A")):o.key=t?r.C0.ESC+"OA":r.C0.ESC+"[A";break;case 40:if(e.metaKey)break;a?(o.key=r.C0.ESC+"[1;"+(a+1)+"B",i||o.key!==r.C0.ESC+"[1;3B"||(o.key=r.C0.ESC+"[1;5B")):o.key=t?r.C0.ESC+"OB":r.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(o.key=r.C0.ESC+"[2~");break;case 46:o.key=a?r.C0.ESC+"[3;"+(a+1)+"~":r.C0.ESC+"[3~";break;case 36:o.key=a?r.C0.ESC+"[1;"+(a+1)+"H":t?r.C0.ESC+"OH":r.C0.ESC+"[H";break;case 35:o.key=a?r.C0.ESC+"[1;"+(a+1)+"F":t?r.C0.ESC+"OF":r.C0.ESC+"[F";break;case 33:e.shiftKey?o.type=2:e.ctrlKey?o.key=r.C0.ESC+"[5;"+(a+1)+"~":o.key=r.C0.ESC+"[5~";break;case 34:e.shiftKey?o.type=3:e.ctrlKey?o.key=r.C0.ESC+"[6;"+(a+1)+"~":o.key=r.C0.ESC+"[6~";break;case 112:o.key=a?r.C0.ESC+"[1;"+(a+1)+"P":r.C0.ESC+"OP";break;case 113:o.key=a?r.C0.ESC+"[1;"+(a+1)+"Q":r.C0.ESC+"OQ";break;case 114:o.key=a?r.C0.ESC+"[1;"+(a+1)+"R":r.C0.ESC+"OR";break;case 115:o.key=a?r.C0.ESC+"[1;"+(a+1)+"S":r.C0.ESC+"OS";break;case 116:o.key=a?r.C0.ESC+"[15;"+(a+1)+"~":r.C0.ESC+"[15~";break;case 117:o.key=a?r.C0.ESC+"[17;"+(a+1)+"~":r.C0.ESC+"[17~";break;case 118:o.key=a?r.C0.ESC+"[18;"+(a+1)+"~":r.C0.ESC+"[18~";break;case 119:o.key=a?r.C0.ESC+"[19;"+(a+1)+"~":r.C0.ESC+"[19~";break;case 120:o.key=a?r.C0.ESC+"[20;"+(a+1)+"~":r.C0.ESC+"[20~";break;case 121:o.key=a?r.C0.ESC+"[21;"+(a+1)+"~":r.C0.ESC+"[21~";break;case 122:o.key=a?r.C0.ESC+"[23;"+(a+1)+"~":r.C0.ESC+"[23~";break;case 123:o.key=a?r.C0.ESC+"[24;"+(a+1)+"~":r.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(i&&!s||!e.altKey||e.metaKey)!i||e.altKey||e.ctrlKey||e.shiftKey||!e.metaKey?e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?o.key=e.key:e.key&&e.ctrlKey&&("_"===e.key&&(o.key=r.C0.US),"@"===e.key&&(o.key=r.C0.NUL)):65===e.keyCode&&(o.type=1);else{var c=n[e.keyCode],l=null==c?void 0:c[e.shiftKey?1:0];if(l)o.key=r.C0.ESC+l;else if(e.keyCode>=65&&e.keyCode<=90){var h=e.ctrlKey?e.keyCode-64:e.keyCode+32,u=String.fromCharCode(h);e.shiftKey&&(u=u.toUpperCase()),o.key=r.C0.ESC+u}else if(32===e.keyCode)o.key=r.C0.ESC+(e.ctrlKey?r.C0.NUL:" ");else if("Dead"===e.key&&e.code.startsWith("Key")){var d=e.code.slice(3,4);e.shiftKey||(d=d.toLowerCase()),o.key=r.C0.ESC+d,o.cancel=!0}}else e.keyCode>=65&&e.keyCode<=90?o.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?o.key=r.C0.NUL:e.keyCode>=51&&e.keyCode<=55?o.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?o.key=r.C0.DEL:219===e.keyCode?o.key=r.C0.ESC:220===e.keyCode?o.key=r.C0.FS:221===e.keyCode&&(o.key=r.C0.GS)}return o}},482:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,r="",n=t;n<i;++n){var s=e[n];s>65535?(s-=65536,r+=String.fromCharCode(55296+(s>>10))+String.fromCharCode(s%1024+56320)):r+=String.fromCharCode(s)}return r},t.StringToUtf32=function(){function e(){C(this,e),this._interim=0}return w(e,[{key:"clear",value:function(){this._interim=0}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r=0,n=0;if(this._interim){var s=e.charCodeAt(n++);56320<=s&&s<=57343?t[r++]=1024*(this._interim-55296)+s-56320+65536:(t[r++]=this._interim,t[r++]=s),this._interim=0}for(var o=n;o<i;++o){var a=e.charCodeAt(o);if(55296<=a&&a<=56319){if(++o>=i)return this._interim=a,r;var c=e.charCodeAt(o);56320<=c&&c<=57343?t[r++]=1024*(a-55296)+c-56320+65536:(t[r++]=a,t[r++]=c)}else 65279!==a&&(t[r++]=a)}return r}}])}(),t.Utf8ToUtf32=function(){function e(){C(this,e),this.interim=new Uint8Array(3)}return w(e,[{key:"clear",value:function(){this.interim.fill(0)}},{key:"decode",value:function(e,t){var i=e.length;if(!i)return 0;var r,n,s,o,a=0,c=0,l=0;if(this.interim[0]){var h=!1,u=this.interim[0];u&=192==(224&u)?31:224==(240&u)?15:7;for(var d,f=0;(d=63&this.interim[++f])&&f<4;)u<<=6,u|=d;for(var v=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,_=v-f;l<_;){if(l>=i)return 0;if(128!=(192&(d=e[l++]))){l--,h=!0;break}this.interim[f++]=d,u<<=6,u|=63&d}h||(2===v?u<128?l--:t[a++]=u:3===v?u<2048||u>=55296&&u<=57343||65279===u||(t[a++]=u):u<65536||u>1114111||(t[a++]=u)),this.interim.fill(0)}for(var g=i-4,p=l;p<i;){for(;!(!(p<g)||128&(r=e[p])||128&(n=e[p+1])||128&(s=e[p+2])||128&(o=e[p+3]));)t[a++]=r,t[a++]=n,t[a++]=s,t[a++]=o,p+=4;if((r=e[p++])<128)t[a++]=r;else if(192==(224&r)){if(p>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[p++]))){p--;continue}if((c=(31&r)<<6|63&n)<128){p--;continue}t[a++]=c}else if(224==(240&r)){if(p>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(s=e[p++]))){p--;continue}if((c=(15&r)<<12|(63&n)<<6|63&s)<2048||c>=55296&&c<=57343||65279===c)continue;t[a++]=c}else if(240==(248&r)){if(p>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(s=e[p++]))){p--;continue}if(p>=i)return this.interim[0]=r,this.interim[1]=n,this.interim[2]=s,a;if(128!=(192&(o=e[p++]))){p--;continue}if((c=(7&r)<<18|(63&n)<<12|(63&s)<<6|63&o)<65536||c>1114111)continue;t[a++]=c}}return a}}])}()},225:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;var r,n=i(1480),s=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],o=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];t.UnicodeV6=function(){function e(){if(C(this,e),this.version="6",!r){(r=new Uint8Array(65536)).fill(1),r[0]=0,r.fill(0,1,32),r.fill(0,127,160),r.fill(2,4352,4448),r[9001]=2,r[9002]=2,r.fill(2,11904,42192),r[12351]=1,r.fill(2,44032,55204),r.fill(2,63744,64256),r.fill(2,65040,65050),r.fill(2,65072,65136),r.fill(2,65280,65377),r.fill(2,65504,65511);for(var t=0;t<s.length;++t)r.fill(0,s[t][0],s[t][1]+1)}}return w(e,[{key:"wcwidth",value:function(e){return e<32?0:e<127?1:e<65536?r[e]:function(e,t){var i,r=0,n=t.length-1;if(e<t[0][0]||e>t[n][1])return!1;for(;n>=r;)if(e>t[i=r+n>>1][1])r=i+1;else{if(!(e<t[i][0]))return!0;n=i-1}return!1}(e,o)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}},{key:"charProperties",value:function(e,t){var i=this.wcwidth(e),r=0===i&&0!==t;if(r){var s=n.UnicodeService.extractWidth(t);0===s?r=!1:s>i&&(i=s)}return n.UnicodeService.createPropertyValue(0,i,r)}}])}()},5981:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;var r=i(8460),n=function(e){function t(e){var i;return C(this,t),(i=d(this,t))._action=e,i._writeBuffer=[],i._callbacks=[],i._pendingData=0,i._bufferOffset=0,i._isSyncWriting=!1,i._syncCalls=0,i._didUserInput=!1,i._onWriteParsed=i.register(new r.EventEmitter),i.onWriteParsed=i._onWriteParsed.event,i}return g(t,e),w(t,[{key:"handleUserInput",value:function(){this._didUserInput=!0}},{key:"writeSync",value:function(e,t){if(void 0!==t&&this._syncCalls>t)this._syncCalls=0;else if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,!this._isSyncWriting){var i;for(this._isSyncWriting=!0;i=this._writeBuffer.shift();){this._action(i);var r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}}},{key:"write",value:function(e,t){var i=this;if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),void this._innerWrite();setTimeout(function(){return i._innerWrite()})}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}},{key:"_innerWrite",value:function(){for(var e=this,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)||Date.now();this._writeBuffer.length>this._bufferOffset;){var r=this._writeBuffer[this._bufferOffset],n=this._action(r,t);if(n){var s=function(t){return Date.now()-i>=12?setTimeout(function(){return e._innerWrite(0,t)}):e._innerWrite(i,t)};return void n.catch(function(e){return queueMicrotask(function(){throw e}),Promise.resolve(!1)}).then(s)}var o=this._callbacks[this._bufferOffset];if(o&&o(),this._bufferOffset++,this._pendingData-=r.length,Date.now()-i>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(function(){return e._innerWrite()})):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}])}(i(844).Disposable);t.WriteBuffer=n},5941:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;var i=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,r=/^[\da-f]+$/;function n(e,t){var i=e.toString(16),r=i.length<2?"0"+i:i;switch(t){case 4:return i[0];case 8:return r;case 12:return(r+r).slice(0,3);default:return r+r}}t.parseColor=function(e){if(e){var t=e.toLowerCase();if(0===t.indexOf("rgb:")){t=t.slice(4);var n=i.exec(t);if(n){var s=n[1]?15:n[4]?255:n[7]?4095:65535;return[Math.round(parseInt(n[1]||n[4]||n[7]||n[10],16)/s*255),Math.round(parseInt(n[2]||n[5]||n[8]||n[11],16)/s*255),Math.round(parseInt(n[3]||n[6]||n[9]||n[12],16)/s*255)]}}else if(0===t.indexOf("#")&&(t=t.slice(1),r.exec(t)&&[3,6,9,12].includes(t.length))){for(var o=t.length/3,a=[0,0,0],c=0;c<3;++c){var l=parseInt(t.slice(o*c,o*c+o),16);a[c]=1===o?l<<4:2===o?l:3===o?l>>4:l>>8}return a}}},t.toRgbString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,i=l(e,3),r=i[0],s=i[1],o=i[2];return"rgb:".concat(n(r,t),"/").concat(n(s,t),"/").concat(n(o,t))}},5770:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;var r=i(482),n=i(8742),s=i(5770),o=[];t.DcsParser=function(){function e(){C(this,e),this._handlers=Object.create(null),this._active=o,this._ident=0,this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return w(e,[{key:"dispose",value:function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=o}},{key:"registerHandler",value:function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var i=this._handlers[e];return i.push(t),{dispose:function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}},{key:"clearHandler",value:function(e){this._handlers[e]&&delete this._handlers[e]}},{key:"setHandlerFallback",value:function(e){this._handlerFb=e}},{key:"reset",value:function(){if(this._active.length)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=o,this._ident=0}},{key:"hook",value:function(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||o,this._active.length)for(var i=this._active.length-1;i>=0;i--)this._active[i].hook(t);else this._handlerFb(this._ident,"HOOK",t)}},{key:"put",value:function(e,t,i){if(this._active.length)for(var n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,i);else this._handlerFb(this._ident,"PUT",(0,r.utf32ToString)(e,t,i))}},{key:"unhook",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._active.length){var i=!1,r=this._active.length-1,n=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;r>=0&&!0!==(i=this._active[r].unhook(e));r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if((i=this._active[r].unhook(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",e);this._active=o,this._ident=0}}])}();var a=new n.Params;a.addParam(0),t.DcsHandler=function(){function e(t){C(this,e),this._handler=t,this._data="",this._params=a,this._hitLimit=!1}return w(e,[{key:"hook",value:function(e){this._params=e.length>1||e.params[0]?e.clone():a,this._data="",this._hitLimit=!1}},{key:"put",value:function(e,t,i){this._hitLimit||(this._data+=(0,r.utf32ToString)(e,t,i),this._data.length>s.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}},{key:"unhook",value:function(e){var t=this,i=!1;if(this._hitLimit)i=!1;else if(e&&(i=this._handler(this._data,this._params))instanceof Promise)return i.then(function(e){return t._params=a,t._data="",t._hitLimit=!1,e});return this._params=a,this._data="",this._hitLimit=!1,i}}])}()},2015:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;var r=i(844),n=i(8742),s=i(6242),o=i(6351),a=function(){function e(t){C(this,e),this.table=new Uint8Array(t)}return w(e,[{key:"setDefault",value:function(e,t){this.table.fill(e<<4|t)}},{key:"add",value:function(e,t,i,r){this.table[t<<8|e]=i<<4|r}},{key:"addMany",value:function(e,t,i,r){for(var n=0;n<e.length;n++)this.table[t<<8|e[n]]=i<<4|r}}])}();t.TransitionTable=a;var c=160;t.VT500_TRANSITION_TABLE=function(){var e=new a(4095),t=Array.apply(null,Array(256)).map(function(e,t){return t}),i=function(e,i){return t.slice(e,i)},r=i(32,127),n=i(0,24);n.push(25),n.push.apply(n,i(28,32));var s,o=i(0,14);for(s in e.setDefault(1,0),e.addMany(r,0,2,0),o)e.addMany([24,26,153,154],s,3,0),e.addMany(i(128,144),s,3,0),e.addMany(i(144,152),s,3,0),e.add(156,s,0,0),e.add(27,s,11,1),e.add(157,s,4,8),e.addMany([152,158,159],s,0,7),e.add(155,s,11,3),e.add(144,s,11,9);return e.addMany(n,0,3,0),e.addMany(n,1,3,1),e.add(127,1,0,1),e.addMany(n,8,0,8),e.addMany(n,3,3,3),e.add(127,3,0,3),e.addMany(n,4,3,4),e.add(127,4,0,4),e.addMany(n,6,3,6),e.addMany(n,5,3,5),e.add(127,5,0,5),e.addMany(n,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(r,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(i(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(r,7,0,7),e.addMany(n,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(i(64,127),3,7,0),e.addMany(i(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(i(48,60),4,8,4),e.addMany(i(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(i(32,64),6,0,6),e.add(127,6,0,6),e.addMany(i(64,127),6,0,0),e.addMany(i(32,48),3,9,5),e.addMany(i(32,48),5,9,5),e.addMany(i(48,64),5,0,6),e.addMany(i(64,127),5,7,0),e.addMany(i(32,48),4,9,5),e.addMany(i(32,48),1,9,2),e.addMany(i(32,48),2,9,2),e.addMany(i(48,127),2,10,0),e.addMany(i(48,80),1,10,0),e.addMany(i(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(i(96,127),1,10,0),e.add(80,1,11,9),e.addMany(n,9,0,9),e.add(127,9,0,9),e.addMany(i(28,32),9,0,9),e.addMany(i(32,48),9,9,12),e.addMany(i(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(n,11,0,11),e.addMany(i(32,128),11,0,11),e.addMany(i(28,32),11,0,11),e.addMany(n,10,0,10),e.add(127,10,0,10),e.addMany(i(28,32),10,0,10),e.addMany(i(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(i(32,48),10,9,12),e.addMany(n,12,0,12),e.add(127,12,0,12),e.addMany(i(28,32),12,0,12),e.addMany(i(32,48),12,9,12),e.addMany(i(48,64),12,0,11),e.addMany(i(64,127),12,12,13),e.addMany(i(64,127),10,12,13),e.addMany(i(64,127),9,12,13),e.addMany(n,13,13,13),e.addMany(r,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(c,0,2,0),e.add(c,8,5,8),e.add(c,6,0,6),e.add(c,11,0,11),e.add(c,13,13,13),e}();var l=function(e){function i(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.VT500_TRANSITION_TABLE;return C(this,i),(e=d(this,i))._transitions=a,e._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},e.initialState=0,e.currentState=e.initialState,e._params=new n.Params,e._params.addParam(0),e._collect=0,e.precedingJoinState=0,e._printHandlerFb=function(e,t,i){},e._executeHandlerFb=function(e){},e._csiHandlerFb=function(e,t){},e._escHandlerFb=function(e){},e._errorHandlerFb=function(e){return e},e._printHandler=e._printHandlerFb,e._executeHandlers=Object.create(null),e._csiHandlers=Object.create(null),e._escHandlers=Object.create(null),e.register((0,r.toDisposable)(function(){e._csiHandlers=Object.create(null),e._executeHandlers=Object.create(null),e._escHandlers=Object.create(null)})),e._oscParser=e.register(new s.OscParser),e._dcsParser=e.register(new o.DcsParser),e._errorHandler=e._errorHandlerFb,e.registerEscHandler({final:"\\"},function(){return!0}),e}return g(i,e),w(i,[{key:"_identifier",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[64,126],i=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if((i=e.prefix.charCodeAt(0))&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(var r=0;r<e.intermediates.length;++r){var n=e.intermediates.charCodeAt(r);if(32>n||n>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=n}}if(1!==e.final.length)throw new Error("final must be a single byte");var s=e.final.charCodeAt(0);if(t[0]>s||s>t[1])throw new Error("final must be in range ".concat(t[0]," .. ").concat(t[1]));return i<<=8,i|=s}},{key:"identToString",value:function(e){for(var t=[];e;)t.push(String.fromCharCode(255&e)),e>>=8;return t.reverse().join("")}},{key:"setPrintHandler",value:function(e){this._printHandler=e}},{key:"clearPrintHandler",value:function(){this._printHandler=this._printHandlerFb}},{key:"registerEscHandler",value:function(e,t){var i=this._identifier(e,[48,126]);void 0===this._escHandlers[i]&&(this._escHandlers[i]=[]);var r=this._escHandlers[i];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}}},{key:"clearEscHandler",value:function(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}},{key:"setEscHandlerFallback",value:function(e){this._escHandlerFb=e}},{key:"setExecuteHandler",value:function(e,t){this._executeHandlers[e.charCodeAt(0)]=t}},{key:"clearExecuteHandler",value:function(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}},{key:"setExecuteHandlerFallback",value:function(e){this._executeHandlerFb=e}},{key:"registerCsiHandler",value:function(e,t){var i=this._identifier(e);void 0===this._csiHandlers[i]&&(this._csiHandlers[i]=[]);var r=this._csiHandlers[i];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}}},{key:"clearCsiHandler",value:function(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}},{key:"setCsiHandlerFallback",value:function(e){this._csiHandlerFb=e}},{key:"registerDcsHandler",value:function(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}},{key:"clearDcsHandler",value:function(e){this._dcsParser.clearHandler(this._identifier(e))}},{key:"setDcsHandlerFallback",value:function(e){this._dcsParser.setHandlerFallback(e)}},{key:"registerOscHandler",value:function(e,t){return this._oscParser.registerHandler(e,t)}},{key:"clearOscHandler",value:function(e){this._oscParser.clearHandler(e)}},{key:"setOscHandlerFallback",value:function(e){this._oscParser.setHandlerFallback(e)}},{key:"setErrorHandler",value:function(e){this._errorHandler=e}},{key:"clearErrorHandler",value:function(){this._errorHandler=this._errorHandlerFb}},{key:"reset",value:function(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])}},{key:"_preserveStack",value:function(e,t,i,r,n){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=i,this._parseStack.transition=r,this._parseStack.chunkPos=n}},{key:"parse",value:function(e,t,i){var r,n=0,s=0,o=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,o=this._parseStack.chunkPos+1;else{if(void 0===i||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");var a=this._parseStack.handlers,l=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===i&&l>-1)for(;l>=0&&!0!==(r=a[l](this._params));l--)if(r instanceof Promise)return this._parseStack.handlerPos=l,r;this._parseStack.handlers=[];break;case 4:if(!1===i&&l>-1)for(;l>=0&&!0!==(r=a[l]());l--)if(r instanceof Promise)return this._parseStack.handlerPos=l,r;this._parseStack.handlers=[];break;case 6:if(n=e[this._parseStack.chunkPos],r=this._dcsParser.unhook(24!==n&&26!==n,i))return r;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(n=e[this._parseStack.chunkPos],r=this._oscParser.end(24!==n&&26!==n,i))return r;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,o=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(var h=o;h<t;++h){switch(n=e[h],(s=this._transitions.table[this.currentState<<8|(n<160?n:c)])>>4){case 2:for(var u=h+1;;++u){if(u>=t||(n=e[u])<32||n>126&&n<c){this._printHandler(e,h,u),h=u-1;break}if(++u>=t||(n=e[u])<32||n>126&&n<c){this._printHandler(e,h,u),h=u-1;break}if(++u>=t||(n=e[u])<32||n>126&&n<c){this._printHandler(e,h,u),h=u-1;break}if(++u>=t||(n=e[u])<32||n>126&&n<c){this._printHandler(e,h,u),h=u-1;break}}break;case 3:this._executeHandlers[n]?this._executeHandlers[n]():this._executeHandlerFb(n),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:h,code:n,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:for(var d=this._csiHandlers[this._collect<<8|n],f=d?d.length-1:-1;f>=0&&!0!==(r=d[f](this._params));f--)if(r instanceof Promise)return this._preserveStack(3,d,f,s,h),r;f<0&&this._csiHandlerFb(this._collect<<8|n,this._params),this.precedingJoinState=0;break;case 8:do{switch(n){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(n-48)}}while(++h<t&&(n=e[h])>47&&n<60);h--;break;case 9:this._collect<<=8,this._collect|=n;break;case 10:for(var v=this._escHandlers[this._collect<<8|n],_=v?v.length-1:-1;_>=0&&!0!==(r=v[_]());_--)if(r instanceof Promise)return this._preserveStack(4,v,_,s,h),r;_<0&&this._escHandlerFb(this._collect<<8|n),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|n,this._params);break;case 13:for(var g=h+1;;++g)if(g>=t||24===(n=e[g])||26===n||27===n||n>127&&n<c){this._dcsParser.put(e,h,g),h=g-1;break}break;case 14:if(r=this._dcsParser.unhook(24!==n&&26!==n))return this._preserveStack(6,[],0,s,h),r;27===n&&(s|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(var p=h+1;;p++)if(p>=t||(n=e[p])<32||n>127&&n<c){this._oscParser.put(e,h,p),h=p-1;break}break;case 6:if(r=this._oscParser.end(24!==n&&26!==n))return this._preserveStack(5,[],0,s,h),r;27===n&&(s|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&s}}}])}(r.Disposable);t.EscapeSequenceParser=l},6242:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;var r=i(5770),n=i(482),s=[];t.OscParser=function(){function e(){C(this,e),this._state=0,this._active=s,this._id=-1,this._handlers=Object.create(null),this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return w(e,[{key:"registerHandler",value:function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var i=this._handlers[e];return i.push(t),{dispose:function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}},{key:"clearHandler",value:function(e){this._handlers[e]&&delete this._handlers[e]}},{key:"setHandlerFallback",value:function(e){this._handlerFb=e}},{key:"dispose",value:function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=s}},{key:"reset",value:function(){if(2===this._state)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=s,this._id=-1,this._state=0}},{key:"_start",value:function(){if(this._active=this._handlers[this._id]||s,this._active.length)for(var e=this._active.length-1;e>=0;e--)this._active[e].start();else this._handlerFb(this._id,"START")}},{key:"_put",value:function(e,t,i){if(this._active.length)for(var r=this._active.length-1;r>=0;r--)this._active[r].put(e,t,i);else this._handlerFb(this._id,"PUT",(0,n.utf32ToString)(e,t,i))}},{key:"start",value:function(){this.reset(),this._state=1}},{key:"put",value:function(e,t,i){if(3!==this._state){if(1===this._state)for(;t<i;){var r=e[t++];if(59===r){this._state=2,this._start();break}if(r<48||57<r)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+r-48}2===this._state&&i-t>0&&this._put(e,t,i)}}},{key:"end",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){var i=!1,r=this._active.length-1,n=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;r>=0&&!0!==(i=this._active[r].end(e));r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if((i=this._active[r].end(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}else this._handlerFb(this._id,"END",e);this._active=s,this._id=-1,this._state=0}}}])}(),t.OscHandler=function(){function e(t){C(this,e),this._handler=t,this._data="",this._hitLimit=!1}return w(e,[{key:"start",value:function(){this._data="",this._hitLimit=!1}},{key:"put",value:function(e,t,i){this._hitLimit||(this._data+=(0,n.utf32ToString)(e,t,i),this._data.length>r.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}},{key:"end",value:function(e){var t=this,i=!1;if(this._hitLimit)i=!1;else if(e&&(i=this._handler(this._data))instanceof Promise)return i.then(function(e){return t._data="",t._hitLimit=!1,e});return this._data="",this._hitLimit=!1,i}}])}()},8742:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;var i=2147483647,r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;if(C(this,e),this.maxLength=t,this.maxSubParamsLength=i,i>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(t),this.length=0,this._subParams=new Int32Array(i),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(t),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}return w(e,[{key:"clone",value:function(){var t=new e(this.maxLength,this.maxSubParamsLength);return t.params.set(this.params),t.length=this.length,t._subParams.set(this._subParams),t._subParamsLength=this._subParamsLength,t._subParamsIdx.set(this._subParamsIdx),t._rejectDigits=this._rejectDigits,t._rejectSubDigits=this._rejectSubDigits,t._digitIsSub=this._digitIsSub,t}},{key:"toArray",value:function(){for(var e=[],t=0;t<this.length;++t){e.push(this.params[t]);var i=this._subParamsIdx[t]>>8,r=255&this._subParamsIdx[t];r-i>0&&e.push(Array.prototype.slice.call(this._subParams,i,r))}return e}},{key:"reset",value:function(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}},{key:"addParam",value:function(e){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>i?i:e}}},{key:"addSubParam",value:function(e){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>i?i:e,this._subParamsIdx[this.length-1]++}}},{key:"hasSubParams",value:function(e){return(255&this._subParamsIdx[e])-(this._subParamsIdx[e]>>8)>0}},{key:"getSubParams",value:function(e){var t=this._subParamsIdx[e]>>8,i=255&this._subParamsIdx[e];return i-t>0?this._subParams.subarray(t,i):null}},{key:"getSubParamsAll",value:function(){for(var e={},t=0;t<this.length;++t){var i=this._subParamsIdx[t]>>8,r=255&this._subParamsIdx[t];r-i>0&&(e[t]=this._subParams.slice(i,r))}return e}},{key:"addDigit",value:function(e){var t;if(!(this._rejectDigits||!(t=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)){var r=this._digitIsSub?this._subParams:this.params,n=r[t-1];r[t-1]=~n?Math.min(10*n+e,i):e}}}],[{key:"fromArray",value:function(t){var i=new e;if(!t.length)return i;for(var r=Array.isArray(t[0])?1:0;r<t.length;++r){var n=t[r];if(Array.isArray(n))for(var s=0;s<n.length;++s)i.addSubParam(n[s]);else i.addParam(n)}return i}}])}();t.Params=r},5741:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=function(){function e(){C(this,e),this._addons=[]}return w(e,[{key:"dispose",value:function(){for(var e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}},{key:"loadAddon",value:function(e,t){var i=this,r={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(r),t.dispose=function(){return i._wrappedAddonDispose(r)},t.activate(e)}},{key:"_wrappedAddonDispose",value:function(e){if(!e.isDisposed){for(var t=-1,i=0;i<this._addons.length;i++)if(this._addons[i]===e){t=i;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}}}])}()},8771:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;var r=i(3785),n=i(511);t.BufferApiView=function(){function e(t,i){C(this,e),this._buffer=t,this.type=i}return w(e,[{key:"init",value:function(e){return this._buffer=e,this}},{key:"cursorY",get:function(){return this._buffer.y}},{key:"cursorX",get:function(){return this._buffer.x}},{key:"viewportY",get:function(){return this._buffer.ydisp}},{key:"baseY",get:function(){return this._buffer.ybase}},{key:"length",get:function(){return this._buffer.lines.length}},{key:"getLine",value:function(e){var t=this._buffer.lines.get(e);if(t)return new r.BufferLineApiView(t)}},{key:"getNullCell",value:function(){return new n.CellData}}])}()},3785:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;var r=i(511);t.BufferLineApiView=function(){function e(t){C(this,e),this._line=t}return w(e,[{key:"isWrapped",get:function(){return this._line.isWrapped}},{key:"length",get:function(){return this._line.length}},{key:"getCell",value:function(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new r.CellData)}},{key:"translateToString",value:function(e,t,i){return this._line.translateToString(e,t,i)}}])}()},8285:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;var r=i(8771),n=i(8460),s=function(e){function t(e){var i;return C(this,t),(i=d(this,t))._core=e,i._onBufferChange=i.register(new n.EventEmitter),i.onBufferChange=i._onBufferChange.event,i._normal=new r.BufferApiView(i._core.buffers.normal,"normal"),i._alternate=new r.BufferApiView(i._core.buffers.alt,"alternate"),i._core.buffers.onBufferActivate(function(){return i._onBufferChange.fire(i.active)}),i}return g(t,e),w(t,[{key:"active",get:function(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}},{key:"normal",get:function(){return this._normal.init(this._core.buffers.normal)}},{key:"alternate",get:function(){return this._alternate.init(this._core.buffers.alt)}}])}(i(844).Disposable);t.BufferNamespaceApi=s},7975:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=function(){function e(t){C(this,e),this._core=t}return w(e,[{key:"registerCsiHandler",value:function(e,t){return this._core.registerCsiHandler(e,function(e){return t(e.toArray())})}},{key:"addCsiHandler",value:function(e,t){return this.registerCsiHandler(e,t)}},{key:"registerDcsHandler",value:function(e,t){return this._core.registerDcsHandler(e,function(e,i){return t(e,i.toArray())})}},{key:"addDcsHandler",value:function(e,t){return this.registerDcsHandler(e,t)}},{key:"registerEscHandler",value:function(e,t){return this._core.registerEscHandler(e,t)}},{key:"addEscHandler",value:function(e,t){return this.registerEscHandler(e,t)}},{key:"registerOscHandler",value:function(e,t){return this._core.registerOscHandler(e,t)}},{key:"addOscHandler",value:function(e,t){return this.registerOscHandler(e,t)}}])}()},7090:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=function(){function e(t){C(this,e),this._core=t}return w(e,[{key:"register",value:function(e){this._core.unicodeService.register(e)}},{key:"versions",get:function(){return this._core.unicodeService.versions}},{key:"activeVersion",get:function(){return this._core.unicodeService.activeVersion},set:function(e){this._core.unicodeService.activeVersion=e}}])}()},744:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;var s=i(8460),o=i(844),c=i(5295),l=i(2585);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;var h=t.BufferService=function(e){function i(e){var r;return C(this,i),(r=d(this,i)).isUserScrolling=!1,r._onResize=r.register(new s.EventEmitter),r.onResize=r._onResize.event,r._onScroll=r.register(new s.EventEmitter),r.onScroll=r._onScroll.event,r.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),r.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),r.buffers=r.register(new c.BufferSet(e,f(r))),r}return g(i,e),w(i,[{key:"buffer",get:function(){return this.buffers.active}},{key:"resize",value:function(e,t){this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t})}},{key:"reset",value:function(){this.buffers.reset(),this.isUserScrolling=!1}},{key:"scroll",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.buffer;(t=this._cachedBlankLine)&&t.length===this.cols&&t.getFg(0)===e.fg&&t.getBg(0)===e.bg||(t=r.getBlankLine(e,i),this._cachedBlankLine=t),t.isWrapped=i;var n=r.ybase+r.scrollTop,s=r.ybase+r.scrollBottom;if(0===r.scrollTop){var o=r.lines.isFull;s===r.lines.length-1?o?r.lines.recycle().copyFrom(t):r.lines.push(t.clone()):r.lines.splice(s+1,0,t.clone()),o?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{var a=s-n+1;r.lines.shiftElements(n+1,a-1,-1),r.lines.set(s,t.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}},{key:"scrollLines",value:function(e,t,i){var r=this.buffer;if(e<0){if(0===r.ydisp)return;this.isUserScrolling=!0}else e+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);var n=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+e,r.ybase),0),n!==r.ydisp&&(t||this._onScroll.fire(r.ydisp))}}])}(o.Disposable);t.BufferService=h=r([n(0,l.IOptionsService)],h)},7994:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=function(){function e(){C(this,e),this.glevel=0,this._charsets=[]}return w(e,[{key:"reset",value:function(){this.charset=void 0,this._charsets=[],this.glevel=0}},{key:"setgLevel",value:function(e){this.glevel=e,this.charset=this._charsets[e]}},{key:"setgCharset",value:function(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}}])}()},1753:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;var s=i(2585),o=i(8460),c=i(844),l={NONE:{events:0,restrict:function(){return!1}},X10:{events:1,restrict:function(e){return 4!==e.button&&1===e.action&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)}},VT200:{events:19,restrict:function(e){return 32!==e.action}},DRAG:{events:23,restrict:function(e){return 32!==e.action||3!==e.button}},ANY:{events:31,restrict:function(e){return!0}}};function h(e,t){var i=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return 4===e.button?(i|=64,i|=e.action):(i|=3&e.button,4&e.button&&(i|=64),8&e.button&&(i|=128),32===e.action?i|=32:0!==e.action||t||(i|=3)),i}var u=String.fromCharCode,f={DEFAULT:function(e){var t=[h(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":"[M".concat(u(t[0])).concat(u(t[1])).concat(u(t[2]))},SGR:function(e){var t=0===e.action&&4!==e.button?"m":"M";return"[<".concat(h(e,!0),";").concat(e.col,";").concat(e.row).concat(t)},SGR_PIXELS:function(e){var t=0===e.action&&4!==e.button?"m":"M";return"[<".concat(h(e,!0),";").concat(e.x,";").concat(e.y).concat(t)}},v=t.CoreMouseService=function(e){function t(e,i){var r;C(this,t),(r=d(this,t))._bufferService=e,r._coreService=i,r._protocols={},r._encodings={},r._activeProtocol="",r._activeEncoding="",r._lastEvent=null,r._onProtocolChange=r.register(new o.EventEmitter),r.onProtocolChange=r._onProtocolChange.event;for(var n=0,s=Object.keys(l);n<s.length;n++){var a=s[n];r.addProtocol(a,l[a])}for(var c=0,h=Object.keys(f);c<h.length;c++){var u=h[c];r.addEncoding(u,f[u])}return r.reset(),r}return g(t,e),w(t,[{key:"addProtocol",value:function(e,t){this._protocols[e]=t}},{key:"addEncoding",value:function(e,t){this._encodings[e]=t}},{key:"activeProtocol",get:function(){return this._activeProtocol},set:function(e){if(!this._protocols[e])throw new Error('unknown protocol "'.concat(e,'"'));this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}},{key:"areMouseEventsActive",get:function(){return 0!==this._protocols[this._activeProtocol].events}},{key:"activeEncoding",get:function(){return this._activeEncoding},set:function(e){if(!this._encodings[e])throw new Error('unknown encoding "'.concat(e,'"'));this._activeEncoding=e}},{key:"reset",value:function(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}},{key:"triggerMouseEvent",value:function(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows)return!1;if(4===e.button&&32===e.action)return!1;if(3===e.button&&32!==e.action)return!1;if(4!==e.button&&(2===e.action||3===e.action))return!1;if(e.col++,e.row++,32===e.action&&this._lastEvent&&this._equalEvents(this._lastEvent,e,"SGR_PIXELS"===this._activeEncoding))return!1;if(!this._protocols[this._activeProtocol].restrict(e))return!1;var t=this._encodings[this._activeEncoding](e);return t&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}},{key:"explainEvents",value:function(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}}},{key:"_equalEvents",value:function(e,t,i){if(i){if(e.x!==t.x)return!1;if(e.y!==t.y)return!1}else{if(e.col!==t.col)return!1;if(e.row!==t.row)return!1}return e.button===t.button&&e.action===t.action&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.shift===t.shift}}])}(c.Disposable);t.CoreMouseService=v=r([n(0,s.IBufferService),n(1,s.ICoreService)],v)},6975:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;var s=i(1439),o=i(8460),c=i(844),l=i(2585),h=Object.freeze({insertMode:!1}),u=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),f=t.CoreService=function(e){function t(e,i,r){var n;return C(this,t),(n=d(this,t))._bufferService=e,n._logService=i,n._optionsService=r,n.isCursorInitialized=!1,n.isCursorHidden=!1,n._onData=n.register(new o.EventEmitter),n.onData=n._onData.event,n._onUserInput=n.register(new o.EventEmitter),n.onUserInput=n._onUserInput.event,n._onBinary=n.register(new o.EventEmitter),n.onBinary=n._onBinary.event,n._onRequestScrollToBottom=n.register(new o.EventEmitter),n.onRequestScrollToBottom=n._onRequestScrollToBottom.event,n.modes=(0,s.clone)(h),n.decPrivateModes=(0,s.clone)(u),n}return g(t,e),w(t,[{key:"reset",value:function(){this.modes=(0,s.clone)(h),this.decPrivateModes=(0,s.clone)(u)}},{key:"triggerDataEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._optionsService.rawOptions.disableStdin){var i=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&i.ybase!==i.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug('sending data "'.concat(e,'"'),function(){return e.split("").map(function(e){return e.charCodeAt(0)})}),this._onData.fire(e)}}},{key:"triggerBinaryEvent",value:function(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug('sending binary "'.concat(e,'"'),function(){return e.split("").map(function(e){return e.charCodeAt(0)})}),this._onBinary.fire(e))}}])}(c.Disposable);t.CoreService=f=r([n(0,l.IBufferService),n(1,l.ILogService),n(2,l.IOptionsService)],f)},9074:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;var r=i(8055),n=i(8460),o=i(844),a=i(6106),c=0,l=0,u=function(e){function t(){var e;return C(this,t),(e=d(this,t))._decorations=new a.SortedList(function(e){return null==e?void 0:e.marker.line}),e._onDecorationRegistered=e.register(new n.EventEmitter),e.onDecorationRegistered=e._onDecorationRegistered.event,e._onDecorationRemoved=e.register(new n.EventEmitter),e.onDecorationRemoved=e._onDecorationRemoved.event,e.register((0,o.toDisposable)(function(){return e.reset()})),e}return g(t,e),w(t,[{key:"decorations",get:function(){return this._decorations.values()}},{key:"registerDecoration",value:function(e){var t=this;if(!e.marker.isDisposed){var i=new f(e);if(i){var r=i.marker.onDispose(function(){return i.dispose()});i.onDispose(function(){i&&(t._decorations.delete(i)&&t._onDecorationRemoved.fire(i),r.dispose())}),this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}}},{key:"reset",value:function(){var e,t=m(this._decorations.values());try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(i){t.e(i)}finally{t.f()}this._decorations.clear()}},{key:"getDecorationsAtCell",value:s().m(function e(t,i,r){var n,o,a,c,l,h,u,d,f;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:n=0,o=0,a=m(this._decorations.getKeyIterator(i)),e.p=1,a.s();case 2:if((c=a.n()).done){e.n=4;break}if(d=c.value,n=null!==(l=d.options.x)&&void 0!==l?l:0,o=n+(null!==(h=d.options.width)&&void 0!==h?h:1),!(t>=n&&t<o)||r&&(null!==(u=d.options.layer)&&void 0!==u?u:"bottom")!==r){e.n=3;break}return e.n=3,d;case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,f=e.v,a.e(f);case 6:return e.p=6,a.f(),e.f(6);case 7:return e.a(2)}},e,this,[[1,5,6,7]])})},{key:"forEachDecorationAtCell",value:function(e,t,i,r){this._decorations.forEachByKey(t,function(t){var n,s,o;c=null!==(n=t.options.x)&&void 0!==n?n:0,l=c+(null!==(s=t.options.width)&&void 0!==s?s:1),e>=c&&e<l&&(!i||(null!==(o=t.options.layer)&&void 0!==o?o:"bottom")===i)&&r(t)})}}])}(o.Disposable);t.DecorationService=u;var f=function(e){function t(e){var i;return C(this,t),(i=d(this,t)).options=e,i.onRenderEmitter=i.register(new n.EventEmitter),i.onRender=i.onRenderEmitter.event,i._onDispose=i.register(new n.EventEmitter),i.onDispose=i._onDispose.event,i._cachedBg=null,i._cachedFg=null,i.marker=e.marker,i.options.overviewRulerOptions&&!i.options.overviewRulerOptions.position&&(i.options.overviewRulerOptions.position="full"),i}return g(t,e),w(t,[{key:"isDisposed",get:function(){return this._isDisposed}},{key:"backgroundColorRGB",get:function(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=r.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}},{key:"foregroundColorRGB",get:function(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=r.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}},{key:"dispose",value:function(){this._onDispose.fire(),h(t,"dispose",this,3)([])}}])}(o.Disposable)},4348:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;var r=i(2585),n=i(8343),s=function(){function e(){C(this,e),this._entries=new Map;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];for(var n=0,s=i;n<s.length;n++){var o=l(s[n],2),a=o[0],c=o[1];this.set(a,c)}}return w(e,[{key:"set",value:function(e,t){var i=this._entries.get(e);return this._entries.set(e,t),i}},{key:"forEach",value:function(e){var t,i=m(this._entries.entries());try{for(i.s();!(t=i.n()).done;){var r=l(t.value,2);e(r[0],r[1])}}catch(n){i.e(n)}finally{i.f()}}},{key:"has",value:function(e){return this._entries.has(e)}},{key:"get",value:function(e){return this._entries.get(e)}}])}();t.ServiceCollection=s,t.InstantiationService=function(){function e(){C(this,e),this._services=new s,this._services.set(r.IInstantiationService,this)}return w(e,[{key:"setService",value:function(e,t){this._services.set(e,t)}},{key:"getService",value:function(e){return this._services.get(e)}},{key:"createInstance",value:function(e){var t,i=(0,n.getServiceDependencies)(e).sort(function(e,t){return e.index-t.index}),r=[],s=m(i);try{for(s.s();!(t=s.n()).done;){var o=t.value,a=this._services.get(o.id);if(!a)throw new Error("[createInstance] ".concat(e.name," depends on UNKNOWN service ").concat(o.id,"."));r.push(a)}}catch(d){s.e(d)}finally{s.f()}for(var c=arguments.length,l=new Array(c>1?c-1:0),h=1;h<c;h++)l[h-1]=arguments[h];var u=i.length>0?i[0].index:l.length;if(l.length!==u)throw new Error("[createInstance] First service dependency of ".concat(e.name," at position ").concat(u+1," conflicts with ").concat(l.length," static arguments"));return function(e,t,i){if(v())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var n=new(e.bind.apply(e,r));return i&&p(n,i.prototype),n}(e,[].concat(l,r))}}])}()},7866:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;var s,o=i(844),l=i(2585),h={trace:l.LogLevelEnum.TRACE,debug:l.LogLevelEnum.DEBUG,info:l.LogLevelEnum.INFO,warn:l.LogLevelEnum.WARN,error:l.LogLevelEnum.ERROR,off:l.LogLevelEnum.OFF},u=t.LogService=function(e){function t(e){var i;return C(this,t),(i=d(this,t))._optionsService=e,i._logLevel=l.LogLevelEnum.OFF,i._updateLogLevel(),i.register(i._optionsService.onSpecificOptionChange("logLevel",function(){return i._updateLogLevel()})),s=f(i),i}return g(t,e),w(t,[{key:"logLevel",get:function(){return this._logLevel}},{key:"_updateLogLevel",value:function(){this._logLevel=h[this._optionsService.rawOptions.logLevel]}},{key:"_evalLazyOptionalParams",value:function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}},{key:"_log",value:function(e,t,i){this._evalLazyOptionalParams(i),e.call.apply(e,[console,(this._optionsService.options.logger?"":"xterm.js: ")+t].concat(c(i)))}},{key:"trace",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.TRACE&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.trace.bind(this._optionsService.options.logger))&&void 0!==t?t:console.log,e,n)}},{key:"debug",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.DEBUG&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.debug.bind(this._optionsService.options.logger))&&void 0!==t?t:console.log,e,n)}},{key:"info",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.INFO&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.info.bind(this._optionsService.options.logger))&&void 0!==t?t:console.info,e,n)}},{key:"warn",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.WARN&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.warn.bind(this._optionsService.options.logger))&&void 0!==t?t:console.warn,e,n)}},{key:"error",value:function(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this._logLevel<=l.LogLevelEnum.ERROR&&this._log(null!==(t=null===(i=this._optionsService.options.logger)||void 0===i?void 0:i.error.bind(this._optionsService.options.logger))&&void 0!==t?t:console.error,e,n)}}])}(o.Disposable);t.LogService=u=r([n(0,l.IOptionsService)],u),t.setTraceLogger=function(e){s=e},t.traceCall=function(e,t,i){if("function"!=typeof i.value)throw new Error("not supported");var r=i.value;i.value=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(s.logLevel!==l.LogLevelEnum.TRACE)return r.apply(this,t);s.trace("GlyphRenderer#".concat(r.name,"(").concat(t.map(function(e){return JSON.stringify(e)}).join(", "),")"));var n=r.apply(this,t);return s.trace("GlyphRenderer#".concat(r.name," return"),n),n}}},7302:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;var n=i(8460),s=i(844),o=i(6114);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:o.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};var a=["normal","bold","100","200","300","400","500","600","700","800","900"],c=function(e){function i(e){var o;C(this,i),(o=d(this,i))._onOptionChange=o.register(new n.EventEmitter),o.onOptionChange=o._onOptionChange.event;var a=r({},t.DEFAULT_OPTIONS);for(var c in e)if(c in a)try{var l=e[c];a[c]=o._sanitizeAndValidateOption(c,l)}catch(e){}return o.rawOptions=a,o.options=r({},a),o._setupOptions(),o.register((0,s.toDisposable)(function(){o.rawOptions.linkHandler=null,o.rawOptions.documentOverride=null})),o}return g(i,e),w(i,[{key:"onSpecificOptionChange",value:function(e,t){var i=this;return this.onOptionChange(function(r){r===e&&t(i.rawOptions[e])})}},{key:"onMultipleOptionChange",value:function(e,t){return this.onOptionChange(function(i){-1!==e.indexOf(i)&&t()})}},{key:"_setupOptions",value:function(){var e=this,i=function(i){if(!(i in t.DEFAULT_OPTIONS))throw new Error('No option with key "'.concat(i,'"'));return e.rawOptions[i]},r=function(i,r){if(!(i in t.DEFAULT_OPTIONS))throw new Error('No option with key "'.concat(i,'"'));r=e._sanitizeAndValidateOption(i,r),e.rawOptions[i]!==r&&(e.rawOptions[i]=r,e._onOptionChange.fire(i))};for(var n in this.rawOptions){var s={get:i.bind(this,n),set:r.bind(this,n)};Object.defineProperty(this.options,n,s)}}},{key:"_sanitizeAndValidateOption",value:function(e,i){switch(e){case"cursorStyle":if(i||(i=t.DEFAULT_OPTIONS[e]),!function(e){return"block"===e||"underline"===e||"bar"===e}(i))throw new Error('"'.concat(i,'" is not a valid value for ').concat(e));break;case"wordSeparator":i||(i=t.DEFAULT_OPTIONS[e]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof i&&1<=i&&i<=1e3)break;i=a.includes(i)?i:t.DEFAULT_OPTIONS[e];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error("".concat(e," cannot be less than 1, value: ").concat(i));break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error("".concat(e," cannot be less than 0, value: ").concat(i));break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error("".concat(e," cannot be less than or equal to 0, value: ").concat(i));break;case"rows":case"cols":if(!i&&0!==i)throw new Error("".concat(e," must be numeric, value: ").concat(i));break;case"windowsPty":i=null!=i?i:{}}return i}}])}(s.Disposable);t.OptionsService=c},2660:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(o=(s<3?n(o):s>3?n(t,i,o):n(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;var s=i(2585),o=t.OscLinkService=function(){function e(t){C(this,e),this._bufferService=t,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}return w(e,[{key:"registerLink",value:function(e){var t=this,i=this._bufferService.buffer;if(void 0===e.id){var r=i.addMarker(i.ybase+i.y),n={data:e,id:this._nextId++,lines:[r]};return r.onDispose(function(){return t._removeMarkerFromLink(n,r)}),this._dataByLinkId.set(n.id,n),n.id}var s=e,o=this._getEntryIdKey(s),a=this._entriesWithId.get(o);if(a)return this.addLineToLink(a.id,i.ybase+i.y),a.id;var c=i.addMarker(i.ybase+i.y),l={id:this._nextId++,key:this._getEntryIdKey(s),data:s,lines:[c]};return c.onDispose(function(){return t._removeMarkerFromLink(l,c)}),this._entriesWithId.set(l.key,l),this._dataByLinkId.set(l.id,l),l.id}},{key:"addLineToLink",value:function(e,t){var i=this,r=this._dataByLinkId.get(e);if(r&&r.lines.every(function(e){return e.line!==t})){var n=this._bufferService.buffer.addMarker(t);r.lines.push(n),n.onDispose(function(){return i._removeMarkerFromLink(r,n)})}}},{key:"getLinkData",value:function(e){var t;return null===(t=this._dataByLinkId.get(e))||void 0===t?void 0:t.data}},{key:"_getEntryIdKey",value:function(e){return"".concat(e.id,";;").concat(e.uri)}},{key:"_removeMarkerFromLink",value:function(e,t){var i=e.lines.indexOf(t);-1!==i&&(e.lines.splice(i,1),0===e.lines.length&&(void 0!==e.data.id&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}}])}();t.OscLinkService=o=r([n(0,s.IBufferService)],o)},8343:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;var i="di$target",r="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[r]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var n=function(e,t,s){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,n){t[i]===t?t[r].push({id:e,index:n}):(t[r]=[{id:e,index:n}],t[i]=t)}(n,e,s)};return n.toString=function(){return e},t.serviceRegistry.set(e,n),n}},2585:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var r,n=i(8343);t.IBufferService=(0,n.createDecorator)("BufferService"),t.ICoreMouseService=(0,n.createDecorator)("CoreMouseService"),t.ICoreService=(0,n.createDecorator)("CoreService"),t.ICharsetService=(0,n.createDecorator)("CharsetService"),t.IInstantiationService=(0,n.createDecorator)("InstantiationService"),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.OFF=5]="OFF"}(r||(t.LogLevelEnum=r={})),t.ILogService=(0,n.createDecorator)("LogService"),t.IOptionsService=(0,n.createDecorator)("OptionsService"),t.IOscLinkService=(0,n.createDecorator)("OscLinkService"),t.IUnicodeService=(0,n.createDecorator)("UnicodeService"),t.IDecorationService=(0,n.createDecorator)("DecorationService")},1480:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;var r=i(8460),n=i(225),s=function(){function e(){C(this,e),this._providers=Object.create(null),this._active="",this._onChange=new r.EventEmitter,this.onChange=this._onChange.event;var t=new n.UnicodeV6;this.register(t),this._active=t.version,this._activeProvider=t}return w(e,[{key:"dispose",value:function(){this._onChange.dispose()}},{key:"versions",get:function(){return Object.keys(this._providers)}},{key:"activeVersion",get:function(){return this._active},set:function(e){if(!this._providers[e])throw new Error('unknown Unicode version "'.concat(e,'"'));this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}},{key:"register",value:function(e){this._providers[e.version]=e}},{key:"wcwidth",value:function(e){return this._activeProvider.wcwidth(e)}},{key:"getStringCellWidth",value:function(t){for(var i=0,r=0,n=t.length,s=0;s<n;++s){var o=t.charCodeAt(s);if(55296<=o&&o<=56319){if(++s>=n)return i+this.wcwidth(o);var a=t.charCodeAt(s);56320<=a&&a<=57343?o=1024*(o-55296)+a-56320+65536:i+=this.wcwidth(a)}var c=this.charProperties(o,r),l=e.extractWidth(c);e.extractShouldJoin(c)&&(l-=e.extractWidth(r)),i+=l,r=c}return i}},{key:"charProperties",value:function(e,t){return this._activeProvider.charProperties(e,t)}}],[{key:"extractShouldJoin",value:function(e){return!!(1&e)}},{key:"extractWidth",value:function(e){return e>>1&3}},{key:"extractCharKind",value:function(e){return e>>3}},{key:"createPropertyValue",value:function(e,t){return(16777215&e)<<3|(3&t)<<1|(arguments.length>2&&void 0!==arguments[2]&&arguments[2]?1:0)}}])}();t.UnicodeService=s}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}var n={};return function(){var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;var t=i(9042),s=i(3236),o=i(844),a=i(5741),c=i(8285),l=i(7975),u=i(7090),f=["cols","rows"],v=function(e){function i(e){var t;C(this,i),(t=d(this,i))._core=t.register(new s.Terminal(e)),t._addonManager=t.register(new a.AddonManager),t._publicOptions=r({},t._core.options);var n=function(e){return t._core.options[e]},o=function(e,i){t._checkReadonlyOptions(e),t._core.options[e]=i};for(var c in t._core.options){var l={get:n.bind(t,c),set:o.bind(t,c)};Object.defineProperty(t._publicOptions,c,l)}return t}return g(i,e),w(i,[{key:"_checkReadonlyOptions",value:function(e){if(f.includes(e))throw new Error('Option "'.concat(e,'" can only be set in the constructor'))}},{key:"_checkProposedApi",value:function(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}},{key:"onBell",get:function(){return this._core.onBell}},{key:"onBinary",get:function(){return this._core.onBinary}},{key:"onCursorMove",get:function(){return this._core.onCursorMove}},{key:"onData",get:function(){return this._core.onData}},{key:"onKey",get:function(){return this._core.onKey}},{key:"onLineFeed",get:function(){return this._core.onLineFeed}},{key:"onRender",get:function(){return this._core.onRender}},{key:"onResize",get:function(){return this._core.onResize}},{key:"onScroll",get:function(){return this._core.onScroll}},{key:"onSelectionChange",get:function(){return this._core.onSelectionChange}},{key:"onTitleChange",get:function(){return this._core.onTitleChange}},{key:"onWriteParsed",get:function(){return this._core.onWriteParsed}},{key:"element",get:function(){return this._core.element}},{key:"parser",get:function(){return this._parser||(this._parser=new l.ParserApi(this._core)),this._parser}},{key:"unicode",get:function(){return this._checkProposedApi(),new u.UnicodeApi(this._core)}},{key:"textarea",get:function(){return this._core.textarea}},{key:"rows",get:function(){return this._core.rows}},{key:"cols",get:function(){return this._core.cols}},{key:"buffer",get:function(){return this._buffer||(this._buffer=this.register(new c.BufferNamespaceApi(this._core))),this._buffer}},{key:"markers",get:function(){return this._checkProposedApi(),this._core.markers}},{key:"modes",get:function(){var e=this._core.coreService.decPrivateModes,t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,wraparoundMode:e.wraparound}}},{key:"options",get:function(){return this._publicOptions},set:function(e){for(var t in e)this._publicOptions[t]=e[t]}},{key:"blur",value:function(){this._core.blur()}},{key:"focus",value:function(){this._core.focus()}},{key:"input",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._core.input(e,t)}},{key:"resize",value:function(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}},{key:"open",value:function(e){this._core.open(e)}},{key:"attachCustomKeyEventHandler",value:function(e){this._core.attachCustomKeyEventHandler(e)}},{key:"attachCustomWheelEventHandler",value:function(e){this._core.attachCustomWheelEventHandler(e)}},{key:"registerLinkProvider",value:function(e){return this._core.registerLinkProvider(e)}},{key:"registerCharacterJoiner",value:function(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}},{key:"deregisterCharacterJoiner",value:function(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}},{key:"registerMarker",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._verifyIntegers(e),this._core.registerMarker(e)}},{key:"registerDecoration",value:function(e){var t,i,r;return this._checkProposedApi(),this._verifyPositiveIntegers(null!==(t=e.x)&&void 0!==t?t:0,null!==(i=e.width)&&void 0!==i?i:0,null!==(r=e.height)&&void 0!==r?r:0),this._core.registerDecoration(e)}},{key:"hasSelection",value:function(){return this._core.hasSelection()}},{key:"select",value:function(e,t,i){this._verifyIntegers(e,t,i),this._core.select(e,t,i)}},{key:"getSelection",value:function(){return this._core.getSelection()}},{key:"getSelectionPosition",value:function(){return this._core.getSelectionPosition()}},{key:"clearSelection",value:function(){this._core.clearSelection()}},{key:"selectAll",value:function(){this._core.selectAll()}},{key:"selectLines",value:function(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}},{key:"dispose",value:function(){h(i,"dispose",this,3)([])}},{key:"scrollLines",value:function(e){this._verifyIntegers(e),this._core.scrollLines(e)}},{key:"scrollPages",value:function(e){this._verifyIntegers(e),this._core.scrollPages(e)}},{key:"scrollToTop",value:function(){this._core.scrollToTop()}},{key:"scrollToBottom",value:function(){this._core.scrollToBottom()}},{key:"scrollToLine",value:function(e){this._verifyIntegers(e),this._core.scrollToLine(e)}},{key:"clear",value:function(){this._core.clear()}},{key:"write",value:function(e,t){this._core.write(e,t)}},{key:"writeln",value:function(e,t){this._core.write(e),this._core.write("\r\n",t)}},{key:"paste",value:function(e){this._core.paste(e)}},{key:"refresh",value:function(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}},{key:"reset",value:function(){this._core.reset()}},{key:"clearTextureAtlas",value:function(){this._core.clearTextureAtlas()}},{key:"loadAddon",value:function(e){this._addonManager.loadAddon(this,e)}},{key:"_verifyIntegers",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var r=0,n=t;r<n.length;r++){var s=n[r];if(s===1/0||isNaN(s)||s%1!=0)throw new Error("This API only accepts integers")}}},{key:"_verifyPositiveIntegers",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var r=0,n=t;r<n.length;r++){var s=n[r];if(s&&(s===1/0||isNaN(s)||s%1!=0||s<0))throw new Error("This API only accepts positive integers")}}}],[{key:"strings",get:function(){return t}}])}(o.Disposable);e.Terminal=v}(),n}()}(J);var Y=J.exports,Z=function(){return w(function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C(this,e),this.terminal=null,this.disposables=[],this.commandDatabase=[],this.enabled=!0,this.options=r({maxSuggestions:i.maxSuggestions||100,triggerCharacters:i.triggerCharacters||[" ","-",".","/"],caseSensitive:i.caseSensitive||!1,showDescriptions:!1!==i.showDescriptions},i),this.currentInput="",this.cursorPosition=0,this.isShowingSuggestions=!1,this.selectedIndex=0,this.suggestions=[],this.suggestionBox=null,window.commandDatabase?this.commandDatabase=window.commandDatabase:fetch("/static/zh.json.gz").then(function(e){return e.json()}).then(function(e){t.commandDatabase=Object.values(e),window.commandDatabase=t.commandDatabase}).catch(function(e){t.commandDatabase=[{name:"systemctl",description:"",subcommands:[{name:"list-units",description:"列出当前内存中的单元",args:{name:"PATTERN",generators:{},isVariadic:!0,isOptional:!0}},{name:"list-sockets",description:"列出当前内存中按地址排序的套接字单元",args:{name:"PATTERN",isVariadic:!0,isOptional:!0}},{name:"list-timers",description:"列出当前内存中按下次经过时间排序的计时器单元",args:{name:"PATTERN",isVariadic:!0,isOptional:!0}},{name:"is-active",description:"检查单元是否处于活动状态",args:{name:"PATTERN",generators:{},isVariadic:!0}},{name:"is-failed",description:"检查单元是否失败",args:{name:"PATTERN",generators:{},isVariadic:!0}},{name:"status",description:"显示一个或多个单元的运行时状态",args:{name:"PATTERN or PID",generators:{},isVariadic:!0,isOptional:!0}},{name:"show",description:"显示一个或多个单元的属性",args:{name:"PATTERN or JOB",generators:{},isVariadic:!0,isOptional:!0}},{name:"cat",description:"显示指定单元的文件和drop-in",args:{name:"PATTERN",generators:{},isVariadic:!0}},{name:"help",description:"显示一个或多个单元的手册",args:{name:"PATTERN or PID",generators:{},isVariadic:!0}},{name:"list-dependencies",description:"递归显示单元所需或想要的单元，或那些单元所需的或想要的单元",args:{name:"PATTERN",generators:{},isVariadic:!0,isOptional:!0}},{name:"start",description:"启动（激活）一个或多个单元",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"stop",description:"停止（停用）一个或多个单元",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"reload",description:"重新加载一个或多个单元",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"restart",description:"启动或重新启动一个或多个单元",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"try-restart",description:"如果处于活动状态，则重新启动一个或多个单元",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"reload-or-restart",description:"如果可能，重新加载一个或多个单元，否则启动或重新启动",args:{name:"UNIT",isVariadic:!0}},{name:"try-reload-or-restart",description:"如果处于活动状态，则重新加载一个或多个单元（如果支持），否则重新启动",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"isolate",description:"启动一个单元并停止所有其他单元",args:{name:"UNIT",generators:{}}},{name:"kill",description:"向单元的进程发送信号",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"clean",description:"清理单元的运行时、缓存、状态、日志或配置",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"freeze",description:"冻结单元进程的执行",args:{name:"PATTERN",isVariadic:!0}},{name:"thaw",description:"恢复冻结单元的执行",args:{name:"PATTERN",isVariadic:!0}},{name:"set-property",description:"设置单元的一个或多个属性",args:[{name:"UNIT",generators:{}},{name:"PROPERTY=VALUE"}]},{name:"bind",description:"将主机中的路径绑定挂载到单元的命名空间中",args:[{name:"UNIT",generators:{}},{name:"PATH",template:"filepaths"},{name:"PATH",template:"filepaths",isOptional:!0}]},{name:"mount-image",description:"将主机中的镜像挂载到单元的命名空间中",args:[{name:"UNIT",generators:{}},{name:"PATH",template:"filepaths"},{name:"PATH",template:"filepaths",isOptional:!0},{name:"OPTS",isOptional:!0}]},{name:"service-log-level",description:"获取/设置服务的日志记录阈值",args:[{name:"SERVICE"},{name:"LEVEL",isOptional:!0}]},{name:"service-log-target",description:"获取/设置服务的日志记录目标",args:[{name:"SERVICE"},{name:"TARGET",isOptional:!0}]},{name:"reset-failed",description:"重置全部、一个或多个单元的失败状态",args:{name:"PATTERN",isVariadic:!0,isOptional:!0}},{name:"list-unit-files",description:"列出已安装的单元文件",args:{name:"PATTERN",generators:{},isVariadic:!0,isOptional:!0}},{name:"enable",description:"启用一个或多个单元文件",args:{name:"UNIT|PATH",generators:[{},{}],isVariadic:!0,isOptional:!0}},{name:"disable",description:"禁用一个或多个单元文件",args:{name:"UNIT|PATH",generators:[{},{}],isVariadic:!0}},{name:"reenable",description:"重新启用一个或多个单元文件",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"preset",description:"基于预设配置启用/禁用一个或多个单元文件",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"preset-all",description:"基于预设配置启用/禁用所有单元文件",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"mask",description:"屏蔽一个或多个单元文件",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"unmask",description:"取消屏蔽一个或多个单元文件",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"link",description:"将一个或多个单元文件链接到搜索路径中",args:{name:"PATH",template:"filepaths",isVariadic:!0}},{name:"revert",description:"将一个或多个单元文件恢复到供应商版本",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"add-wants",description:"为目标添加对指定的一个或多个单元的依赖",args:[{name:"TARGET"},{name:"UNIT",isVariadic:!0}]},{name:"add-requires",description:"为目标添加对指定的一个或多个单元的依赖",args:[{name:"TARGET"},{name:"UNIT",isVariadic:!0}]},{name:"edit",description:"编辑一个或多个单元文件",args:{name:"UNIT",generators:{},isVariadic:!0}},{name:"get-default",description:"获取默认目标的名称"},{name:"set-default",description:"设置默认目标",args:{name:"TARGET"}},{name:"list-jobs",description:"列出任务",args:{name:"PATTERN",isVariadic:!0,isOptional:!0}},{name:"cancel",description:"取消全部、一个或多个任务",args:{name:"JOB",isVariadic:!0,isOptional:!0}},{name:"show-environment",description:"转储环境"},{name:"set-environment",description:"设置一个或多个环境变量",args:{name:"VARIABLE=VALUE",isVariadic:!0}},{name:"unset-environment",description:"取消设置一个或多个环境变量",args:{name:"VARIABLE",isVariadic:!0}},{name:"import-environment",description:"导入全部或部分环境变量",args:{name:"VARIABLE",isVariadic:!0}},{name:"daemon-reload",description:"重新加载 systemd 管理器配置"},{name:"daemon-reexec",description:"重新执行 systemd 管理器"},{name:"log-level",description:"获取/设置管理器的日志记录阈值",args:{name:"LEVEL",isOptional:!0}},{name:"log-target",description:"获取/设置管理器的日志记录目标",args:{name:"TARGET",isOptional:!0}},{name:"service-watchdogs",description:"获取/设置服务 watchdog 状态",args:{name:"BOOL",isOptional:!0,suggestions:["true","false"]}},{name:"is-system-running",description:"检查系统是否完全运行"},{name:"default",description:"进入系统默认模式",isDangerous:!0},{name:"rescue",description:"进入系统救援模式",isDangerous:!0},{name:"emergency",description:"进入系统紧急模式",isDangerous:!0},{name:"halt",description:"关闭并停止系统",isDangerous:!0},{name:"poweroff",description:"关闭并断电系统",isDangerous:!0},{name:"reboot",description:"关闭并重启系统",isDangerous:!0},{name:"kexec",description:"关闭并使用 kexec 重启系统",isDangerous:!0},{name:"exit",description:"请求用户实例或容器退出",args:{name:"EXIT_CODE",isOptional:!0},isDangerous:!0},{name:"switch-root",description:"更改为不同的根文件系统",args:[{name:"ROOT"},{name:"INIT"}],isDangerous:!0},{name:"suspend",description:"挂起系统",isDangerous:!0},{name:"hibernate",description:"休眠系统",isDangerous:!0},{name:"hybrid-sleep",description:"休眠并挂起系统",isDangerous:!0},{name:"suspend-then-hibernate",description:"挂起系统，一段时间后唤醒，然后休眠",isDangerous:!0}],options:[{name:["-h","--help"],description:"显示此帮助"},{name:"--version",description:"显示软件包版本"},{name:"--system",description:"连接到系统管理器"},{name:"--user",description:"连接到用户服务管理器"},{name:["-H","--host"],description:"在远程主机上操作",args:{name:"[USER@]HOST"}},{name:["-M","--machine"],description:"在本地容器上操作",args:{name:"CONTAINER"}},{name:["-t","--type"],description:"列出特定类型的单元",args:{name:"TYPE"}},{name:"--state",description:"列出具有特定 LOAD 或 SUB 或 ACTIVE 状态的单元",exclusiveOn:["--failed"],args:{name:"STATE"}},{name:"--failed",description:"--state=failed 的快捷方式",exclusiveOn:["--state"]},{name:["-p","--property"],description:"仅显示此名称的属性",exclusiveOn:["-P"],args:{name:"NAME"}},{name:"-P",description:"等效于 --value --property=NAME",exclusiveOn:["-p","--property","--value"]},{name:["-a","--all"],description:"显示当前内存中的所有属性/所有单元，包括已死/空的单元。要列出系统上安装的所有单元，请改用 'list-unit-files'"},{name:["-l","--full"],description:"不要在输出中省略单元名称"},{name:["-r","--recursive"],description:"显示主机和本地容器的单元列表"},{name:"--reverse",description:"使用 'list-dependencies' 显示反向依赖关系"},{name:"--with-dependencies",description:"使用 'status'、'cat'、'list-units' 和 'list-unit-files' 显示单元依赖关系"},{name:"--job-mode",description:"指定在排队新任务时，如何处理已排队的任务",args:{name:"MODE"}},{name:["-T","--show-transaction"],description:"在对单元任务进行排队时，显示完整事务"},{name:"--show-types",description:"在显示套接字时，显式显示其类型"},{name:"--value",description:"在显示属性时，仅打印值",exclusiveOn:["-P"]},{name:"--check-inhibitors",description:"指定在关闭睡眠或休眠状态之前是否检查抑制器",exclusiveOn:["-i"],args:{name:"MODE"}},{name:"-i",description:"--check-inhibitors=no 的快捷方式",exclusiveOn:["--check-inhibitors"]},{name:"--kill-who",description:"要将信号发送给谁",args:{name:"WHO"}},{name:["-s","--signal"],description:"要发送哪个信号",args:{name:"SIGNAL"}},{name:"--what",description:"要删除哪些类型的资源",args:{name:"RESOURCES"}},{name:"--now",description:"在启用或禁用单元后启动或停止单元"},{name:"--dry-run",description:"仅打印将要执行的操作"},{name:["-q","--quiet"],description:"禁止输出"},{name:"--wait",description:"对于（重新）启动，请等到服务再次停止。对于 is-system-running，请等到启动完成"},{name:"--no-block",description:"不要等到操作完成"},{name:"--no-wall",description:"在停止/断电/重启之前，不要发送 wall 消息"},{name:"--no-reload",description:"在启用/禁用单元文件后，不要重新加载守护程序"},{name:"--legend",description:"启用/禁用图例（列标题和提示）",args:{name:"BOOL",suggestions:["true","false"]}},{name:"--no-pager",description:"不要将输出通过管道传递到分页器"},{name:"--no-ask-password",description:"不要询问系统密码"},{name:"--global",description:"全局编辑/启用/禁用/屏蔽默认用户单元文件"},{name:"--runtime",description:"临时编辑/启用/禁用/屏蔽单元文件，直到下次重启"},{name:["-f","--force"],description:"在启用单元文件时，覆盖现有符号链接。在关闭时，立即执行操作"},{name:"--preset-mode",description:"仅应用启用、仅禁用或所有预设",args:{name:"MODE"}},{name:"--root",description:"在指定的根目录中编辑/启用/禁用/屏蔽单元文件",args:{name:"PATH"}},{name:["-n","--lines"],description:"要显示的日志条目数",args:{name:"N"}},{name:["-o","--output"],description:"更改日志输出模式",args:{name:"MODE",suggestions:["short","short-precise","short-iso","short-iso-precise","short-full","short-monotonic","short-unix","verbose","export","json","json-pretty","json-sse","cat"]}},{name:"--firmware-setup",description:"告诉固件在下次启动时显示设置菜单"},{name:"--boot-loader-menu",description:"在下次启动时启动到引导加载程序菜单",args:{name:"TIME"}},{name:"--boot-loader-entry",description:"在下次启动时启动到特定的引导加载程序条目",args:{name:"NAME"}},{name:"--plain",description:"将单元依赖关系打印为列表而不是树"},{name:"--timestamp",description:"更改打印的时间戳的格式",args:{name:"FORMAT",suggestions:["pretty","unix","us","utc","us+utc"]}},{name:"--read-only",description:"创建只读绑定挂载"},{name:"--mkdir",description:"如果缺少，则在挂载之前创建目录"},{name:"--marked",description:"重新启动/重新加载先前标记的单元"}]},{name:"systemctl1",description:"",subcommands:[],options:[]},{name:"systemctl2",description:"",subcommands:[],options:[]},{name:"systemctl3",description:"",subcommands:[],options:[]},{name:"systemctl4",description:"",subcommands:[],options:[]},{name:"systemctl5",description:"",subcommands:[],options:[]},{name:"systemctl6",description:"",subcommands:[],options:[]},{name:"systemctl7",description:"",subcommands:[],options:[]},{name:"systemctl8",description:"",subcommands:[],options:[]},{name:"systemctl9",description:"",subcommands:[],options:[]},{name:"systemctl10",description:"",subcommands:[],options:[]},{name:"systemctl11",description:"",subcommands:[],options:[]}]}),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleInput=this.handleInput.bind(this),this.hideSuggestions=this.hideSuggestions.bind(this)},[{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.hideSuggestions()}},{key:"activate",value:function(e){var t=this;this.terminal=e,this.createSuggestionBox(),setTimeout(function(){t.attachEventListeners()},100)}},{key:"createSuggestionBox",value:function(){if(this.suggestionBox=document.createElement("div"),this.suggestionBox.className="xterm-autocomplete-suggestions",this.suggestionBox.style.cssText="\n            position: absolute;\n            background: #2d2d2d;\n            border: 1px solid #555;\n            border-radius: 4px;\n            box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n            max-height: 300px;\n            overflow-y: auto;\n            z-index: 1000;\n            font-family: 'Courier New', monospace;\n            font-size: 13px;\n            display: none;\n            min-width: 350px;\n            max-width: 600px;\n        ",!document.getElementById("xterm-autocomplete-styles")){var e=document.createElement("style");e.id="xterm-autocomplete-styles",e.textContent="\n                .xterm-autocomplete-suggestions {\n                    scrollbar-width: thin;\n                    scrollbar-color: #555 #2d2d2d;\n                }\n                \n                .xterm-autocomplete-suggestions::-webkit-scrollbar {\n                    width: 8px;\n                }\n                \n                .xterm-autocomplete-suggestions::-webkit-scrollbar-track {\n                    background: #2d2d2d;\n                    border-radius: 4px;\n                }\n                \n                .xterm-autocomplete-suggestions::-webkit-scrollbar-thumb {\n                    background: #555;\n                    border-radius: 4px;\n                }\n                \n                .xterm-autocomplete-suggestions::-webkit-scrollbar-thumb:hover {\n                    background: #666;\n                }\n                \n                .xterm-suggestion-item {\n                    padding: 4px 12px;\n                    cursor: pointer;\n                    border-bottom: 1px solid #3a3a3a;\n                    transition: background-color 0.1s;\n                    display: flex;\n                    align-items: center;\n                    justify-content: space-between;\n                    min-height: 28px;\n                }\n                \n                .xterm-suggestion-item:last-child {\n                    border-bottom: none;\n                }\n                \n                .xterm-suggestion-item:hover,\n                .xterm-suggestion-item.selected {\n                    background: #404040;\n                }\n                \n                .xterm-suggestion-content {\n                    display: flex;\n                    align-items: center;\n                    gap: 12px;\n                    flex: 1;\n                    min-width: 0;\n                }\n                \n                .xterm-suggestion-command {\n                    color: #20a53a;\n                    font-weight: bold;\n                    min-width: 80px;\n                    flex-shrink: 0;\n                }\n                \n                .xterm-suggestion-description {\n                    color: #888;\n                    font-size: 12px;\n                    flex: 1;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                    white-space: nowrap;\n                }\n                \n                .xterm-suggestion-type {\n                    color: #98FB98;\n                    font-size: 10px;\n                    background: rgba(152, 251, 152, 0.1);\n                    padding: 2px 6px;\n                    border-radius: 3px;\n                    flex-shrink: 0;\n                }\n            ",document.head.appendChild(e)}document.body.appendChild(this.suggestionBox)}},{key:"attachEventListeners",value:function(){var e=this,t=this.terminal.element;t&&(this.keydownHandler=function(t){e.enabled&&(e.isShowingSuggestions&&(e.handleKeyDown(t,t.key)||(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation())))},t.addEventListener("keydown",this.keydownHandler,!0)),this.disposables.push(this.terminal.onData(function(t){e.enabled&&e.handleInput(t)})),document.addEventListener("click",this.hideSuggestions),this.suggestionBox.addEventListener("click",function(t){var i=t.target.closest(".xterm-suggestion-item");if(i){var r=i.dataset.command;e.applySuggestion(r),e.terminal&&e.terminal.textarea&&e.terminal.textarea.focus()}})}},{key:"handleKeyDown",value:function(e){if(this.isShowingSuggestions)switch(e.key){case"ArrowDown":return e.preventDefault(),e.stopPropagation(),this.selectNext(),!1;case"ArrowUp":return e.preventDefault(),e.stopPropagation(),this.selectPrevious(),!1;case"Tab":case"Enter":return e.preventDefault(),e.stopPropagation(),this.applySelectedSuggestion(),!1;case"Escape":return e.preventDefault(),e.stopPropagation(),this.hideSuggestions(),!1}return!0}},{key:"handleInput",value:function(e){if("\r"===e)return this.currentInput="",void this.hideSuggestions();""===e?this.currentInput=this.currentInput.slice(0,-1):e.charCodeAt(0)>=32&&(this.currentInput+=e),this.triggerAutoComplete()}},{key:"triggerAutoComplete",value:function(){var e=this.currentInput;if(e.length<1)this.hideSuggestions();else{var t=e.split(/\s+/).filter(function(e){return e.length>0}),i=[];if(1===t.length&&!e.includes(" ")){var r=t[0];i=this.getCommandSuggestions(r)}else if(t.length>=2){var n=t[0],s=this.commandDatabase.find(function(e){return e.name===n});if(!s)return void this.hideSuggestions();i=this.getContextualSuggestions(s,t.slice(1),e.endsWith(" "))}i.length>0?this.showSuggestions(i):this.hideSuggestions()}}},{key:"getContextualSuggestions",value:function(e,t,i){var r=e,n=i?t:t.slice(0,-1);if(n.forEach(function(e){var t,i,n=null===(t=r.subcommands)||void 0===t?void 0:t.find(function(t){return t.name===e});n?r=n:null===(i=r.options)||void 0===i||i.some(function(t){return(Array.isArray(t.name)?t.name:[t.name]).includes(e)})}),i)return this.getAllOptionsAndSubcommandsFromContext(r,n);var s=t[t.length-1];return this.getMatchingSuggestions(r,s)}},{key:"getAllOptionsAndSubcommandsFromContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return e.subcommands&&e.subcommands.length>0&&e.subcommands.forEach(function(e){t.includes(e.name)||i.push({text:e.name,description:e.description,type:"subcommand"})}),e.options&&e.options.length>0&&e.options.forEach(function(e){var r=Array.isArray(e.name)?e.name:[e.name];r.some(function(e){return t.includes(e)})||i.push({text:r[0],displayText:r.join(", "),description:e.description,type:"option"})}),i.length>0?i:[]}},{key:"getMatchingSuggestions",value:function(e,t){var i=this,r=[],n=this.options.caseSensitive?t:t.toLowerCase();return e.subcommands&&e.subcommands.length>0&&e.subcommands.forEach(function(e){var t=e.name;(i.options.caseSensitive?t:t.toLowerCase()).startsWith(n)&&r.push({text:t,description:e.description,type:"subcommand"})}),e.options&&e.options.length>0&&e.options.forEach(function(e){(Array.isArray(e.name)?e.name:[e.name]).forEach(function(t){(i.options.caseSensitive?t:t.toLowerCase()).startsWith(n)&&r.push({text:t,description:e.description,type:"option"})})}),r.slice(0,this.options.maxSuggestions)}},{key:"getCommandSuggestions",value:function(e){var t=this,i=[],r=this.options.caseSensitive?e:e.toLowerCase();return this.commandDatabase.forEach(function(e){var n=e.name;(t.options.caseSensitive?n:n.toLowerCase()).startsWith(r)&&i.push({text:n,description:e.description,type:""})}),i.slice(0,this.options.maxSuggestions)}},{key:"showSuggestions",value:function(e){var t=this;this.suggestions=e,this.selectedIndex=0,this.isShowingSuggestions=!0,this.suggestionBox.innerHTML="",e.forEach(function(e,i){var r=document.createElement("div");r.className="xterm-suggestion-item",0===i&&r.classList.add("selected"),r.dataset.command=e.text;var n=document.createElement("div");n.className="xterm-suggestion-content";var s=document.createElement("span");if(s.className="xterm-suggestion-command",s.textContent=e.displayText||e.text,n.appendChild(s),t.options.showDescriptions&&e.description){var o=document.createElement("span");o.className="xterm-suggestion-description",o.textContent=e.description,n.appendChild(o)}r.appendChild(n),t.suggestionBox.appendChild(r)}),this.positionSuggestionBox(),this.suggestionBox.style.display="block"}},{key:"positionSuggestionBox",value:function(){if(this.terminal.element){var e=this.terminal.element.getBoundingClientRect(),t=this.terminal.buffer.active,i=t.cursorY,r=Math.floor(e.height/this.terminal.rows),n=Math.floor(e.width/this.terminal.cols),s=e.left+t.cursorX*n,o=e.top+(i+1)*r+10;this.suggestionBox.style.visibility="hidden",this.suggestionBox.style.display="block";var a=this.suggestionBox.getBoundingClientRect();this.suggestionBox.style.visibility="visible";var c=window.innerWidth,l=window.innerHeight;s+a.width>c&&(s=e.left+t.cursorX*n-a.width)<0&&(s=c-a.width-10),s=Math.max(10,s);var h=l-o,u=e.top+i*r-10;if(a.height>h&&u>h){if((o=e.top+i*r-a.height-10)<10){o=10;var d=Math.min(300,u-20);this.suggestionBox.style.maxHeight="".concat(d,"px")}}else if(o+a.height>l&&(o=l-a.height-10)<10){o=10;var f=Math.min(300,l-20);this.suggestionBox.style.maxHeight="".concat(f,"px")}this.suggestionBox.style.left="".concat(s,"px"),this.suggestionBox.style.top="".concat(o,"px")}}},{key:"hideSuggestions",value:function(){this.isShowingSuggestions=!1,this.suggestionBox.style.display="none",this.suggestions=[],this.selectedIndex=0}},{key:"selectNext",value:function(){if(0!==this.suggestions.length){var e=this.suggestionBox.querySelectorAll(".xterm-suggestion-item");e[this.selectedIndex].classList.remove("selected"),this.selectedIndex=(this.selectedIndex+1)%this.suggestions.length,e[this.selectedIndex].classList.add("selected"),e[this.selectedIndex].scrollIntoView({block:"nearest"})}}},{key:"selectPrevious",value:function(){if(0!==this.suggestions.length){var e=this.suggestionBox.querySelectorAll(".xterm-suggestion-item");e[this.selectedIndex].classList.remove("selected"),this.selectedIndex=0===this.selectedIndex?this.suggestions.length-1:this.selectedIndex-1,e[this.selectedIndex].classList.add("selected"),e[this.selectedIndex].scrollIntoView({block:"nearest"})}}},{key:"applySelectedSuggestion",value:function(){if(0!==this.suggestions.length){var e=this.suggestions[this.selectedIndex];this.applySuggestion(e.text)}}},{key:"applySuggestion",value:function(e){var t=this,i=this.currentInput;if(i.endsWith(" "))this.terminal.input("".concat(e," ")),this.currentInput+="".concat(e," ");else{var r=i.split(/\s+/),n=r[r.length-1],s=e.substring(n.length);if(s){this.terminal.input("".concat(s," "));var o=i.split(/\s+/);o[o.length-1]=e,this.currentInput="".concat(o.join(" ")," ")}else e===n&&(this.terminal.input(" "),this.currentInput+=" ")}this.hideSuggestions(),setTimeout(function(){t.checkAndShowSuggestionsAfterApply()},50)}},{key:"checkAndShowSuggestionsAfterApply",value:function(){var e=this.currentInput,t=e.split(/\s+/).filter(function(e){return e.length>0});if(!(t.length<1)){var i=t[0],r=this.commandDatabase.find(function(e){return e.name===i});if(r&&e.endsWith(" ")){var n=this.getContextualSuggestions(r,t.slice(1),!0);n&&n.length>0&&this.showSuggestions(n)}}}},{key:"addCommand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={name:e,description:t.description||"自定义命令: ".concat(e),subcommands:t.subcommands||[],options:t.options||[]},r=this.commandDatabase.findIndex(function(t){return t.name===e});-1!==r?this.commandDatabase[r]=i:this.commandDatabase.push(i)}},{key:"addCommands",value:function(e){var t=this;Array.isArray(e)?e.forEach(function(e){t.addCommand(e.name,e)}):Object.entries(e).forEach(function(e){var i=l(e,2),r=i[0],n=i[1];t.addCommand(r,n)})}},{key:"removeCommand",value:function(e){var t=this.commandDatabase.findIndex(function(t){return t.name===e});-1!==t&&this.commandDatabase.splice(t,1)}},{key:"getCommands",value:function(){return this.commandDatabase.map(function(e){return e.name})}},{key:"dispose",value:function(){var e;this.disposables.forEach(function(e){return e.dispose()}),this.disposables.length=0;var t=null===(e=this.terminal)||void 0===e?void 0:e.element;t&&this.keydownHandler&&t.removeEventListener("keydown",this.keydownHandler,!0),this.suggestionBox&&this.suggestionBox.parentNode&&this.suggestionBox.parentNode.removeChild(this.suggestionBox),document.removeEventListener("click",this.hideSuggestions),this.terminal=null,this.suggestionBox=null,this.keydownHandler=null}}])}();void 0!==i&&i.exports?i.exports=Z:"undefined"!=typeof window&&(window.AutoCompleteAddon=Z);var $={class:"flex relative xterm-view"},Q={key:0,class:"terminal-add-host"},ee={class:"w-[50rem] bg-white rounded-[4px] flex flex-col items-center"},te={class:"text-[1.8rem] flex items-center w-full px-2rem mt-2rem"},ie={class:"flex w-full mb-[4rem] pl-[12rem]"};e("_",n({__name:"index",props:{url:{default:"/webssh"},id:{default:""},active:{type:Boolean,default:!0},fitColsRows:{type:Boolean,default:!0},requestToken:{type:Boolean,default:!1},checkMsgFn:{},hostInfo:{default:function(){return{}}},autoComplete:{type:Boolean,default:!1}},emits:["close"],setup:function(e,i){var n,a,l,h=i.expose,d=(i.emit,W().rowData),f=e,v=o(0),g=o(),p=o("success"),m=o(),C=o(!1),w=o(!1),U=o(),z=u({isEdit:!0,isLocal:!0,rows:{host:"127.0.0.1",port:22,username:"root",password:"",pkey:"",pkey_passwd:"",ps:"127.0.0.1"}}),V=o(""),K=o(!1),J=null;_(function(){return f.active},function(e){e&&b(function(){var e;_e(),null===(e=n)||void 0===e||e.focus()})}),_(function(){return f.autoComplete},function(e){l?e?l.enable():l.disable():e&&(l=new Z({maxSuggestions:100,caseSensitive:!1,showDescriptions:!0}),n.loadAddon(l))}),_(function(){return w.value},function(e){l&&(e?l.disable():l.enable()),e&&b(function(){d.value=z,N()})}),_(p,function(e){l&&("success"===e?l.enable():l.disable())});var re=function(e){J=H({route:f.url,noInit:!f.requestToken,onMessage:oe,onConnected:e})},ne=o(!0),se=0,oe=function(e,t){!0===ne.value&&(ne.value=!1);var i,r,s=t.data;return s.indexOf("Authentication timeout.")>-1&&(C.value=!0),-1==s.indexOf("@127.0.0.1:")&&-1==s.indexOf("@localhost:")||-1==s.indexOf("Authentication failed")?"\r\n登出\r\n"==s||"登出\r\n"==s||"\r\nlogout\r\n"==s||"logout\r\n"==s||s.search(/logout[\r\n]+$/)>-1?(null===(r=J)||void 0===r||r.close(),J=null,ue(),setTimeout(function(){n.write("\r连接已断开,按回车将尝试重新连接!\r")},500),p.value="danger",!1):(null!=f&&f.checkMsgFn&&f.checkMsgFn(s),"warning"===p.value?setTimeout(function(){p.value="success"},500):p.value="success",!f.active&&se>3&&(p.value="warning"),(-1!==s.indexOf("连接目标服务器失败")||s.includes("Authentication failed"))&&(p.value="danger"),f.active?(se=0,!1):void setTimeout(function(){se+=1},500)):(null===(i=J)||void 0===i||i.close(),J=null,ue(),p.value="danger",w.value=!0,!1)},ae=function(e){l&&(e?l.disable():l.enable())},ce=function(){var e;J&&J.socket.ws.value&&(n.loadAddon(a),n.loadAddon(new q.CanvasAddon),n.loadAddon(new X.WebLinksAddon),f.autoComplete&&(l=new Z({maxSuggestions:100,caseSensitive:!1,showDescriptions:!0}),n.loadAddon(l)),n.loadAddon(new j.AttachAddon(null===(e=J)||void 0===e?void 0:e.socket.ws.value)),n.focus())},le=!1,he=function(){le=!0},ue=function(){le=!1},de=function(){var e,i=r({id:f.id},f.hostInfo);"/pyenv_webssh"===f.url&&(i=r({},f.hostInfo)),f.requestToken||(i=r(r({},i),{"x-http-token":window.vite_public_request_token})),null===(e=J)||void 0===e||e.send(i),n.focus(),n.onData(function(){var e=t(s().m(function e(t){var i;return s().w(function(e){for(;;)switch(e.n){case 0:if(""!=t){e.n=3;break}if(!V.value){e.n=1;break}n.write(V.value),V.value="",e.n=3;break;case 1:return e.n=2,navigator.clipboard.readText();case 2:(i=e.v)&&n.write(i);case 3:"\r"===t&&C.value&&(C.value=!1,n.write("\r\n"),fe()),null!==J||"\r"!==t||le||(p.value="danger",he(),n.write("\r\n正在尝试重新连接!\r\n"),fe());case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),n.onSelectionChange(function(){n.hasSelection()&&(V.value=n.getSelection())})},fe=function(){J||re(function(){var e;de();var t=null===(e=J)||void 0===e?void 0:e.socket.ws.value;t&&n.loadAddon(new j.AttachAddon(t))})},ve=function(){J&&n.open(g.value)},_e=function(){if(K.value=!0,f.fitColsRows&&J&&(a.fit(),!J.isStatus("CLOSED"))){var e=n,t=e.cols,i=e.rows;J.send({cols:t,rows:i,resize:1}),K.value=!1}},ge=function(){var e=t(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,null===(t=U.value)||void 0===t?void 0:t.onConfirm();case 1:e.v&&(w.value=!1,n.focus(),n.write("\r\n"),fe());case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),pe=function(){try{var e,t;if(null===(e=J)||void 0===e||e.close(),J=null,n.dispose(),m.value instanceof ResizeObserver)null===(t=m.value)||void 0===t||t.disconnect()}catch(i){}},me=I(function(e){ne.value||K.value||f.active&&!K.value&&_e()},100);return y(function(){m.value=S(document.body,me),b(function(){re(function(){v.value>=1&&fe(),v.value+=1}),function(){n=new Y.Terminal({cursorBlink:!0,fontSize:14,fontFamily:"Monaco, Menlo, Consolas, 'Courier New', monospace",theme:{background:"#111",foreground:"#fff"}}),a=new G.FitAddon,ce(),ve();var e=n.parser;e.registerCsiHandler({final:"h"},function(e,t){return"?"===t&&[1047,1049].includes(e[0])&&ae(!0),!1}),e.registerCsiHandler({final:"l"},function(e,t){return"?"===t&&[1047,1049].includes(e[0])&&ae(!1),!1}),de(),setTimeout(function(){_e()},0)}(),d.value=z})}),k(function(){pe()}),L(function(){var e,t=document.querySelector('div[style*="position: absolute; top: -50000px;"]');t&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t))}),h({socketInfo:function(){return J},useTerminal:function(){return n},useStatus:function(){return p},fitTerminal:_e,disposeTerminal:pe}),function(e,t){var i=O,r=P;return x(),E("div",$,[R("div",{ref_key:"terminalDom",ref:g,class:"w-full h-full"},null,512),D(w)?(x(),E("div",Q,[R("div",ee,[R("div",te,[A(i,{type:"warning",closable:!1,"show-icon":""},{title:M(function(){return c(t[0]||(t[0]=[R("span",null,"无法自动认证，请填写本地服务器的登录信息!",-1)]))}),_:1})]),A(F,{ref_key:"xtermAddHost",ref:U,"comp-data":D(z)},null,8,["comp-data"]),R("div",ie,[A(r,{type:"primary",onClick:ge},{default:M(function(){return c(t[1]||(t[1]=[T("保存配置",-1)]))}),_:1})])])])):B("",!0)])}}}))}}})}();
