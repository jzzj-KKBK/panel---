import{_ as a}from"./index103.js?v=1756369731";import{_ as t}from"./index112.js?v=1756369731";import{u as e,fU as s,bv as n,R as r,K as o,S as i,k as l}from"./utils-lib.js?v=1756369731";import{ag as p,ah as m}from"./firewall.js?v=1756369731";import{o as d}from"./useMethod6.js?v=1756369731";import{c,U as u,r as _,b4 as b,p as g,G as f,q as j,M as h,A as x,H as w,x as k,e as v,J as U,B as D}from"./base-lib.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./column.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore5.js?v=1756369731";import"./validator.js?v=1756369731";const y=c({__name:"index",props:{compData:{default:()=>({isPopup:!1,name:""})}},setup(c){const y=c;e();const C=u(!1),q=_([]),A=_(0),H=_(y.compData.isPopup);y.compData;const M=b({p:1,limit:20}),P=[{label:"网站列表",prop:"site_name",showOverflowTooltip:!0},{label:"扫描URL总数",prop:"scans",width:100},{label:"扫描耗时",prop:"time",render:a=>[a.end_time<=1||a.end_time-a.start_time<=0?v("span",null,[D("0秒")]):v("span",null,[s(a.end_time-a.start_time)])]},{label:"风险次数",render:a=>[0==a.risks?v("span",null,[D("无风险")]):v("span",{class:"bt-link !text-danger",onClick:()=>d(a)},[a.risks])]},{label:"状态",render:a=>[0===a.is_status&&0===a.end_time||1===a.end_time?v("span",{class:"text-red"},[D("扫描未完成")]):1===a.is_status&&0===a.end_time?v("span",{class:"text-[#fc6d26]"},[D("扫描中")]):v("span",null,[D("扫描完成")])]},{label:"扫描时间",width:150,render:a=>{const t=n(a.start_time,"number",0);return v("span",null,[r(t)])}},{label:"操作",align:"right",render:a=>[0===a.is_status&&0===a.end_time||1===a.end_time||1===a.is_status&&0===a.end_time?v("span",{class:"text-[#c8c9cc] cursor-not-allowed"},[D("扫描未完成")]):v("span",{class:"bt-link",onClick:()=>(a=>{window.open("/project/content/report/html?id="+a.testing_id,"_blank","noopener,noreferrer")})(a)},[D("查看报告")])]}],R=async(a=1)=>{await o({loading:C,request:H.value?p({site_name:y.compData.name,...M}):m({...M}),data:{data:[Array,q],page:i(A)}})};return g(R),(e,s)=>{const n=l,r=t,o=a,i=f("bt-loading");return j(),h(o,{class:U({"p-[2rem]":k(H)})},{content:x(()=>[w(v(n,{ref:"table",column:P,data:k(q),"max-height":k(H)?500:null,description:"检测历史列表为空"},null,8,["data","max-height"]),[[i,k(C)],[i,"正在加载检测历史列表，请稍后...","title"]])]),"footer-right":x(()=>[v(r,{total:k(A),page:k(M).p,"onUpdate:page":s[0]||(s[0]=a=>k(M).p=a),row:k(M).limit,"onUpdate:row":s[1]||(s[1]=a=>k(M).limit=a),onChange:R,layout:"prev, pager, next, total, jumper"},null,8,["total","page","row"])]),popup:x(()=>[...s[2]||(s[2]=[])]),_:1},8,["class"])}}});export{y as default};
