!function(){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n(t)}function t(n){return function(n){if(Array.isArray(n))return e(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(n){if("string"==typeof n)return e(n,t);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(n,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=Array(t);e<t;e++)r[e]=n[e];return r}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,t,e="function"==typeof Symbol?Symbol:{},a=e.iterator||"@@iterator",u=e.toStringTag||"@@toStringTag";function i(e,r,a,u){var i=r&&r.prototype instanceof l?r:l,s=Object.create(i.prototype);return o(s,"_invoke",function(e,r,o){var a,u,i,l=0,s=o||[],f=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(t,e){return a=t,u=0,i=n,p.n=e,c}};function d(e,r){for(u=e,i=r,t=0;!f&&l&&!o&&t<s.length;t++){var o,a=s[t],d=p.p,m=a[2];e>3?(o=m===r)&&(i=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=n):a[0]<=d&&((o=e<2&&d<a[1])?(u=0,p.v=r,p.n=a[1]):d<m&&(o=e<3||a[0]>r||r>m)&&(a[4]=e,a[5]=r,p.n=m,u=0))}if(o||e>1)return c;throw f=!0,r}return function(o,s,m){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,m),u=s,i=m;(t=u<2?n:i)||!f;){a||(u?u<3?(u>1&&(p.n=-1),d(u,i)):p.n=i:p.v=i);try{if(l=2,a){if(u||(o="next"),t=a[o]){if(!(t=t.call(a,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,u<2&&(u=0)}else 1===u&&(t=a.return)&&t.call(a),u<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=n}else if((t=(f=p.n<0)?i:e.call(r,p))!==c)break}catch(t){a=n,u=1,i=t}finally{l=1}}return{value:t,done:f}}}(e,a,u),!0),s}var c={};function l(){}function s(){}function f(){}t=Object.getPrototypeOf;var p=[][a]?t(t([][a]())):(o(t={},a,function(){return this}),t),d=f.prototype=l.prototype=Object.create(p);function m(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,o(n,u,"GeneratorFunction")),n.prototype=Object.create(d),n}return s.prototype=f,o(d,"constructor",f),o(f,"constructor",s),s.displayName="GeneratorFunction",o(f,u,"GeneratorFunction"),o(d),o(d,u,"Generator"),o(d,a,function(){return this}),o(d,"toString",function(){return"[object Generator]"}),(r=function(){return{w:i,m:m}})()}function o(n,t,e,r){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}o=function(n,t,e,r){function u(t,e){o(n,t,function(n){return this._invoke(t,e,n)})}t?a?a(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(u("next",0),u("throw",1),u("return",2))},o(n,t,e,r)}function a(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,r)}return e}function u(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?a(Object(e),!0).forEach(function(t){i(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function i(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(n,t,e,r,o,a,u){try{var i=n[a](u),c=i.value}catch(n){return void e(n)}i.done?t(c):Promise.resolve(c).then(r,o)}function l(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function u(n){c(a,r,o,u,i,"next",n)}function i(n){c(a,r,o,u,i,"throw",n)}u(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./index-legacy103.js?v=1756369731","./column-legacy.js?v=1756369731","./config-legacy.js?v=1756369731","./validator-legacy.js?v=1756369731","./useStore-legacy.js?v=1756369731","./useMethod-legacy.js?v=1756369731","./index-legacy112.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731"],function(n,e){"use strict";var o,a,i,c,s,f,p,d,m,v,y,b,h,g,w,k,_,j,O,x,S,P,A,C,V,T,I,L,D,E,M,G,U,q,H,z,F,R,W,B,N,J,$,K,Q,X,Z,Y,nn,tn,en,rn,on,an;return{setters:[function(n){o=n.u,a=n.Z,i=n.l,c=n.L,s=n.K,f=n.P,p=n.o,d=n.$,m=n.J,v=n.k,y=n.a0,b=n.e,h=n.c,g=n.M,w=n.a1,k=n.S,_=n.a2},function(n){j=n.c,O=n.r,x=n.k,S=n.aB,P=n.aQ,A=n.e,C=n.p,V=n.G,T=n.q,I=n.v,L=n.A,D=n.B,E=n.x,M=n.y,G=n.H,U=n.D,q=n.J,H=n.z,z=n.t,F=n.C,R=n.g,W=n.F,B=n.w,N=n.M,J=n.a5},function(n){$=n._},function(n){K=n.a,Q=n.b,X=n.u,Z=n.c},function(n){Y=n.t,nn=n.W,tn=n.X},function(n){en=n.s},function(n){rn=n.g},function(n){on=n.a},function(n){an=n._},null,null],execute:function(){var un={style:{"overflow-y":"hidden"}},cn=j({__name:"index",setup:function(n,b){var h=b.expose,g=o(),w=g.mainHeight,k=g.push,_=g.getSenderAlarmListInfo,j=O(),q=O(!1),H=O([]),z=x({p:1,rows:10,status:"",keyword:""}),F=new Map([["wx_account","微信公众号"],["feishu","飞书"],["mail","邮箱"],["sms","短信通知"],["dingding","钉钉"],["weixin","企业微信"],["webhook","自定义消息通道"]]),R=function(n){var t=!a(n);i({title:"".concat(t?"编辑":"添加","告警任务"),component:function(){return c(function(){return e.import("./index-legacy113.js?v=1756369731")},void 0,e.meta.url)},area:80,showFooter:!0,compData:{isEdit:t,row:n,onRefresh:W}})},W=function(){var n=l(r().m(function n(){return r().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,s({loading:q,request:f(u({},z)),success:function(n){var t=n.data;B(t.data)}});case 1:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),B=function(n){H.value=null==n?void 0:n.map(function(n){var t=n.sender;return u(u({},n),{},{alarmAccounts:t.map(function(n){var t=k.value.config.find(function(t){return t.id===n});return t?"sms"===t.sender_type?{id:n,type:t.sender_type,title:"短信"}:{id:n,type:t.sender_type,title:F.get(t.sender_type)||"",account:t.data.title}:null})})})},N=function(){var n=l(r().m(function n(t){return r().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,p({title:"".concat(t.status?"禁用":"启用","【").concat(t.title,"】任务"),content:"您真的要".concat(t.status?"禁用":"启用","【").concat(t.title,"】这个任务吗？")});case 1:return n.n=2,s({loading:"正在修改告警任务状态，请稍候...",request:Y({task_id:t.id,status:Number(!t.status)}),message:!0,success:W});case 2:return n.a(2)}},n)}));return function(t){return n.apply(this,arguments)}}(),J=function(){var n=l(r().m(function n(t){return r().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,p({icon:"warning-filled",title:"删除告警任务",content:"删除后将不再告警此条任务，是否继续？"});case 1:return n.n=2,s({loading:"正在删除告警任务，请稍候...",request:nn({task_id:t.id}),message:!0,success:W});case 2:return n.a(2)}},n)}));return function(t){return n.apply(this,arguments)}}(),tn=function(){var n=l(r().m(function n(t,e,o,a){var u,i,c;return r().w(function(n){for(;;)switch(n.n){case 0:return u=function(){var n=l(r().m(function n(t,e){var o,a,u,i;return r().w(function(n){for(;;)switch(n.n){case 0:o=t.id,t.status,a=new Map([["delete",nn],["start",Y],["stop",Y]]),u=a.get(c),i=c,n.n="start"===i?1:"stop"===i?4:"delete"===i?7:10;break;case 1:if(!u){n.n=3;break}return n.n=2,u({task_id:o,status:1});case 2:case 5:case 8:return n.a(2,n.v);case 3:case 6:case 9:return n.a(3,10);case 4:if(!u){n.n=6;break}return n.n=5,u({task_id:o,status:0});case 7:if(!u){n.n=9;break}return n.n=8,u({task_id:o});case 10:return n.a(2)}},n)}));return function(t,e){return n.apply(this,arguments)}}(),i=a.label,c=a.value,n.n=1,t({title:"批量".concat(i,"告警"),content:"即将批量".concat(i,"告警，是否继续操作?"),column:[{label:"告警名称",prop:"title"},Z()],onConfirm:function(){var n=l(r().m(function n(){return r().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,e(u);case 1:return W(),n.a(2,!1)}},n)}));return function(){return n.apply(this,arguments)}}()});case 1:return n.a(2)}},n)}));return function(t,e,r,o){return n.apply(this,arguments)}}(),en=[K(),{prop:"title",label:"标题",minWidth:140,width:300},Q({minWidth:100,event:N,data:["停用","正常"]}),{label:"告警方式",width:260,render:function(n){return S(P,{content:n.alarmAccounts.filter(function(n){return null!==n}).map(function(n){return"sms"===(null==n?void 0:n.type)?"短信通知":"".concat((null==n?void 0:n.account)||"","(").concat((null==n?void 0:n.title)||"",")")}).join(","),placement:"top",openDelay:500},[S("span",[n.alarmAccounts.filter(function(n){return null!==n}).map(function(n){return"sms"===(null==n?void 0:n.type)?"短信通知":"".concat(null==n?void 0:n.account,"(").concat(n.title,")")}).join(",")])])}},{label:"告警条件",minWidth:180,render:function(n){return A("span",{innerHTML:n.view_msg},null)}},X([{title:"告警记录",width:70,onClick:function(n){i({title:"【".concat(n.title,"】告警记录"),component:function(){return c(function(){return e.import("./record-legacy.js?v=1756369731")},void 0,e.meta.url)},area:80,compData:n})}},{title:"编辑",onClick:function(n){return R(n)}},{title:"删除",onClick:J}])],rn=[{label:"启动",value:"start",event:tn},{label:"停止",value:"stop",event:tn},{label:"删除",value:"delete",event:tn}],on=function(){var n=l(r().m(function n(){return r().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,_(!0);case 1:return n.n=2,W();case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}();return C(on),h({init:on}),function(n,e){var r=U,o=d,a=m,u=v,i=y,c=$,l=V("bt-loading");return T(),I("div",un,[A(c,null,{"header-left":L(function(){return[A(r,{type:"primary",onClick:e[0]||(e[0]=function(n){return R(!1)})},{default:L(function(){return t(e[3]||(e[3]=[D("添加任务",-1)]))}),_:1})]}),"header-right":L(function(){return[A(o,{class:"alarm-custom-radio mr-[1rem]",type:"button",size:"default",modelValue:E(z).status,"onUpdate:modelValue":e[1]||(e[1]=function(n){return E(z).status=n}),options:[{label:"全部",value:""},{label:"运行中",value:!0},{label:"已停止",value:!1}],onChange:W},null,8,["modelValue"]),M("div",null,[A(a,{modelValue:E(z).keyword,"onUpdate:modelValue":e[2]||(e[2]=function(n){return E(z).keyword=n}),onSearch:W,placeholder:"请输入搜索关键词",class:"!w-24rem"},null,8,["modelValue"])])]}),content:L(function(){return[G(A(u,{ref_key:"alarmListRef",ref:j,data:E(H),column:en,"max-height":E(w)-300,description:"告警列表为空"},null,8,["data","max-height"]),[[l,E(q)],[l,"正在加载告警列表，请稍后...","title"]])]}),"footer-left":L(function(){return[A(i,{"table-ref":E(j),options:rn},null,8,["table-ref"])]}),_:1})])}}}),ln=b(cn,[["__scopeId","data-v-5d926d59"]]),sn={class:"flex items-center"},fn={class:"flex-1 leading-[1.5]"},pn={class:"flex"},dn=b(j({__name:"module-name",props:{row:{}},setup:function(n){return function(n,e){var r=h;return T(),I("div",sn,[M("div",{class:q(["icon",n.row.ps.indexOf("API")>-1?"webhook":n.row.name])},null,2),M("div",fn,[M("span",{class:"text-14px font-bold cursor-pointer",onClick:e[0]||(e[0]=function(t){n.row})},H(n.row.title),1),M("div",pn,[M("span",null,H(n.row.ps),1),A(r,{href:n.row.help,target:"_blank"},{default:L(function(){return t(e[1]||(e[1]=[D(">>帮助文档",-1)]))}),_:1},8,["href"])])])])}}}),[["__scopeId","data-v-eacf7c0c"]]),mn={key:1,class:"c7"},vn={key:1},yn=j({__name:"module-content",props:{row:{}},setup:function(n){var t=o().getSenderAlarmListInfo,e=z(n).row,a=function(){var n=l(r().m(function n(){return r().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,t(!0);case 1:g.success("刷新成功");case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}();return function(n,t){return T(),I("div",null,[0===E(e).list.length?(T(),I("span",{key:0,class:"text-danger cursor-pointer",onClick:t[0]||(t[0]=function(n){return E(en)(E(e))})},"未配置")):E(e).list.length>0?(T(),I("span",mn,["sms"!==E(e).name?(T(),I("span",{key:0,class:"cursor-pointer",onClick:t[1]||(t[1]=function(n){return E(en)(E(e))})},"已绑定【"+H((r=E(e).list,r.map(function(n){return n.data.title}).join("、")))+"】,可继续配置绑定更多账号",1)):F("",!0),"sms"===E(e).name?(T(),I("span",vn,[D("今日剩余发送次数："+H(E(e).list.at(0).data.count)+"( ",1),M("span",{class:"bt-link",onClick:a},"刷新次数"),t[2]||(t[2]=D(")",-1))])):F("",!0)])):F("",!0)]);var r}}}),bn=j({__name:"module-action",props:{row:{}},setup:function(n){var t=o().getSenderAlarmListInfo,e=rn().refs.isRefreshList,a=z(n).row,i=R(function(){return a.value.list.at(0).used}),c=function(){var n=l(r().m(function n(){var e,o,u;return r().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,p({title:"".concat(i.value?"禁用":"开启","短信通知"),content:"您真的要".concat(i.value?"禁用":"开启","短信通知吗？")});case 1:return o=null===(e=a.value.list)||void 0===e?void 0:e.at(0).id,n.n=2,w({sender_id:o});case 2:u=n.v,g.request(u),a.value.list.at(0).used=!i.value,t(),n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}},n,null,[[0,3]])}));return function(){return n.apply(this,arguments)}}();return function(n,t){return T(),I("div",null,["sms"!==E(a).name?(T(),I("span",{key:0,class:"bt-link",onClick:t[0]||(t[0]=function(n){return en(u(u({},a.value),{},{callback:function(){e.value=!0}}))})},"配置")):(T(),I(W,{key:1},[E(i)?F("",!0):(T(),I("span",{key:0,class:"bt-link",onClick:c},"开启")),E(i)?(T(),I("span",{key:1,class:"bt-link",onClick:c},"禁用")):F("",!0)],64))])}}}),hn=j({__name:"index",setup:function(n,t){var e=t.expose,a=o(),u=a.push,i=a.getSenderAlarmListInfo,c=rn().refs.isRefreshList,s=O(!1),f=O([]),p=[{label:"告警模块",width:400,render:function(n){return A(dn,{row:n},null)}},{label:"配置情况",render:function(n){return A(yn,{row:n},null)}},{label:"操作",align:"right",width:100,render:function(n){return A(bn,{row:n},null)}}],d=function(){var n=l(r().m(function n(){var t=arguments;return r().w(function(n){for(;;)switch(n.n){case 0:return(!(t.length>0&&void 0!==t[0])||t[0])&&(s.value=!0),n.n=1,i();case 1:f.value=on(u.value.config),s.value=!1;case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}();return B(function(){return c.value},function(n){c.value&&(d(!1),c.value=!1)},{immediate:!0}),C(d),e({init:d}),function(n,t){var e=v,r=$,o=V("bt-loading");return T(),N(r,null,{content:L(function(){return[G(A(e,{data:E(f),column:p,description:"告警设置列表为空"},null,8,["data"]),[[o,E(s)],[o,"正在加载告警设置列表，请稍后...","title"]])]}),_:1})}}}),gn=j({__name:"index",setup:function(n,t){var e=t.expose,a=o().mainHeight,u=O([]),i=O(!1),c=O(0),f=x({p:1,limit:20,keyword:"",status:""}),p=function(){var n=l(r().m(function n(){return r().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,s({loading:i,request:tn(J(f)),data:{data:[Array,u],page:k(c)}});case 1:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),y=[{label:"标题",render:function(n){return A("span",{innerHTML:n.log},null)}},{prop:"addtime",label:"时间",width:150}];return C(p),e({init:p}),function(n,t){var e=d,r=m,o=v,l=an,s=$,b=V("bt-loading");return T(),N(s,null,{"header-right":L(function(){return[A(e,{type:"button",modelValue:E(f).status,"onUpdate:modelValue":t[0]||(t[0]=function(n){return E(f).status=n}),options:[{label:"全部",value:""},{label:"发送成功",value:!0},{label:"发送失败",value:!1}],onChange:p,class:"mr-[1rem]"},null,8,["modelValue"]),M("div",null,[A(r,{modelValue:E(f).keyword,"onUpdate:modelValue":t[1]||(t[1]=function(n){return E(f).keyword=n}),onSearch:p,placeholder:"请输入搜索关键词",class:"!w-24rem"},null,8,["modelValue"])])]}),content:L(function(){return[G(A(o,{data:E(u),column:y,"max-height":E(a)-254,description:"告警日志列表为空"},null,8,["data","max-height"]),[[b,E(i)],[b,"正在加载告警日志列表，请稍后...","title"]])]}),"footer-right":L(function(){return[A(l,{total:E(c),page:E(f).p,"onUpdate:page":t[2]||(t[2]=function(n){return E(f).p=n}),row:E(f).limit,"onUpdate:row":t[3]||(t[3]=function(n){return E(f).limit=n}),onChange:p},null,8,["total","page","row"])]}),_:1})}}});n("default",j({__name:"index",setup:function(n){var t=_({type:"card",options:[{label:"告警列表",name:"list",lazy:!0,render:ln},{label:"告警设置",name:"set",lazy:!0,render:hn},{label:"告警日志",name:"log",lazy:!0,render:gn}]}).BtTabs;return function(n,e){return T(),N(E(t))}}}))}}})}();
