import{K as e,W as a,b as l}from"./utils-lib.js?v=1756369731";import{c as s,r as t,k as o,p as r,q as i,v as u,e as n,A as p,x as c,F as m,a_ as d,M as f,ai as v,aj as _,a9 as j,a7 as P}from"./base-lib.js?v=1756369731";import{h,i as b,o as y}from"./validator.js?v=1756369731";import{batchPhpVersion as V,getPhpVersion as g}from"./site.js?v=1756369731";import{u as x}from"./useStore4.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const H={class:"p-2rem"},w=s({__name:"index",props:{compData:{default:()=>{}}},setup(s,{expose:w}){const D=l(),k=s,{isRefreshList:q,batchConfig:M}=x(),A=t(),C=o({selectValue:""}),O=o({selectValue:[{required:!0,message:"请选择PHP版本",trigger:"change"}]}),R=t([]);return w({onConfirm:async e=>{let a;try{await A.value.validate(),a=D.load("正在调整php版本，请稍后...");let l=[];const s=k.compData.filter(e=>{var a;return"PHPMOD"!==(null==(a=null==e?void 0:e.project_config)?void 0:a.type)});k.compData.forEach(e=>{var a;"PHPMOD"===(null==(a=null==e?void 0:e.project_config)?void 0:a.type)&&l.push({name:e.name,msg:"异步项目不支持",status:!1})});const{enable:t,exclude:o}=M.value,r=h(s,o,t,{params:{project_type:"PHP",version:C.selectValue}}),i=await V(r),{data:u}=b(i.data);y(u,{title:"设置php版本"}),e(),q.value=!0}catch(l){}finally{null==a||a.close()}}}),r(()=>{(async()=>{var a;await e({request:g(),data:[Array,R]}),C.selectValue=(null==(a=R.value[0])?void 0:a.version)||""})()}),(e,l)=>{const s=v,t=_,o=j,r=P,h=a;return i(),u("div",H,[n(r,{ref_key:"formRef",ref:A,model:c(C),"label-width":"80px",rules:c(O)},{default:p(()=>[n(o,{label:"PHP版本",prop:"selectValue"},{default:p(()=>[n(t,{modelValue:c(C).selectValue,"onUpdate:modelValue":l[0]||(l[0]=e=>c(C).selectValue=e),placeholder:"请选择PHP版本",class:"!w-24rem"},{default:p(()=>[(i(!0),u(m,null,d(c(R),e=>(i(),f(s,{key:e.version,label:e.name,value:e.version},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),n(h,{options:[{content:"请根据您的程序需求选择版本"}],class:"pl-4rem"})])}}});export{w as default};
