import{c as e,r as a,p as l,q as s,v as t,e as o,A as m,x as u,y as n,P as r,B as d,T as i}from"./base-lib.js?v=1756369731";import{K as c,gx as p,b as v,bT as f,k as x,W as h,h as V}from"./utils-lib.js?v=1756369731";import{B as j}from"./index140.js?v=1756369731";import{_}from"./index103.js?v=1756369731";import{d as b,u as g}from"./column.js?v=1756369731";import{bf as y,bg as q}from"./firewall.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./ace.js?v=1756369731";import"./index104.js?v=1756369731";const w={class:"p-[2rem]"},C={class:"p-[2rem]"},U={class:"flex items-center p-[2rem] text-[1.4rem]"},k={class:"flex flex-col ml-[1.2rem]"},A={class:"flex items-center mt-[1.2rem]"},B=e({__name:"index",setup(e){const B=v(),F=a([]),T=a(""),E=a(!1),H=a({}),J=a(!1),K=a(!1),N=a([{label:"隔离时间",prop:"time"},b({label:"文件",prop:"path"}),g([{title:"样本文件",width:60,onClick:async e=>{H.value=e;const a=await c({request:p({path:e.path})});a.data.msg?B.request(a):(T.value=a.data.data,E.value=!0)}},{title:"删除",onClick:async e=>{J.value=!0,H.value=e}}])]),O=async()=>{c({request:y(),data:[Array,F]})},P=async()=>{c({request:f({path:H.value.path,data:T.value,encoding:"utf-8"}),message:!0})},S=async()=>{c({request:q({data:JSON.stringify({md5:H.value.md5,path:H.value.path,type:K.value?"delete":""})}),message:!0,success:()=>{O(),K.value=!1,J.value=!1}})};return l(()=>{O()}),(e,a)=>{const l=x,c=_,p=h,v=j,f=V,b=i;return s(),t("div",w,[o(c,null,{content:m(()=>[o(l,{column:u(N),data:u(F)},null,8,["column","data"])]),_:1}),o(p,{options:[{content:"样本文件：查杀时的文件内容被记录形成的样本文件"}],class:"ml-[2rem] mt-[1.2rem]"}),o(f,{title:"在线编辑",showFooter:"",modelValue:u(E),"onUpdate:modelValue":a[1]||(a[1]=e=>r(E)?E.value=e:null),area:70,onConfirm:P},{default:m(()=>[n("div",C,[o(v,{modelValue:u(T),"onUpdate:modelValue":a[0]||(a[0]=e=>r(T)?T.value=e:null),class:"!h-[40rem]"},null,8,["modelValue"])])]),_:1},8,["modelValue"]),o(f,{title:"删除文件",showFooter:"",area:40,modelValue:u(J),"onUpdate:modelValue":a[3]||(a[3]=e=>r(J)?J.value=e:null),onConfirm:S},{default:m(()=>[n("div",U,[a[6]||(a[6]=n("i",{class:"svgtofont-el-question text-[#E6A23C] text-[4rem]"},null,-1)),n("div",k,[a[5]||(a[5]=n("span",{class:"leading-8"},"是否要删除关联的源文件？",-1)),n("div",A,[o(b,{modelValue:u(K),"onUpdate:modelValue":a[2]||(a[2]=e=>r(K)?K.value=e:null),class:"!mr-[.4rem]"},null,8,["modelValue"]),a[4]||(a[4]=d(" 源文件 ",-1))])])])]),_:1},8,["modelValue"])])}}});export{B as default};
