import{_ as e}from"./index103.js?v=1756369731";import{u as a,fi as l,M as t,K as s,o as r,j as n,k as i,W as o,e as d}from"./utils-lib.js?v=1756369731";import{c as u,U as m,r as p,b4 as c,aB as I,p as f,G as y,q as P,v as w,e as _,A as b,x,y as h,H as V,I as g,B as j,aA as U,aC as v,D as k}from"./base-lib.js?v=1756369731";import{at as q,au as C,av as H,aw as A,ax as L,ay as R}from"./firewall.js?v=1756369731";import{u as B}from"./column.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";const D={class:"flex w-full p-[2rem]"},G={class:"w-[86%] flex-1"},K={class:"flex items-center"},M={class:"flex items-center"},N=d(u({__name:"index",setup(d){a();const u=m(!1),N=p([]),T=p([]),W=c({type:"url",url:"",startIP:"",endIP:"",urlHelp:[{content:"例子1: bt.cn/admin/admin.php?system=abc 添加地址: ^/admin/admin.php"},{content:"例子2: bt.cn/admin/1 1 为可变 1-99 添加地址为: ^/admin/[1-99]"}],ipHelp:[{content:"添加某个IP：起始IP为192.168.10.6 结束IP为192.168.10.6"},{content:"添加IP段：起始IP为192.168.1.1 结束IP为192.168.1.254"}]}),z=e=>{W.type=e.paneName,J()},E=async()=>{switch(W.type){case"url":if(!W.url)return t.error("请输入URL地址");await s({loading:"正在添加，请稍后...",request:C({url_rule:W.url}),message:!0}),W.url="";break;case"ip":if(!l(W.startIP)||!l(W.endIP))return t.error("IP地址格式不正确");await s({loading:"正在添加，请稍后...",request:q({start_ip:W.startIP,end_ip:W.endIP}),message:!0}),W.startIP="",W.endIP=""}J()},F=async()=>{await r({title:"清空白名单",content:"是否清空白名单？",icon:"warning-filled"}),await s({loading:"正在清空，请稍后...",request:H({type:W.type+"_white"}),message:!0,success:e=>{e.status&&J()}})},J=async()=>{await s({loading:u,request:A(),data:{ip_white:[Array,N],url_white:[Array,T]}})},O=async(e,a)=>{const l="url"===W.type;l?a-=1:a=N.value.findIndex(a=>a.at(0)===e.at(0)&&a.at(1)===e.at(1)),await s({loading:"正在删除，请稍后...",request:l?L({index:a}):R({index:a}),message:!0,success:e=>{e.status&&J()}})},Q=[{label:"起始IP",render:e=>I("span",e[0])},{label:"结束IP",render:e=>I("span",e[1])},B([{onClick:O,title:"删除"}])],S=[{label:"URL",render:e=>I("span",e)},B([{onClick:O,title:"删除"}])];return f(()=>J()),(a,l)=>{const t=U,s=v,r=n,d=k,m=i,p=o,c=e,I=y("bt-loading");return P(),w("div",D,[_(s,{"tab-position":"left",modelValue:x(W).type,"onUpdate:modelValue":l[0]||(l[0]=e=>x(W).type=e),onTabClick:z,class:"w-[8%] mr-[2.4rem]"},{default:b(()=>[_(t,{label:"URL白名单",name:"url"}),_(t,{label:"IP白名单",name:"ip"})]),_:1},8,["modelValue"]),h("div",G,[_(c,{class:"flex-1"},{"header-left":b(()=>[V(h("div",K,[_(r,{modelValue:x(W).url,"onUpdate:modelValue":l[1]||(l[1]=e=>x(W).url=e),width:"30rem",placeholder:"URL地址，例如：/admin/update"},null,8,["modelValue"])],512),[[g,"url"===x(W).type]]),V(h("div",M,[_(r,{modelValue:x(W).startIP,"onUpdate:modelValue":l[2]||(l[2]=e=>x(W).startIP=e),width:"25rem",placeholder:"起始IP地址"},null,8,["modelValue"]),_(r,{modelValue:x(W).endIP,"onUpdate:modelValue":l[3]||(l[3]=e=>x(W).endIP=e),class:"ml-[0.8rem]",width:"25rem",placeholder:"结束IP地址"},null,8,["modelValue"])],512),[[g,"ip"===x(W).type]]),_(d,{type:"primary",title:"添加",onClick:E,class:"ml-[0.8rem]"},{default:b(()=>[...l[4]||(l[4]=[j(" 添加 ",-1)])]),_:1}),_(d,{onClick:F},{default:b(()=>[...l[5]||(l[5]=[j("清空",-1)])]),_:1})]),content:b(()=>[V(_(m,{column:"url"===x(W).type?S:Q,data:"url"===x(W).type?x(T):x(N)},null,8,["column","data"]),[[I,x(u)],[I,"正在加载列表，请稍后...","title"]])]),"footer-left":b(()=>[_(p,{"list-style":"disc",options:"ip"===x(W).type?x(W).ipHelp:x(W).urlHelp,class:"mt-[2rem] ml-[2rem]"},null,8,["options"])]),_:1})])])}}}),[["__scopeId","data-v-dba09103"]]);export{N as default};
