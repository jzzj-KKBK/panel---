import{_ as a}from"./index103.js?v=1756369731";import{o as e,at as t,K as s,k as l,h as n,j as o,W as i,b as r}from"./utils-lib.js?v=1756369731";import{c as d,r as p,k as u,p as c,aD as m,G as v,q as f,v as y,e as g,A as h,x,P as w,B as D,H as _,y as b,I as k,a$ as V,ah as j,af as C,D as q,a9 as A,a7 as H}from"./base-lib.js?v=1756369731";import{m as U}from"./validator.js?v=1756369731";import{getPyVersion as M,getVersionList as z,setGoEnvironment as J,installPyVersionNew as L,installPyVersion as N,installVersion as O,uninstallVersion as S}from"./site.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const T={class:"p-[20px]"},B={class:"bg-[#333] p-[12px] h-[36rem] text-white overflow-auto logMsg"},G=["innerHTML"],I={class:"p-2rem"},K=d({__name:"index",props:{compData:{default:{}}},setup(d){const K=d,P=p(""),W=r(),$=p(!1),E=p("正在请求安装..."),F=[{label:"版本号",width:200,render:a=>g("div",null,[a.version.replace(K.compData.type,""),D(" "),"stable"===a.type&&"go"===K.compData.type?"(正式版)":"",a.version===P.value&&a.installed?g("span",{class:"font-bold text-[#333]"},[D("【正在使用】")]):""])},{label:"安装状态",render:a=>("string"==typeof a.installed&&(a.installed="1"===a.installed),g("div",null,[!0===a.is_install?g("span",{class:"text-gray-400"},[D("安装中")]):a.installed?g("span",{class:"text-primary"},[D("已安装")]):g("span",{class:"text-danger"},[D("未安装")])]))},{label:"操作",align:"right",render:a=>(a.version.replace(K.compData.type,""),g("div",null,[_(g("div",{class:"inline-block"},[a.installed&&a.version!==P.value&&"go"===K.compData.type?g("span",{class:"cursor-pointer bt-link",onClick:()=>{ta(a.version)}},[D("设置默认")]):g("span",null,[D("--")]),g(V,{direction:"vertical"},null)]),[[k,"go"===K.compData.type]]),a.installed?g("span",{class:"cursor-pointer text-[#ef0808]",onClick:()=>{la(a.version)}},[D("卸载")]):!0===a.is_install?g("span",{class:"cursor-pointer text-gray-400",onClick:()=>{U()}},[D("安装中...")]):g("span",{class:"cursor-pointer bt-link",onClick:()=>{sa(a.version)}},[D("安装")])]))}],Q=p([]),R=p(!1);p("");const X=p([]),Y=p("py"===K.compData.type?"常用版本":"所有版本"),Z=u({version:"",extended:"",status:!1}),aa=p([{content:"填写时请勿添加换行符等特殊符号，这可能会导致参数不生效"},{content:"多个参数时以空格隔开"},{content:'"--prefix"参数已被使用'},{content:"验证参数是否生效，可查看安装日志并搜索对应名称"}]),ea=async a=>{var s;let l="all";"常用版本"===Y.value&&(l="streamline");try{let t;if("py"===K.compData.type){!0===a&&await e({title:"提示",width:"35rem",icon:"warning-filled",content:"将从镜像源获取版本列表，是否继续？"});let n={force:!0===a?"true":"false"};R.value=!0,t=await M(n),Q.value=t.data.sdk[l],P.value=(null==(s=t.data.command_path.find(a=>a.python_path===t.data.used))?void 0:s.version)||""}else R.value=!0,t=await z(K.compData.type),X.value=t.data,t.data.sdk[l].sort((a,e)=>e.installed-a.installed),P.value=t.data.used,Q.value=t.data.sdk[l]}catch(n){t(n)}finally{R.value=!1}},ta=async a=>{(await s({loading:"正在设置默认版本，请稍后...",request:J({name:a}),message:!0})).status&&ea()},sa=async a=>{var t,l;const n="py"===K.compData.type;if(n){if(Z.status){const a={data:JSON.stringify({version:Z.version,extended:Z.extended})};await s({request:L(a),message:!0}),Z.status=!1,U(),K.compData&&"function"==typeof(null==(t=K.compData)?void 0:t.refresh)&&K.compData.refresh(),ea()}else Z.version=a,Z.status=!0;return}await e({title:"安装",content:"是否安装[".concat(a,"]版本？"),icon:"warning-filled"});(await s({loading:"正在安装，请稍后...",request:n?N({data:JSON.stringify({version:a})}):O({version:a},K.compData.type),message:!0})).status&&(K.compData&&"function"==typeof(null==(l=K.compData)?void 0:l.refresh)&&K.compData.refresh(),ea())},la=async a=>{var t,l;await e({title:"卸载sdk",content:"卸载[".concat(a,"]版本后，相关项目将无法启动，是否继续？"),icon:"warning-filled"});const n=await s({loading:"正在卸载，请稍后...",request:S({version:a},K.compData.type)});(n.status||Array.isArray(n.data)&&n.data[0].status)&&ea(),Array.isArray(n.data)&&!n.data[0].status&&W.error(null==(l=null==(t=n.data)?void 0:t[0])?void 0:l.msg)};return c(()=>{ea()}),m(()=>{}),(e,t)=>{const s=j,r=C,d=q,p=l,u=n,c=o,m=A,k=H,V=i,U=a,M=v("bt-loading");return f(),y("div",T,[g(U,null,{"header-left":h(()=>[g(r,{modelValue:x(Y),"onUpdate:modelValue":t[0]||(t[0]=a=>w(Y)?Y.value=a:null),size:"default",onChange:ea},{default:h(()=>[g(s,{value:"常用版本"},{default:h(()=>[...t[7]||(t[7]=[D("常用版本",-1)])]),_:1}),g(s,{value:"所有版本"},{default:h(()=>[...t[8]||(t[8]=[D("所有版本",-1)])]),_:1})]),_:1},8,["modelValue"])]),"header-right":h(()=>[g(d,{type:"default",onClick:t[1]||(t[1]=a=>ea(!0))},{default:h(()=>[...t[9]||(t[9]=[D(" 更新版本列表 ",-1)])]),_:1})]),content:h(()=>[_(g(p,{height:"400",column:F,data:x(Q)},null,8,["data"]),[[M,x(R)]])]),popup:h(()=>[g(u,{title:"安装信息",modelValue:x($),"onUpdate:modelValue":t[2]||(t[2]=a=>w($)?$.value=a:null),area:[50,36],onCancel:t[3]||(t[3]=()=>E.value="正在请求安装...")},{default:h(()=>[b("div",B,[b("pre",{innerHTML:x(E),class:"whitespace-pre-wrap"},null,8,G)])]),_:1},8,["modelValue"]),g(u,{title:"安装版本【".concat(x(Z).version,"】"),modelValue:x(Z).status,"onUpdate:modelValue":t[5]||(t[5]=a=>x(Z).status=a),area:50,"show-footer":!0,onConfirm:t[6]||(t[6]=a=>sa(x(Z).version))},{default:h(()=>[b("div",I,[g(k,{model:x(Z)},{default:h(()=>[g(m,{label:"自定义参数"},{default:h(()=>[g(c,{modelValue:x(Z).extended,"onUpdate:modelValue":t[4]||(t[4]=a=>x(Z).extended=a),name:"extended",width:"32rem",placeholder:"可为空，实例：--enable-optimizations"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),g(V,{class:"pl-4rem mt-1rem",options:x(aa)},null,8,["options"])])]),_:1},8,["title","modelValue"])]),_:1})])}}});export{K as default};
