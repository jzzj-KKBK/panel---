import{c as e,p as l,G as a,q as o,v as s,H as t,x as n,M as u,A as d,e as i,C as r,y as m,T as p,ba as c,B as f,z as _,F as V,I as y,Q as b,al as g,a9 as v,b8 as h,b9 as k,S as U,a7 as j}from"./base-lib.js?v=1756369731";import{_ as x}from"./validator.js?v=1756369731";import{$ as C,j as F,ag as w,e as A}from"./utils-lib.js?v=1756369731";import{u as I,b as L,c as S,d as D,f as z,h as H,j as M,t as T}from"./index306.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";import"./useStore8.js?v=1756369731";const q={class:"px-[2rem] py-[2.4rem]"},B={class:"condition-risk"},G={class:"flex items-center"},O={class:"tip"},P={key:0},Q=A(e({__name:"timed-scan",setup(e,{expose:A}){const{isAutoScan:Q,ruleForm:$,userOptions:E,isLoading:J,addFtpInfo:K}=I();return l(L),A({onConfirm:S}),(e,l)=>{const A=g,I=v,L=C,S=F,N=w,R=h,W=k,X=U,Y=x,Z=j,ee=a("bt-loading");return o(),s("div",q,[t((o(),u(Z,{ref_key:"addFtpInfo",ref:K,model:n($),class:"btCustomForm p-0","label-width":"4rem",rules:n(T),onSubmit:l[13]||(l[13]=b(()=>{},["prevent"]))},{default:d(()=>[n(Q)?(o(),u(I,{key:0,label:"告警状态"},{default:d(()=>[i(A,{modelValue:n($).status,"onUpdate:modelValue":l[0]||(l[0]=e=>n($).status=e),"active-color":"#20A53A","inactive-color":"#cdcdcd"},null,8,["modelValue"])]),_:1})):r("",!0),i(I,{label:"安全风险项",prop:"risk"},{default:d(()=>[m("div",B,[i(n(p),{modelValue:n($).login_error,"onUpdate:modelValue":l[1]||(l[1]=e=>n($).login_error=e)},{default:d(()=>[l[14]||(l[14]=m("span",null,"多次登录失败",-1)),i(n(c),{type:"info",class:"risk-tag",title:n($).config.login_error_des},{default:d(()=>[f(_(n($).config.login_error_des),1)]),_:1},8,["title"])]),_:1},8,["modelValue"]),i(n(p),{modelValue:n($).time,"onUpdate:modelValue":l[2]||(l[2]=e=>n($).time=e)},{default:d(()=>{var e;return[l[15]||(l[15]=m("span",null,"登录时间异常",-1)),i(n(c),{type:"info",class:"risk-tag",title:null==(e=n($).config)?void 0:e.time_des},{default:d(()=>{var e;return[f(_(null==(e=n($).config)?void 0:e.time_des),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),i(n(p),{modelValue:n($).area,"onUpdate:modelValue":l[3]||(l[3]=e=>n($).area=e)},{default:d(()=>{var e;return[l[16]||(l[16]=m("span",null,"登录地区异常",-1)),i(n(c),{type:"info",class:"risk-tag",title:null==(e=n($).config)?void 0:e.area_des},{default:d(()=>{var e,l,a;return[f(_((null==(l=null==(e=n($).config)?void 0:e.area)?void 0:l.country.length)?null==(a=n($).config)?void 0:a.area_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),i(n(p),{modelValue:n($).anonymous,"onUpdate:modelValue":l[4]||(l[4]=e=>n($).anonymous=e),disabled:"other"===n($).user&&!n(Q)},{default:d(()=>[...l[17]||(l[17]=[m("span",null,"匿名用户登录",-1)])]),_:1},8,["modelValue","disabled"]),i(n(p),{modelValue:n($).upload_shell,"onUpdate:modelValue":l[5]||(l[5]=e=>n($).upload_shell=e)},{default:d(()=>{var e;return[l[18]||(l[18]=m("span",null,"上传脚本文件",-1)),i(n(c),{type:"info",class:"risk-tag",title:null==(e=n($).config)?void 0:e.upload_shell_des},{default:d(()=>{var e,l,a;return[f(_((null==(l=null==(e=n($).config)?void 0:e.upload_shell)?void 0:l.length)?null==(a=n($).config)?void 0:a.upload_shell_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),m("span",{class:"bt-link",onClick:l[6]||(l[6]=(...e)=>n(D)&&n(D)(...e))}," 【设置扫描触发条件】 ")])]),_:1}),n(Q)?(o(),s(V,{key:2},[t(i(I,{label:"周期",prop:"cycle"},{default:d(()=>[i(X,{class:"max-w-[16rem]",modelValue:n($).cycle,"onUpdate:modelValue":l[11]||(l[11]=e=>n($).cycle=e),min:1,type:"number"},{append:d(()=>[i(W,{type:"flex"},{default:d(()=>[i(R,null,{default:d(()=>[...l[19]||(l[19]=[m("span",null,"天",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[y,!1]]),i(I,{label:"告警方式",prop:"channel"},{default:d(()=>[i(Y,{modelValue:n($).channel,"onUpdate:modelValue":l[12]||(l[12]=e=>n($).channel=e),multiple:!0,class:"!w-30rem",limit:["wx_account","sms"]},null,8,["modelValue"])]),_:1})],64)):(o(),s(V,{key:1},[i(I,{label:"扫描日志天数",prop:"otherDay"},{default:d(()=>[i(L,{type:"button",size:"small",modelValue:n($).day,"onUpdate:modelValue":l[7]||(l[7]=e=>n($).day=e),options:n(z)},null,8,["modelValue","options"]),"other"===n($).day?(o(),u(S,{key:0,type:"number",modelValue:n($).otherDay,"onUpdate:modelValue":l[8]||(l[8]=e=>n($).otherDay=e),modelModifiers:{number:!0},class:"!inline-block ml-[1rem]"},null,8,["modelValue"])):r("",!0)]),_:1}),i(I,{label:"FTP用户",prop:"userList"},{default:d(()=>[m("div",G,[i(N,{class:"!w-[16rem]",modelValue:n($).user,"onUpdate:modelValue":l[9]||(l[9]=e=>n($).user=e),options:n(H),onChange:n(M)},null,8,["modelValue","options","onChange"]),"other"===n($).user?(o(),u(N,{key:0,class:"ml-[1rem]",multiple:"","collapse-tags":"",filterable:"",modelValue:n($).userList,"onUpdate:modelValue":l[10]||(l[10]=e=>n($).userList=e),options:n(E)},null,8,["modelValue","options"])):r("",!0)])]),_:1})],64))]),_:1},8,["model","rules"])),[[ee,n(J)]]),m("div",O,[m("ul",null,[n(Q)?(o(),s("li",P,"默认扫描全部用户30天的日志")):r("",!0),l[20]||(l[20]=m("li",null,"【多次登录失败】检测时间为：5分钟",-1))])])])}}}),[["__scopeId","data-v-0fb4045b"]]);export{Q as default};
