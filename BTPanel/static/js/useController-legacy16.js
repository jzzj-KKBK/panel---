!function(){function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,r,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function c(t,a,u,o){var c=a&&a.prototype instanceof s?a:s,f=Object.create(c.prototype);return n(f,"_invoke",function(t,n,a){var u,o,c,s=0,f=a||[],l=!1,v={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return u=t,o=0,c=e,v.n=n,i}};function p(t,n){for(o=t,c=n,r=0;!l&&s&&!a&&r<f.length;r++){var a,u=f[r],p=v.p,h=u[2];t>3?(a=h===n)&&(c=u[(o=u[4])?5:(o=3,3)],u[4]=u[5]=e):u[0]<=p&&((a=t<2&&p<u[1])?(o=0,v.v=n,v.n=u[1]):p<h&&(a=t<3||u[0]>n||n>h)&&(u[4]=t,u[5]=n,v.n=h,o=0))}if(a||t>1)return i;throw l=!0,n}return function(a,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&p(f,h),o=f,c=h;(r=o<2?e:c)||!l;){u||(o?o<3?(o>1&&(v.n=-1),p(o,c)):v.n=c:v.v=c);try{if(s=2,u){if(o||(a="next"),r=u[a]){if(!(r=r.call(u,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,o<2&&(o=0)}else 1===o&&(r=u.return)&&r.call(u),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);u=e}else if((r=(l=v.n<0)?c:t.call(n,v))!==i)break}catch(r){u=e,o=1,c=r}finally{s=1}}return{value:r,done:l}}}(t,u,o),!0),f}var i={};function s(){}function f(){}function l(){}r=Object.getPrototypeOf;var v=[][u]?r(r([][u]())):(n(r={},u,function(){return this}),r),p=l.prototype=s.prototype=Object.create(v);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,n(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t}return f.prototype=l,n(p,"constructor",l),n(l,"constructor",f),f.displayName="GeneratorFunction",n(l,o,"GeneratorFunction"),n(p),n(p,o,"Generator"),n(p,u,function(){return this}),n(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:h}})()}function n(t,e,r,a){var u=Object.defineProperty;try{u({},"",{})}catch(t){u=0}n=function(t,e,r,a){function o(e,r){n(t,e,function(t){return this._invoke(e,r,t)})}e?u?u(t,e,{value:r,enumerable:!a,configurable:!a,writable:!a}):t[e]=r:(o("next",0),o("throw",1),o("return",2))},n(t,e,r,a)}function e(t,n,e,r,a,u,o){try{var c=t[u](o),i=c.value}catch(t){return void e(t)}c.done?n(i):Promise.resolve(i).then(r,a)}function r(t){return function(){var n=this,r=arguments;return new Promise(function(a,u){var o=t.apply(n,r);function c(t){e(o,a,u,c,i,"next",t)}function i(t){e(o,a,u,c,i,"throw",t)}c(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./site-legacy.js?v=1756369731"],function(n,e){"use strict";var a,u,o,c,i,s,f,l,v,p,h,y,m,g,d;return{setters:[function(t){a=t.at,u=t.K,o=t.cm,c=t.u,i=t.N,s=t.o,f=t.R,l=t.M},function(t){v=t.j,p=t.r,h=t.g},function(t){y=t.u,m=t.S},function(t){g=t.getRewriteTel,d=t.getComposerVersion}],execute:function(){var e=n("S",v("SITE-CONFIG-FILE-STORE",function(){var n=function(){var n=r(t().m(function n(e){var r,u;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,g({filename:e.path,history:e.row});case 1:return r=t.v,t.a(2,{status:r.data.status,data:r.data.data});case 2:return t.p=2,u=t.v,a(u),t.a(2,{status:!1,msg:"获取文件历史失败"})}},n,null,[[0,2]])}));return function(t){return n.apply(this,arguments)}}(),e=function(){var n=r(t().m(function n(e){var r;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,u({loading:"正在恢复，请稍后...",request:o({filename:e.path,history:e.row}),data:{status:Boolean}});case 1:return r=t.v,t.a(2,{msg:r.status?"恢复成功":"恢复失败",status:r.status});case 2:t.p=2,t.v;case 3:return t.a(2)}},n,null,[[0,2]])}));return function(t){return n.apply(this,arguments)}}(),c=function(){var n=r(t().m(function n(e){var r;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,u({request:d({path:e}),data:{file_path:String}});case 1:return r=t.v,t.a(2,{data:r.data.file_path,status:r.status});case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"获取composer路径失败"})}},n,null,[[0,2]])}));return function(t){return n.apply(this,arguments)}}();return{viewFileHistoryEvent:n,recoverFileEvent:e,getComposerPathEvent:c}})),w=y(),b=w.activeType,j=w.siteInfo,E=w.isBindExtranet,O=(w.siteType,m()),S=O.getFileEvent,_=O.saveFileEvent,F=e(),T=F.viewFileHistoryEvent,x=F.recoverFileEvent,P=F.getComposerPathEvent,G=c().plugin,k=n("d",p("config")),C=(n("t",p([{label:"配置文件",name:"config",render:function(){}},{label:"Composer配置文件",name:"composer",render:function(){}}])),n("e",p(""))),I=n("h",p()),q=n("f",p("")),N=h(function(){var t="nodejs"===b.value?"node":b.value,n="php"!==b.value&&"proxy"!==b.value&&"proxy"!==b.value?"".concat(t,"_"):"",e="/www/server/panel/vhost/".concat(G.value.webserver,"/").concat(n).concat(j.value.name,".conf");return"config"===k.value?e.replace(/\/+/g,"/"):R.value}),R=n("c",p(""));p(!1);var B=n("b",p(!1)),H=n("g",function(){var n=r(t().m(function n(e){var r,a;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,B.value=!0,t.n=1,S(e);case 1:r=t.v,a=r.data,C.value=a.data,i(a.historys)&&(I.value=a.historys),B.value=!1,t.n=3;break;case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"获取配置文件失败"});case 3:return t.a(2)}},n,null,[[0,2]])}));return function(t){return n.apply(this,arguments)}}()),K=(n("a",function(t,n){k.value=n,H({path:N.value})}),n("s",r(t().m(function n(){var e,r=arguments;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:{data:C.value,encoding:"utf-8",path:N.value},t.p=1,t.n=2,_(e);case 2:t.v.status&&H({path:e.path}),t.n=4;break;case 3:return t.p=3,t.v,t.a(2,{status:!1,msg:"保存文件失败"});case 4:return t.a(2)}},n,null,[[1,3]])}))),n("v",function(){var n=r(t().m(function n(e){var r;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,T({row:e,path:N.value});case 1:return r=t.v,q.value=r.status?r.data:"文件不存在",t.a(2,r);case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"获取文件历史失败"})}},n,null,[[0,2]])}));return function(t){return n.apply(this,arguments)}}()),n("r",function(){var n=r(t().m(function n(e){var r;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,s({title:"恢复历史文件",content:"是否恢复历史文件 ".concat(f(e))});case 1:return t.n=2,x({row:e,path:N.value});case 2:return r=t.v,l.request({status:r.status,msg:r.status?"恢复成功":"恢复失败"}),r.status&&H({path:N.value}),t.a(2,r.status);case 3:t.p=3,t.v;case 4:return t.a(2)}},n,null,[[0,3]])}));return function(t){return n.apply(this,arguments)}}()),n("j",function(){var t=j.value,n=t.project_type,e=t.project_config;t.name;E.value=!(null==e||!e.bind_extranet),["php","html","proxy"].includes(n)&&(E.value=!0),"php"===n&&L()})),L=function(){var n=r(t().m(function n(){var e;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,P(j.value.path);case 1:return(e=t.v).status&&(R.value=e.data),t.a(2,e);case 2:return t.p=2,t.v,t.a(2,{status:!1,msg:"获取composer路径失败"})}},n,null,[[0,2]])}));return function(){return n.apply(this,arguments)}}();n("i",r(t().m(function n(){return t().w(function(t){for(;;)switch(t.n){case 0:if(K(),!E.value){t.n=1;break}return t.n=1,H({path:N.value});case 1:return t.a(2)}},n)})))}}})}();
