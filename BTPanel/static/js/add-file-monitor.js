import{K as a,W as e}from"./utils-lib.js?v=1756369731";import{c as t,k as s,r as o,g as l,p as i,q as r,v as p,e as d,A as n,x as c,F as m,a_ as u,a9 as f,ac as h,a7 as b,y as _,z as g,T as D}from"./base-lib.js?v=1756369731";import{_ as j}from"./index101.js?v=1756369731";import{bJ as y}from"./firewall.js?v=1756369731";import{f as w}from"./validator.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const x={class:"p-20px"},v=t({__name:"add-file-monitor",props:{compData:{default:()=>{}}},setup(t,{expose:v}){const V=t,k=s({path:"",type:"dir",domain:V.compData.name,actions:[]}),q=o(),C=l(()=>"dir"===k.type),F=[{name:"read",title:"读取"},{name:"del",title:"删除"},{name:"reit",title:"修改/增加"}],U={path:[{required:!0,message:"请选择监测路径",trigger:"blur"}],actions:[{required:!0,message:"请选择告警操作",trigger:"change"}]},z=()=>{V.compData.row||w({type:"all",path:k.path,change:(a,e)=>{k.path=a,k.type=e,k.actions="dir"===e?["read"]:["read","del","reit"]}})};return i(()=>(()=>{if(V.compData.path&&(k.path=V.compData.path.replace("//","/")),V.compData.row){const a=["del","read","reit"],e=[];Object.entries(V.compData.row).forEach(([t,s])=>{a.includes(t)&&Number(s)&&e.push(t)}),k.type=V.compData.row.type,k.actions=e}})()),v({onConfirm:async e=>{await q.value.validate();let t={...k},s=[0,0,0,0];k.actions.includes("read")&&(s[0]=1),k.actions.includes("del")&&(s[1]=1),k.actions.includes("reit")&&(s[2]=1,s[3]=1),t.actions=s.join(","),await a({loading:"正在添加文件监视器，请稍后...",request:y(!!V.compData.row,{...t}),message:!0,success:a=>{a.status&&(V.compData.refresh&&V.compData.refresh(),e())}})}}),(a,t)=>{const s=j,o=f,l=D,i=h,y=b,w=e;return r(),p("div",x,[d(y,{model:c(k),ref_key:"addFileMonitorRef",ref:q,rules:U},{default:n(()=>[d(o,{prop:"path",label:"监测路径"},{default:n(()=>[d(s,{modelValue:c(k).path,"onUpdate:modelValue":t[0]||(t[0]=a=>c(k).path=a),class:"!w-[28rem]",icon:"icon-file_mode",onIconClick:z,disabled:!!V.compData.row,onChangePassive:t[1]||(t[1]=a=>{k.path=k.path.replace(/\s+/g,"")}),placeholder:"请选择文件目录"},null,8,["modelValue","disabled"])]),_:1}),d(o,{label:"告警操作",prop:"actions"},{default:n(()=>[d(i,{modelValue:c(k).actions,"onUpdate:modelValue":t[2]||(t[2]=a=>c(k).actions=a)},{default:n(()=>[(r(),p(m,null,u(F,(a,e)=>d(l,{key:e,label:a.name,disabled:c(C)&&e>0},{default:n(()=>[_("div",null,[_("span",null,g(a.title),1)])]),_:2},1032,["label","disabled"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),d(w,{options:[{content:"目录暂时只支持读取告警操作"}],class:"ml-20px mt-20px","list-style":"disc"})])}}});export{v as default};
