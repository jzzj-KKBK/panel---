import{K as a,k as e,j as l,h as s}from"./utils-lib.js?v=1756369731";import{c as d,r as t,p as u,G as o,q as i,v as n,H as r,x as m,e as p,A as c,y as v,P as b,F as _,a_ as f,M as V,B as j,a9 as q,ai as y,aj as h,a7 as w}from"./base-lib.js?v=1756369731";import{getSiteInfo as x,getMysqlInfo as g,modifyMysqlLink as k}from"./database.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const U={class:"p-[20px]"},A=d({__name:"index",setup(d,{expose:A}){const C=t(!1),H=t(!1),B=t([]),F=t([]),G=t({sql_id:"",pid:"",database:""}),K=[{prop:"name",label:"数据库"},{label:"站点名称",render:function(a){return p("div",null,[a.rname||"--"," ",p("span",{class:"cursor-pointer bt-link",onClick:()=>M(a)},[j("切换")])])}}],M=async a=>{var e;try{const l=await x();B.value=l.data,G.value.database=a.name,G.value.sql_id=a.id,G.value.pid=a.pid?a.pid:null==(e=B.value[0])?void 0:e.id,C.value=!0}catch(l){}},P=async()=>{await a({request:g(),loading:H,data:[Array,F]})},z=async()=>{const e={pid:G.value.pid,sql_id:G.value.sql_id};await a({request:k(e),loading:"正在切换中...",message:!0,success:()=>{C.value=!1,P()}})};return u(P),A({init:P}),(a,d)=>{const t=e,u=l,j=q,x=y,g=h,k=w,A=s,M=o("bt-loading");return i(),n("div",null,[r(p(t,{"max-height":"560",column:K,data:m(F)},null,8,["data"]),[[M,m(H)]]),p(A,{title:"切换网站",modelValue:m(C),"onUpdate:modelValue":d[3]||(d[3]=a=>b(C)?C.value=a:null),area:42,"show-footer":"",onConfirm:z},{default:c(()=>[v("div",U,[p(k,{modelValue:m(G),"onUpdate:modelValue":d[2]||(d[2]=a=>b(G)?G.value=a:null)},{default:c(()=>[p(j,{label:"数据库"},{default:c(()=>[p(u,{disabled:"",modelValue:m(G).database,"onUpdate:modelValue":d[0]||(d[0]=a=>m(G).database=a),width:"24rem"},null,8,["modelValue"])]),_:1}),p(j,{label:"站点名称"},{default:c(()=>[p(g,{modelValue:m(G).pid,"onUpdate:modelValue":d[1]||(d[1]=a=>m(G).pid=a),class:"!w-[24rem]"},{default:c(()=>[(i(!0),n(_,null,f(m(B),(a,e)=>(i(),V(x,{key:e,label:a.rname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}});export{A as default};
