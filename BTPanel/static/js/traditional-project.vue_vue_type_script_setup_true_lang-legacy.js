!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function t(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?n(Object(l),!0).forEach(function(n){r(e,n,l[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):n(Object(l)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(l,n))})}return e}function r(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var l=r.call(n,t||"default");if("object"!=e(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function u(t,r,l,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return o(s,"_invoke",function(t,r,l){var o,a,u,c=0,s=l||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return o=n,a=0,u=e,f.n=t,i}};function p(t,r){for(a=t,u=r,n=0;!d&&c&&!l&&n<s.length;n++){var l,o=s[n],p=f.p,m=o[2];t>3?(l=m===r)&&(u=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=p&&((l=t<2&&p<o[1])?(a=0,f.v=r,f.n=o[1]):p<m&&(l=t<3||o[0]>r||r>m)&&(o[4]=t,o[5]=r,f.n=m,a=0))}if(l||t>1)return i;throw d=!0,r}return function(l,s,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&p(s,m),a=s,u=m;(n=a<2?e:u)||!d;){o||(a?a<3?(a>1&&(f.n=-1),p(a,u)):f.n=u:f.v=u);try{if(c=2,o){if(a||(l="next"),n=o[l]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,a<2&&(a=0)}else 1===a&&(n=o.return)&&n.call(o),a<2&&(u=TypeError("The iterator does not provide a '"+l+"' method"),a=1);o=e}else if((n=(d=f.n<0)?u:t.call(r,f))!==i)break}catch(n){o=e,a=1,u=n}finally{c=1}}return{value:n,done:d}}}(t,l,a),!0),s}var i={};function c(){}function s(){}function d(){}n=Object.getPrototypeOf;var f=[][r]?n(n([][r]())):(o(n={},r,function(){return this}),n),p=d.prototype=c.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,o(p,"constructor",d),o(d,"constructor",s),s.displayName="GeneratorFunction",o(d,a,"GeneratorFunction"),o(p),o(p,a,"Generator"),o(p,r,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(l=function(){return{w:u,m:m}})()}function o(e,n,t,r){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}o=function(e,n,t,r){function a(n,t){o(e,n,function(e){return this._invoke(n,t,e)})}n?l?l(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},o(e,n,t,r)}function a(e,n,t,r,l,o,a){try{var u=e[o](a),i=u.value}catch(e){return void t(e)}u.done?n(i):Promise.resolve(i).then(r,l)}function u(e){return function(){var n=this,t=arguments;return new Promise(function(r,l){var o=e.apply(n,t);function u(e){a(o,r,l,u,i,"next",e)}function i(e){a(o,r,l,u,i,"throw",e)}u(void 0)})}}function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return c(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./base-lib-legacy.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./index-legacy101.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./validator-legacy.js?v=1756369731","./index-legacy70.js?v=1756369731","./site-legacy.js?v=1756369731","./index-legacy140.js?v=1756369731"],function(e,n){"use strict";var r,o,a,c,s,d,f,p,m,v,_,w,g,y,j,b,h,x,V,k,O,U,C,D,S,I,P,N,q,E,F,T,A,B,G,M,W,z,R,J,K,$,H,L,Q,X,Y,Z,ee,ne,te,re,le,oe;return{setters:[function(e){r=e.c,o=e.r,a=e.ay,c=e.g,s=e.w,d=e.q,f=e.M,p=e.A,m=e.e,v=e.y,_=e.x,w=e.v,g=e.a_,y=e.F,j=e.B,b=e.C,h=e.z,x=e.P,V=e.m,k=e.aj,O=e.a9,U=e.aQ,C=e.T,D=e.ax,S=e.ai,I=e.K,P=e.D,N=e.J,q=e.ah,E=e.af,F=e.al},function(e){T=e._},function(e){A=e.G,B=e.j,G=e.bV,M=e.K,W=e.bv,z=e._,R=e.H,J=e.c,K=e.fg,$=e.gx},function(e){H=e._},function(e){L=e.u},function(e){Q=e.f},function(e){X=e.n,Y=e.g,Z=e.i,ee=e.o,ne=e.u,te=e.s},function(e){re=e.checkPathStatus,le=e.getRunList},function(e){oe=e.B}],execute:function(){var n={class:"flex items-center"},ae={class:"flex items-center"},ue={key:0,class:"text-1.2rem ml-[0.8rem] text-[#999]"},ie={key:0,class:"text-danger text-[1.2rem]"},ce=r({__name:"advanced-config",props:{ps:{},rowData:{}},setup:function(e,t){var r,l=t.expose,u=e,I=o(),P=o((null===(r=u.rowData)||void 0===r?void 0:r.project_name)||!1),N=o(!1),q=a("nodeData",{user_list:[]}),E=A({data:function(){var e,n,t,r,l=(null===(e=q.value)||void 0===e||null===(e=e.user_list)||void 0===e?void 0:e.length)&&-1===(null===(n=q.value.user_list)||void 0===n?void 0:n.findIndex(function(e){return"www"===e}));return{run_user:P.value?(null===(t=u.rowData)||void 0===t?void 0:t.run_user)||"":l?q.value.user_list[0]:"www",port:(null===(r=u.rowData)||void 0===r?void 0:r.port)||"",release_firewall:!1,project_ps:(null==u?void 0:u.ps)||"",domains:""}},options:function(){return c(function(){return[{type:"slots",key:"custom",rules:{run_user:[{required:!0,message:"请选择运行用户",trigger:"change"}]}}]})}}),F=E.BtForm,T=E.param;return s(function(){return u.ps},function(e){T.value.project_ps=e||""},{immediate:!0}),l({formData:T,popover:I}),function(e,t){var r=S,l=k,o=O,a=B,c=U,s=C,E=D;return d(),f(_(F),V({class:"mt-2rem"},e.$attrs),{custom:p(function(){return[m(o,{label:"运行用户",prop:"run_user"},{default:p(function(){return[v("div",n,[m(l,{modelValue:_(T).run_user,"onUpdate:modelValue":t[0]||(t[0]=function(e){return _(T).run_user=e}),class:"mr-8px !w-[16rem]"},{default:p(function(){return[(d(!0),w(y,null,g(_(q).user_list,function(e,n){return d(),f(r,{key:n,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),t[7]||(t[7]=v("span",{class:"text-[1.2rem] text-[#666]"},"* 无特殊需求请选择www用户",-1))])]}),_:1}),m(o,{label:"项目端口"},{default:p(function(){var e,n,r;return[v("div",ae,[m(a,{width:"20rem",type:"number",class:"mr-12px !w-[20rem]",min:1,max:65535,modelValue:_(T).port,"onUpdate:modelValue":t[1]||(t[1]=function(e){return _(T).port=e}),placeholder:"请输入项目的真实端口"},null,8,["modelValue"]),_(P)?b("",!0):(d(),w(y,{key:0},[""===_(T).port?(d(),w("span",ue,"* 若不清楚端口可不填写")):(d(),f(s,{key:1,modelValue:_(T).release_firewall,"onUpdate:modelValue":t[2]||(t[2]=function(e){return _(T).release_firewall=e})},{default:p(function(){return[t[9]||(t[9]=j(" 放行端口 ",-1)),m(c,{class:"item",effect:"dark",content:"选中将在防火墙安全组放行监听端口，放行后该项目可在外网访问",placement:"right"},{default:p(function(){return i(t[8]||(t[8]=[v("i",{class:"svgtofont-el-question text-warning"},null,-1)]))}),_:1})]}),_:1},8,["modelValue"]))],64))]),!_(P)||null===(e=u.rowData)||void 0===e||null===(e=e.listen)||void 0===e||!e.length||null!==(n=u.rowData)&&void 0!==n&&null!==(n=n.listen)&&void 0!==n&&n.includes(_(T).port)?b("",!0):(d(),w("span",ie," 项目端口可能有误，检测到当前项目监听了以下端口[ "+h(null===(r=u.rowData)||void 0===r||null===(r=r.listen)||void 0===r?void 0:r.join(","))+" ]",1))]}),_:1}),m(o,{label:"项目备注"},{default:p(function(){return[m(a,{modelValue:_(T).project_ps,"onUpdate:modelValue":t[3]||(t[3]=function(e){return _(T).project_ps=e}),placeholder:"请输入项目备注",width:"24rem"},null,8,["modelValue"])]}),_:1}),_(P)?b("",!0):(d(),f(o,{key:0,label:"绑定域名"},{default:p(function(){return[m(E,{ref_key:"popover",ref:I,placement:"top-start","popper-class":"green-tips-popover !p-0",title:"",width:"400",visible:_(N),"onUpdate:visible":t[6]||(t[6]=function(e){return x(N)?N.value=e:null}),"trigger-keys":[],trigger:"focus"},{reference:p(function(){return[m(a,{rows:6,resize:"none",width:"40rem",modelValue:_(T).domains,"onUpdate:modelValue":t[4]||(t[4]=function(e){return _(T).domains=e}),onFocus:t[5]||(t[5]=function(e){return N.value=!0}),type:"textarea",placeholder:"如需填写多个域名，请换行填写，每行一个域名，默认为80端口\nIP地址格式：192.168.1.199\n泛解析添加方法 *.domain.com\n如另加端口格式为 www.domain.com:88"},null,8,["modelValue"])]}),default:p(function(){return[t[10]||(t[10]=v("div",{class:"!p-[12px] bg-[#20a53a] text-white"},[j(" 如需填写多个域名，请换行填写，每行一个域名，默认为80端口"),v("br"),j(" IP地址格式：192.168.1.199"),v("br"),j(" 泛解析添加方法 *.domain.com"),v("br"),j(" 如另加端口格式为 www.domain.com:88 ")],-1))]}),_:1},8,["visible"])]}),_:1}))]}),_:1},16)}}}),se={key:0,class:"ml-8px text-[1.2rem] text-danger leading-[2rem]"},de={class:"flex items-center"},fe={class:"flex items-center"},pe={class:"flex items-center custom-refresh-select"},me={class:"el-input-group__append !h-3rem !flex items-center"},ve={class:"flex items-center"},_e={key:0,class:"pl-[12rem]"},we=(e("_",r({__name:"node-project",setup:function(e,n){var r,s,h=n.expose,x=L().siteInfo,V=o(!1),U=o([]),D=o(""),N=o(X.value.nodejs_versions),q=o(X.value.package_managers),E=o(),F=a("getNodeData",function(e){}),K=function(){var e=u(l().m(function e(){var n,t;return l().w(function(e){for(;;)switch(e.n){case 0:return t=console,e.n=1,F(!0);case 1:return t.log.call(t,"刷新Node版本",e.v),e.n=2,F(!0);case 2:n=e.v,N.value=n.nodejs_versions;case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),$=function(){var e;Q({type:"dir",path:je.value.project_cwd,change:(e=u(l().m(function e(n){var t,r,o,a;return l().w(function(e){for(;;)switch(e.n){case 0:if(je.value.project_cwd=n,Z.value){e.n=3;break}return r=null===(t=n.substring(n.lastIndexOf("/")+1))||void 0===t?void 0:t.replace(/\W/g,"_"),je.value.project_name||(je.value.project_name=r),D.value=r,e.n=1,ie(je.value.project_cwd);case 1:return o=e.v,Object.assign(je.value,o),e.n=2,oe(n);case 2:(a=e.v).node_modules&&(je.value.not_install_pkg=!0),V.value=!a.package_json;case 3:return e.a(2)}},e)})),function(n){return e.apply(this,arguments)})})},oe=function(){var e=u(l().m(function e(n){var t,r;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,M({request:re({path:n})});case 1:return t=e.v,r=t.data,e.a(2,r)}},e)}));return function(n){return e.apply(this,arguments)}}(),ae=function(){Q({type:"file",path:je.value.project_cwd,change:function(e){je.value.userCmd=e}})},ue=function(){var e=u(l().m(function e(n){var t;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ne(n);case 1:t=e.v,q.value=t,je.value.pkg_manager=t[0]||"";case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),ie=function(){var e=u(l().m(function e(n){var t,r,o,a,u;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return t={},e.p=1,e.n=2,le({data:JSON.stringify({project_cwd:n})});case 2:return r=e.v,o=W(r.data,"object",{}),0===Object.keys(o).length?t.project_script="0":(a=Object.keys(o),U.value=a.map(function(e){return{label:e+":"+o[e],value:e}}),t.project_script=a[0]||""),Z.value&&(u=x.value.project_config.project_script,t.project_script=u,t.userCmd=u,!U.value.find(function(e){return e.value===u})&&(t.project_script="0")),e.a(2,t);case 3:return e.p=3,e.v,e.a(2,t)}},e,null,[[1,3]])}));return function(n){return e.apply(this,arguments)}}(),we=A({data:(s=u(l().m(function e(){var n,r,o,a,u,i;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Y();case 1:if(q.value=X.value.package_managers,N.value=X.value.nodejs_versions,!Z.value){e.n=3;break}return o=x.value,a=o.project_config,u=o.ps,e.n=2,ie(a.project_cwd);case 2:return i=e.v,D.value=u,e.a(2,t(t({},a),{},{project_type:a.project_type||"nodejs",userCmd:""},i));case 3:return e.a(2,{project_name:"",project_script:"",project_cwd:"/www/wwwroot",project_type:"nodejs",pkg_manager:(null===(n=q.value)||void 0===n?void 0:n.at(0))||"",not_install_pkg:!1,run_user:"www",nodejs_version:(null===(r=N.value)||void 0===r?void 0:r.at(0))||"",userCmd:""})}},e)})),function(){return s.apply(this,arguments)}),options:function(e){return c(function(){return[{type:"slots",key:"custom",rules:{project_cwd:[G({message:"请输入项目启动目录"})],project_name:[G({message:"请输入项目名称"})],nodejs_version:[{required:!0,message:"请选择Node版本",trigger:["blur","change"]}],project_script:[G({message:"请选择项目启动脚本"})]}}]})},submit:(r=u(l().m(function e(n,r){var o;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:return o=E.value.formData,e.a(2,t(t(t({},n.value),{},{project_script:"0"===n.value.project_script?n.value.userCmd:n.value.project_script},o),{},{domains:o.domains?o.domains.split("\n"):[]}))}},e)})),function(e,n){return r.apply(this,arguments)})}),ge=we.BtForm,ye=we.submit,je=we.param,be=function(){var e=u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ye();case 1:n=e.v,te(n);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return h({submit:ye}),function(e,n){var r=H,l=O,o=B,a=S,u=k,c=z,s=R,h=J,F=C,A=T,G=P;return d(),w("div",{class:"overflow-auto",style:I({"max-height":_(Z)?"76rem":"50rem"})},[m(_(ge),{"label-width":"80px"},{custom:p(function(){return[m(l,{label:"项目目录",prop:"project_cwd"},{default:p(function(){return[v("div",null,[m(r,{modelValue:_(je).project_cwd,"onUpdate:modelValue":n[0]||(n[0]=function(e){return _(je).project_cwd=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择Node项目目录",onIconClick:$,width:"32rem"},null,8,["modelValue"]),_(V)?(d(),w("div",se,"* 文件夹中未检测到package.json文件，建议前往传统项目进行项目添加")):b("",!0)])]}),_:1}),m(l,{label:"项目名称",prop:"project_name"},{default:p(function(){return[m(o,{disabled:_(Z),modelValue:_(je).project_name,"onUpdate:modelValue":n[1]||(n[1]=function(e){return _(je).project_name=e}),width:"32rem",placeholder:"请输入Node项目名称"},null,8,["disabled","modelValue"])]}),_:1}),m(l,{label:"启动选项",prop:"project_script"},{default:p(function(){return[v("div",de,[m(u,{placeholder:"请选择项目目录进行操作",modelValue:_(je).project_script,"onUpdate:modelValue":n[2]||(n[2]=function(e){return _(je).project_script=e}),class:"!w-[30rem]",disabled:"/www/wwwroot/"===_(je).project_cwd||"/www/wwwroot"===_(je).project_cwd},{default:p(function(){return[m(a,{label:"自定义启动命令",value:"0"}),(d(!0),w(y,null,g(_(U),function(e){return d(),f(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue","disabled"]),n[7]||(n[7]=v("span",{class:"ml-8px text-[1.2rem]"},"* 自动获取package.json文件中的启动模式",-1))])]}),_:1}),"0"===_(je).project_script?(d(),f(l,{key:0,label:" "},{default:p(function(){return[m(r,{modelValue:_(je).userCmd,"onUpdate:modelValue":n[3]||(n[3]=function(e){return _(je).userCmd=e}),placeholder:"请输入自定义启动命令",icon:"el-folder-opened",onIconClick:ae,width:"32rem"},null,8,["modelValue"])]}),_:1})):b("",!0),m(l,{label:"Node版本",prop:"nodejs_version"},{default:p(function(){return[v("div",fe,[v("div",pe,[m(u,{modelValue:_(je).nodejs_version,"onUpdate:modelValue":n[4]||(n[4]=function(e){return _(je).nodejs_version=e}),class:"!w-[16rem]",onChange:ue},{default:p(function(){return[(d(!0),w(y,null,g(_(N),function(e){return d(),f(a,{key:e,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),v("div",me,[m(s,{title:"刷新Node版本",class:"!flex",onClick:K},{default:p(function(){return[m(c,{icon:"el-refresh",class:"!text-[14px]"})]}),_:1})])]),n[9]||(n[9]=v("span",{class:"ml-8px text-[1.2rem] text-[#666]"},"* 请根据项目选择合适的Node版本，",-1)),m(h,{onClick:_(ee)},{default:p(function(){return i(n[8]||(n[8]=[j("安装其他版本",-1)]))}),_:1},8,["onClick"])])]}),_:1}),m(l,{label:"包管理器"},{default:p(function(){return[v("div",ve,[m(u,{modelValue:_(je).pkg_manager,"onUpdate:modelValue":n[5]||(n[5]=function(e){return _(je).pkg_manager=e}),class:"!w-[16rem]"},{default:p(function(){return[(d(!0),w(y,null,g(_(q),function(e,n){return d(),f(a,{key:n,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),n[11]||(n[11]=v("span",{class:"text-[1.2rem] text-[#666 mx-8px"},"* 请选择项目的包管理器",-1)),_(Z)?b("",!0):(d(),f(F,{key:0,modelValue:_(je).not_install_pkg,"onUpdate:modelValue":n[6]||(n[6]=function(e){return _(je).not_install_pkg=e})},{default:p(function(){return i(n[10]||(n[10]=[j(" 不安装node_module ",-1)]))}),_:1},8,["modelValue"]))])]}),_:1})]}),_:1}),m(A,{isShowDivider:!_(Z)},{config:p(function(){var e,n;return[m(ce,{ref_key:"advancedConfigRef",ref:E,"label-width":"80px",type:"node",rowData:t(t({},null===(e=_(x))||void 0===e?void 0:e.project_config),{},{listen:null===(n=_(x))||void 0===n?void 0:n.listen}),ps:_(D)},null,8,["rowData","ps"])]}),_:1},8,["isShowDivider"]),_(Z)?(d(),w("div",_e,[m(G,{type:"primary",onClick:be},{default:p(function(){return i(n[12]||(n[12]=[j("保存修改",-1)]))}),_:1})])):b("",!0),n[13]||(n[13]=v("ul",{class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-32px"},[v("li",null,"【启动选项】：默认读取package.json中的scripts列表，也可以选择[自定义启动命令]选项来手动输入启动命令"),v("li",null,"【自定义启动命令】：可以选择启动文件，或直接输入启动命令，支持的启动方式：例：npm/node/pm2/yarn"),v("li",null,"【项目端口】：错误的端口会导致访问502，若不知道端口，可先随意填写，启动项目后再改为正确端口"),v("li",null,"【运行用户】：为了安全考虑，默认使用www用户运行，root用户运行可能带来安全风险")],-1))],4)}}})),{class:"flex items-center"}),ge={class:"flex items-center custom-refresh-select"},ye={class:"el-input-group__append !h-3rem !flex items-center"},je={key:2,class:"mt-2rem"},be={class:"flex items-center"},he={class:"flex items-center"},xe={class:"text-[1.2rem] text-[#666] ml-[0.8rem]"},Ve={class:"flex items-center"},ke={key:3,class:"mt-2rem"},Oe={class:"flex items-center"},Ue={key:0,class:"mb-[2rem]"},Ce=(e("a",r({__name:"pm-project",props:{compData:{default:function(){return{isEdit:!1}}}},setup:function(e,n){var r,s,x=n.expose,V=L().siteInfo,U=o(X.value.nodejs_versions),D=o(X.value.package_managers),M=c(function(){return Z.value?V.value.ps:pe.value.project_name}),W=o(),re=a("getNodeData",function(e){}),le=function(){var e=u(l().m(function e(n){var t,r;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,$({path:n});case 1:return t=e.v,r=t.data,e.a(2,r.data);case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),ae=function(e,n){var t;Q({type:n,path:"file"===e?pe.value.project_file:pe.value.project_cwd,change:(t=u(l().m(function n(t){var r,o,a,u,i,c;return l().w(function(n){for(;;)switch(n.n){case 0:if(r=pe.value.project_name,"cwd"!==e){n.n=1;break}pe.value.project_cwd=t,a=null===(o=t.substring(t.lastIndexOf("/")+1))||void 0===o?void 0:o.replace(/\W/g,"_"),r||(pe.value.project_name=a),n.n=3;break;case 1:if(pe.value.project_cwd=t.substring(0,t.lastIndexOf("/")),i=null===(u=pe.value.project_cwd.substring(pe.value.project_cwd.lastIndexOf("/")+1))||void 0===u?void 0:u.replace(/\W/g,"_"),r||(pe.value.project_name=i),"file"===e&&(pe.value.project_file=t),"config_file"!==e){n.n=3;break}return pe.value.config_file=t,n.n=2,le(t);case 2:c=n.v,pe.value.config_body=c;case 3:return n.a(2)}},n)})),function(e){return t.apply(this,arguments)})})},ue=function(e){me()},ie=function(){var e=u(l().m(function e(n){var t;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ne(n);case 1:t=e.v,D.value=t,pe.value.pkg_manager=t[0]||"";case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),se=A({data:(s=u(l().m(function e(){var n,r,o,a,u;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Y();case 1:if(D.value=X.value.package_managers,U.value=X.value.nodejs_versions,!Z.value){e.n=2;break}return o=V.value,a=o.project_config,u=o.ps,e.a(2,t(t({},a),{},{project_ps:K(u),watch:"true"===a.watch}));case 2:return e.a(2,{add_type:0,project_name:"",project_type:"pm2",project_cwd:"",project_file:"",pkg_manager:(null===(n=D.value)||void 0===n?void 0:n.at(0))||"yarn",not_install_pkg:!1,nodejs_version:(null===(r=U.value)||void 0===r?void 0:r.at(0))||"",cluster:1,max_memory_limit:1024,watch:!1,config_file:"",config_body:"",project_args:"",env:""})}},e)})),function(){return s.apply(this,arguments)}),options:function(){return c(function(){return[{type:"slots",key:"custom",rules:{project_name:[G({message:"请输入项目名称"})],project_file:[{required:!0,message:"请输入项目启动文件",trigger:["blur","change"]}],nodejs_version:[{required:!0,message:"请选择Node版本",trigger:["blur","change"]}],project_cwd:[G({message:"请输入项目启动目录"})],cluster:[{required:!0,message:"请输入负载实例数量",trigger:["blur","change"]}],max_memory_limit:[{required:!0,message:"请输入内存上限",trigger:["blur","change"]}]}}]})},submit:(r=u(l().m(function e(n,r){var o,a;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:return a=W.value.formData,0===(o=t(t(t({},n.value),a),{},{domains:a.domains?a.domains.split("\n"):[]})).add_type&&(delete o.config_file,delete o.config_body),delete o.add_type,e.a(2,o)}},e)})),function(e,n){return r.apply(this,arguments)})}),de=se.BtForm,fe=se.submit,pe=se.param,me=se.clearValidate,ve=function(){var e=u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fe();case 1:n=e.v,te(n);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return x({submit:fe}),function(e,n){var t=B,r=O,l=S,o=k,a=z,u=R,c=J,s=q,x=E,A=H,G=F,K=C,$=oe,L=T,Q=P;return d(),w("div",{class:"overflow-auto",style:I({"max-height":_(Z)?"68rem":"50rem"})},[m(_(de),{"label-width":"90px"},{custom:p(function(){return[m(r,{label:"项目名称",prop:"project_name"},{default:p(function(){return[m(t,{modelValue:_(pe).project_name,"onUpdate:modelValue":n[0]||(n[0]=function(e){return _(pe).project_name=e}),width:"32rem",disabled:_(Z),placeholder:"请输入Node项目名称"},null,8,["modelValue","disabled"])]}),_:1}),_(Z)&&_(pe).pm2_name?(d(),f(r,{key:0,label:"PM2服务名"},{default:p(function(){return[m(t,{modelValue:_(pe).pm2_name,"onUpdate:modelValue":n[1]||(n[1]=function(e){return _(pe).pm2_name=e}),width:"32rem",disabled:""},null,8,["modelValue"])]}),_:1})):b("",!0),m(r,{label:"Node版本",prop:"nodejs_version"},{default:p(function(){return[v("div",we,[v("div",ge,[m(o,{onChange:ie,modelValue:_(pe).nodejs_version,"onUpdate:modelValue":n[2]||(n[2]=function(e){return _(pe).nodejs_version=e}),class:"!w-[16rem]"},{default:p(function(){return[(d(!0),w(y,null,g(_(U),function(e){return d(),f(l,{key:e,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),v("div",ye,[m(u,{title:"刷新Node版本",class:"!flex",onClick:n[3]||(n[3]=function(e){return _(re)(!0)})},{default:p(function(){return[m(a,{icon:"el-refresh",class:"!text-[14px]"})]}),_:1})])]),n[22]||(n[22]=v("span",{class:"ml-8px text-[1.2rem] text-[#666]"},"* 请根据项目选择合适的Node版本，",-1)),m(c,{onClick:_(ee)},{default:p(function(){return i(n[21]||(n[21]=[j("安装其他版本",-1)]))}),_:1},8,["onClick"])])]}),_:1}),_(Z)?b("",!0):(d(),f(r,{key:1,label:"添加方式",prop:"add_type"},{default:p(function(){return[m(x,{modelValue:_(pe).add_type,"onUpdate:modelValue":n[4]||(n[4]=function(e){return _(pe).add_type=e}),onChange:ue},{default:p(function(){return[m(s,{label:0},{default:p(function(){return i(n[23]||(n[23]=[j("自定义添加",-1)]))}),_:1}),m(s,{label:1},{default:p(function(){return i(n[24]||(n[24]=[j("从文件/内容添加",-1)]))}),_:1})]}),_:1},8,["modelValue"])]}),_:1})),0===_(pe).add_type?(d(),w("div",je,[m(r,{label:"启动文件",prop:"project_file"},{default:p(function(){return[m(A,{modelValue:_(pe).project_file,"onUpdate:modelValue":n[5]||(n[5]=function(e){return _(pe).project_file=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目启动文件",onIconClick:n[6]||(n[6]=function(e){return ae("file","file")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(r,{label:"运行目录",prop:"project_cwd"},{default:p(function(){return[m(A,{modelValue:_(pe).project_cwd,"onUpdate:modelValue":n[7]||(n[7]=function(e){return _(pe).project_cwd=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目运行目录",onIconClick:n[8]||(n[8]=function(e){return ae("cwd","dir")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(r,{label:"负载实例数量",prop:"cluster"},{default:p(function(){return[v("div",be,[m(t,{width:"10rem",class:"!w-[10rem]",type:"number",modelValue:_(pe).cluster,"onUpdate:modelValue":n[9]||(n[9]=function(e){return _(pe).cluster=e}),min:1},null,8,["modelValue"]),n[25]||(n[25]=v("span",{class:"text-[1.2rem] text-[#666] ml-[0.8rem]"},"* 若实例数量大于1，则开启集群模式",-1))])]}),_:1}),m(r,{label:"内存上限",prop:"max_memory_limit"},{default:p(function(){return[v("div",he,[m(t,{width:"16rem",class:"!w-[16rem]",type:"number","text-type":"MB",min:1,modelValue:_(pe).max_memory_limit,"onUpdate:modelValue":n[10]||(n[10]=function(e){return _(pe).max_memory_limit=e})},null,8,["modelValue"]),v("span",xe,"* 超过上限PM2会自动重启项目，系统最大可用内存为["+h(_(X).maximum_memory)+"MB]",1)])]}),_:1}),m(r,{label:"自动重载"},{default:p(function(){return[m(G,{modelValue:_(pe).watch,"onUpdate:modelValue":n[11]||(n[11]=function(e){return _(pe).watch=e})},null,8,["modelValue"])]}),_:1}),m(r,{label:"包管理器"},{default:p(function(){return[v("div",Ve,[m(o,{modelValue:_(pe).pkg_manager,"onUpdate:modelValue":n[12]||(n[12]=function(e){return _(pe).pkg_manager=e}),class:"!w-[16rem]"},{default:p(function(){return[(d(!0),w(y,null,g(_(D),function(e,n){return d(),f(l,{key:n,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),n[27]||(n[27]=v("span",{class:"text-[1.2rem] text-[#666 mx-8px"},"* 请选择项目的包管理器",-1)),_(Z)?b("",!0):(d(),f(K,{key:0,modelValue:_(pe).not_install_pkg,"onUpdate:modelValue":n[13]||(n[13]=function(e){return _(pe).not_install_pkg=e})},{default:p(function(){return i(n[26]||(n[26]=[j(" 不安装node_module ",-1)]))}),_:1},8,["modelValue"]))])]}),_:1})])):(d(),w("div",ke,[m(r,{label:"配置文件"},{default:p(function(){return[v("div",Oe,[m(A,{modelValue:_(pe).config_file,"onUpdate:modelValue":n[14]||(n[14]=function(e){return _(pe).config_file=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目配置文件",onIconClick:n[15]||(n[15]=function(e){return ae("config_file","file")}),width:"32rem"},null,8,["modelValue"]),n[28]||(n[28]=v("span",{class:"text-1.2rem text-#999 leading-[18px] ml-4px"},"* 请选择pm2的ecosystem配置文件或粘贴内容",-1))])]}),_:1}),m(r,{label:"运行目录",prop:"project_cwd"},{default:p(function(){return[m(A,{modelValue:_(pe).project_cwd,"onUpdate:modelValue":n[16]||(n[16]=function(e){return _(pe).project_cwd=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目运行目录",onIconClick:n[17]||(n[17]=function(e){return ae("cwd","dir")}),width:"30rem"},null,8,["modelValue"])]}),_:1}),m(r,{label:"内容",prop:"config_body"},{default:p(function(){return[m($,{modelValue:_(pe).config_body,"onUpdate:modelValue":n[18]||(n[18]=function(e){return _(pe).config_body=e}),style:{height:"24rem"},class:"!h-[24rem] w-[58rem]"},null,8,["modelValue"])]}),_:1})])),m(L,{"is-show-divider":!_(Z)},{config:p(function(){var e;return[0===_(pe).add_type?(d(),w("div",Ue,[m(r,{label:"参数"},{default:p(function(){return[m(t,{width:"32rem ",placeholder:"请输入项目参数",modelValue:_(pe).project_args,"onUpdate:modelValue":n[19]||(n[19]=function(e){return _(pe).project_args=e})},null,8,["modelValue"])]}),_:1}),m(r,{label:"环境变量"},{default:p(function(){return[m(t,{width:"32rem",placeholder:"请输入项目环境变量，一行一个",resize:"none",rows:3,modelValue:_(pe).env,"onUpdate:modelValue":n[20]||(n[20]=function(e){return _(pe).env=e}),type:"textarea"},null,8,["modelValue"])]}),_:1})])):b("",!0),m(ce,{ref_key:"advanceConfigRef",ref:W,"label-width":"90px",rowData:null===(e=_(V))||void 0===e?void 0:e.project_config,ps:_(M)},null,8,["rowData","ps"])]}),_:1},8,["is-show-divider"])]}),_:1}),_(Z)?(d(),f(Q,{key:0,type:"primary",class:"!mt-[1.2rem] !ml-10rem",onClick:ve},{default:p(function(){return i(n[29]||(n[29]=[j(" 保存修改 ",-1)]))}),_:1})):b("",!0),v("ul",{class:N(["mt-[8px] leading-8 text-[1.2rem] list-disc ml-32px",{"mb-[20px]":_(Z)}])},i(n[30]||(n[30]=[v("li",null,"【启动文件】用于启动nodejs项目的启动文件，通常是一个js文件",-1),v("li",null,"【配置文件】用于pm2直接启动服务的文件，通常是名为ecosystem.config.cjs",-1),v("li",null,"【运行目录】运行项目时默认的运行目录，通常为启动文件或配置文件所在目录",-1),v("li",null,"【负载实例数】集群模式，有些项目可能不支持，实例数量>1时为开启集群模式",-1),v("li",null,"【负载均衡】开启集群模式后将根据实例数自动负载均衡",-1)])),2)],4)}}})),{class:"flex items-center"}),De={class:"flex items-center custom-refresh-select"},Se={class:"el-input-group__append !h-3rem !flex items-center"};e("b",r({__name:"traditional-project",props:{compData:{default:function(){return{isEdit:!1}}}},setup:function(e,n){var r=n.expose,s=L().siteInfo,h=o(X.value.nodejs_versions);o(X.value.package_managers);var x,V,U=o(),C=a("getNodeData",function(e){}),D=function(){var e=u(l().m(function e(n,t){return l().w(function(e){for(;;)switch(e.n){case 0:Q({type:t,path:"file"===n?F.value.project_file:F.value.project_cwd,change:function(){var e=u(l().m(function e(t){var r,o,a,u,i;return l().w(function(e){for(;;)switch(e.n){case 0:"file"===n?F.value.project_file=t:F.value.project_cwd=t,r=F.value.project_name,"cwd"===n&&""===r&&(a=null===(o=t.substring(t.lastIndexOf("/")+1))||void 0===o?void 0:o.replace(/\W/g,"_"),F.value.project_name=a),"file"===n&&(F.value.project_cwd=t.substring(0,t.lastIndexOf("/")),i=null===(u=F.value.project_cwd.substring(F.value.project_cwd.lastIndexOf("/")+1))||void 0===u?void 0:u.replace(/\W/g,"_"),""===r&&(F.value.project_name=i));case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(n,t){return e.apply(this,arguments)}}(),N=A({data:(V=u(l().m(function e(){var n,t;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Y();case 1:if(h.value=X.value.nodejs_versions,!Z.value){e.n=2;break}return e.a(2,null===(t=s.value)||void 0===t?void 0:t.project_config);case 2:return e.a(2,{project_name:"",nodejs_version:(null===(n=h.value)||void 0===n?void 0:n.at(0))||"",project_file:"",project_cwd:"",project_type:"general",project_args:"",env:""})}},e)})),function(){return V.apply(this,arguments)}),options:function(){return c(function(){return[{type:"slots",key:"custom",rules:{project_name:[G({message:"请输入项目名称"})],nodejs_version:[{required:!0,message:"请选择Node版本",trigger:["blur","change"]}],project_file:[{required:!0,message:"请输入项目启动文件",trigger:["blur","change"]}],project_cwd:[G({message:"请输入项目启动目录"})]}}]})},submit:(x=u(l().m(function e(n,r){var o,a;return l().w(function(e){for(;;)switch(e.n){case 0:return o=!1,e.n=1,r();case 1:return a=U.value.formData,o=t(t(t({},n.value),a),{},{domains:a.domains?a.domains.split("\n"):[]}),e.a(2,o)}},e)})),function(e,n){return x.apply(this,arguments)})}),q=N.BtForm,E=N.submit,F=N.param,M=function(){var e=u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,E();case 1:n=e.v,te(n);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return r({submit:E}),function(e,n){var r=B,l=O,o=S,a=k,u=z,c=R,x=J,V=H,N=T,E=P;return d(),w("div",{class:"overflow-auto",style:I({"max-height":_(Z)?"76rem":"52rem"})},[m(_(q),{"label-width":"80px"},{custom:p(function(){return[m(l,{label:"项目名称",prop:"project_name"},{default:p(function(){return[m(r,{modelValue:_(F).project_name,"onUpdate:modelValue":n[0]||(n[0]=function(e){return _(F).project_name=e}),width:"32rem",disabled:_(Z),placeholder:"请输入项目名称"},null,8,["modelValue","disabled"])]}),_:1}),m(l,{label:"Node版本",prop:"nodejs_version"},{default:p(function(){return[v("div",Ce,[v("div",De,[m(a,{modelValue:_(F).nodejs_version,"onUpdate:modelValue":n[1]||(n[1]=function(e){return _(F).nodejs_version=e}),class:"!w-[16rem]"},{default:p(function(){return[(d(!0),w(y,null,g(_(h),function(e){return d(),f(o,{key:e,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),v("div",Se,[m(c,{title:"刷新Node版本",class:"!flex",onClick:n[2]||(n[2]=function(e){return _(C)(!0)})},{default:p(function(){return[m(u,{icon:"el-refresh",class:"!text-[14px]"})]}),_:1})])]),n[10]||(n[10]=v("span",{class:"ml-8px text-[1.2rem] text-[#666]"},"* 请根据项目选择合适的Node版本，",-1)),m(x,{onClick:_(ee)},{default:p(function(){return i(n[9]||(n[9]=[j("安装其他版本",-1)]))}),_:1},8,["onClick"])])]}),_:1}),m(l,{label:"启动文件",prop:"project_file"},{default:p(function(){return[m(V,{modelValue:_(F).project_file,"onUpdate:modelValue":n[3]||(n[3]=function(e){return _(F).project_file=e}),readOnly:"",placeholder:"请选择项目启动文件",icon:"el-folder-opened",onIconClick:n[4]||(n[4]=function(e){return D("file","file")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(l,{label:"运行目录",prop:"project_cwd"},{default:p(function(){return[m(V,{modelValue:_(F).project_cwd,"onUpdate:modelValue":n[5]||(n[5]=function(e){return _(F).project_cwd=e}),readOnly:"",placeholder:"请选择项目运行目录",icon:"el-folder-opened",onIconClick:n[6]||(n[6]=function(e){return D("cwd","dir")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(l,{label:"参数"},{default:p(function(){return[m(r,{width:"32rem ",placeholder:"请输入项目参数",modelValue:_(F).project_args,"onUpdate:modelValue":n[7]||(n[7]=function(e){return _(F).project_args=e})},null,8,["modelValue"])]}),_:1}),m(l,{label:"环境变量"},{default:p(function(){return[m(r,{width:"32rem",placeholder:"请输入项目环境变量，一行一个，格式参照key=value",resize:"none",rows:3,modelValue:_(F).env,"onUpdate:modelValue":n[8]||(n[8]=function(e){return _(F).env=e}),type:"textarea"},null,8,["modelValue"])]}),_:1})]}),_:1}),m(N,{"is-show-divider":!_(Z)},{config:p(function(){var e,n;return[m(ce,{ref_key:"advanceConfigRef",ref:U,"label-width":"80px",rowData:t(t({},null===(e=_(s))||void 0===e?void 0:e.project_config),{},{listen:null===(n=_(s))||void 0===n?void 0:n.listen}),ps:_(F).project_name},null,8,["rowData","ps"])]}),_:1},8,["is-show-divider"]),_(Z)?(d(),f(E,{key:0,type:"primary",class:"!mt-[1.2rem] !ml-10rem",onClick:M},{default:p(function(){return i(n[11]||(n[11]=[j(" 保存修改 ",-1)]))}),_:1})):b("",!0),n[12]||(n[12]=v("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-32px"},[v("li",null,"【启动文件】用于启动nodejs项目的启动文件，通常是一个js文件"),v("li",null,"【运行目录】运行项目时默认的运行目录，通常为启动文件或配置文件所在目录")],-1))],4)}}}))}}})}();
