!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,u,l=[],i=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return l(s,"_invoke",function(n,r,a){var o,u,l,c=0,s=a||[],f=!1,v={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return o=t,u=0,l=e,v.n=n,i}};function p(n,r){for(u=n,l=r,t=0;!f&&c&&!a&&t<s.length;t++){var a,o=s[t],p=v.p,d=o[2];n>3?(a=d===r)&&(l=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=p&&((a=n<2&&p<o[1])?(u=0,v.v=r,v.n=o[1]):p<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,v.n=d,u=0))}if(a||n>1)return i;throw f=!0,r}return function(a,s,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,d),u=s,l=d;(t=u<2?e:l)||!f;){o||(u?u<3?(u>1&&(v.n=-1),p(u,l)):v.n=l:v.v=l);try{if(c=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=e}else if((t=(f=v.n<0)?l:n.call(r,v))!==i)break}catch(t){o=e,u=1,l=t}finally{c=1}}return{value:t,done:f}}}(n,a,o),!0),s}var i={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var v=[][r]?t(t([][r]())):(l(t={},r,function(){return this}),t),p=f.prototype=c.prototype=Object.create(v);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=f,l(p,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(p),l(p,a,"Generator"),l(p,r,function(){return this}),l(p,"toString",function(){return"[object Generator]"}),(u=function(){return{w:o,m:d}})()}function l(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,n,r){function o(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},l(e,t,n,r)}function i(e,t,n,r,a,o,u){try{var l=e[o](u),i=l.value}catch(e){return void n(e)}l.done?t(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function u(e){i(o,r,a,u,l,"next",e)}function l(e){i(o,r,a,u,l,"throw",e)}u(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./index-legacy103.js?v=1756369731","./column-legacy.js?v=1756369731","./useController-legacy6.js?v=1756369731"],function(t,r){"use strict";var o,l,i,s,f,v,p,d,m,b,y,_,h,g,w,S,j,k,O,x,q,R,M,P,E,C,T,B,D,L,A,G,N,W,H,I,Y,z,F,Q,$,V,J,U,K,Z,X,ee,te,ne;return{setters:[function(e){o=e.K,l=e.eY,i=e.eZ,s=e.at,f=e.e_,v=e.e$,p=e.u,d=e.eP,m=e.M,b=e.l,y=e.L,_=e.o,h=e.a6,g=e.v,w=e.R,S=e.f0,j=e.f1,k=e.aM,O=e.f2,x=e.a7,q=e.a8,R=e.e,M=e.f3,P=e.f4,E=e.f5,C=e.f6,T=e.al},function(e){B=e.j,D=e.bJ,L=e.s,A=e.r,G=e.e,N=e.B,W=e.bM,H=e.bN,I=e.i,Y=e.c,z=e.p,F=e.n,Q=e.q,$=e.v,V=e.A,J=e.x,U=e.J,K=e.M,Z=e.P},function(e){X=e._},function(e){ee=e.c,te=e.u,ne=e.a},null],execute:function(){t("g",function(e){var t,n,r,a,o,u,l,i,c,s,f,v,p,d,m,b,y,_,h,w,S,j,k,O,x,q,R,M,P,E,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"master";var T="master"==C?(null===(t=e.value)||void 0===t?void 0:t.master_detail.data)||{}:e.data||{},B=T.memory||{},D=T.performance||{},L=T.connections||{},A=T.replication||{},G=[{name:"base",label:"基础信息",items:[{label:"节点状态",value:"online"===T.status?"在线":"离线"},{label:"Redis版本",value:T.redis_version||"--"},{label:"运行天数",value:(null!==(n=T.uptime_days)&&void 0!==n?n:"--")+"天"},{label:"监听端口",value:null!==(r=T.port)&&void 0!==r?r:"--"},{label:"连接数",value:null!==(a=T.connected_slaves)&&void 0!==a?a:"--"},{label:"角色",value:null!==(o=T.role)&&void 0!==o?o:"--"}]},{name:"memory",label:"内存信息",items:[{label:"已使用内存",value:null!==(u=B.used_memory_human)&&void 0!==u?u:"--"},{label:"系统内存",value:B.max_memory?g(B.max_memory):"--"},{label:"内存使用率",value:null!=B.usage_percent?xe(B.usage_percent):"--",tooltip:"计算方式：已使用内存/系统内存"}]},{name:"connection",label:"连接信息",items:[{label:"当前连接数",value:null!==(l=L.connected_clients)&&void 0!==l?l:"--"},{label:"总连接数",value:null!==(i=L.total_connections)&&void 0!==i?i:"--",tooltip:"仅记录TCP连接数"},{label:"最大连接数限制",value:null!==(c=L.max_clients)&&void 0!==c?c:"--"},{label:"拒绝连接数",value:null!==(s=L.rejected_connections)&&void 0!==s?s:"--"}]},{name:"performance",label:"性能统计",items:[{label:"当前QPS",value:null!==(f=D.qps)&&void 0!==f?f:"--"},{label:"总执行命令数",value:null!==(v=D.total_commands)&&void 0!==v?v:"--"},{label:"键命中次数",value:null!==(p=D.keyspace_hits)&&void 0!==p?p:"--"},{label:"键未命中次数",value:null!==(d=D.keyspace_misses)&&void 0!==d?d:"--"},{label:"命中率",value:null!=D.hit_rate?xe(D.hit_rate):"--"}]}],N=[{name:"base",label:"基础信息",items:[{label:"Redis版本",value:T.redis_version||"--"},{label:"运行天数",value:(null!==(m=T.uptime_days)&&void 0!==m?m:"--")+"天"},{label:"监听端口",value:null!==(b=T.tcp_port)&&void 0!==b?b:"--"},{label:"角色",value:null!==(y=A.role)&&void 0!==y?y:"--"},{label:"主节点地址",value:null!==(_=A.master_host)&&void 0!==_?_:"--"},{label:"主节点端口",value:null!==(h=A.master_port)&&void 0!==h?h:"--"}]},{name:"memory",label:"内存信息",items:[{label:"已使用内存",value:null!==(w=B.used_memory_human)&&void 0!==w?w:"--"},{label:"系统内存",value:B.max_memory?g(B.max_memory):"--"},{label:"内存使用率",value:null!=B.usage_percent?xe(B.usage_percent):"--"}]},{name:"connection",label:"连接信息",items:[{label:"当前连接数",value:null!==(S=L.connected_clients)&&void 0!==S?S:"--"},{label:"总连接数",value:null!==(j=L.total_connections)&&void 0!==j?j:"--"},{label:"阻塞连接数",value:null!==(k=L.rejected_connections)&&void 0!==k?k:"--"}]},{name:"replication",label:"复制信息",items:[{label:"主从连接状态",value:null!==(O=A.master_link_status)&&void 0!==O?O:"--"},{label:"最后IO时间",value:A.last_io_seconds?A.last_io_seconds+"秒前":"--"},{label:"同步进度",value:A.sync_in_progress?"是":"否"},{label:"复制偏移量",value:null!==(x=A.repl_offset)&&void 0!==x?x:"--"},{label:"复制延迟（秒）",value:null!==(q=A.lag)&&void 0!==q?q:"--"},{label:"是否在线",value:A.is_online?"是":"否"}]},{name:"performance",label:"性能统计",items:[{label:"当前QPS",value:null!==(R=D.qps)&&void 0!==R?R:"--"},{label:"总执行命令数",value:null!==(M=D.total_commands)&&void 0!==M?M:"--"},{label:"键命中次数",value:null!==(P=D.keyspace_hits)&&void 0!==P?P:"--"},{label:"键未命中次数",value:null!==(E=D.keyspace_misses)&&void 0!==E?E:"--"},{label:"命中率",value:null!=D.hit_rate?xe(D.hit_rate):"--"}]}];return"master"==C?G:N});var re=B("MASTER-STORE",function(){return{tabActive:D("nodeRedisTabActive","mysqlMaster")}}),ae=B("MASTER-MYSQL-STORE",function(){var e=A(!1),t=A([]),n=function(){var e=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n={slave_ip:t.slave_ip},e.n=1,o({loading:"正在删除从库，请稍候...",request:l(n),message:!0});case 1:return r=e.v,e.a(2,{status:r.status,msg:r.msg});case 2:return e.p=2,e.v,e.a(2,{status:!1,msg:"删除从库失败"})}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),r=function(){var t=c(u().m(function t(n,r,a,o){var i,s,f;return u().w(function(t){for(;;)switch(t.n){case 0:return i=o.label,s=o.value,f=function(){var e=c(u().m(function e(t,n){var r;return u().w(function(e){for(;;)switch(e.n){case 0:r=s,e.n="delete"===r?1:3;break;case 1:return e.n=2,l({slave_ip:t.slave_ip});case 2:return e.a(2,e.v);case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),t.n=1,n({title:"批量".concat(i,"从库"),content:"批量".concat(i,"已选的从库，是否继续操作！"),column:[{label:"从库地址",prop:"slave_ip"},ee()],onConfirm:function(){var t=c(u().m(function t(){return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r(f);case 1:return e.value=!0,t.a(2,!1)}},t)}));return function(){return t.apply(this,arguments)}}()});case 1:return t.a(2)}},t)}));return function(e,n,r,a){return t.apply(this,arguments)}}(),a=function(){var e=c(u().m(function e(){var t,n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,i();case 1:return t=e.v,e.a(2,t);case 2:e.p=2,n=e.v,s(n);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),p=function(){var e=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f(t);case 1:return n=e.v,e.a(2,n);case 2:e.p=2,r=e.v,s(r);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=c(u().m(function e(t,n){var r,a;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,v({slave_ip:t.slave_ip,status:n});case 1:return r=e.v,e.a(2,r);case 2:e.p=2,a=e.v,s(a);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t,n){return e.apply(this,arguments)}}();return{deleteMysqlSlaveEvent:n,multDeleteMysqlSlaveEvent:r,setMysqlSlaveEvent:d,getMysqlSlaveHistoryEvent:a,deleteMysqlSlaveHistoryEvent:p,isRefreshList:e,mysqlRowData:t}}),oe=t("a",function(){return a(a({},ae()),L(ae()))});function ue(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!I(e)}var le=oe().mysqlRowData,ie=p(),ce=(ie.plugin,ie.getGlobalInfo),se=function(){var e=c(u().m(function e(){var t,a;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ce();case 1:return a=e.v,e.n=2,o({request:d(),loading:"正在获取节点数据，请稍等...",success:function(e){e.msg&&!1===e.status&&m.error(e.msg),le.value=e.data.data.filter(function(e){return!e.is_local&&!e.lpver}).map(function(e){return{label:"".concat(e.remarks," - ").concat(e.server_ip),value:e.id,remarks:e.server_ip}})}});case 2:b({title:"添加主从",area:62,compData:{panel_address:"object"===n(a)&&(null==a||null===(t=a.panel)||void 0===t?void 0:t.address)},btn:["添加","取消"],component:function(){return y(function(){return r.import("./add-form-legacy.js?v=1756369731")},void 0,r.meta.url)},showFooter:!0});case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,de().openMasterSlaveLog)(e,t)},ve=function(){var e=c(u().m(function e(t){var n,r,a,o,l,i;return u().w(function(e){for(;;)switch(e.n){case 0:return n=oe(),r=n.deleteMysqlSlaveEvent,a=n.isRefreshList,e.n=1,_({title:"".concat("删除mysql从库【".concat(t.slave_ip,"】")),content:"".concat("风险操作，此操作不可逆，删除【".concat(t.slave_ip,"】后您将无法管理该从库，是否继续操作？"))});case 1:return e.n=2,r(t);case 2:o=e.v,l=o.status,i=o.msg,l?(m.success(i),a.value=!0):m.error(i);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=c(u().m(function e(t){var n,r,a;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,_({title:"".concat("start"===t.run_status?"停止":"启动","从库同步【").concat(t.slave_ip,"】"),content:"是否确认".concat("start"===t.run_status?"停止":"启动","从库同步【").concat(t.slave_ip,"】？")});case 1:return n=oe(),r=n.setMysqlSlaveEvent,a=n.isRefreshList,e.n=2,r(t,"start"===t.run_status?"stop":"start");case 2:a.value=!0;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),de=function(){var t=function(){var t=c(u().m(function t(n){var r,a,o,l,i,c=arguments;return u().w(function(t){for(;;)switch(t.n){case 0:if(r=c.length>1&&void 0!==c[1]&&c[1],a=A(),!r||"done"!==n.config_status){t.n=2;break}return t.n=1,S({slave_ip:n.slave_ip});case 1:o=t.v,l=o.data,a.value=l,t.n=4;break;case 2:if(j(n.error_msg)){t.n=3;break}a.value=n.error_msg,t.n=4;break;case 3:return"done"!==n.config_status&&m.error("主从配置未完成，请先完成主从配置：操作 - 同步中"),t.a(2);case 4:i=m.load("正在获取日志信息，请稍后..."),b({title:"从库状态日志",area:60,component:function(){var t;return G("div",{class:"p-[1.6rem] max-h-[60rem] overflow-y-auto"},[G("div",{class:"mb-[1.6rem]"},[N("从库地址: "),n.slave_ip]),G(W,{column:1,border:!0},ue(t=Object.entries(a.value).map(function(t){var n,r=e(t,2),a=r[0],o=r[1];return G(H,{label:a},ue(n=String(o))?n:{default:function(){return[n]}})}))?t:{default:function(){return[t]}})])}}),null==i||i.close();case 5:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}();return{openMasterSlaveLog:t}},me=t("b",function(e){b({title:"同步进度",area:[60,"auto"],component:function(){return y(function(){return r.import("./index-legacy348.js?v=1756369731")},void 0,r.meta.url)},compData:{slave_ip:e}})}),be=Y({__name:"index",setup:function(e){p();var t,n=oe(),a=n.isRefreshList,o=n.multDeleteMysqlSlaveEvent,l=k({options:[{type:"button",label:"添加主从",active:!0,onClick:se},{type:"button",label:"历史备份",active:!1,onClick:function(){var e,t,n,r=(e=oe(),t=e.getMysqlSlaveHistoryEvent,n=e.deleteMysqlSlaveHistoryEvent,{openHistoryBackup:function(){var e,r,a=h({request:(r=c(u().m(function e(){var n,r;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t();case 1:return n=e.v,(r=n.data).msg&&!1===r.status&&m.error(r.msg),e.a(2,{data:r.data,total:r.data.length})}},e)})),function(){return r.apply(this,arguments)}),columns:[{label:"文件名",prop:"name"},{label:"大小",prop:"size",render:function(e){return g(e.size)}},{label:"创建时间",prop:"mtime",width:160,render:function(e){return w(e.mtime)}},te([{title:"下载",onClick:function(e){window.open("/download?filename="+e.path)}},{title:"删除",onClick:(e=c(u().m(function e(t){var r,a,o;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,_({title:"删除备份文件",content:"是否确认删除该备份文件？"});case 1:return e.n=2,n({path:t.path});case 2:r=e.v,a=r.status,o=r.msg,a?(m.success(o),l()):m.error(o);case 3:return e.a(2)}},e)})),function(t){return e.apply(this,arguments)})}])]}),o=a.BtTable,l=a.refresh;b({title:"主库历史备份文件",area:62,component:function(){return G("div",{class:"p-[1.6rem]"},[G(o,{maxHeight:"40rem"},null)])}})}});(0,r.openHistoryBackup)()}}]}),i=l.BtOperation,s=q([{label:"删除从库",value:"delete",event:o}]),f=function(e){return{label:e.label,prop:e.prop,render:function(t){var n="function"==typeof e.status?e.status(t):t[e.prop];return e.render?e.render(t):G("span",{class:"bt-link ".concat(e.onClick?"cursor-pointer":""," ").concat(e.class?e.class(t):""),style:{color:"success"===n.type?"#20a53a":"#ef0808"},onClick:function(){var n;null===(n=e.onClick)||void 0===n||n.call(e,t)}},[n.text])}}},v=h({request:(t=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,O(t);case 1:return n=e.v,(r=n.data).msg&&!1===r.status&&m.error(r.msg),e.a(2,{data:r.data,total:0,search:{}})}},e)})),function(e){return t.apply(this,arguments)}),columns:[ne({key:"slave_ip"}),{label:"从库地址",prop:"slave_ip",minWidth:220},{label:"同步中的数据库",prop:"db_name",render:function(e){return e.db_name}},f({label:"读写状态",prop:"io_status",status:function(e){return{type:"Yes"===e.io_status&&"done"===e.config_status?"success":"danger",text:"done"!==e.config_status?"未开始":"Yes"===e.io_status?"正常":"异常"}},onClick:fe}),f({label:"同步状态",prop:"sql_status",status:function(e){return{type:"Yes"===e.sql_status&&"done"===e.config_status?"success":"danger",text:"done"!==e.config_status?"未开始":"Yes"===e.sql_status?"正常":"异常"}},onClick:fe}),f({label:"是否启用",prop:"run_status",status:function(e){return{type:"start"===e.run_status?"success":"danger",text:"start"===e.run_status?"已启用":"已停用"}},onClick:pe}),te([{render:function(e){var t="done"===e.config_status?"状态":"同步中";return G("span",null,[G("span",{onClick:function(){return"done"===e.config_status?fe(e,!0):me(e.slave_ip)},title:t,class:"bt-link"},[t]),G("div",{class:"el-divider el-divider--vertical",role:"separator",style:"--el-border-style: solid;"},null)])}},{title:"删除",onClick:function(e){return ve(e)}}])],extension:[s,x(a)],empty:function(){return G("span",null,[N("您的列表为空，您可以"),G("span",{class:"bt-link",onClick:se},[N("添加一个主从")])])}}),d=v.BtTable,S=v.BtSearch,j=v.BtRefresh,R=v.BtPage,M=(v.BtColumn,v.BtBatch);v.refresh;return z(function(){F(function(){y(function(){return r.import("./index-legacy349.js?v=1756369731")},void 0,r.meta.url),y(function(){return r.import("./index-legacy350.js?v=1756369731")},void 0,r.meta.url)})}),function(e,t){var n=X;return Q(),$("div",null,[G(n,null,{"header-left":V(function(){return[G(J(i))]}),"header-right":V(function(){return[G(J(S),{class:U(["mr-[10px]","!w-[210px]"]),placeholder:"请输入地址"}),G(J(j))]}),content:V(function(){return[G(J(d))]}),"footer-left":V(function(){return[G(J(M))]}),"footer-right":V(function(){return[G(J(R))]}),_:1})])}}}),ye=R(be,[["__scopeId","data-v-f67b8eeb"]]),_e=B("MASTER-REDIS-STORE",function(){return{isRedisRefreshList:A(!1),redisRowData:A([]),redisAvailableNodes:A({row:[],nodes:[]}),redisGroupDetail:A({}),openNodesLoading:A(!0),slaveListLoad:A(!0)}}),he=t("u",function(){return a(a({},_e()),L(_e()))}),ge=he(),we=ge.isRedisRefreshList,Se=ge.redisAvailableNodes,je=ge.redisGroupDetail,ke=ge.openNodesLoading,Oe=ge.slaveListLoad,xe=t("f",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if("number"!=typeof e||isNaN(e))return"-";var n=(+(100*e).toFixed(t)).toString();return n.indexOf(".")>-1&&(n=(n=n.replace(/\.0+$/,"")).replace(/(\.[1-9]*)0+$/,"$1")),n+"%"}),qe=function(){var e=c(u().m(function e(){var t,n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return b({title:"新建主从复制组",area:60,btn:["创建","取消"],component:function(){return y(function(){return r.import("./index-legacy351.js?v=1756369731")},void 0,r.meta.url)}}),e.p=1,e.n=2,E();case 2:t=e.v,(n=t.data).status||m.error(n.msg||"获取可用节点失败！"),Se.value={row:n.data,nodes:n.data.map(function(e){var t;return{label:"".concat(e.name," - ").concat(e.server_ip," ").concat(null===e.group_info?"":"（主从组 - ".concat(null===(t=e.group_info)||void 0===t?void 0:t.group_name,"）")),value:e.id,server_ip:e.server_ip,disabled:null!==e.group_info}})},e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,ke.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=c(u().m(function e(t,n,r,a){var o,l,i;return u().w(function(e){for(;;)switch(e.n){case 0:return o=a.label,l=a.value,i=function(){var e=c(u().m(function e(t,n){var r;return u().w(function(e){for(;;)switch(e.n){case 0:r=l,e.n="delete"===r?1:3;break;case 1:return e.n=2,P({group_id:t.group_id});case 2:return e.a(2,e.v);case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),e.n=1,t({title:"批量".concat(o),content:"批量删除选中的项目后，项目将无法恢复，是否继续操作？",column:[{label:"主从组名称",prop:"group_name"},ee()],onConfirm:function(){var e=c(u().m(function e(){return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n(i);case 1:return we.value=!0,e.a(2,!1)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),Me=function(){var e=c(u().m(function e(t){var n,a;return u().w(function(e){for(;;)switch(e.n){case 0:return b({title:"管理主从复制组【".concat(t.group_name,"】"),area:80,component:function(){return y(function(){return r.import("./index-legacy352.js?v=1756369731")},void 0,r.meta.url)},compData:{rowData:t}}),e.n=1,M({group_id:t.group_id});case 1:n=e.v,(a=n.data).status||m.error(a.msg||"获取主从复制组失败！"),je.value=a.data,Oe.value=!1;case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Pe=(t("h",function(e,t){var n;b({title:"".concat("slave"===t?"从节点详情【".concat(e.data.server_ip,"】"):"主节点详情【".concat(null===(n=e.value)||void 0===n||null===(n=n.master_detail)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.address,"】")),area:70,component:function(){return y(function(){return r.import("./index-legacy353.js?v=1756369731")},void 0,r.meta.url)},compData:{rowData:e,type:t||"master"}})}),function(){var e=c(u().m(function e(t){return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,e.n=2,_({icon:"warning-filled",title:"删除主从复制组【".concat(t.group_name,"】"),content:"即将删除主从复制组，是否继续操作？"});case 2:return e.n=3,o({loading:"正在删除主从复制组，因需重新还原所有redis相关配置进行重启操作，过程可能较长请稍等...",request:P({group_id:t.group_id}),message:!0,success:function(e){we.value=!0}});case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}());t("o",function(){var e=c(u().m(function e(t){return u().w(function(e){for(;;)switch(e.n){case 0:b({title:"创建主从复制组",area:60,component:function(){return y(function(){return r.import("./redis-create-log-legacy.js?v=1756369731")},void 0,r.meta.url)},compData:{task_id:t}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());var Ee={class:"node-master-redis"},Ce=Y({__name:"index",setup:function(e){var t,n=he().isRedisRefreshList,r=q([{label:"删除主从组",value:"delete",event:Re}]),a=k({options:A([{type:"button",label:"新建主从复制组",active:!0,onClick:function(){return qe()}}])}).BtOperation,o=[ne({key:"group_id"}),{label:"主从组名称",prop:"group_name",minWidth:120},{label:"主库地址",prop:"master_server_ip",minWidth:160},{label:"内存占用",prop:"memory_usage",minWidth:100,render:function(e){return G("span",{style:{color:e.memory_usage>=.95?"#fa1616":e.memory_usage>.8?"#ef8a08":"#20a53a"}},[xe(e.memory_usage,0)])}},{label:"QPS",prop:"qps",minWidth:80},{label:"连接数",prop:"connections",minWidth:80},{label:"从库数量",prop:"slave_count",minWidth:80},{label:"从库正常数",prop:"normal_slaves",minWidth:100,render:function(e){return G("span",{style:{color:e.normal_slaves<e.slave_count?"#ef0808":"#333"}},[e.normal_slaves])}},{label:"平均延迟（秒）",prop:"avg_lag",minWidth:100},te([{title:"管理",onClick:Me},{title:"删除",onClick:Pe}])],l=h({request:(t=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,C(t);case 1:return n=e.v,(r=n.data).status||m.error(r.msg),e.a(2,{data:r.data,total:r.page.total_count,search:{}})}},e)})),function(e){return t.apply(this,arguments)}),columns:o,extension:[r,x(n)],empty:function(){return G("span",null,[N("您的列表为空，您可以"),G("span",{class:"bt-link",onClick:function(){return qe()}},[N("新建主从复制组")])])}}),i=l.BtTable,s=l.BtBatch,f=l.BtSearch,v=l.BtRefresh,p=l.BtPage;return function(e,t){var n=X;return Q(),$("div",Ee,[G(n,null,{"header-left":V(function(){return[G(J(a))]}),"header-right":V(function(){return[G(J(f),{class:U(["mr-[10px]","!w-[210px]"]),placeholder:"请输入名称或地址"}),G(J(v))]}),content:V(function(){return[G(J(i))]}),"footer-left":V(function(){return[G(J(s))]}),"footer-right":V(function(){return[G(J(p))]}),_:1})])}}}),Te=[{label:"MySQL",name:"mysqlMaster",lazy:!0,render:function(){return G(ye,null,null)}},{label:"Redis",name:"redisMaster",lazy:!0,render:function(){return G(Ce,null,null)}}],Be=Y({__name:"index",setup:function(e){var t=L(re()).tabActive;return function(e,n){var r=T;return Q(),K(r,{class:"module-ui",type:"card",modelValue:J(t),"onUpdate:modelValue":n[0]||(n[0]=function(e){return Z(t)?t.value=e:null}),options:J(Te)},null,8,["modelValue","options"])}}}),De=Object.freeze(Object.defineProperty({__proto__:null,default:Be},Symbol.toStringTag,{value:"Module"}));t("i",De)}}})}();
