!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function l(e,o,i,a){var l=o&&o.prototype instanceof s?o:s,c=Object.create(l.prototype);return t(c,"_invoke",function(e,t,o){var i,a,l,s=0,c=o||[],d=!1,f={p:0,n:0,v:r,a:m,f:m.bind(r,4),d:function(e,t){return i=e,a=0,l=r,f.n=t,u}};function m(e,t){for(a=e,l=t,n=0;!d&&s&&!o&&n<c.length;n++){var o,i=c[n],m=f.p,v=i[2];e>3?(o=v===t)&&(l=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=r):i[0]<=m&&((o=e<2&&m<i[1])?(a=0,f.v=t,f.n=i[1]):m<v&&(o=e<3||i[0]>t||t>v)&&(i[4]=e,i[5]=t,f.n=v,a=0))}if(o||e>1)return u;throw d=!0,t}return function(o,c,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===c&&m(c,v),a=c,l=v;(n=a<2?r:l)||!d;){i||(a?a<3?(a>1&&(f.n=-1),m(a,l)):f.n=l:f.v=l);try{if(s=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=r}else if((n=(d=f.n<0)?l:e.call(t,f))!==u)break}catch(n){i=r,a=1,l=n}finally{s=1}}return{value:n,done:d}}}(e,i,a),!0),c}var u={};function s(){}function c(){}function d(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(t(n={},i,function(){return this}),n),m=d.prototype=s.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=d,t(m,"constructor",d),t(d,"constructor",c),c.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(m),t(m,a,"Generator"),t(m,i,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:v}})()}function t(e,r,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,r,n,o){function a(r,n){t(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[r]=n:(a("next",0),a("throw",1),a("return",2))},t(e,r,n,o)}function r(e,t,r,n,o,i,a){try{var l=e[i](a),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,o)}System.register(["./utils-lib-legacy.js?v=1756369731","./index-legacy103.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./firewall-legacy.js?v=1756369731","./useMethod-legacy6.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./column-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./useStore-legacy5.js?v=1756369731","./validator-legacy.js?v=1756369731"],function(t,n){"use strict";var o,i,a,l,u,s,c,d,f,m,v,p,y,b,g,x,h,_,k,w,j,S,O,T,P,E,F,A;return{setters:[function(e){o=e.K,i=e.bv,a=e.R,l=e.k,u=e.gK,s=e.fU},function(e){c=e._},function(e){d=e.c,f=e.r,m=e.p,v=e.q,p=e.v,y=e.y,b=e.F,g=e.a_,x=e.x,h=e.e,_=e.M,k=e.A,w=e.n,j=e.B,S=e.av,O=e.J,T=e.z},function(e){P=e.ac},function(e){E=e.i,F=e.m,A=e.o},null,null,null,null,null],execute:function(){var n={class:"flex"},G={class:"w-[60%] mr-4"},L={class:"flex ml-[0.2rem] mb-[1.6rem]"},R={class:"flex items-center mb-[1.2rem] text-[#999]"},z={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem]"},C={key:0,class:"w-full h-[32rem] flex items-center justify-center"},M={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem] mt-[1.6rem]"},W={key:0,class:"w-full h-[32rem] flex items-center justify-center"},D={class:"flex-1 ml-4"},N={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem]"},q={key:0,class:"w-full h-[24rem]"},I={key:1,class:"w-full h-[24rem] flex items-center justify-center"},K={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem] mt-[1.6rem]"},B={class:"w-full h-[24rem]"},H={class:"border-1 border-[#e9e9e9] rounded-[.4rem] p-[1.6rem] mt-[1.6rem]"},J={key:0,class:"w-full h-[24rem]"},U={key:1,class:"w-full h-[24rem] flex items-center justify-center"};t("default",d({__name:"index",setup:function(t){var d=f(),Q=f(),V=f(),X=f(!1),Y=f({}),Z=f([]),$=f([]),ee=f([]),te=f(),re=f(),ne=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],r=[],n=[],o=0;o<e.length&&!(o>=5);o++){var i=e[o];r.push(i.site_name),t.push(i.end_time-i.start_time),n.push(i.scans)}return{legend:{left:"left",data:["耗时","检测页面"]},grid:{left:45,top:50,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e.length?"检测网站: "+e[0].name+(2===e.length?"</br>耗时: "+s(e[0].value)+"</br>检测页面数量: "+e[1].value:e[0].seriesIndex?"</br>检测页面数量: "+e[0].value:"</br>耗时: "+s(e[0].value)):""}},xAxis:{type:"category",data:r,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>6?e.substr(0,6)+"...":e}}},yAxis:{type:"value"},series:[{type:"bar",name:"耗时",barWidth:24,data:t,itemStyle:{color:"#fcc858"}},{type:"bar",name:"检测页面",barWidth:24,data:n,itemStyle:{color:"#8dcf6e"}}]}},oe=function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{grid:{left:45,right:15,top:50,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e[0].name+"</br>风险次数: "+Number(e[0].value||0)}},xAxis:{type:"category",boundaryGap:!1,data:null===(e=Object.keys(r))||void 0===e?void 0:e.map(function(e){return e}).sort(function(e,t){return new Date(e).getTime()<new Date(t).getTime()?-1:1}),axisLabel:{fontSize:10,color:"#666",formatter:function(e){return a(new Date(e).getTime()/1e3,"MM-dd")}}},axisLabel:{fontSize:10,color:"#666"},axisLine:{show:!1},axisTick:{show:!1},yAxis:{type:"value",splitNumber:5,name:"风险次数/次",min:0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{fontSize:10,color:"#666"}},series:[{type:"line",smooth:.6,data:null===(t=Object.values(r))||void 0===t?void 0:t.map(function(e){return e}),areaStyle:{normal:{}},itemStyle:{normal:{color:"#FF8585",lineStyle:{color:"#FF8585",type:"solid"}}}}]}},ie=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],r=[],n=0;n<e.length&&!(n>=6);n++){var o=e[n];t.push(o.words),r.push(o.count)}return{grid:{top:10,left:60,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return"敏感词: "+e[0].name+"</br>次数: "+e[0].value}},xAxis:{type:"value"},yAxis:{type:"category",data:t,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>4?e.substr(0,4)+"...":e}}},series:[{type:"bar",data:r,barWidth:20,itemStyle:{color:function(e){return["#ffa688","#ffc87d","#98caa5","#acce9b","#cad48f"][e.dataIndex]}}}]}},ae=function(){var t,n=(t=e().m(function t(){var r,n,a;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,o({loading:"正在获取数据，请稍后...",request:P()});case 1:a=e.v,Y.value=a.data,$.value=i(null==a||null===(r=a.data)||void 0===r?void 0:r.site_info,"array",[]),ee.value=i(null==a||null===(n=a.data)||void 0===n?void 0:n.risk_info,"array",[]),Z.value=[{title:"监控网站",value:Y.value.site_count},{title:"总风险次数",value:Y.value.risk_count},{title:"今日风险次数",value:Y.value.day_risk},{title:"今日巡检次数",value:Y.value.today_count}],w(function(){var e,t;te.value=null==a?void 0:a.data["7day_risk"],X.value=!(null!=a&&null!==(e=a.data)&&void 0!==e&&e.sensitive_word.length),re.value=null==a||null===(t=a.data)||void 0===t?void 0:t.sensitive_word});case 2:return e.a(2)}},t)}),function(){var e=this,n=arguments;return new Promise(function(o,i){var a=t.apply(e,n);function l(e){r(a,o,i,l,u,"next",e)}function u(e){r(a,o,i,l,u,"throw",e)}l(void 0)})});return function(){return n.apply(this,arguments)}}(),le=[{label:"巡检时间",prop:"time",render:function(e){var t=i(e.time,"number",0);return h("span",null,[a(t)])}},{label:"检测域名",prop:"site_name"},{label:"检测方式",prop:"method",render:function(e){return F[e.method]}},{label:"检测页面数",prop:"scans"},{label:"巡检结果",render:function(e){return[0===e.risks?h("span",{class:"text-[#20a53a]"},[j("无风险 ")]):h("span",{class:"bt-link !text-danger",onClick:function(){return A(e)}},[e.risks])]}}],ue=E();return m(ae),function(e,t){var r=S,o=l,i=c,a=u;return v(),p("div",n,[y("div",G,[y("div",L,[(v(!0),p(b,null,g(x(Z),function(e,t){return v(),p("div",{key:t,class:O("block-bg "+(t>0?"ml-[5rem]":""))},[y("div",R,[y("span",null,T(e.title),1)]),y("div",{class:O("font-bold text-[2rem] leading-none "+(0!==t&&3!==t&&e.value>0?"text-[#fe7d2e]":"text-[#666]"))},T(e.value),3)],2)}),128))]),y("div",z,[t[0]||(t[0]=y("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"网站内容检测",-1)),0===x($).length?(v(),p("div",C,[h(r,{description:"网站内容检测为空"})])):(v(),_(i,{key:1},{content:k(function(){return[h(o,{"max-height":"320",column:le,data:x($)},null,8,["data"])]}),_:1}))]),y("div",M,[t[1]||(t[1]=y("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"风险动态",-1)),0===x(ee).length?(v(),p("div",W,[h(r,{description:"风险动态为空"})])):(v(),_(i,{key:1},{content:k(function(){return[h(o,{"max-height":"320",column:x(ue),data:x(ee)},null,8,["column","data"])]}),_:1}))])]),y("div",D,[y("div",N,[t[2]||(t[2]=y("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"风险历史",-1)),x($).length?(v(),p("div",q,[h(a,{ref_key:"riskEchartRef",ref:d,options:ne(x($))},null,8,["options"])])):(v(),p("div",I,[h(r,{description:"风险历史数据为空"})]))]),y("div",K,[t[3]||(t[3]=y("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"近7日巡检情况",-1)),y("div",B,[h(a,{ref_key:"dayRiskEchartRef",ref:Q,options:oe(x(te))},null,8,["options"])])]),y("div",H,[t[4]||(t[4]=y("div",{class:"card_title flex items-center text-[#666] text-[1.4rem] mb-[1.2rem]"},"敏感词排行",-1)),x(X)?(v(),p("div",U,[h(r,{description:"敏感词排行数据为空"})])):(v(),p("div",J,[h(a,{ref_key:"sensitiveWordEchartRef",ref:V,options:ie(x(re))},null,8,["options"])]))])])])}}}))}}})}();
