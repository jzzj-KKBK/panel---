import{d9 as e,N as a,ag as t,L as l,R as n,dZ as o,a3 as r,aj as s,l as i,o as u,d_ as c,d$ as d,b as m,k as p,e as _,e0 as v,e1 as h,e2 as f,e3 as w,al as b}from"./utils-lib.js?v=1756369731";import{_ as g}from"./index103.js?v=1756369731";import{c as y,W as x,X as j,r as V,q as k,M as O,x as P,j as E,k as C,e as R,s as L,p as T,a4 as D,G as I,A as S,y as A,B as U,H as z,D as M,at as W,v as q,aD as B,aM as N,a9 as X,S as H,a7 as G,P as J}from"./base-lib.js?v=1756369731";import{u as Z}from"./column.js?v=1756369731";import{b as $,c as F,s as K,r as Q,d as Y}from"./useMethod7.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./validator.js?v=1756369731";const ee=y({__name:"sender-select",props:x({isInit:{type:Boolean,default:!1}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(l,{expose:n}){const o=l,r=j(l,"value"),s=V([]),i=async()=>{const{data:t}=await e();a(t.data)&&t.data.length>0&&(s.value=t.data.map(e=>({label:e.username,value:e.username})),r.value=t.data[0].username)};return o.isInit&&i(),n({getList:i}),(e,a)=>{const l=t;return k(),O(l,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),filterable:!0,options:P(s),placeholder:"请选择发件人"},null,8,["modelValue","options"])}}}),ae=E("MAIL_INBOX",()=>{const e=V(),a=C({p:1,username:null}),{table:t,columns:o}=$([{prop:"from",label:"发件人",width:250,showOverflowTooltip:!0},{prop:"to",label:"收件人",width:250,showOverflowTooltip:!0},{prop:"theme",label:"主题",minWidth:160,showOverflowTooltip:!0,render:e=>{const a=e.html;return(a||e.body||"").slice(0,2e3),(a||e.body||"").length,R("span",{class:"cursor-pointer",onClick:async()=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}},[R("a",{class:"bt-link"},[e.subject])])}},{prop:"time",label:"时间",width:150,minWidth:150,render:e=>n(e.time)},Z([{title:"查看",onClick:async e=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}},{title:"垃圾邮件",onClick:async e=>{const{onSpam:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}},{title:"删除",onClick:async e=>{const{onDel:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}}],{fixed:"right",width:200,label:"操作"})]);return{senderRef:e,search:a,table:t,columns:o,reset:()=>{a.p=1,a.username=null,t.data=[],t.total=0,e.value=null}}}),{search:te,table:le}=L(ae()),ne=m(),oe=async()=>{try{le.value.loading=!0;const{data:e}=await o({p:te.value.p,username:te.value.username||""});r(e)&&(le.value.data=a(e.data)?e.data:[],le.value.total=s(e.page))}finally{le.value.loading=!1}},re=()=>{te.value.p=1,oe()},se=Object.freeze(Object.defineProperty({__proto__:null,getList:oe,onDel:async e=>{const{data:a}=await d({path:e.path});ne.request(a),oe()},onShowView:e=>{i({title:"检查邮件【".concat(e.subject,"】"),area:[85,68],compData:{row:e},component:()=>l(()=>import("./mail-view.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},onSpam:async e=>{try{await u({title:"标记为垃圾邮件",content:"您确定要将此消息标记为垃圾邮件吗？"});const{data:a}=await c({path:e.path,username:te.value.username||""});ne.request(a),oe()}catch(a){}},refresh:re},Symbol.toStringTag,{value:"Module"})),ie={class:"w-460px flex items-center"},ue={class:"flex items-center"},ce=_(y({__name:"index",setup(e){const{search:a,table:t,senderRef:l}=L(ae()),{columns:n,reset:o}=ae();return T(async()=>{await l.value.getList()}),D(()=>{o()}),(e,o)=>{const r=M,s=p,i=W,u=g,c=I("bt-loading");return k(),O(u,null,{"header-left":S(()=>[A("div",ie,[o[2]||(o[2]=A("span",{class:"mr-[1rem] w-[7rem] text-[1.3rem]"},"邮箱地址",-1)),R(ee,{ref_key:"senderRef",ref:l,value:P(a).username,"onUpdate:value":[o[0]||(o[0]=e=>P(a).username=e),P(re)]},null,8,["value","onUpdate:value"])])]),"header-right":S(()=>[A("div",ue,[R(r,{onClick:P(re)},{default:S(()=>[...o[3]||(o[3]=[U("刷新",-1)])]),_:1},8,["onClick"])])]),content:S(()=>[z(R(s,{data:P(t).data,column:P(n)},null,8,["data","column"]),[[c,P(t).loading]])]),"footer-right":S(()=>[R(i,{size:"small","current-page":P(a).p,"onUpdate:currentPage":o[1]||(o[1]=e=>P(a).p=e),"page-size":10,layout:"prev, pager, next, total",total:P(t).total,background:"",onCurrentChange:P(oe)},null,8,["current-page","total","onCurrentChange"])]),_:1})}}}),[["__scopeId","data-v-a44e7c91"]]),de=E("MAIL_OUTBOX",()=>{const e=V(),a=C({p:1,username:null}),{table:t,columns:o}=$([{prop:"from",label:"发件人",width:250,showOverflowTooltip:!0},{prop:"to",label:"收件人",width:250,showOverflowTooltip:!0},{prop:"theme",label:"主题",minWidth:160,showOverflowTooltip:!0,render:e=>{const a=e.html;return(a||e.body||"").slice(0,2e3),(a||e.body||"").length,R("span",{class:"cursor-pointer",onClick:async()=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>fe),void 0,import.meta.url);a(e)}},[R("a",{class:"bt-link"},[e.subject])])}},{prop:"time",label:"时间",width:150,minWidth:150,render:e=>n(e.time)},Z([{title:"查看",onClick:async e=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>fe),void 0,import.meta.url);a(e)}},{title:"删除",onClick:async e=>{const{onDel:a}=await l(()=>Promise.resolve().then(()=>fe),void 0,import.meta.url);a(e)}}],{width:200,fixed:"right",label:"操作"})]);return{search:a,table:t,columns:o,senderRef:e,reset:()=>{a.username=null,t.data=[],t.total=0,a.p=1}}}),{search:me,table:pe}=L(de()),_e=m(),ve=async()=>{try{pe.value.loading=!0;const{data:e}=await v({p:me.value.p,username:me.value.username||""});r(e)&&(pe.value.data=a(e.data)?e.data:[],pe.value.total=s(e.page))}finally{pe.value.loading=!1}},he=()=>{me.value.p=1,ve()},fe=Object.freeze(Object.defineProperty({__proto__:null,getList:ve,onDel:async e=>{const{data:a}=await d({path:e.path});_e.request(a),ve()},onShowView:e=>{i({title:"检查邮件【".concat(e.subject,"】"),area:[85,68],compData:{row:e},component:()=>l(()=>import("./mail-view.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},refresh:he},Symbol.toStringTag,{value:"Module"})),we={class:"w-460px flex items-center"},be={class:"flex items-center"},ge=_(y({__name:"index",setup(e){const{search:a,table:t,senderRef:l}=L(de()),{columns:n,reset:o}=de();return T(async()=>{await l.value.getList()}),D(()=>{o()}),(e,o)=>{const r=M,s=p,i=W,u=g,c=I("bt-loading");return k(),q("div",null,[R(u,null,{"header-left":S(()=>[A("div",we,[o[2]||(o[2]=A("span",{class:"mr-[1rem] w-[7rem] text-[1.3rem]"},"邮箱地址",-1)),R(ee,{ref_key:"senderRef",ref:l,value:P(a).username,"onUpdate:value":[o[0]||(o[0]=e=>P(a).username=e),P(he)]},null,8,["value","onUpdate:value"])])]),"header-right":S(()=>[A("div",be,[R(r,{onClick:P(he)},{default:S(()=>[...o[3]||(o[3]=[U("刷新",-1)])]),_:1},8,["onClick"])])]),content:S(()=>[z(R(s,{data:P(t).data,column:P(n)},null,8,["data","column"]),[[c,P(t).loading]])]),"footer-right":S(()=>[R(i,{size:"small","current-page":P(a).p,"onUpdate:currentPage":o[1]||(o[1]=e=>P(a).p=e),"page-size":10,layout:"prev, pager, next, total",total:P(t).total,background:"",onCurrentChange:P(ve)},null,8,["current-page","total","onCurrentChange"])]),_:1})])}}}),[["__scopeId","data-v-36c98dfb"]]),ye=E("MAIL_SPAM",()=>{const e=V(),a=C({p:1,username:null}),{table:t,columns:o}=$([{prop:"from",label:"发件人",width:250,minWidth:250,showOverflowTooltip:!0},{prop:"to",label:"收件人",width:250,minWidth:250,showOverflowTooltip:!0},{prop:"theme",label:"主题",minWidth:160,showOverflowTooltip:!0,render:e=>{const a=e.html;return(a||e.body||"").slice(0,2e3),(a||e.body||"").length,R("span",{class:"cursor-pointer",onClick:async()=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>Pe),void 0,import.meta.url);a(e)}},[R("a",{class:"bt-link"},[e.subject])])}},{prop:"time",label:"时间",width:150,minWidth:150,render:e=>n(e.time)},Z([{title:"查看",onClick:async e=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>Pe),void 0,import.meta.url);a(e)}},{title:"取消标记",onClick:async e=>{const{onSpam:a}=await l(()=>Promise.resolve().then(()=>Pe),void 0,import.meta.url);a(e)}},{title:"删除",onClick:async e=>{const{onDel:a}=await l(()=>Promise.resolve().then(()=>Pe),void 0,import.meta.url);a(e)}}],{fixed:"right",width:200,label:"操作"})]);return{search:a,table:t,columns:o,senderRef:e,reset:()=>{a.username=null,t.data=[],t.total=0,a.p=1}}}),{search:xe,table:je}=L(ye()),Ve=m(),ke=async()=>{try{je.value.loading=!0;const{data:e}=await h({p:xe.value.p,username:xe.value.username||""});r(e)&&(je.value.data=a(e.data)?e.data:[],je.value.total=s(e.page))}finally{je.value.loading=!1}},Oe=()=>{xe.value.p=1,ke()},Pe=Object.freeze(Object.defineProperty({__proto__:null,getList:ke,onDel:async e=>{const{data:a}=await d({path:e.path});Ve.request(a),ke()},onShowView:e=>{i({title:"检查邮件【".concat(e.subject,"】"),area:[85,68],compData:{row:e},component:()=>l(()=>import("./mail-view.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},onSpam:async e=>{const{data:a}=await f({path:e.path,username:xe.value.username||""});Ve.request(a),ke()},refresh:Oe},Symbol.toStringTag,{value:"Module"})),Ee={class:"w-460px flex items-center"},Ce={class:"flex items-center"},Re=_(y({__name:"index",setup(e){const{search:a,table:t,senderRef:l}=L(ye()),{columns:n,reset:o}=ye();return T(async()=>{await l.value.getList()}),D(()=>{o()}),(e,o)=>{const r=M,s=p,i=W,u=g,c=I("bt-loading");return k(),O(u,null,{"header-left":S(()=>[A("div",Ee,[o[2]||(o[2]=A("span",{class:"mr-[1rem] w-[7rem] text-[1.3rem]"},"邮箱地址",-1)),R(ee,{ref_key:"senderRef",ref:l,value:P(a).username,"onUpdate:value":[o[0]||(o[0]=e=>P(a).username=e),P(Oe)]},null,8,["value","onUpdate:value"])])]),"header-right":S(()=>[A("div",Ce,[R(r,{onClick:P(Oe)},{default:S(()=>[...o[3]||(o[3]=[U("刷新",-1)])]),_:1},8,["onClick"])])]),content:S(()=>[z(R(s,{data:P(t).data,column:P(n)},null,8,["data","column"]),[[c,P(t).loading]])]),"footer-right":S(()=>[R(i,{size:"small","current-page":P(a).p,"onUpdate:currentPage":o[1]||(o[1]=e=>P(a).p=e),"page-size":10,layout:"prev, pager, next, total",total:P(t).total,background:"",onCurrentChange:P(ke)},null,8,["current-page","total","onCurrentChange"])]),_:1})}}}),[["__scopeId","data-v-987ee772"]]),Le=E("MAIL_SEND",()=>{const e=V(),a=V(null),t=C({sender:null,mail_to:"",subject:"",content:""}),l={mail_to:{trigger:["blur","input"],validator:()=>""!==t.mail_to.trim()||new Error("请输入收件人")},subject:{trigger:["blur","input"],validator:()=>""!==t.subject.trim()||new Error("请输入邮件主题")},content:{validator:()=>""!==F()||new Error("请输入邮件内容")}};return{formRef:a,senderRef:e,form:t,rules:l,reset:()=>{t.sender=null,t.mail_to="",t.subject="",t.content="",e.value=null}}}),{form:Te,formRef:De}=L(Le()),Ie=m(),Se=async()=>{var e;await(null==(e=De.value)?void 0:e.validate());const a={mail_from:Te.value.sender||"",mail_to:JSON.stringify(Te.value.mail_to.split(",")),subject:Te.value.subject,content:F(),subtype:"html",smtp_server:"localhost"},{data:t}=await w(a);Ie.request(t),Te.value.mail_to="",Te.value.subject="",K("")},Ae={class:"p-[16px]"},Ue={class:"w-350px"},ze={class:"w-760px"},Me={class:"w-760px"},We=y({__name:"index",setup(e){const{form:a,formRef:t,senderRef:l}=L(Le()),{rules:n,reset:o}=Le();return T(()=>{Q("editor"),l.value.getList()}),B(()=>{Y(),o()}),(e,o)=>{const r=X,s=H,i=M,u=G,c=N("bt-tips");return k(),q("div",Ae,[R(u,{ref_key:"formRef",ref:t,class:"pt-8px",model:P(a),rules:P(n)},{default:S(()=>[R(r,{label:"发件人",prop:"sender"},{default:S(()=>[A("div",Ue,[R(ee,{ref_key:"senderRef",ref:l,value:P(a).sender,"onUpdate:value":o[0]||(o[0]=e=>P(a).sender=e),placeholder:"请输入或选择用户邮箱"},null,8,["value"])])]),_:1}),R(r,{label:"收件人",prop:"mail_to"},{default:S(()=>[A("div",ze,[R(s,{modelValue:P(a).mail_to,"onUpdate:modelValue":o[1]||(o[1]=e=>P(a).mail_to=e),placeholder:'多个收件人使用 "," 来分隔收件人邮箱'},null,8,["modelValue"])])]),_:1}),R(r,{label:"主题",prop:"subject"},{default:S(()=>[A("div",Me,[R(s,{modelValue:P(a).subject,"onUpdate:modelValue":o[2]||(o[2]=e=>P(a).subject=e),placeholder:""},null,8,["modelValue"])])]),_:1}),R(r,{label:"内容",prop:"content"},{default:S(()=>[...o[3]||(o[3]=[A("div",{class:"w-[760px]"},[A("textarea",{class:"hidden",name:"editor",id:"editor",rows:"10"})],-1)])]),_:1}),R(r,{label:" ","show-feedback":!1},{default:S(()=>[R(i,{type:"primary",size:"large",onClick:P(Se)},{default:S(()=>[...o[4]||(o[4]=[U("发送",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"]),R(c,{class:"ml-24px mt-24px"},{default:S(()=>[...o[5]||(o[5]=[A("li",{class:"text-[#dc2626]"},"提示：此功能只建议测试发件功能用，真正使用请使用客户端软件（比如foxmail）或者api接口",-1)])]),_:1})])}}}),qe=y({__name:"index",setup(e){const a=V("inbox"),t=[{label:"收件箱",name:"inbox",lazy:!0,render:()=>R(ce,null,null)},{name:"outbox",label:"发件箱",lazy:!0,render:()=>R(ge,null,null)},{name:"spam",label:"垃圾邮件",lazy:!0,render:()=>R(Re,null,null)},{name:"sender",label:"发送邮件",lazy:!0,render:()=>R(We,null,null)}];return(e,l)=>{const n=b;return k(),q("div",null,[R(n,{type:"card",options:t,modelValue:P(a),"onUpdate:modelValue":l[0]||(l[0]=e=>J(a)?a.value=e:null)},null,8,["modelValue"])])}}});export{qe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
