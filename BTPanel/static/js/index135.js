import{c as e,r as a,p as l,q as d,v as t,e as s,A as o,x as r,F as m,a_ as i,y as u,aj as n,a9 as p,a7 as b,M as c,ai as f}from"./base-lib.js?v=1756369731";import{K as _,j as v}from"./utils-lib.js?v=1756369731";import{setRedisValue as g}from"./database.js?v=1756369731";import{g as x}from"./useStore2.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const w={class:"p-[20px]"},V=e({__name:"index",props:{compData:{default:()=>({options:[],sid:0})}},setup(e,{expose:V}){const{refreshTableList:h}=x(),y=e,D=a(),j=a(),q=a({db_idx:Number(y.compData.keyId),name:"",val:"",endtime:""}),U={db_idx:[{required:!0,message:"请选择数据库",trigger:"change"}],name:[{required:!0,message:"请输入键",trigger:["blur","input"]}],val:[{required:!0,message:"请输入值",trigger:["blur","input"]}]};return l(async()=>{var e;j.value=await(null==(e=y.compData)?void 0:e.refresh()),y.compData.row&&(q.value=y.compData.row)}),V({onConfirm:async e=>{await D.value.validate();let a={...q.value,sid:y.compData.sid};q.value.endtime&&"0"!==q.value.endtime||delete a.endtime,await _({loading:"正在".concat(y.compData.row?"编辑":"添加","数据库，请稍后..."),request:g({data:JSON.stringify(a)}),message:!0}),h(),e()}}),(e,a)=>{const l=f,_=n,g=p,x=v,V=b;return d(),t("div",w,[s(V,{"label-position":"right","label-width":"80px",model:r(q),ref_key:"redisFormRef",ref:D,rules:U},{default:o(()=>[s(g,{label:"数据库",prop:"db_idx"},{default:o(()=>[s(_,{class:"!w-[24rem]",modelValue:r(q).db_idx,"onUpdate:modelValue":a[0]||(a[0]=e=>r(q).db_idx=e),disabled:e.compData.row},{default:o(()=>[(d(!0),t(m,null,i(r(j),(e,a)=>(d(),c(l,{key:a,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),s(g,{label:"键",prop:"name"},{default:o(()=>[s(x,{width:"24rem",placeholder:"请输入键名",modelValue:r(q).name,"onUpdate:modelValue":a[1]||(a[1]=e=>r(q).name=e),disabled:e.compData.row},null,8,["modelValue","disabled"])]),_:1}),s(g,{label:"值",prop:"val"},{default:o(()=>[s(x,{width:"24rem",placeholder:"请输入值",modelValue:r(q).val,"onUpdate:modelValue":a[2]||(a[2]=e=>r(q).val=e),rows:6,type:"textarea"},null,8,["modelValue"])]),_:1}),s(g,{label:"有效期"},{default:o(()=>[s(x,{width:"24rem",placeholder:"为空则永不过期",modelValue:r(q).endtime,"onUpdate:modelValue":a[3]||(a[3]=e=>r(q).endtime=e),"text-type":"秒",min:0,type:"number"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a[4]||(a[4]=u("ul",{class:"mt-[20px] leading-8 text-[1.2rem] list-disc ml-[36px]"},[u("li",null,"有效期为0表示永久")],-1))])}}});export{V as default};
