!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){u(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function u(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var a=r.call(n,t||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function u(t,r,a,u){var o=r&&r.prototype instanceof l?r:l,s=Object.create(o.prototype);return i(s,"_invoke",function(t,r,a){var u,o,i,l=0,s=a||[],f=!1,_={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(n,t){return u=n,o=0,i=e,_.n=t,c}};function d(t,r){for(o=t,i=r,n=0;!f&&l&&!a&&n<s.length;n++){var a,u=s[n],d=_.p,m=u[2];t>3?(a=m===r)&&(i=u[(o=u[4])?5:(o=3,3)],u[4]=u[5]=e):u[0]<=d&&((a=t<2&&d<u[1])?(o=0,_.v=r,_.n=u[1]):d<m&&(a=t<3||u[0]>r||r>m)&&(u[4]=t,u[5]=r,_.n=m,o=0))}if(a||t>1)return c;throw f=!0,r}return function(a,s,m){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,m),o=s,i=m;(n=o<2?e:i)||!f;){u||(o?o<3?(o>1&&(_.n=-1),d(o,i)):_.n=i:_.v=i);try{if(l=2,u){if(o||(a="next"),n=u[a]){if(!(n=n.call(u,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,o<2&&(o=0)}else 1===o&&(n=u.return)&&n.call(u),o<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),o=1);u=e}else if((n=(f=_.n<0)?i:t.call(r,_))!==c)break}catch(n){u=e,o=1,i=n}finally{l=1}}return{value:n,done:f}}}(t,a,u),!0),s}var c={};function l(){}function s(){}function f(){}n=Object.getPrototypeOf;var _=[][r]?n(n([][r]())):(i(n={},r,function(){return this}),n),d=f.prototype=l.prototype=Object.create(_);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,i(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=f,i(d,"constructor",f),i(f,"constructor",s),s.displayName="GeneratorFunction",i(f,a,"GeneratorFunction"),i(d),i(d,a,"Generator"),i(d,r,function(){return this}),i(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:u,m:m}})()}function i(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}i=function(e,n,t,r){function u(n,t){i(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(u("next",0),u("throw",1),u("return",2))},i(e,n,t,r)}function c(e,n,t,r,a,u,o){try{var i=e[u](o),c=i.value}catch(e){return void t(e)}i.done?n(c):Promise.resolve(c).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var u=e.apply(n,t);function o(e){c(u,r,a,o,i,"next",e)}function i(e){c(u,r,a,o,i,"throw",e)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./index-legacy116.js?v=1756369731","./index-legacy101.js?v=1756369731","./index-legacy140.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1756369731","./validator-legacy.js?v=1756369731","./store-legacy4.js?v=1756369731","./useMethod-legacy4.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./ace-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./column-legacy.js?v=1756369731","./database-legacy.js?v=1756369731","./useStore-legacy2.js?v=1756369731"],function(e,t){"use strict";var r,i,c,s,f,_,d,m,p,b,h,v,y,g,z,w,x,k,q,j,C,S,V,O,P,B,M,N,I,U,F,G,E,L,T,D,A,H,K,Q,R,J,$,W,Y,X,Z,ee,ne,te,re,ae,ue,oe,ie,ce,le,se,fe,_e,de,me,pe,be,he,ve,ye,ge,ze,we,xe,ke,qe,je,Ce,Se,Ve,Oe,Pe;return{setters:[function(e){r=e.o,i=e.K,c=e.gz,s=e.M,f=e.gA,_=e.aq,d=e.bT,m=e.l,p=e.L,b=e.R,h=e.v,v=e.bz,y=e.r,g=e.at,z=e.gx,w=e.W,x=e.ag,k=e.h,q=e.j,j=e.al,C=e.e},function(e){S=e.s,V=e.r,O=e.k,P=e.c,B=e.g,M=e.p,N=e.G,I=e.q,U=e.v,F=e.e,G=e.A,E=e.y,L=e.x,T=e.M,D=e.B,A=e.C,H=e.P,K=e.z,Q=e.H,R=e.F,J=e.a_,$=e.I,W=e.D,Y=e.a9,X=e.a7,Z=e.aA,ee=e.bN,ne=e.bM,te=e.au,re=e.aw,ae=e.ai,ue=e.aj,oe=e.a$,ie=e.al},function(e){ce=e._},function(e){le=e._},function(e){se=e.B},function(e){fe=e.S,_e=e._},function(e){de=e.S,me=e._},function(e){pe=e.E,be=e.f,he=e.F,ve=e.G,ye=e.H,ge=e.J,ze=e.K,we=e.L,xe=e.M,ke=e.N,qe=e.O,je=e.P,Ce=e.Q,Se=e.R,Ve=e.T},function(e){Oe=e.H},function(e){Pe=e.u},null,null,null,null,null,null],execute:function(){var Be=fe(),Me=de(),Ne=S(de()).compData,Ie=Oe();S(Ie);var Ue=V("service"),Fe=V(!1);V(!0);var Ge=V(""),Ee=V(!1),Le=O({re_level:1,tips:""}),Te=[{label:"级别一",value:1},{label:"级别二",value:2},{label:"级别三",value:3},{label:"级别四",value:4},{label:"级别五",value:5},{label:"级别六",value:6}],De=V(null),Ae={recover:[{content:"启动完成后请立即备份和检查数据库完整性"},{content:"恢复级别说明（从1到6进行尝试）："},{content:"级别一：尝试忽略损坏的页，适用于轻微损坏的情况，可以尝试从数据中恢复。"},{content:"级别二：禁用后台线程，适合解决由于并发操作导致的问题。"},{content:"级别三：适用于需要快速恢复的场景，但可能会导致最近的数据丢失。"},{content:"级别四：适用于插入缓冲区引起问题时的恢复，可能会导致数据文件损坏。"},{content:"级别五：适合于需要快速启动但可能会导致数据一致性问题的情况。"},{content:"级别六：适用于最严重的情况，可能会导致较高的数据丢失及数据文件损坏。"}],config:[{content:"此处为mysql主配置文件，若您不了解配置规则，请勿随意修改"}],storage:[{content:"风险提示：迁移过程中Mysql将会停止运行，请谨慎操作"},{content:"风险提示：迁移过程中请等待迁移完成后再进行其他操作"}],memoryProtection:[{content:"说明：开启后将调整Mysql内存优先级，设置mysql为永不被系统杀死，可确保Mysql稳定运行。但可能导致其他进程异常被杀，严重时可能影响系统运行，建议需要Mysql稳定运行时在开启。"}]},He=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r({title:"mysqld服务",icon:"warning-filled",content:"即将开始修复mysql启动问题，是否继续？"});case 1:return e.n=2,i({loading:"正在修复启动，请稍后...",request:c(),success:function(){var e=l(o().m(function e(n){return o().w(function(e){for(;;)switch(e.n){case 0:"data_err"===n.err_type?(Le.tips=n.msg,Ee.value=!0):"log_err"===n.err_type?Ke(n.msg):(Re(),s.msg({dangerouslyUseHTMLString:!0,message:n.msg,type:n.status?"success":"error",duration:n.status?2e3:0,showClose:!n.status,customClass:"".concat("port_in_use"===n.err_type?"max-w-[48rem]":"")}));case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=l(o().m(function e(n){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r({title:"修复MySQL启动",icon:"warning-filled",content:n});case 1:i({loading:"正在修复MySQL启动，请稍后...",request:pe(),message:!0,success:function(e){Re()}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Qe=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:if(!(Le.re_level>=4)){e.n=1;break}return e.n=1,r({title:"修复MYSQL启动",width:"39rem",isHtml:!0,content:'警告：当前选择的恢复等级将可能导致<span class="text-danger">数据文件损坏会丢失</span>，请做好服务器快照或备份好数据库数据目录【/www/server/data】如果启动成功，数据库将会进入只读模式'});case 1:return e.n=2,i({loading:"正在修复启动，请稍后...",request:f({re_level:Le.re_level}),message:!0,success:function(){var e=l(o().m(function e(n){return o().w(function(e){for(;;)switch(e.n){case 0:n.status&&(Ee.value=!1),Re();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Re=function(){i({request:_({sName:"mysql"}),success:function(e){Ne.value=e.data}})},Je=V(""),$e=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:"正在保存配置，请稍后...",request:d({path:"/etc/my.cnf",data:Je.value,encoding:"utf-8"}),message:!0});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),We=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:Fe,request:z({path:"/etc/my.cnf"}),data:{data:[String,Je]}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Ye=O({path:"",port:"",oldData:{path:"",port:""}}),Xe=function(){be({type:"dir",path:Ye.path,change:function(e){Ye.path=e}})},Ze=function(){var e=l(o().m(function e(){var n,t;return o().w(function(e){for(;;)switch(e.n){case 0:if(n="port"===Ue.value,Ye.path||n){e.n=1;break}return e.a(2,s.error("存储位置不能为空"));case 1:if(Ye.port||!n){e.n=2;break}return e.a(2,s.error("端口不能为空"));case 2:if(!n||Ye.port!==Ye.oldData.port){e.n=3;break}return e.a(2,s.success("未修改端口数据"));case 3:if(n||Ye.path!==Ye.oldData.path){e.n=4;break}return e.a(2,s.success("未修改存储位置数据"));case 4:if(!!n){e.n=5;break}return e.n=5,r({title:"数据库迁移",icon:"warning-filled",content:"请确定是否迁移至:【".concat(Ye.path,"】？")});case 5:t=u({},n?"port":"datadir",Ye[n?"port":"path"]),i({loading:"正在设置，请稍后...",request:(n?je:Ce)(t),message:!0,success:function(){var e=l(o().m(function e(n){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,De.value;case 1:e.v.unmount(),nn();case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()}),setTimeout(function(){!n&&en()},1e3);case 6:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),en=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:De.value=m({title:"迁移任务",area:60,component:function(){return p(function(){return t.import("./progress-legacy2.js?v=1756369731")},void 0,t.meta.url)}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),nn=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:Fe,request:he(),success:function(e){var n,t,r,a;Ye.path=(null==e||null===(n=e.data)||void 0===n?void 0:n.datadir)||"",Ye.port=(null==e||null===(t=e.data)||void 0===t?void 0:t.port)||"",Ye.oldData.path=(null==e||null===(r=e.data)||void 0===r?void 0:r.datadir)||"",Ye.oldData.port=(null==e||null===(a=e.data)||void 0===a?void 0:a.port)||""}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),tn=V([{name:"启动时间",field:"Run",value:"无",function:function(e){return b(e.Run)}},{name:"总连接次数",field:"Connections",value:"无"},{name:"发送",value:"无",field:"other",function:function(e){return h(Number(e.Bytes_sent))}},{name:"接收",value:"无",field:"other",function:function(e){return h(Number(e.Bytes_received))}},{name:"每秒查询",value:"无",field:"other",function:function(e){return parseInt((e.Questions/e.Uptime).toString())}},{name:"每秒事务",value:"无",field:"other",function:function(e){return parseInt(((parseInt(e.Com_commit)+parseInt(e.Com_rollback))/e.Uptime).toString())}},{name:"File",value:"无",field:"File"},{name:"Position",value:"无",field:"Position"}]),rn=V([{name:"活动/峰值连接数",function:function(e){return e.Threads_running+"/"+e.Max_used_connections},value:"",ps:"若值过大,增加max_connections"},{name:"线程缓存命中率",value:"",function:function(e){var n=(100*(1-e.Threads_created/e.Connections)).toFixed(2);return isNaN(n)?"0":n+"%"},ps:"若过低,增加thread_cache_size"},{value:"",name:"索引命中率",function:function(e){var n=(100*(1-e.Key_reads/e.Key_read_requests)).toFixed(2);return isNaN(n)?"0":n+"%"},ps:"若过低,增加key_buffer_size"},{value:"",name:"Innodb索引命中率",function:function(e){var n=(100*(1-e.Innodb_buffer_pool_reads/e.Innodb_buffer_pool_read_requests)).toFixed(2);return isNaN(n)?"0":n},ps:"若过低,增加innodb_buffer_pool_size"},{value:"",name:"查询缓存命中率",function:function(e){var n=(parseInt(e.Qcache_hits)/(parseInt(e.Qcache_hits)+parseInt(e.Qcache_inserts))*100).toFixed(2)+"%";return"NaN%"==n&&(n="OFF"),n},ps:"若过低,增加query_cache_size"},{value:"",name:"创建临时表到磁盘",function:function(e){var n=(e.Created_tmp_disk_tables/e.Created_tmp_tables*100).toFixed(2);return isNaN(n)?"0":n+"%"},ps:"若过大,尝试增加tmp_table_size"},{value:"",name:"已打开的表",function:function(e){return e.Open_tables},ps:"table_open_cache配置值应大于等于此值"},{value:"",name:"没有使用索引的量",function:function(e){return e.Select_full_join},ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"没有索引的JOIN量",function:function(e){return e.Select_range_check},ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"排序后的合并次数",function:function(e){return e.Sort_merge_passes},ps:"若值过大,增加sort_buffer_size"},{value:"",name:"锁表次数",function:function(e){return e.Table_locks_waited},ps:"若值过大,请考虑增加您的数据库性能"}]),an=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:Fe,request:Se(),success:function(e){var n;if(!1===e.status||null!==(n=e.data)&&void 0!==n&&n.status)return s.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:e.msg||e.data.msg,type:"error",showClose:!0});tn.value.forEach(function(n){n.function?n.value=n.function(e.data):n.value=e.data[n.field]}),rn.value.forEach(function(n){n.function&&(n.value=n.function(e.data))})}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),un=[{title:"1-2GB",data:{key_buffer_size:32,query_cache_size:32,tmp_table_size:32,innodb_buffer_pool_size:64,sort_buffer_size:256,read_buffer_size:256,read_rnd_buffer_size:256,join_buffer_size:512,thread_stack:256,binlog_cache_size:64,thread_cache_size:64,table_open_cache:128,max_connections:100}},{title:"2-4GB",data:{key_buffer_size:64,query_cache_size:64,tmp_table_size:64,innodb_buffer_pool_size:128,sort_buffer_size:512,read_buffer_size:512,read_rnd_buffer_size:512,join_buffer_size:1024,thread_stack:256,binlog_cache_size:64,thread_cache_size:96,table_open_cache:192,max_connections:200}},{title:"4-8GB",data:{key_buffer_size:128,query_cache_size:128,tmp_table_size:128,innodb_buffer_pool_size:256,sort_buffer_size:1024,read_buffer_size:1024,read_rnd_buffer_size:768,join_buffer_size:2048,thread_stack:256,binlog_cache_size:128,thread_cache_size:128,table_open_cache:384,max_connections:300}},{title:"8-16GB",data:{key_buffer_size:256,query_cache_size:256,tmp_table_size:256,innodb_buffer_pool_size:1024,sort_buffer_size:1024,read_buffer_size:2048,read_rnd_buffer_size:1024,join_buffer_size:2048,thread_stack:384,binlog_cache_size:192,thread_cache_size:192,table_open_cache:1024,max_connections:400}},{title:"16-32GB",data:{key_buffer_size:512,query_cache_size:384,tmp_table_size:1024,innodb_buffer_pool_size:2048,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:2048,join_buffer_size:4096,thread_stack:512,binlog_cache_size:256,thread_cache_size:256,table_open_cache:2048,max_connections:500}},{title:"32-48GB",data:{key_buffer_size:1024,query_cache_size:512,tmp_table_size:1536,innodb_buffer_pool_size:4096,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:3072,join_buffer_size:6144,thread_stack:512,binlog_cache_size:384,thread_cache_size:384,table_open_cache:3072,max_connections:750}},{title:"48-64GB",data:{key_buffer_size:2048,query_cache_size:768,tmp_table_size:2048,innodb_buffer_pool_size:8192,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:512,binlog_cache_size:512,thread_cache_size:512,table_open_cache:4096,max_connections:1e3}},{title:"64-96GB",data:{key_buffer_size:2048,query_cache_size:1024,tmp_table_size:3072,innodb_buffer_pool_size:16384,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:768,binlog_cache_size:768,thread_cache_size:768,table_open_cache:6144,max_connections:1500}},{title:"96-128GB",data:{key_buffer_size:2048,query_cache_size:1536,tmp_table_size:4096,innodb_buffer_pool_size:32768,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:1024,binlog_cache_size:1024,thread_cache_size:1024,table_open_cache:8192,max_connections:2e3}},{title:"128-256GB",data:{key_buffer_size:4096,query_cache_size:2048,tmp_table_size:8192,innodb_buffer_pool_size:65536,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:2048,binlog_cache_size:2048,thread_cache_size:2048,table_open_cache:16384,max_connections:4e3}}],on={key_buffer_size:"MB,用于索引的缓冲区大小",query_cache_size:"MB,查询缓存,不开启请设为0",tmp_table_size:"MB,临时表缓存大小",innodb_buffer_pool_size:"MB,Innodb缓冲区大小",innodb_log_buffer_size:"MB,Innodb日志缓冲区大小",sort_buffer_size:"KB * 连接数,每个线程排序的缓冲大小",read_buffer_size:"KB * 连接数读入缓冲区大小",read_rnd_buffer_size:"KB * 连接数随机读取缓冲区大小",join_buffer_size:"KB * 连接数关联表缓存大小",thread_stack:"KB * 连接数每个线程的堆栈大小",binlog_cache_size:"KB * 连接数二进制日志缓存大小(4096的倍数)",thread_cache_size:"线程池大小",table_open_cache:"表缓存",max_connections:"最大连接数"},cn=V(""),ln=V([]),sn=V(),fn=function(){var e=l(o().m(function e(n){return o().w(function(e){for(;;)switch(e.n){case 0:ln.value.forEach(function(e){un[n].data[e.name]&&(e.value=un[n].data[e.name]),"query_cache_size"!==e.name||un[n].data.query_cache_size||(e.value=0)}),_n();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),_n=function(){var e,n=0,t=0,r=["key_buffer_size","query_cache_size","tmp_table_size","innodb_buffer_pool_size","innodb_log_buffer_size"],a=["sort_buffer_size","read_buffer_size","read_rnd_buffer_size","join_buffer_size","thread_stack","binlog_cache_size"],u=Number(ln.value.find(function(e){return"max_connections"===e.name}).value);ln.value.forEach(function(e){r.includes(e.name)?n+=Number(e.value):a.includes(e.name)&&(t+=Number(e.value)/1024)}),e=n+t*u,sn.value=e},dn=function(){var e=l(o().m(function e(){var n;return o().w(function(e){for(;;)switch(e.n){case 0:return n={query_cache_type:0},ln.value.forEach(function(e){var t="bt_query_cache_size"===e.name?"query_cache_size":e.name;n[t]=e.value}),n.query_cache_size>0&&(n.query_cache_type=1),delete n.query_cache_supprot,n.max_heap_table_size=n.tmp_table_size,e.n=1,i({loading:"正在保存中，请稍后...",request:ve(n),message:!0,success:function(e){e.status&&s.success("设置成功，重启数据库后配置生效，请重启数据库")}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),mn=function(){var e=l(o().m(function e(n){var t;return o().w(function(e){for(;;)switch(e.n){case 0:return t={restart:"重启",stop:"停止",reload:"重载配置",start:"启动"},e.n=1,r({title:"".concat(t[n],"mysqld服务"),content:"是否".concat(t[n],"mysqld服务？")});case 1:return e.n=2,i({loading:"正在".concat(t[n],"mysqld服务，请稍后..."),request:v({name:"mysqld",type:n}),message:!0,success:function(e){e.status&&y.go(0)}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),pn=function(){var e=l(o().m(function e(){var n,t,r,a;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return Fe.value=!0,e.p=1,e.n=2,Ve();case 2:n=e.v,t=n.data,ln.value=[],t.mem.hasOwnProperty("join_buffer_size")||(t.mem.join_buffer_size=512),t.mem.hasOwnProperty("thread_stack")||(t.mem.thread_stack=256),t.mem.hasOwnProperty("binlog_cache_size")||(t.mem.binlog_cache_size=32),r="disable"===t.mem.query_cache_supprot,Object.keys(t.mem).forEach(function(e){"query_cache_size"===e||"bt_query_cache_size"===e?r||ln.value.push({name:"query_cache_size",value:t.mem.bt_query_cache_size,ps:on[e]?on[e]:""}):ln.value.push({name:e,value:t.mem[e],ps:on[e]?on[e]:""})}),sn.value=t.mem.bt_mem_size,cn.value="",_n(),e.n=4;break;case 3:e.p=3,a=e.v,g(a);case 4:return e.p=4,Fe.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),bn=V(""),hn=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r({title:"清空日志操作提示",icon:"warning-filled",content:"清空日志会导致运行错误信息丢失，无法排除问题，请谨慎操作，是否继续？"});case 1:return e.n=2,i({loading:"正在清空日志，请稍后...",request:ye({close:1}),message:!0,success:vn});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),vn=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:Fe,request:ge(),data:[String,bn]});case 1:bn.value=bn.value||"当前暂无数据";case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),yn=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:Fe,request:ze(),data:{msg:[String,bn]}});case 1:bn.value=bn.value||"当前暂无数据";case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),gn=V(!1),zn=V(),wn=V([]),xn=O({status:!1,size:""}),kn=V(!1),qn=O({days:""}),jn=O({days:[{required:!0,message:"请输入天数",trigger:"blur"},{validator:function(e,n,t){n<7?t(new Error("请输入大于7的天数")):t()}}]}),Cn=function(){var e=l(o().m(function e(n){return o().w(function(e){for(;;)switch(e.n){case 0:return xn.status=!n,e.n=1,r({title:(n?"开启":"关闭")+"二进制日志",icon:"warning-filled",content:(n?"开启二进制日志可以保护Mysql的数据安全，但同时会消耗一定磁盘存储，是否继续?":"关闭二进制日志后，将不会再记录所有对数据库的修改操作")+"二进制日志?"});case 1:return e.n=2,i({loading:"正在"+(n?"开启":"关闭")+"二进制日志，请稍后...",request:we(),message:!0,success:function(e){On()}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Sn=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,zn.value.validate();case 1:return e.n=2,r({title:"清理日志",content:"即将清理【"+qn.days+"】天前的MySQL二进制日志，是否继续？",icon:"warning-filled"});case 2:return e.n=3,i({loading:"正在清理日志，请稍后...",request:pe({days:qn.days}),message:!0,success:function(e){e.status&&(kn.value=!1,Vn(),On(),Pn())}});case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Vn=function(){var e,n;kn.value=!1,null===(e=zn.value)||void 0===e||e.clearValidate(),null===(n=zn.value)||void 0===n||n.resetFields()},On=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({request:we({status:1}),success:function(e){xn.status=e.data.binlog_status,xn.size=h(e.data.size)}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Pn=function(){var e=l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:Fe,request:xe(),data:{data:[Array,wn]}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Bn=function(){var e=l(o().m(function e(n){var t;return o().w(function(e){for(;;)switch(e.n){case 0:return t=n.row,e.n=1,r({title:"删除日志",icon:"warning-filled",content:"您真的要删除【".concat(t.name,"】日志？"),type:"calc"});case 1:return e.n=2,i({loading:"正在删除【".concat(t.name,"】日志，请稍后..."),request:ke({path:t.path}),message:!0,success:Pn});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Mn=V(!1),Nn=function(){var e=l(o().m(function e(n){var t,r,a;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t="get"===n?{}:{status:Number(n)},e.n=1,qe(t);case 1:r=e.v,"get"===n?(r.status||"当前状态关闭中！"===r.msg||s.request(r),Mn.value=Boolean(r.status)):s.request(r),e.n=3;break;case 2:e.p=2,a=e.v,g(a);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),In=function(){var e=l(o().m(function e(n){var t;return o().w(function(e){for(;;)switch(e.n){case 0:t=n,e.n="config"===t?1:"port"===t||"storage"===t?2:"state"===t?3:"performance"===t?4:"errorLogs"===t?5:"slowLogs"===t?6:"binaryLogs"===t?7:"memoryProtection"===t?9:10;break;case 1:return We(),e.a(3,10);case 2:return nn(),e.a(3,10);case 3:return an(),e.a(3,10);case 4:return pn(),e.a(3,10);case 5:return vn(),e.a(3,10);case 6:return yn(),e.a(3,10);case 7:return e.n=8,Pn();case 8:return On(),e.a(3,10);case 9:return Nn("get"),e.a(3,10);case 10:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Un=function(e){Ue.value="service",e&&(Ne.value=e);var n=a(a({},Ne.value),{},{name:"mysqld"});Me.init(n),Be.init(n),Ge.value=Ne.value.status},Fn={key:0},Gn={class:"p-2rem"},En={class:"content flex items-center"},Ln={class:"message flex-1 ml-4 py-[.3rem] leading-[2.4rem] text-[1.3rem]"},Tn={class:"text text-[15px] leading-[2.5rem] flex !flex-wrap break-all"},Dn={class:"my-[12px]"},An={class:"flex text-[#666] items-center"},Hn={class:"flex text-[#666] items-center"},Kn={class:"text-[#666] performance"},Qn={class:"flex items-center justify-center"},Rn={class:"flex items-center"},Jn={class:"ml-2rem"},$n={class:"my-[12px]"},Wn={class:"my-[12px]"},Yn={class:"flex items-center"},Xn={class:"ml-[16rem]"},Zn=["onClick"],et={class:"p-[20px]"},nt=P({__name:"index",props:{compData:{default:{}}},setup:function(e){var t=S(de()).compData,r=e,a=B(function(){return t.value.status});return M(function(){Un(r.compData),t.value.refreshEvent=l(o().m(function e(){var n;return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Pe("mysql");case 1:n=e.v,t.value.status=n.s_status;case 2:return e.a(2)}},e)}))}),function(e,t){var r=W,u=w,o=x,i=Y,c=X,l=k,s=Z,f=se,_=le,d=q,m=ee,p=ne,v=te,y=re,g=ae,z=ue,C=oe,S=ce,V=ie,O=j,P=N("bt-loading");return I(),U("div",null,[F(O,{modelValue:L(Ue),"onUpdate:modelValue":t[12]||(t[12]=function(e){return H(Ue)?Ue.value=e:null}),type:"left-bg-card",position:"left",class:"h-full",onChange:L(In)},{default:G(function(){return[F(s,{label:"服务",name:"service"},{default:G(function(){return[E("div",null,[F(me),F(_e),L(a)?A("",!0):(I(),T(r,{key:0,class:"mt-4rem",onClick:L(He)},{default:G(function(){return n(t[13]||(t[13]=[D("修复启动",-1)]))}),_:1},8,["onClick"])),F(u,{options:[{content:"如需更换mysql版本，请备份好数据后，卸载mysql重新安装"}],class:"pl-1rem"},{default:G(function(){return[L(a)?A("",!0):(I(),U("li",Fn,"如无法正常启动，请尝试使用修复启动按钮进行修复启动"))]}),_:1}),F(l,{modelValue:L(Ee),"onUpdate:modelValue":t[1]||(t[1]=function(e){return H(Ee)?Ee.value=e:null}),area:50,title:"修复启动-恢复模式-innodb_force_recovery","show-footer":"",onConfirm:L(Qe)},{default:G(function(){return[E("div",Gn,[E("div",En,[t[14]||(t[14]=E("i",{class:"svgtofont-el-warning-filled !text-[4rem] text-warning"},null,-1)),E("div",Ln,[E("div",Tn,K(L(Le).tips),1)])]),F(c,{model:L(Le),"label-width":"80px"},{default:G(function(){return[F(i,{label:"恢复级别"},{default:G(function(){return[F(o,{modelValue:L(Le).re_level,"onUpdate:modelValue":t[0]||(t[0]=function(e){return L(Le).re_level=e}),options:L(Te),class:"!w-20rem"},null,8,["modelValue","options"])]}),_:1})]}),_:1},8,["model"]),F(u,{options:L(Ae).recover,class:"pl-3rem"},null,8,["options"])])]}),_:1},8,["modelValue","onConfirm"])])]}),_:1}),F(s,{label:"配置文件",name:"config",lazy:!0},{default:G(function(){return[Q((I(),U("div",null,[t[16]||(t[16]=E("span",{class:"my-[4px] text-[#666]"}," 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ",-1)),E("div",Dn,[F(f,{class:"!h-[48rem] !w-full",modelValue:L(Je),"onUpdate:modelValue":t[2]||(t[2]=function(e){return H(Je)?Je.value=e:null}),id:"configContent",onSave:L($e)},null,8,["modelValue","onSave"])]),F(r,{type:"primary",onClick:L($e)},{default:G(function(){return n(t[15]||(t[15]=[D("保存",-1)]))}),_:1},8,["onClick"]),F(u,{options:L(Ae).config,class:"pl-2rem"},null,8,["options"])])),[[P,L(Fe)]])]}),_:1}),F(s,{label:"存储位置",name:"storage",lazy:!0},{default:G(function(){return[Q((I(),U("div",null,[E("div",An,[F(_,{icon:"icon-file_mode",onIconClick:L(Xe),width:"32rem",modelValue:L(Ye).path,"onUpdate:modelValue":t[3]||(t[3]=function(e){return L(Ye).path=e}),class:"!w-32rem"},null,8,["onIconClick","modelValue"]),F(r,{class:"ml-[12px]",onClick:L(Ze),type:"primary"},{default:G(function(){return n(t[17]||(t[17]=[D("迁移",-1)]))}),_:1},8,["onClick"])]),F(u,{options:L(Ae).storage,class:"pl-2rem"},null,8,["options"])])),[[P,L(Fe)]])]}),_:1}),F(s,{label:"端口配置",name:"port",lazy:!0},{default:G(function(){return[Q((I(),U("div",Hn,[F(d,{modelValue:L(Ye).port,"onUpdate:modelValue":t[4]||(t[4]=function(e){return L(Ye).port=e}),type:"number",width:"10rem",class:"!w-10rem"},null,8,["modelValue"]),F(r,{type:"primary",class:"ml-[12px]",onClick:L(Ze)},{default:G(function(){return n(t[18]||(t[18]=[D("修改",-1)]))}),_:1},8,["onClick"])])),[[P,L(Fe)]])]}),_:1}),F(s,{label:"当前状态",name:"state",lazy:!0},{default:G(function(){return[Q((I(),U("div",null,[F(p,{class:"margin-top table-descriptions",column:2,border:""},{default:G(function(){return[(I(!0),U(R,null,J(L(tn),function(e,n){return I(),T(m,{key:n},{label:G(function(){return[D(K(e.name),1)]}),default:G(function(){return[D(" "+K(e.value),1)]}),_:2},1024)}),128))]}),_:1}),F(y,{data:L(rn),class:"mt-[20px]","max-height":"400"},{default:G(function(){return[F(v,{prop:"name",label:"字段",width:"180"}),F(v,{prop:"value",label:"当前值",width:"100"}),F(v,{prop:"ps",label:"注意"})]}),_:1},8,["data"])])),[[P,L(Fe)]])]}),_:1}),F(s,{label:"性能调整",name:"performance",lazy:!0},{default:G(function(){return[Q((I(),U("div",Kn,[E("div",Qn,[t[19]||(t[19]=D(" 优化方案 ",-1)),F(z,{class:"!w-[12rem] mr-[20px] ml-8px",modelValue:L(cn),"onUpdate:modelValue":t[5]||(t[5]=function(e){return H(cn)?cn.value=e:null}),onChange:L(fn)},{default:G(function(){return[(I(!0),U(R,null,J(L(un),function(e,n){return I(),T(g,{key:n,value:n,label:e.title},null,8,["value","label"])}),128))]}),_:1},8,["modelValue","onChange"]),t[20]||(t[20]=D(" 最大使用内存 ",-1)),F(d,{"text-type":"MB",width:"16rem",class:"!w-16rem ml-8px",readonly:"",modelValue:L(sn),"onUpdate:modelValue":t[6]||(t[6]=function(e){return H(sn)?sn.value=e:null})},null,8,["modelValue"])]),F(C),F(c,{class:"performance-form","label-position":"right","label-width":"146px"},{default:G(function(){return[(I(!0),U(R,null,J(L(ln),function(e,n){return Q((I(),T(i,{label:e.name,key:n},{default:G(function(){return[E("div",Rn,[F(d,{modelValue:e.value,"onUpdate:modelValue":function(n){return e.value=n},width:"16rem",class:"!w-16rem",type:"number",onChange:L(_n)},null,8,["modelValue","onUpdate:modelValue","onChange"]),E("span",Jn,K(e.ps),1)])]}),_:2},1032,["label"])),[[$,e.ps]])}),128)),F(i,{label:" ",class:"mt-1rem"},{default:G(function(){return[F(r,{type:"primary",onClick:L(dn)},{default:G(function(){return n(t[21]||(t[21]=[D("保存",-1)]))}),_:1},8,["onClick"]),F(r,{onClick:t[7]||(t[7]=function(e){return L(mn)("restart")})},{default:G(function(){return n(t[22]||(t[22]=[D("重启数据库",-1)]))}),_:1}),t[23]||(t[23]=E("span",{class:"ml-3rem"},"* 修改配置后，需重启数据库生效",-1))]}),_:1})]}),_:1})])),[[P,L(Fe)]])]}),_:1}),F(s,{label:"错误日志",name:"errorLogs",lazy:!0},{default:G(function(){return[Q((I(),U("div",null,[F(r,{type:"default",onClick:L(hn)},{default:G(function(){return n(t[24]||(t[24]=[D("清空日志",-1)]))}),_:1},8,["onClick"]),E("div",$n,[F(S,{class:"!h-[56rem] !w-full",content:L(bn),id:"errorLogs",isHtml:!0,fullScreen:{title:"全屏查看【错误日志】",onRefresh:L(vn)}},null,8,["content","fullScreen"])])])),[[P,L(Fe)]])]}),_:1}),F(s,{label:"慢日志",name:"slowLogs",lazy:!0},{default:G(function(){return[Q((I(),U("div",Wn,[F(S,{content:L(bn),isHtml:!0,class:"!h-[60rem] !w-full",id:"slowLogs",fullScreen:{title:"全屏查看【慢日志】",onRefresh:L(yn)}},null,8,["content","fullScreen"])])),[[P,L(Fe)]])]}),_:1}),F(s,{label:"二进制日志",name:"binaryLogs",lazy:!0},{default:G(function(){return[E("div",null,[E("div",Yn,[E("div",null,[t[25]||(t[25]=D(" 二进制日志 ",-1)),F(V,{modelValue:L(xn).status,"onUpdate:modelValue":t[8]||(t[8]=function(e){return L(xn).status=e}),onChange:L(Cn)},null,8,["modelValue","onChange"])]),E("span",Xn,K(L(xn).size),1)]),F(C),t[27]||(t[27]=E("span",null," · 温馨提示：Mysql二进制日志是记录当前的操作日志，可用于数据恢复，数据备份。 ",-1)),Q((I(),T(y,{class:"mt-[20px]",data:L(wn),"max-height":"500"},{default:G(function(){return[F(v,{prop:"name",label:"文件名"}),F(v,{prop:"size",label:"大小"},{default:G(function(e){return[D(K(L(h)(e.row.size)),1)]}),_:1}),F(v,{prop:"last_modified",label:"最后修改时间"},{default:G(function(e){return[D(K(L(b)(e.row.last_modified)),1)]}),_:1}),F(v,{align:"right",label:"操作"},{default:G(function(e){return[E("span",{class:"bt-link",onClick:function(n){return L(Bn)(e)}},"删除",8,Zn)]}),_:1})]}),_:1},8,["data"])),[[P,L(Fe)]]),F(l,{title:"清理日志",modelValue:L(kn),"onUpdate:modelValue":t[10]||(t[10]=function(e){return H(kn)?kn.value=e:null}),area:42,showFooter:"",onCancel:L(Vn),onConfirm:L(Sn)},{default:G(function(){return[E("div",et,[F(c,{disabled:L(gn),class:"flex justify-center","label-position":"right",model:L(qn),ref_key:"binlogFormRef",ref:zn,rules:L(jn)},{default:G(function(){return[F(i,{label:"清理周期",prop:"days"},{default:G(function(){return[F(d,{modelValue:L(qn).days,"onUpdate:modelValue":t[9]||(t[9]=function(e){return L(qn).days=e}),type:"number",min:7,width:"24","text-type":"天"},null,8,["modelValue"])]}),_:1})]}),_:1},8,["disabled","model","rules"]),t[26]||(t[26]=E("ul",{class:"leading-8 text-[1.2rem] list-disc ml-[48px]"},[E("li",null,"只能清理7天前的日志,请输入大于7的天数")],-1))])]}),_:1},8,["modelValue","onCancel","onConfirm"])])]}),_:1}),F(s,{label:"内存保护",name:"memoryProtection",lazy:!0},{default:G(function(){return[E("div",null,[E("div",null,[t[28]||(t[28]=D(" 内存保护 ",-1)),F(V,{modelValue:L(Mn),"onUpdate:modelValue":t[11]||(t[11]=function(e){return H(Mn)?Mn.value=e:null}),onChange:L(Nn)},null,8,["modelValue","onChange"])]),F(u,{options:L(Ae).memoryProtection,class:"pl-2rem"},null,8,["options"])])]}),_:1})]}),_:1},8,["modelValue","onChange"])])}}});e("default",C(nt,[["__scopeId","data-v-ed08ed41"]]))}}})}();
