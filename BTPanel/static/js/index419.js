import{c as e,r as a,k as r,p as s,q as l,v as t,e as i,A as o,x as p,M as d,C as n,Q as u,bZ as c,a9 as _,a7 as m}from"./base-lib.js?v=1756369731";import{j as g}from"./utils-lib.js?v=1756369731";import{t as v}from"./useController3.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const f={class:"p-2rem"},h=e({__name:"index",props:{compData:{default:()=>({})}},setup(e,{expose:h}){const b=e,j=a(),x=a(!1),y=a(),C=r({run_script_id:"",script:"",args:""}),k=r({is_args:"",args_holder:"",args_title:""}),V={label:"name",value:"script_id",children:"script_list"},w=r({run_script_id:[{required:!0,message:"请选择脚本",trigger:"change"}],args:[{required:!0,message:"请输入值",trigger:"blur"}]}),q=a(""),A=a([]),D=e=>{let a=y.value.getCheckedNodes()[0].data;C.script=a.script,1===a.is_args?(k.is_args=!0,k.args_holder=a.args_ps,k.args_title=a.args_title):k.is_args=!1};return s(async()=>{try{const e=await v();A.value=Array.isArray(e)?e.filter(e=>"服务管理"==e.name):[]}catch(e){}}),h({onConfirm:async e=>{await j.value.validate(),q.value=""!==q.value?q.value+"\n"+C.script:C.script,-1!==C.script.indexOf("php_version")&&(q.value=q.value.replace("${1/./}",C.args)),b.compData.onConfirm({scriptText:q.value,args:C.args}),e()}}),(e,a)=>{const r=c,s=_,v=g,h=m;return l(),t("div",f,[i(h,{ref_key:"taskEvent",ref:j,disabled:p(x),"label-width":"80px",model:p(C),rules:p(w),onSubmit:a[2]||(a[2]=u(()=>{},["prevent"]))},{default:o(()=>[i(s,{label:"选择脚本",prop:"run_script_id"},{default:o(()=>[i(r,{"show-all-levels":!1,onChange:D,modelValue:p(C).run_script_id,"onUpdate:modelValue":a[0]||(a[0]=e=>p(C).run_script_id=e),ref_key:"scriptCascader",ref:y,props:V,options:p(A),placeholder:"请选择脚本,支持搜索",filterable:""},null,8,["modelValue","options"])]),_:1}),p(k).is_args?(l(),d(s,{key:0,label:p(k).args_title,prop:"args"},{default:o(()=>[i(v,{placeholder:p(k).args_holder,modelValue:p(C).args,"onUpdate:modelValue":a[1]||(a[1]=e=>p(C).args=e),width:"17rem"},null,8,["placeholder","modelValue"])]),_:1},8,["label"])):n("",!0)]),_:1},8,["disabled","model","rules"])])}}});export{h as default};
