import{u as e,K as a,R as s,L as t,l,_ as c,c as n,d as r,e as i}from"./utils-lib.js?v=1756369731";import{c as d,s as o,t as m,r as u,U as p,w as v,q as f,v as b,y as h,x as w,C as x,e as _,M as y,z as g,A as S,B as k,b7 as C,F as T,a_ as j,P as M,D as B,a$ as P,ba as z,bv as H,bw as D}from"./base-lib.js?v=1756369731";import{H as E}from"./index317.js?v=1756369731";import{p as L}from"./firewall.js?v=1756369731";import{B as O}from"./store5.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./validator.js?v=1756369731";import"./index104.js?v=1756369731";import"./column.js?v=1756369731";const V={class:"p-[1rem]"},A={class:"head mb-[2rem]"},I={class:"scan-header flex flex-row flex-wrap items-center justify-between"},Z={class:"flex flex-row flex-wrap justify-center items-center"},q={key:0,class:"relative scan-header-cont"},F={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"},R={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},K=["innerHTML"],N={class:"scan-subtitle text-[1.6rem] mt-[1.2rem]"},U={class:"scan-header-cont justify-end relative"},W={class:"text-[1.5rem]"},X={class:"content"},Y={key:0,class:"info"},$={class:"webedit-con flex items-center justify-center"},G={key:1,class:"scan"},J={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-[#e8e8e8] flex items-center justify-center"},Q={class:"flex flex-column items-center"},ee={key:1,class:"scan-dangerous"},ae={class:"overflow-auto h-[36rem]"},se={class:"flex items-center"},te={class:"w-[26rem] flex items-center justify-start"},le={class:"ml-[1.2rem]"},ce={class:"flex items-center justify-between w-full"},ne={class:"flex items-center ml-[1.2rem]"},re={class:"text-[#999] ml-[1.2rem]"},ie={class:"bg-[#f6f6f6] text-[#999] p-[2rem] ml-[1.2rem]"},de={class:"mt-[1.2rem] ml-[2rem]"},oe={class:"flex items-center"},me=i(d({__name:"web",props:{compData:{default:()=>({isSiteModule:!1})}},setup(i){const d=i,{payment:me}=e(),ue=E(),{repairTypeActive:pe}=o(ue),{authType:ve}=m(me.value),fe=u(!0),be=u(!1),he=u({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),we=u(["1"]),xe=p([]),_e={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},ye=u("success"),ge=u(!1),Se=async()=>{if("ltd"!==ve.value)return ue.openPayView();ye.value="loading",he.value.scanTitle="正在扫描中，请稍后...";try{const{data:e}=await a({request:L(),loading:ge});if(he.value.scanTitle="扫描完成",he.value.scanTime="扫描时间：".concat(s(e.time)),he.value.scanCheckButton="重新检测",fe.value=!1,e.info.length?(be.value=!1,xe.value=e.info,ye.value="danger",he.value.scanCheckButton="重新检测",he.value.scanTitle="全部【".concat(e.site_num,"个】网站存在风险项<span class='text-danger'>").concat(e.loophole_num,"</span>个")):(be.value=!0,he.value.scanTitle="当前网站没有风险项"),e.loophole_num!==ue.tootipTotal.web&&ue.getScanTotal(),!1!==(null==e?void 0:e.status)&&!0===d.compData.isSiteModule){const{useSitePhpStore:a}=await t(()=>import("./useController5.js?v=1756369731").then(e=>e.w),__vite__mapDeps([]),import.meta.url),{scanData:s}=a();Object.assign(s.value,e)}}catch(e){ye.value="success"}};v(pe,e=>{"web"===e&&(async()=>{const{data:e}=await O(),{loophole_num:a,site_num:s,time:t}=e.data;a>0?(he.value.scanTitle="<span class='text-danger'>".concat(a,"</span>个高危网站漏洞待处理！ 总扫描网站数量").concat(s,"个"),he.value.scanTime="上一次扫描时间:".concat(t),ye.value="danger",he.value.scanCheckButton="立即查看"):(he.value.scanTitle="未扫描到网站漏洞，总扫描网站数量".concat(s,"个"),he.value.scanTime="上一次扫描时间:".concat(t),he.value.scanCheckButton="重新检测",ye.value="success")})()});const ke=()=>l({title:"设置自动扫描",area:54,component:()=>t(()=>import("./index495.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),showFooter:!0});return(e,a)=>{const s=c,t=n,l=B,i=P,d=r,o=z,m=H,u=D;return f(),b("div",null,[a[9]||(a[9]=h("div",{class:"text-[1.8rem] mb-6"},"网站漏洞检测",-1)),h("div",V,[h("div",A,[h("div",I,[h("div",Z,["loading"==w(ye)?(f(),b("div",q,[w(ge)?(f(),b("div",F)):x("",!0),_(s,{icon:"scanning-scan",size:60,color:"#20a53a"})])):x("",!0),"success"==w(ye)?(f(),y(s,{key:1,icon:"scanning-success",size:60,color:"#20a53a"})):x("",!0),"danger"==w(ye)?(f(),y(s,{key:2,icon:"scanning-danger",size:60,color:"#ef0808"})):x("",!0),h("div",R,[h("div",{class:"scan-title text-[2rem] font-bold",innerHTML:w(he).scanTitle},null,8,K),h("div",N,g(w(he).scanTime),1)])]),h("div",U,[_(t,{class:"btlink setScanAlarm absolute top-[5rem] right-1rem",onClick:ke},{default:S(()=>[...a[1]||(a[1]=[k(" 自动扫描>> ",-1)])]),_:1}),_(l,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==w(ye)?"default":"primary",size:"large",onClick:Se},{default:S(()=>[h("span",W,g(w(he).scanCheckButton),1)]),_:1},8,["type"])])])]),_(i,{class:"!mt-0"}),h("div",X,[w(fe)?(f(),b("div",Y,[h("div",$,[_(d,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",src:"/preview/site_scanning.png"}),a[2]||(a[2]=C('<div class="thumbnail-introduce mt-[0rem]" data-v-d86d3dc2><span class="text-[1.8rem] font-bold" data-v-d86d3dc2>漏洞扫描工具介绍：</span><ul class="block leading-[2.6rem] mx-[2rem] list-square mt-[2rem]" data-v-d86d3dc2><li data-v-d86d3dc2> 可识别多款开源CMS程序，支持如下： <br data-v-d86d3dc2> 迅睿CMS、pbootcms、苹果CMS、eyoucms、海洋CMS、 <br data-v-d86d3dc2> ThinkCMF、zfaka、dedecms、MetInfo、emlog、 <br data-v-d86d3dc2>帝国CMS、discuz、Thinkphp、Wordpress、Z-Blog、 <br data-v-d86d3dc2>极致CMS、ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-d86d3dc2>phpcms、likeshop、iCMS、WellCMS、chanzhiEPS、 <br data-v-d86d3dc2>PHPOK、LaySNS、骑士CMS、openSNS、齐博CMS、 <br data-v-d86d3dc2>ZZZCMS、prestashop、ThinkphpSHOP、DouPHP、 <br data-v-d86d3dc2>cmseasy、piwigo、phpwind、行云海CMS </li><li data-v-d86d3dc2>可扫描网站中存在的漏洞</li><li data-v-d86d3dc2>提供修复/提供付费解决方案</li></ul></div>',1))])])):(f(),b("div",G,[w(be)?(f(),b("div",J,[h("div",Q,[_(d,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),a[3]||(a[3]=h("span",{class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(f(),b("div",ee,[a[6]||(a[6]=h("div",{class:"flex items-center mb-[2rem] text-[#333]"},[h("span",{class:"w-[26rem]"},"网站"),h("span",null,"类型")],-1)),h("div",ae,[_(u,{modelValue:w(we),"onUpdate:modelValue":a[0]||(a[0]=e=>M(we)?we.value=e:null),accordion:""},{default:S(()=>[(f(!0),b(T,null,j(w(xe),(e,s)=>(f(),y(m,{key:s},{title:S(()=>[h("div",se,[h("div",te,[_(o,{type:e.cms.length>0?"warning":"success",effect:"dark"},{default:S(()=>[k(g(e.cms.length)+"项 ",1)]),_:2},1032,["type"]),h("span",le,g(e.name),1)]),h("span",null,g(e.cms_name+"--"+e.version_info),1),a[4]||(a[4]=h("div",{class:"text-[#666] text-[1.2rem] ml-[6rem]"},"无法自动修复,请在网站后台更新该软件版本。",-1))])]),default:S(()=>[_(u,{accordion:""},{default:S(()=>[(f(!0),b(T,null,j(e.cms,(e,s)=>(f(),y(m,{key:s},{title:S(()=>[h("div",ce,[h("div",ne,[_(o,{type:_e[e.dangerous][0]},{default:S(()=>[k(g(_e[e.dangerous][1]),1)]),_:2},1032,["type"]),h("span",re,g(e.ps),1)]),_(t,{class:"mb-[.2rem] mr-[1.6rem]"},{default:S(()=>[...a[5]||(a[5]=[k("详情",-1)])]),_:1})])]),default:S(()=>[h("div",ie,"修复建议："+g(e.repair),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])]))])),h("div",de,[h("div",oe,[a[8]||(a[8]=k(" 如需支持其他cms程序，请发帖反馈： ",-1)),_(t,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:S(()=>[...a[7]||(a[7]=[k(" https://www.bt.cn/bbs/thread-89149-1-1.html ",-1)])]),_:1})])])])])])}}}),[["__scopeId","data-v-d86d3dc2"]]);export{me as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
