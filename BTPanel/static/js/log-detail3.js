import{c as a,q as e,v as t,e as s,A as l,B as o,z as c,x as i,y as n,bN as r,bM as d,D as m}from"./base-lib.js?v=1756369731";import{R as p,o as f,K as u,c as _,e as b}from"./utils-lib.js?v=1756369731";import{am as w}from"./firewall.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";const D={class:"p-[2rem]"},x={class:"mb-[1.2rem] flex flex-col"},v={class:"detail-content"},j={class:"mb-[1.2rem] flex flex-col"},g={class:"detail-content"},R={class:"mb-[1.2rem] flex flex-col"},U={class:"flex justify-between items-end"},L={class:"detail-content"},y={class:"mb-[1.2rem] flex flex-col"},k={class:"detail-content"},q=b(a({__name:"log-detail",props:{compData:{default:{}}},setup(a){const b=a,q=()=>{b.compData.addIpWhiteEvent(b.compData.row)},I=async()=>{await f({title:"加入URL白名单",content:"加入URL白名单后此URL将不再进行防御，是否继续操作？",icon:"warning-filled"}),await u({loading:"正在加入URL白名单...",request:w({url_rule:b.compData.row.url}),message:!0})};return(a,f)=>{const u=r,b=_,w=d,h=m;return e(),t("div",D,[s(w,{title:"",direction:"vertical",column:4,border:"",class:"mb-[1.2rem] table-descriptions"},{default:l(()=>[s(u,{label:"时间"},{default:l(()=>[o(c(i(p)(a.compData.row.addtime)),1)]),_:1}),s(u,{label:"用户Ip"},{default:l(()=>[s(b,{onClick:q},{default:l(()=>[o(c(a.compData.row.address),1)]),_:1})]),_:1}),s(u,{label:"触发函数"},{default:l(()=>[o(c(a.compData.row.fun_name),1)]),_:1}),s(u,{label:"过滤器"},{default:l(()=>[o(c(a.compData.row.intercept),1)]),_:1})]),_:1}),n("div",x,[f[0]||(f[0]=n("span",{class:"detail-title"},"URL地址",-1)),n("span",v,c(a.compData.row.url),1)]),n("div",j,[f[1]||(f[1]=n("span",{class:"detail-title"},"User-Agent",-1)),n("span",g,c(a.compData.row.data_info.data.request.headers["user-agent"]),1)]),n("div",R,[n("div",U,[f[3]||(f[3]=n("span",{class:"detail-title"},"传入值",-1)),s(h,{type:"text",onClick:I},{default:l(()=>[...f[2]||(f[2]=[o("URL加白",-1)])]),_:1})]),n("span",L,c(a.compData.row.data_info.data.args.join("\n")),1)]),n("div",y,[f[4]||(f[4]=n("span",{class:"detail-title"},"调用栈",-1)),n("span",k,c(a.compData.row.data_info.data.stack_trace.join("\n")),1)])])}}}),[["__scopeId","data-v-2b19d57a"]]);export{q as default};
