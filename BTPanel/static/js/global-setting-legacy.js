!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function u(t,a,l,o){var u=a&&a.prototype instanceof c?a:c,s=Object.create(u.prototype);return r(s,"_invoke",function(t,r,a){var l,o,u,c=0,s=a||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return l=n,o=0,u=e,d.n=t,i}};function p(t,r){for(o=t,u=r,n=0;!f&&c&&!a&&n<s.length;n++){var a,l=s[n],p=d.p,g=l[2];t>3?(a=g===r)&&(u=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=p&&((a=t<2&&p<l[1])?(o=0,d.v=r,d.n=l[1]):p<g&&(a=t<3||l[0]>r||r>g)&&(l[4]=t,l[5]=r,d.n=g,o=0))}if(a||t>1)return i;throw f=!0,r}return function(a,s,g){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,g),o=s,u=g;(n=o<2?e:u)||!f;){l||(o?o<3?(o>1&&(d.n=-1),p(o,u)):d.n=u:d.v=u);try{if(c=2,l){if(o||(a="next"),n=l[a]){if(!(n=n.call(l,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,o<2&&(o=0)}else 1===o&&(n=l.return)&&n.call(l),o<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((n=(f=d.n<0)?u:t.call(r,d))!==i)break}catch(n){l=e,o=1,u=n}finally{c=1}}return{value:n,done:f}}}(t,l,o),!0),s}var i={};function c(){}function s(){}function f(){}n=Object.getPrototypeOf;var d=[][l]?n(n([][l]())):(r(n={},l,function(){return this}),n),p=f.prototype=c.prototype=Object.create(d);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=f,r(p,"constructor",f),r(f,"constructor",s),s.displayName="GeneratorFunction",r(f,o,"GeneratorFunction"),r(p),r(p,o,"Generator"),r(p,l,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:u,m:g}})()}function r(e,n,t,a){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}r=function(e,n,t,a){function o(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?l?l(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},r(e,n,t,a)}function a(e,n,t,r,a,l,o){try{var u=e[l](o),i=u.value}catch(e){return void t(e)}u.done?n(i):Promise.resolve(i).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise(function(r,l){var o=e.apply(n,t);function u(e){a(o,r,l,u,i,"next",e)}function i(e){a(o,r,l,u,i,"throw",e)}u(void 0)})}}System.register(["./base-lib-legacy.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./index-legacy101.js?v=1756369731","./validator-legacy.js?v=1756369731","./useController-legacy6.js?v=1756369731","./site-legacy.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./column-legacy.js?v=1756369731","./useStore-legacy4.js?v=1756369731"],function(n,r){"use strict";var a,o,u,i,c,s,f,d,p,g,m,v,_,h,y,b,x,C,w,P,I,j,F,S,V,k,O,A,T,X,G,R,U,q,E,B,H,W;return{setters:[function(e){a=e.c,o=e.r,u=e.k,i=e.aB,c=e.p,s=e.G,f=e.H,d=e.x,p=e.q,g=e.v,m=e.y,v=e.e,_=e.A,h=e.B,y=e.F,b=e.I,x=e.C,C=e.al,w=e.a9,P=e.D,I=e.a7,j=e.a$,F=e.c2},function(e){S=e.u,V=e.o,k=e.at,O=e.K,A=e.W,T=e.b,X=e.e},function(e){G=e._},function(e){R=e.f},function(e){U=e.o},function(e){q=e.getGloalSetting,E=e.setSitesLogPath,B=e.setSitesLogStatus,H=e.openCdnIp,W=e.getCdnIp},null,null,null,null],execute:function(){var r={class:"flex flex-col site-globa-setting-module"},D={class:"flex items-center"},L={class:"flex items-center"},$={class:"flex items-center"},K={class:"flex items-center"},M={class:"flex items-center"},N={class:"flex items-center"},z=a({__name:"global-setting",setup:function(n){var a=T(),X=S().plugin.value.webserver,z=o(!1),J=o(),Q=u({log_split:!1,log_path:""}),Y=u({page_index:!1,page_404:!1}),Z=u({cdn_ip:"",header:""}),ee="",ne=u({log_path:[{required:!0,message:"请选择日志路径",trigger:"change"}]}),te=o([{label:"名称",prop:"site_name"},{label:"结果",render:function(e){return i("span",{class:e.status?"text-primary":"text-danger"},e.status?"操作成功":"操作失败")}}]),re=[{value:"X-Forwarded-For",label:"X-Forwarded-For"},{value:"X-Real-IP",label:"X-Real-IP"},{value:"X-Forwarded",label:"X-Forwarded"},{value:"Forwarded-For",label:"Forwarded-For"},{value:"Forwarded",label:"Forwarded"},{value:"True-Client-IP",label:"True-Client-IP"},{value:"Client-IP",label:"Client-IP"},{value:"Ali-Cdn-Real-IP",label:"Ali-Cdn-Real-IP"},{value:"Cdn-Src-IP",label:"Cdn-Src-IP"},{value:"Cdn-Real-IP",label:"Cdn-Real-IP"},{value:"Cf-Connecting-IP",label:"Cf-Connecting-IP"},{value:"X-Cluster-Client-IP",label:"X-Cluster-Client-IP"},{value:"Wl-Proxy-Client-IP",label:"Wl-Proxy-Client-IP"},{value:"Proxy-Client-IP",label:"Proxy-Client-IP"}],ae=function(e,n){n(re)},le=function(){var e=l(t().m(function e(){var n,r;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return z.value=!0,e.p=1,e.n=2,q();case 2:n=e.v,r=n.data,Q.log_path=r.log_path,Q.log_split=r.log_split,Y.page_index=r.page_index,Y.page_404=r.page_404,Z.cdn_ip=r.cdn_ip,e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,z.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=l(t().m(function e(){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,J.value.validate();case 1:return e.n=2,V({title:"修改日志路径",content:"是否修改日志预设路径,继续执行?",type:"check",icon:"warning-filled",check:{content:"更改已有网站日志",value:!0,onConfirm:function(){var e=l(t().m(function e(n){var r,l;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,E({mv_log:"1",change_sites:n?"1":"0",log_path:Q.log_path});case 1:r=e.v,n?U({resultColumn:te.value,resultData:r.data,resultTitle:"修改日志路径",title:"修改日志路径结果"}):a.request(r),e.n=3;break;case 2:e.p=2,l=e.v,k(l);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}()}});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ue=function(){R({type:"dir",path:Q.log_path,change:function(e){Q.log_path=e}})},ie=function(){var e=l(t().m(function e(){return t().w(function(e){for(;;)switch(e.n){case 0:O({loading:"正在设置，请稍后...",request:B({log_split:Q.log_split,page_index:Y.page_index,page_404:Y.page_404}),message:!0});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=l(t().m(function e(n){return t().w(function(e){for(;;)switch(e.n){case 0:O({loading:"正在设置，请稍后...",request:H({cdn_ip:n,header_cdn:Z.header}),message:!0,success:le});case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),se=function(){var e=l(t().m(function e(){var n,r;return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,W();case 1:n=e.v,r=n.data,Z.header=r.header_cdn||"X-Forwarded-For";case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),fe=function(){ee=Z.header,Z.header=""},de=function(){""===Z.header&&(Z.header=ee)};return c(function(){le(),se()}),function(n,t){var a=C,l=w,o=G,u=P,i=I,c=j,S=A,V=F,k=s("bt-loading");return f((p(),g("div",r,[m("div",null,[v(i,{ref_key:"globalSettingRef",ref:J,model:d(Q),rules:d(ne)},{default:_(function(){return[v(l,{label:"日志切割"},{default:_(function(){return[m("div",D,[v(a,{onChange:ie,modelValue:d(Q).log_split,"onUpdate:modelValue":t[0]||(t[0]=function(e){return d(Q).log_split=e})},null,8,["modelValue"]),t[7]||(t[7]=m("span",{class:"text-[#999] ml-[4px]"},"*提示：开启该选项将自动创建网站日志切割任务，当存在所有网站日志切割任务时不会新建",-1))])]}),_:1}),v(l,{label:"预设日志路径",prop:"log_path"},{default:_(function(){return[m("div",L,[v(o,{modelValue:d(Q).log_path,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d(Q).log_path=e}),icon:"icon-file_mode",onIconClick:ue},null,8,["modelValue"]),v(u,{type:"primary",class:"!ml-1rem",onClick:oe},{default:_(function(){return e(t[8]||(t[8]=[h("保存",-1)]))}),_:1})])]}),_:1})]}),_:1},8,["model","rules"])]),v(c),v(i,{model:d(Y)},{default:_(function(){return[v(l,{label:"默认页面设置"},{default:_(function(){return[m("div",$,[v(a,{onChange:ie,modelValue:d(Y).page_index,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d(Y).page_index=e})},null,8,["modelValue"]),t[9]||(t[9]=m("span",{class:"ml-[4px] mb-[2px]"},"自动生成index.html(默认首页)",-1))])]}),_:1}),v(l,{label:" "},{default:_(function(){return[m("div",K,[v(a,{onChange:ie,modelValue:d(Y).page_404,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d(Y).page_404=e})},null,8,["modelValue"]),t[10]||(t[10]=m("span",{class:"ml-[4px] mb-[2px]"},"自动生成404.html(默认404页面)",-1))])]}),_:1})]}),_:1},8,["model"]),v(S,{options:[{content:"请注意，仅对后续创建的PHP网站生效。"}],class:"ml-[20px] mt-[20px]"}),"nginx"===d(X)?(p(),g(y,{key:0},[v(c),v(i,{model:d(Z)},{default:_(function(){return[v(l,{label:"cdn来源IP解析"},{default:_(function(){return[m("div",M,[v(a,{onChange:ce,modelValue:d(Z).cdn_ip,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d(Z).cdn_ip=e})},null,8,["modelValue"]),t[11]||(t[11]=m("span",{class:"ml-[4px] mb-[2px]"},[h(" * 请确保使用 "),m("span",{class:"text-danger"},"安全可靠"),h(" 的cdn ")],-1))])]}),_:1}),f(v(l,{label:"来源的请求头"},{default:_(function(){return[m("div",N,[v(V,{modelValue:d(Z).header,"onUpdate:modelValue":t[5]||(t[5]=function(e){return d(Z).header=e}),"fetch-suggestions":ae,placeholder:"请选择或输入来源的请求头",onFocus:fe,onBlur:de},{suffix:_(function(){return e(t[12]||(t[12]=[m("span",{class:"svgtofont-el-arrow-down"},null,-1)]))}),_:1},8,["modelValue"]),v(u,{type:"primary",class:"!ml-1rem",onClick:t[6]||(t[6]=function(e){return ce(d(Z).cdn_ip)})},{default:_(function(){return e(t[13]||(t[13]=[h("保存",-1)]))}),_:1})])]}),_:1},512),[[b,d(Z).cdn_ip]])]}),_:1},8,["model"])],64)):x("",!0)])),[[k,d(z)]])}}});n("default",X(z,[["__scopeId","data-v-26ddcd85"]]))}}})}();
