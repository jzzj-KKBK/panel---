import{N as a,dG as t,K as e,l as o,L as n,o as s,k as r}from"./utils-lib.js?v=1756369731";import{_ as i}from"./index103.js?v=1756369731";import{c as l,r as m,e as p,B as c,p as _,G as d,q as u,v as f,A as b,H as h,x as j,D as k}from"./base-lib.js?v=1756369731";import{ad as w,ae as g,af as y}from"./firewall.js?v=1756369731";import{u as E}from"./column.js?v=1756369731";import{m as C,o as D}from"./useMethod6.js?v=1756369731";import"./__commonjsHelpers__.js?v=1756369731";import"./index104.js?v=1756369731";import"./useStore5.js?v=1756369731";import"./validator.js?v=1756369731";const v=l({__name:"index",setup(l){const v=m(!1),A=m(),x=async()=>{await e({loading:v,request:w(),data:[Array,A]})},L=()=>{o({title:"自定义词库",area:44,component:()=>n(()=>import("./own-thesaurus.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},R=a=>{o({title:"添加监控",area:68,showFooter:!0,compData:{...a,refreshEvent:x},component:()=>n(()=>import("./add-monitor.js?v=1756369731"),__vite__mapDeps([]),import.meta.url)})},T=[{label:"监控名",prop:"name"},{label:"网站/URL",prop:"url"},{label:"监控方式",prop:"method",render:a=>C[a.method]},{label:"上一次检测时间",minWidth:110,render:e=>a(e.last_scan_time)&&!e.last_scan_time.length?"未检测":e.last_scan_time?t(e.last_scan_time):"未检测"},{label:"上一次风险",minWidth:90,render:a=>[a.last_risk_count>0?p("span",{class:"bt-link !text-danger",onClick:()=>D(a)},[a.last_risk_count]):p("span",null,[c("无风险")])]},{label:"计划任务状态",prop:"crontab_status",minWidth:100,render:a=>[1===a.crontab_status?p("span",null,[c("正常")]):p("span",{style:"color:#f0ad4e;cursor:pointer",onClick:()=>(a=>o({isAsync:!0,title:"修复计划任务【".concat(a.name,"】"),area:64,component:()=>n(()=>import("./repair-crontab.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{...a,refreshEvent:x},showFooter:!0}))(a)},[c("未设置")])]},{label:"发送告警",prop:"send_msg",render:a=>p("span",{style:"color:".concat(1===a.send_msg?"#20a53a":"#f0ad4e",";cursor:pointer"),onClick:()=>R(a)},[1===a.send_msg?"已开启":"未开启"])},{label:"检测频率",prop:"crontab_info",render:a=>a.crontab_info?a.crontab_info.cycle:a.crontab_info},E([{onClick:async a=>{var t;const s=await e({request:y({id:a.id})});o({title:"检测详情",area:[64,50],btn:["停止检测"],component:()=>n(()=>import("./scan-details.js?v=1756369731"),__vite__mapDeps([]),import.meta.url),compData:{name:a.name,id:a.id,path_info:null==(t=s.data)?void 0:t.path_info}})},title:"立即检测",width:70},{onClick:R,title:"编辑"},{onClick:async a=>{await s({icon:"warning-filled",title:"删除监控【"+a.name+"】",width:"34rem",content:"删除后无法继续监控该网站，是否继续？"}),await e({loading:"正在删除监控，请稍后...",request:g({id:a.id}),message:!0}),x()},title:"删除"}])];return _(()=>x()),(a,t)=>{const e=k,o=r,n=i,s=d("bt-loading");return u(),f("div",null,[p(n,null,{"header-left":b(()=>[p(e,{type:"primary",onClick:t[0]||(t[0]=a=>R())},{default:b(()=>[...t[1]||(t[1]=[c("添加监控",-1)])]),_:1}),p(e,{onClick:L},{default:b(()=>[...t[2]||(t[2]=[c("自定义词库",-1)])]),_:1})]),content:b(()=>[h(p(o,{ref:"portTable",column:T,data:j(A),description:"监控列表为空"},null,8,["data"]),[[s,j(v)],[s,"正在加载监控列表，请稍后...","title"]])]),popup:b(()=>[...t[3]||(t[3]=[])]),_:1})])}}});export{v as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
