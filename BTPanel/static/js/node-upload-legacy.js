!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function l(n,i,a,o){var l=i&&i.prototype instanceof s?i:s,d=Object.create(l.prototype);return r(d,"_invoke",function(n,i,r){var a,o,l,s=0,d=r||[],c=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,o=0,l=e,p.n=n,u}};function f(n,i){for(o=n,l=i,t=0;!c&&s&&!r&&t<d.length;t++){var r,a=d[t],f=p.p,m=a[2];n>3?(r=m===i)&&(l=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=n<2&&f<a[1])?(o=0,p.v=i,p.n=a[1]):f<m&&(r=n<3||a[0]>i||i>m)&&(a[4]=n,a[5]=i,p.n=m,o=0))}if(r||n>1)return u;throw c=!0,i}return function(r,d,m){if(s>1)throw TypeError("Generator is already running");for(c&&1===d&&f(d,m),o=d,l=m;(t=o<2?e:l)||!c;){a||(o?o<3?(o>1&&(p.n=-1),f(o,l)):p.n=l:p.v=l);try{if(s=2,a){if(o||(r="next"),t=a[r]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=a.return)&&t.call(a),o<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),o=1);a=e}else if((t=(c=p.n<0)?l:n.call(i,p))!==u)break}catch(t){a=e,o=1,l=t}finally{s=1}}return{value:t,done:c}}}(n,a,o),!0),d}var u={};function s(){}function d(){}function c(){}t=Object.getPrototypeOf;var p=[][a]?t(t([][a]())):(r(t={},a,function(){return this}),t),f=c.prototype=s.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,r(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return d.prototype=c,r(f,"constructor",c),r(c,"constructor",d),d.displayName="GeneratorFunction",r(c,o,"GeneratorFunction"),r(f),r(f,o,"Generator"),r(f,a,function(){return this}),r(f,"toString",function(){return"[object Generator]"}),(i=function(){return{w:l,m:m}})()}function r(e,t,n,i){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,t,n,i){function o(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},r(e,t,n,i)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n,i,r,a,o){try{var l=e[a](o),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(i,r)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var a=e.apply(t,n);function o(e){l(a,i,r,o,u,"next",e)}function u(e){l(a,i,r,o,u,"throw",e)}o(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,c(i.key),i)}}function d(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,n||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./vue-virtual-scroller.esm-legacy.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731"],function(e,n){"use strict";var r,a,l,c,p,f,m,v,h,g,y,S,b,T,w,z,F,L,I,k,x,_,E,j,O,P,U,N,C,D,G,R,A,M,B,q,H,K,X,J,Q;return{setters:[function(e){r=e.v,a=e.k,l=e.e,c=e.bU,p=e.Y,f=e.a4,m=e.j0,v=e.l,h=e.b,g=e.ai,y=e.o,S=e.c},function(e){b=e.c,T=e.r,w=e.q,z=e.v,F=e.y,L=e.e,I=e.x,k=e.J,x=e.n,_=e.k,E=e.g,j=e.p,O=e.aD,P=e.H,U=e.I,N=e.F,C=e.A,D=e.B,G=e.C,R=e.z,A=e.K,M=e.M,B=e.ap,q=e.ao,H=e.an,K=e.D,X=e.aQ},function(e){J=e._},function(e){Q=e.s},null],execute:function(){var n={class:""},Y=l(b({__name:"file-cover-confirm",props:{compData:{default:function(){}}},setup:function(e,t){var i=t.expose,o=e,l=T([{label:"文件名",prop:"name"},{label:"文件差异(本地->线上)",render:function(e){return"".concat(r(e.locaSize)," -> ").concat(r(e.size))}}]);return i({onConfirm:function(e){return o.compData.confirm(e,!0),!1},onCancel:function(e){return o.compData.cancel(e,!1),!1}}),function(e,t){var i=a;return w(),z("div",{class:k(["confirm-default","text-dark relative p-2rem"])},[t[0]||(t[0]=F("div",{class:"content flex items-center mb-[10px]"},[F("i",{class:"svgtofont-el-warning text-[4rem] text-[#f0ad4e]"}),F("div",{class:"message flex flex-col flex-1 ml-4 py-[.3rem] leading-[2.4rem] text-[1.3rem]"},[F("div",{class:"text text-[1.4rem] text-[#666] leading-[2.5rem]"},"检测到上传目录包含重复文件，是否覆盖？")])],-1)),F("div",n,[L(i,{column:I(l),data:o.compData.data,"max-height":170},null,8,["column","data"])])])}}}),[["__scopeId","data-v-7012342e"]]),$=h(),V=function(){return e=function t(n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,"target",""),d(this,"uploadPath",""),d(this,"uploadElement",null),d(this,"loading",{close:function(){}}),d(this,"isUpload",!0),d(this,"isGetFiles",!1),d(this,"readFileTimeout",0),d(this,"limit",{size:32212254720,number:1e3}),d(this,"uploadStatus","paused"),d(this,"uploadLimitSize",2097152),d(this,"uploadList",[]),d(this,"uploadTime",{endTime:0,startTime:0}),d(this,"uploadInfo",{estimatedTime:0,uploadedSize:0,speedInterval:null,speedAverage:0,uploadTime:0,fileSize:0,startTime:0,endTime:0,success:0,error:0}),d(this,"fileList",[]),d(this,"fileTotalSize",0),d(this,"fileTotalNumber",0),d(this,"uploadInterval",0),d(this,"uploadCycleSize",[]),d(this,"speedLastTime",0),d(this,"timerSpeed",0),d(this,"uploadError",0),d(this,"nodeId",0),d(this,"isOpenCoverLayer",0),d(this,"uploadedFiles",[]),d(this,"initData",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a.uploadStatus="paused",a.uploadList=[],a.isUpload=!0,a.uploadTime={endTime:0,startTime:0},a.isGetFiles=!1,a.uploadInfo={estimatedTime:0,uploadedSize:0,speedInterval:null,speedAverage:0,uploadTime:0,fileSize:0,startTime:0,endTime:0,success:0,error:0},a.fileList=[],a.fileTotalSize=0,a.fileTotalNumber=0,a.uploadInterval=0,a.uploadCycleSize=[],a.speedLastTime=0,a.timerSpeed=0,e&&a.watchFileUploadStatus({status:"paused",timeElapsed:0,averageSpeed:0,uploadSize:"0B",successNumber:0,errorNumber:0})}),d(this,"watchFileList",function(e){return e}),d(this,"watchFileUploadSpeed",function(e){return e}),d(this,"watchFileUploadStatus",function(e){return e}),d(this,"fileUploadLimit",function(e,t){var n=t;if(!a.isGetFiles)return!1;var i=e.name.split("."),o=(t=t||e.webkitRelativePath).split("/");t=("/"+o.slice(0,o.length-1).join("/")).replace("//","/");var l=!1;return a.fileList.forEach(function(t,i){if(t.path+t.name==n&&t.size==r(e.size))return $.error("该文件已存在"),l=!0}),!(!l&&(a.fileList=a.fileList.filter(function(e,t){return e.path+e.name!==n}),a.fileList.push({vid:c(8),file:e,path:t,name:e.name,size:r(e.size),type:i.length>1?i[i.length-1]:"txt",status:"paused",progress:0}),a.watchFileList(a.fileList),a.fileTotalSize+=e.size,a.fileTotalNumber++,a.fileTotalNumber>=a.limit.number?($.error("当前文件数量已超过文件上传上限".concat(a.limit.number,"个， 请压缩文件夹后重试！")),1):a.fileTotalSize>=a.limit.size&&($.error("当前文件大小已超过文件上传".concat(r(a.limit.size),"限制， 请使用SFTP/FTP等工具上传文件！")),1)))}),d(this,"uploadFile",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 0!==a.fileList.length&&(0==e&&0==a.uploadList.length&&(a.isOpenCoverLayer=0,a.uploadStatus="uploading",a.uploadedFiles=[],a.uploadCycleSize=[],a.uploadTime.startTime=a.getTimeReal()),a.fileList.length===t?(clearTimeout(a.uploadInterval),a.uploadStatus="success",a.uploadTime.endTime=a.getTimeReal(),a.renderUploadSpeed(),a.initData(),!1):void a.uploadFileItem(e,t))}),d(this,"uploadFileItem",function(){var e=u(i().m(function e(t,n){var r,l,u,s,d,c,m,v,h,g,y,S,b,T;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=a.fileList[n],l=0,null!=r){e.n=1;break}return e.a(2,!1);case 1:return u=a.uploadInfo.uploadedSize,a.uploadInterval=setInterval(function(){4===a.uploadCycleSize.length&&a.uploadCycleSize.splice(0,1),a.uploadCycleSize.push(Math.abs(a.uploadInfo.uploadedSize-u))},1e3),a.uploadInfo.endTime=a.getTimeReal(),s=(a.uploadInfo.endTime-a.uploadInfo.startTime)/1e3,a.timerSpeed=Number((a.uploadInfo.fileSize/s).toFixed(2)),a.uploadInfo.startTime=a.getTimeReal(),d=a.getUpdateSpeed(),c=a.uploadLimitSize,(m=Math.floor(d/a.uploadLimitSize))&&n>1&&(c*=m>4?4:m),0==t&&(a.uploadInfo.startTime=a.getTimeReal(),r=o(o({},r),{progress:0,upload:2,upload_size:"0B"})),l=Math.min(r.file.size,t+c),a.uploadInfo.fileSize=l-t,v=a.uploadPath+r.path,h=new FormData,g=p(),y=g.request_time,S=g.request_token,h.append("f_path",v),h.append("f_name",r.name),h.append("f_size",r.file.size),h.append("f_start",t.toString()),h.append("blob",r.file.slice(t,l)),h.append("node_id",a.nodeId.toString()),h.append("request_time","".concat(y)),h.append("request_token",S),e.p=2,e.n=3,f({method:"post",url:""+a.target,headers:{"x-http-token":window.vite_public_request_token},data:h});case 3:return b=e.v,T=b.data,e.n=4,a.watchUploadStatus(T,r,n,{fileStart:t,fileEnd:l});case 4:e.n=6;break;case 5:e.p=5,e.v;case 6:return e.a(2)}},e,null,[[2,5]])}));return function(t,n){return e.apply(this,arguments)}}()),d(this,"fileSelectHandler",function(e,t){var n;if(a.readFileTimeout=0,a.isGetFiles=!0,a.loading=$.load("正在获取上传文件，请稍候..."),null!==(n=e.target)&&void 0!==n&&n.files){var i,r=null===(i=e.target)||void 0===i?void 0:i.files;[].forEach.call(r,function(e){a.traverseFileTree(e,t)})}else if(e.dataTransfer.items){var o=e.dataTransfer.items;[].forEach.call(o,function(e){var n=(e.webkitGetAsEntry||e.getAsEntry).call(e);if(n){if(!a.isUpload)return!1;a.traverseFileTree(n,t)}})}}),d(this,"traverseFileTree",function(e,t){var n=e.fullPath||"";if(e.isFile)e.file(function(e){a.isGetFiles=a.fileUploadLimit(e,n),clearTimeout(a.readFileTimeout),a.readFileTimeout=setTimeout(function(){if(a.loading.close(),!a.isGetFiles)return a.clearUploadFileList(),a.watchFileList(a.fileList),!1;t&&t(a.fileList)},100)});else if(e.isDirectory){var i=e.createReader(),r=function(e){[].forEach.call(e,function(e){if(!a.isUpload)return!1;a.traverseFileTree(e,t)}),e.length>0&&i.readEntries(r)};i.readEntries(r),setTimeout(function(){if(0===a.fileList.length&&a.isGetFiles)return $.error("拖拽上传文件夹内容为空")},500)}}),d(this,"watchUploadStatus",function(e,t,n,i){"number"==typeof e?(a.renderUploadSpeed(n,o(o({},t),{progress:(e/t.file.size*100).toFixed(2),upload:2,upload_size:r(e)})),i.fileEnd!=e?a.uploadInfo.uploadedSize+=e:a.uploadInfo.uploadedSize+=parseInt((i.fileEnd-i.fileStart).toString()),setTimeout(function(){a.uploadFile(e,n)},50)):(e.status?(a.uploadInfo.success++,a.uploadInfo.endTime=a.getTimeReal(),a.uploadInfo.uploadedSize+=parseInt((i.fileEnd-i.fileStart).toString()),a.renderUploadSpeed(n,o(o({},t),{upload:1,upload_size:t.size}))):(a.renderUploadSpeed(n,o(o({},t),{progress:100,upload:-1,errorMsg:e.msg})),a.uploadInfo.error++),a.uploadFile(0,++n))}),d(this,"getUpdateSpeed",function(){for(var e=0,t=0;t<a.uploadCycleSize.length;t++)e+=a.uploadCycleSize[t];var n=e/a.uploadCycleSize.length;return isNaN(n)?0:n}),d(this,"renderUploadSpeed",function(t,n){if(void 0!==t)try{var i=a.fileList[t];if(1===n.upload||-1===n.upload){i.is_upload=!0,a.uploadList.push(i);var o=document.querySelector(".file-upload-list");o&&(1===a.uploadList.length&&(o.scrollTop=0),a.uploadList.length>1&&(o.scrollTop+=45.5))}i.progress=n.progress,i.status=a.isUploadStatus(n.upload),i.message=n.errorMsg||"",a.watchFileList(a.fileList),a.watchFileUploadSpeed({totalProgress:(a.uploadInfo.uploadedSize/a.fileTotalSize*100).toFixed(2),currentSpeed:r(isNaN(a.timerSpeed)?0:a.timerSpeed),timeRemaining:a.time(parseInt(((a.fileTotalSize-a.uploadInfo.uploadedSize)/a.timerSpeed*1e3).toString())),uploadList:a.uploadList.length})}catch(e){}else{var l=a.getTimeReal();a.watchFileUploadStatus({status:"success",timeElapsed:a.diffTime(a.uploadTime.startTime,l),averageSpeed:a.toSize(a.uploadInfo.uploadedSize/((l-a.uploadTime.startTime)/1e3)),uploadSize:r(a.uploadInfo.uploadedSize),successNumber:a.uploadInfo.success,errorNumber:a.uploadInfo.error})}}),d(this,"getFileName",function(e){return(e.path+"/"+e.name).replace(/\/\//,"/")}),d(this,"useFileUploadExistsConfirm",u(i().m(function e(){var t,n,r,o,l;return i().w(function(e){for(;;)switch(e.n){case 0:return t=a.fileList.map(function(e){return a.uploadPath+a.getFileName(e)}),e.n=1,m({files:t.join("\n"),node_id:a.nodeId.toString()});case 1:if(n=e.v,r=n.data){e.n=2;break}return e.a(2);case 2:if(o=[],a.fileList.forEach(function(e,t){var n=r[t];n.exists&&o.push({name:a.getFileName(e),size:n.size,locaSize:e.file.size})}),!o.length){e.n=4;break}return l=function(e,t){if(!t)for(var n=function(){var e=a.fileList[i];o.findIndex(function(t){return t.name.indexOf(e.name)>-1})>=0&&a.fileList.splice(i,1)},i=a.fileList.length-1;i>=0;i--)n();x(function(){e(),a.fileList.length?a.uploadFile():a.clearUploadFileList()})},e.n=3,v({title:"文件冲突确认",area:40,component:Y,compData:{data:o,confirm:l,cancel:l},showFooter:!0,cancelText:"跳过",confirmText:"覆盖"});case 3:e.n=5;break;case 4:a.fileList.length&&a.uploadFile();case 5:return e.a(2)}},e)}))),d(this,"cancelFile",function(e){var t=a.fileList.filter(function(t,n){return t.vid!==e.vid});a.fileList=t,a.watchFileList(a.fileList),0===a.fileList.length&&a.clearUploadFileList()}),d(this,"toSize",function(e){for(var t=[" B"," KB"," MB"," GB"," TB"," PB"],n=0;n<t.length;n+=1){if(e<1024){var i=e.toFixed(2)+t[n];return isNaN(e.toFixed(2))||void 0===i?"0B":i}e/=1024}}),d(this,"time",function(e){var t=Math.floor(e/36e5),n=Math.floor(e/6e4),i=e%6e4/1e3,r=i+"秒";return n>0&&(r="".concat(n,"分钟").concat(i.toFixed(0),"秒")),t>0&&(r="".concat(t,"小时").concat(Math.floor((e-36e5*t)/6e4),"分钟")),r}),this.target=n.target,this.uploadPath=n.uploadPath,this.nodeId=n.nodeId,this.watchFileList=n.renewalData,this.watchFileUploadSpeed=n.renewalSpeed,this.watchFileUploadStatus=n.renewalStatus,this.initData()},(t=[{key:"uploadStatusInfo",value:function(e){return{success:"上传成功",error:"上传失败",uploading:"上传中",paused:"等待上传",waiting:"等待上传"}[e]}},{key:"isUploadStatus",value:function(e){return{"-1":"error",0:"paused",1:"success",2:"uploading",3:"waiting"}[e]}},{key:"getTimeReal",value:function(){return(new Date).getTime()}},{key:"clearUploadFileList",value:function(){this.initData(!0),this.watchFileList(this.fileList)}},{key:"diffTime",value:function(e,t){"number"!=typeof e&&(e=e.getTime()),"number"!=typeof t&&(t=t.getTime());var n=t-e,i=Math.floor(n/6e4),r=n%6e4/1e3,a=r.toFixed(i>0?0:2)+"秒";return i>0&&(a=i+"分"+r.toFixed(0)+"秒"),a}}])&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}(),W=function(e){e.preventDefault()},Z={id:"upload-mask"},ee={class:"p-[20px]"},te=["webkitdirectory"],ne={class:"mb-[16px] flex justify-between"},ie={key:1,class:"upload-press"},re={key:2,class:"upload-press"},ae={key:3,class:"upload-files-tips"},oe={key:4,class:"uploader-list"},le={class:"th"},ue={class:"td justify-end"},se={class:"uploader-file tr"},de={class:"td-block"},ce={class:"td !w-[55%] flex"},pe=["title"],fe={class:"td"},me={class:"td"},ve={class:"truncate"},he={key:0},ge={class:"td justify-end"},ye={class:"flex justify-end"},Se=b({__name:"node-upload",props:{compData:{default:function(){return{path:"",nodeId:0,refresh:function(){}}}}},setup:function(e,n){var r=n.expose,a=e,l=h(),s=null,d=T(),c=T(!1),p=T("paused"),f=T([]),m=T(),v=T(!1),b=_({totalProgress:0,uploadList:0,sizeUploaded:0,currentSpeed:0,timeRemaining:0,timeElapsed:0,averageSpeed:0,errorNumber:0,successNumber:0,uploadSize:""}),x=new V({target:"/mod/node/file_transfer/file_upload",uploadPath:a.compData.path,nodeId:a.compData.nodeId,renewalData:function(e){f.value=t(e)},renewalSpeed:function(e){b.totalProgress=e.totalProgress,b.uploadList=e.uploadList,b.sizeUploaded=e.sizeUploaded,b.currentSpeed=e.currentSpeed,b.timeRemaining=e.timeRemaining},renewalStatus:function(e){p.value=e.status,b.timeElapsed=e.timeElapsed,b.averageSpeed=e.averageSpeed,b.uploadSize=e.uploadSize,b.successNumber=e.successNumber,b.errorNumber=e.errorNumber}}),Y=x.uploadStatusInfo,$=x.initData,Se=x.fileUploadLimit,be=x.cancelFile,Te=E(function(){return!f.value.length}),we=E(function(){return!f.value.length}),ze=function(e){return(e.path+"/"+e.name).replace(/\/\//,"/")},Fe=function(e){if(e.isFolder)return"folder";var t=e.name.split(".").pop();return["zip","rar","gz","tar","war","tgz","bz2","7z","tar.gz"].includes(t)?"compress":t},Le=function(e){x.isGetFiles=!0,"file"!==e&&g(e)?v.value=!0:v.value=!1,setTimeout(function(){m.value.click()},0)},Ie=function(e){for(var t=e.target.files,n=0;n<t.length;n++){var i="/".concat(""==t[n].webkitRelativePath?t[n].name:t[n].webkitRelativePath);if(!Se(t[n],i))return!1}if(!x.isGetFiles)return!1},ke=function(e){return"success"===e.status?{transform:"translateX(-0%)"}:{transform:"translateX(-".concat(100-e.progress,"%)")}},xe=function(){if(0===f.value.length)return l.error("请添加需要上传的文件");p.value="uploading",x.useFileUploadExistsConfirm()},_e=function(){$(),f.value=[],p.value="paused"},Ee=function(){c.value=!0,"success"===p.value&&_e()},je=function(){c.value=!1},Oe=function(e){c.value=!1,x.fileSelectHandler(e,function(e){f.value=e||[]})},Pe=function(){var e=u(i().m(function e(){return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!["uploading","paused"].includes(p.value)||!f.value.length){e.n=2;break}return e.n=1,y({title:"取消上传",width:"35rem",icon:"warning-filled",content:"是否取消上传，取消后将清空上传列表？"});case 1:return a.compData.refresh(),e.a(2,!0);case 2:e.n=4;break;case 3:return e.p=3,e.v,e.a(2,!1);case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}();return j(function(){var e,t;s=o({},(e={dragenter:Ee,dragleave:je,drop:Oe,dragover:function(){}},t=document.querySelector("#upload-mask"),window.addEventListener("dragenter",function(t){W(t),e.dragenter(t)}),null==t||t.addEventListener("dragenter",function(t){W(t),e.dragenter(t)}),null==t||t.addEventListener("dragleave",function(t){W(t),e.dragleave(t)}),null==t||t.addEventListener("dragover",function(t){W(t),e.dragover(t)}),null==t||t.addEventListener("drop",function(t){W(t),e.drop(t)}),e))}),O(function(){var e,t;e=s,t=document.querySelector("#upload-mask"),window.removeEventListener("dragenter",e.dragenter),null==t||t.removeEventListener("dragenter",e.dragenter),null==t||t.removeEventListener("dragover",e.dragover),null==t||t.removeEventListener("dragleave",e.dragleave),null==t||t.removeEventListener("drop",e.drop)}),r({onCancel:Pe}),function(e,n){var i=B,r=q,a=H,o=K,l=J,u=X,s=S;return w(),z("div",{class:"upload-file-view",ref_key:"upload",ref:d},[P(F("div",Z,"请将需要上传的文件/文件夹拖到此处",512),[[U,I(c)]]),F("div",ee,[I(p).indexOf("paused")>-1?(w(),z(N,{key:0},[F("input",{type:"file",ref_key:"uploadFileInput",ref:m,webkitdirectory:I(v),onChange:Ie,style:{display:"none"},multiple:""},null,40,te),F("div",ne,[L(a,{"split-button":"",type:"default","show-timeout":50,"hide-timeout":50,onClick:Le,onCommand:Le},{dropdown:C(function(){return[L(r,{class:"w-[10rem]"},{default:C(function(){return[L(i,{command:"file"},{default:C(function(){return t(n[0]||(n[0]=[D("上传文件",-1)]))}),_:1}),L(i,{command:"dir"},{default:C(function(){return t(n[1]||(n[1]=[D("上传文件夹",-1)]))}),_:1})]}),_:1})]}),default:C(function(){return[n[2]||(n[2]=D(" 上传文件 ",-1))]}),_:1}),L(o,{onClick:_e,disabled:I(Te)},{default:C(function(){return t(n[3]||(n[3]=[D("清空列表",-1)]))}),_:1},8,["disabled"])])],64)):G("",!0),I(p).indexOf("uploading")>-1?(w(),z("div",ie,[F("span",null,"总进度："+R(I(b).totalProgress)+"%",1),L(l),F("span",null,"正在上传：("+R("".concat(I(b).uploadList,"/").concat(I(f).length))+")",1),L(l),F("span",null,"上传速度："+R(I(b).currentSpeed)+"/s",1),L(l),F("span",null,"预计耗时："+R(I(b).timeRemaining),1)])):G("",!0),I(p).indexOf("success")>-1?(w(),z("div",re,[F("span",null,"上传大小："+R(I(b).uploadSize),1),L(l),F("span",null,"共耗时："+R(I(b).timeElapsed),1),L(l),F("span",null,"平均上传速度："+R(I(b).averageSpeed)+"/s",1),L(l),F("span",null,"上传成功："+R(I(b).successNumber)+"个",1),P(L(l,null,null,512),[[U,I(b).errorNumber>0]]),P(F("span",null,"上传失败："+R(I(b).errorNumber)+"个",513),[[U,I(b).errorNumber>0]])])):G("",!0),I(we)?(w(),z("div",ae,t(n[4]||(n[4]=[F("span",null,"请将需要上传的文件/文件夹拖到此处",-1)])))):(w(),z("div",oe,[F("div",le,[n[5]||(n[5]=F("div",{class:"td !w-[55%]"},"文件名",-1)),n[6]||(n[6]=F("div",{class:"td"},"文件大小",-1)),n[7]||(n[7]=F("div",{class:"td"},"上传状态",-1)),P(F("div",ue,"操作",512),[[U,"success"!==I(p)]])]),F("div",null,[L(I(Q),{class:k(["!mb-0 overflow-auto file-upload-list files-list","!h-[400px]"]),items:I(f),"item-size":45,buffer:800,"key-field":"vid"},{default:C(function(e){var i=e.item;return[F("div",se,[F("div",{class:k({"td-progress":!0,error:"error"===i.status,success:"success"===i.status}),style:A(ke(i))},null,6),F("div",de,[F("div",ce,[F("i",{class:k(["icon-bg","".concat(Fe(i),"-icon")])},null,2),F("span",{class:"flex-1 w-0 ml-[4px] truncate h-[20px] leading-[20px]",title:ze(i)},R(ze(i)),9,pe)]),F("div",fe,R(i.size),1),F("div",me,[P(L(u,{effect:"dark",content:"".concat(I(Y)(i.status)).concat(i.message?"，".concat(i.message):""),placement:"right","show-after":200},{default:C(function(){return[P(F("span",ve,[D(R(I(Y)(i.status))+" ",1),i.message?(w(),z("span",he," ,"+R(i.message),1)):G("",!0)],512),[[U,"uploading"!==i.status]])]}),_:2},1032,["content"]),[[U,"uploading"!==i.status]]),P(F("span",null,[F("span",null,"上传中("+R(parseInt(i.progress))+"%)",1)],512),[[U,"uploading"===i.status]])]),P(F("div",ge,[P(L(s,{onClick:function(e){return I(be)(i)}},{default:C(function(){return t(n[8]||(n[8]=[D("取消",-1)]))}),_:2},1032,["onClick"]),[[U,I(p).indexOf("paused")>-1]])],512),[[U,"success"!==I(p)]])])])]}),_:1},8,["items"])])])),F("div",ye,[I(p).indexOf("paused")>-1?(w(),M(o,{key:0,type:"primary",onClick:xe},{default:C(function(){return t(n[9]||(n[9]=[D(" 开始上传 ",-1)]))}),_:1})):G("",!0),["success","error"].includes(I(p))?(w(),M(o,{key:1,type:"primary",onClick:_e},{default:C(function(){return t(n[10]||(n[10]=[D(" 继续上传 ",-1)]))}),_:1})):G("",!0)])])],512)}}});e("default",l(Se,[["__scopeId","data-v-0ca2a2b8"]]))}}})}();
