!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function u(n,a,l,o){var u=a&&a.prototype instanceof c?a:c,s=Object.create(u.prototype);return r(s,"_invoke",function(n,r,a){var l,o,u,c=0,s=a||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return l=t,o=0,u=e,f.n=n,i}};function d(n,r){for(o=n,u=r,t=0;!p&&c&&!a&&t<s.length;t++){var a,l=s[t],d=f.p,m=l[2];n>3?(a=m===r)&&(u=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=d&&((a=n<2&&d<l[1])?(o=0,f.v=r,f.n=l[1]):d<m&&(a=n<3||l[0]>r||r>m)&&(l[4]=n,l[5]=r,f.n=m,o=0))}if(a||n>1)return i;throw p=!0,r}return function(a,s,m){if(c>1)throw TypeError("Generator is already running");for(p&&1===s&&d(s,m),o=s,u=m;(t=o<2?e:u)||!p;){l||(o?o<3?(o>1&&(f.n=-1),d(o,u)):f.n=u:f.v=u);try{if(c=2,l){if(o||(a="next"),t=l[a]){if(!(t=t.call(l,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((t=(p=f.n<0)?u:n.call(r,f))!==i)break}catch(t){l=e,o=1,u=t}finally{c=1}}return{value:t,done:p}}}(n,l,o),!0),s}var i={};function c(){}function s(){}function p(){}t=Object.getPrototypeOf;var f=[][l]?t(t([][l]())):(r(t={},l,function(){return this}),t),d=p.prototype=c.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,r(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=p,r(d,"constructor",p),r(p,"constructor",s),s.displayName="GeneratorFunction",r(p,o,"GeneratorFunction"),r(d),r(d,o,"Generator"),r(d,l,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(n=function(){return{w:u,m:m}})()}function r(e,t,n,a){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}r=function(e,t,n,a){function o(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?l?l(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},r(e,t,n,a)}function a(e,t,n,r,a,l,o){try{var u=e[l](o),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,l){var o=e.apply(t,n);function u(e){a(o,r,l,u,i,"next",e)}function i(e){a(o,r,l,u,i,"throw",e)}u(void 0)})}}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./index-legacy116.js?v=1756369731","./index-legacy101.js?v=1756369731","./index-legacy130.js?v=1756369731","./validator-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1756369731","./form-item-legacy.js?v=1756369731","./index.vue_vue_type_script_setup_true_lang-legacy25.js?v=1756369731","./index-legacy103.js?v=1756369731","./column-legacy.js?v=1756369731","./index-legacy456.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./index.vue_vue_type_style_index_0_scoped_b3c4124c_lang-legacy.js?v=1756369731","./index-legacy112.js?v=1756369731","./index-legacy123.js?v=1756369731"],function(t,r){"use strict";var a,o,u,i,c,s,p,f,d,m,v,_,h,g,y,b,w,x,V,k,j,C,P,S,O,T,N,U,q,H,z,A,I,E,G,R,F,D,M,B,L,W,J,$,K,Q,X,Y,Z,ee,te,ne,re,ae,le,oe,ue,ie,ce,se,pe,fe,de,me,ve,_e,he,ge,ye,be,we,xe,Ve,ke,je,Ce,Pe,Se,Oe,Te,Ne,Ue,qe,He,ze,Ae,Ie,Ee;return{setters:[function(e){a=e.at,o=e.K,u=e.o,i=e.j,c=e.c,s=e.h,p=e.b,f=e.W,d=e.G,m=e.aM,v=e.l,_=e.L,h=e.k,g=e.a0,y=e.a2,b=e.e},function(e){w=e.c,x=e.r,V=e.k,k=e.w,j=e.p,C=e.aD,P=e.q,S=e.v,O=e.x,T=e.M,N=e.A,U=e.B,q=e.C,H=e.y,z=e.e,A=e.F,I=e.a_,E=e.z,G=e.P,R=e.ai,F=e.aj,D=e.D,M=e.a9,B=e.a$,L=e.a7,W=e.G,J=e.H,$=e.T,K=e.a4,Q=e.I,X=e.al,Y=e.s,Z=e.j,ee=e.g,te=e.ax,ne=e.S,re=e.bq,ae=e.U},function(e){le=e.u},function(e){oe=e._},function(e){ue=e._},function(e){ie=e._},function(e){ce=e.f,se=e.k},function(e){pe=e.getComposerVersion,fe=e.updateComposer,de=e.deleteComposerFile,me=e.execComposer,ve=e.getComposerLine,_e=e.setTomcatSettings,he=e.getSitePhpVersion,ge=e.setPhpSiteGzip,ye=e.removePhpSiteGzip,be=e.getPhpSiteGzip,we=e.setSecurityHeaders,xe=e.getSecurityHeaders,Ve=e.getCrossOriginAccess,ke=e.setCrossOriginAccess,je=e.deleteCrossOriginAccess,Ce=e.getCrontabList,Pe=e.modifyCrontabStatus,Se=e.startTaskCrontab,Oe=e.removeCrontab},function(e){Te=e._},function(e){Ne=e.h},function(e){Ue=e._},function(e){qe=e._},function(e){He=e.a,ze=e.b,Ae=e.u,Ie=e.c},function(e){Ee=e.default},null,null,null,null,null],execute:function(){var Ge={class:"p-1rem"},Re={class:"flex items-center"},Fe={key:0,class:"text-danger"},De={key:1,class:"text-danger text-[1.2rem]"},Me={class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},Be={key:0},Le={class:"p-2rem h-50rem flex flex-col"},We={class:"mb-1rem"},Je={class:"flex-1 overflow-auto"},$e=w({__name:"index",setup:function(t,r){var f,d=r.expose,m=le().siteInfo,v=null===(f=m.value)||void 0===f?void 0:f.project_type,_=p(),h=x(!1),g=x(!1),y=V({path:m.value.path,user:"phpasync"!==v?"www":"root",php:["静态","其它"].includes(m.value.php_version)?"auto":"PHP-"+m.value.php_version.replace(".",""),otherCommand:"",mirror:"https://mirrors.aliyun.com/composer/",command:"install",composerVersion:"install",version:"2.7.3",help_tips:"",comp_json:"",comp_lock:"",phpVersion:[],commandOptions:[{label:"install",value:"install"},{label:"update",value:"update"},{label:"require",value:"require"},{label:"create-project",value:"create-project"},{label:"自定义",value:""}]}),b=x("正在执行..."),w=x(!1),W=x(),J=x(!1);k(function(){return m.value},function(e){y.php=["静态","其它"].includes(e.php_version)?"auto":"PHP-"+e.php_version.replace(".","")},{immediate:!0});var $=function(){var e=l(n().m(function e(t){var r,l;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return h.value=!0,e.p=1,e.n=2,pe({path:t||m.value.path});case 2:(r=e.v).data.status?(g.value=!1,y.phpVersion=r.data.php_versions.filter(function(e){return"00"!==e.version}),y.phpVersion.unshift({name:"自动选择",version:"auto"}),y.comp_json=!1,y.comp_lock=!1,"string"==typeof r.data.comp_json&&(y.comp_json=r.data.comp_json),"string"==typeof r.data.comp_lock&&(y.comp_lock=r.data.comp_lock)):(g.value=!0,_.request(r)),e.n=4;break;case 3:e.p=3,l=e.v,a(l);case 4:return e.p=4,h.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),K=function(){ce({type:"dir",path:y.path,change:function(e){y.path=e,$(y.path)}})},Q=function(){o({loading:"正在更新，请稍后...",request:fe(),message:!0,success:function(e){e.status&&$(y.path)}})},X=function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:o({loading:"正在删除，请稍后...",request:de({path:y.path+"/composer.lock"}),message:!0,success:function(e){e.status&&$(y.path)}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:W.value=setInterval(l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:try{ee()}catch(t){clearInterval(W.value)}case 1:return e.a(2)}},e)})),2e3);case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=l(n().m(function e(){var t,r;return n().w(function(e){for(;;)switch(e.n){case 0:return r={php_version:null===(t=y.php)||void 0===t?void 0:t.replace("PHP-",""),composer_args:y.command,composer_cmd:y.otherCommand,repo:y.mirror,path:y.path,user:y.user,composer_version:y.version,siteName:m.value.name},e.n=1,u({title:"执行composer命令",content:"即将执行设定的composer命令，继续吗？",icon:"warning-filled"});case 1:o({loading:"正在执行，请稍后...",request:me(r),message:!0,success:function(e){e.status&&(w.value=!0,Y())}});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=l(n().m(function e(){var t,r,l,o=arguments;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],e.p=1,e.n=2,ve({filename:"/tmp/composer_".concat(m.value.name,".log"),num:100});case 2:r=e.v,b.value=r.data.msg,t&&_.success("刷新成功"),e.n=4;break;case 3:e.p=3,l=e.v,a(l);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),te=function(){J.value=!0,ee()},ne=function(){clearInterval(W.value),w.value=!1,J.value=!1,b.value=""};return j($),d({init:$}),C(function(){clearInterval(W.value)}),function(t,n){var r=ie,a=R,l=F,o=D,u=M,p=i,f=ue,d=c,m=B,_=L,h=oe,x=s;return P(),S("div",null,[O(g)?(P(),T(r,{key:0,width:"28rem",options:{name:"composer",title:"composer"}},{default:N(function(){return e(n[11]||(n[11]=[U(" 没有找到可用的composer版本 ",-1)]))}),_:1})):q("",!0),H("div",Ge,[z(_,{model:O(y)},{default:N(function(){return[z(u,{label:"Composer版本"},{default:N(function(){return[H("div",Re,[z(l,{modelValue:O(y).version,"onUpdate:modelValue":n[0]||(n[0]=function(e){return O(y).version=e}),class:"!w-[28rem]"},{default:N(function(){return[z(a,{label:"2.7.3",value:"2.7.3"}),z(a,{label:"1.10.27",value:"1.10.27"})]}),_:1},8,["modelValue"]),z(o,{type:"default",class:"!ml-1rem",onClick:Q},{default:N(function(){return e(n[12]||(n[12]=[U(" 升级Composer ",-1)]))}),_:1})])]}),_:1}),z(u,{label:"PHP版本"},{default:N(function(){return["phpasync"!==O(v)?(P(),T(l,{key:0,class:"!w-[28rem]",modelValue:O(y).php,"onUpdate:modelValue":n[1]||(n[1]=function(e){return O(y).php=e})},{default:N(function(){return[(P(!0),S(A,null,I(O(y).phpVersion,function(e,t){return P(),T(a,{key:t,label:e.name,value:e.version},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"])):(P(),T(p,{key:1,modelValue:O(y).php,"onUpdate:modelValue":n[2]||(n[2]=function(e){return O(y).php=e}),disabled:""},null,8,["modelValue"]))]}),_:1}),z(u,{label:"执行参数"},{default:N(function(){return[z(l,{class:"!w-[28rem]","empty-values":[null,void 0],modelValue:O(y).command,"onUpdate:modelValue":n[3]||(n[3]=function(e){return O(y).command=e})},{default:N(function(){return[(P(!0),S(A,null,I(O(y).commandOptions,function(e,t){return P(),T(a,{key:t,label:e.label,value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"])]}),_:1}),z(u,{label:"补充命令"},{default:N(function(){return[z(p,{modelValue:O(y).otherCommand,"onUpdate:modelValue":n[4]||(n[4]=function(e){return O(y).otherCommand=e}),placeholder:"请输入补充命令",width:"28rem"},null,8,["modelValue"])]}),_:1}),z(u,{label:"镜像源"},{default:N(function(){return[z(l,{modelValue:O(y).mirror,"onUpdate:modelValue":n[5]||(n[5]=function(e){return O(y).mirror=e}),filterable:"","allow-create":"","default-first-option":"",class:"!w-[28rem]"},{default:N(function(){return[z(a,{label:"阿里云(mirrors.aliyun.com)",value:"https://mirrors.aliyun.com/composer/"}),z(a,{label:"官方源(packagist.org)",value:"repos.packagist"}),z(a,{label:"中国全量镜像(packagist.phpcomposer.com)",value:"https://packagist.phpcomposer.com"}),z(a,{label:"Packagist Mirror(packagist.mirrors.sjtug.sjtu.edu.cn)",value:"https://packagist.mirrors.sjtug.sjtu.edu.cn"}),z(a,{label:"腾讯源(mirrors.tencent.com)",value:"https://mirrors.tencent.com/composer/"}),z(a,{label:"华为云(mirrors.huaweicloud.com)",value:"https://mirrors.huaweicloud.com/repository/php/"})]}),_:1},8,["modelValue"])]}),_:1}),"phpasync"!==O(v)?(P(),T(u,{key:0,label:"执行用户",prop:"command"},{default:N(function(){return[z(l,{modelValue:O(y).user,"onUpdate:modelValue":n[6]||(n[6]=function(e){return O(y).user=e}),class:"!w-28rem"},{default:N(function(){return[z(a,{label:"www(推荐)",value:"www"}),z(a,{label:"root(不推荐)",value:"root"})]}),_:1},8,["modelValue"])]}),_:1})):q("",!0),z(u,{label:"执行目录",prop:"composerVersion"},{default:N(function(){return[z(f,{modelValue:O(y).path,"onUpdate:modelValue":n[7]||(n[7]=function(e){return O(y).path=e}),icon:"el-folder-opened",onIconClick:K,width:"28rem"},null,8,["modelValue"])]}),_:1}),z(u,{label:" ",prop:"composerVersion"},{default:N(function(){return[H("div",null,[O(y).comp_lock?(P(),S("span",Fe,[U(E(O(y).comp_lock)+" ",1),z(d,{onClick:X},{default:N(function(){return e(n[13]||(n[13]=[U("[点击删除]",-1)]))}),_:1})])):q("",!0),O(y).comp_json?(P(),S("span",De,E(O(y).comp_json),1)):q("",!0)])]}),_:1}),z(u,{label:" "},{default:N(function(){return[z(o,{type:"primary",disabled:!!("boolean"!=typeof O(y).comp_json&&O(y).comp_json||"boolean"!=typeof O(y).comp_lock&&O(y).comp_lock),onClick:Z},{default:N(function(){return e(n[14]||(n[14]=[U(" 执行 ",-1)]))}),_:1},8,["disabled"]),z(m,{direction:"vertical",class:"!h-1rem !mx-2rem"}),z(o,{onClick:te},{default:N(function(){return e(n[15]||(n[15]=[U("查看日志",-1)]))}),_:1})]}),_:1})]}),_:1},8,["model"]),H("ul",Me,[n[16]||(n[16]=H("li",null,"Composer是PHP主流依赖包管理器，若您的项目使用Composer管理依赖包，可在此处对依赖进行升级或安装",-1)),n[17]||(n[17]=H("li",null,"Composer版本：当前安装的Composer版本，可点击右侧的【升级Composer】将Composer升级到最新稳定版",-1)),n[18]||(n[18]=H("li",null,"PHP版本：用于执行composer的PHP版本，无特殊要求，默认即可，如安装出错，可尝试选择其它PHP版本",-1)),n[19]||(n[19]=H("li",null,"执行参数：按需选择执行参数,可配合补充命令使用",-1)),n[20]||(n[20]=H("li",null,"补充命令：若此处为空，则按composer.json中的配置执行，此处支持填写完整composer命令",-1)),n[21]||(n[21]=H("li",null,"镜像源：提供【阿里源】和【官方源】，建议国内服务器使用【阿里源】，海外服务器使用【官方源】",-1)),"phpasync"!==O(v)?(P(),S("li",Be,"执行用户：默认为www用户，除非您的网站以root权限运行，否则不建议使用root用户执行composer")):q("",!0),n[22]||(n[22]=H("li",null,"执行目录：默认为当前网站根目录",-1))])]),z(x,{title:"请执行完毕确认结果无误后关闭此窗口",onCancel:ne,modelValue:O(w),"onUpdate:modelValue":n[8]||(n[8]=function(e){return G(w)?w.value=e:null}),area:[50,42]},{default:N(function(){return[z(h,{class:"h-full",title:"全屏查看composer执行日志",content:O(b),isHtml:!0,isRefreshBtn:!1,isAuto:!0},null,8,["content"])]}),_:1},8,["modelValue"]),z(x,{title:"composer执行日志",onCancel:ne,modelValue:O(J),"onUpdate:modelValue":n[10]||(n[10]=function(e){return G(J)?J.value=e:null}),area:60},{default:N(function(){return[H("div",Le,[H("div",We,[z(o,{type:"primary",onClick:n[9]||(n[9]=function(e){return ee(!0)})},{default:N(function(){return e(n[23]||(n[23]=[U(" 刷新日志 ",-1)]))}),_:1})]),H("div",Je,[z(h,{class:"h-full",title:"全屏查看composer执行日志",content:O(b),isHtml:!0,isRefreshBtn:!1},null,8,["content"])])])]}),_:1},8,["modelValue"])])}}}),Ke={class:"p-1rem relative"},Qe={class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},Xe={key:0},Ye=w({__name:"index",setup:function(t,r){var a=r.expose,u=le().siteInfo,i=x(!1),s=x(!1),p=V({tomcat:!1}),f=x(""),d=function(){o({loading:"正在设置，请稍后...",request:_e({siteName:u.value.name}),message:!0,success:function(e){e.status&&m()}})},m=function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:o({loading:i,request:he({siteName:u.value.name}),success:function(e){p.tomcat=e.data.tomcat>0,s.value=!e.data.tomcatversion,f.value=e.data.tomcatversion}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),v=function(){se({name:"tomcat",type:"i"})};return j(m),a({init:m}),function(t,n){var r=c,a=ie,l=$,o=W("bt-loading");return J((P(),S("div",null,[O(s)?(P(),T(a,{key:0,width:"28rem"},{content:N(function(){return[n[2]||(n[2]=U(" 请先安装tomcat， ",-1)),z(r,{onClick:v,class:"!text-[1.2rem]"},{default:N(function(){return e(n[1]||(n[1]=[U(" 立即安装 ",-1)]))}),_:1})]}),_:1})):q("",!0),H("div",Ke,[z(l,{modelValue:O(p).tomcat,"onUpdate:modelValue":n[0]||(n[0]=function(e){return O(p).tomcat=e}),onChange:d},{default:N(function(){return e(n[3]||(n[3]=[U(" 启用Tomcat ",-1)]))}),_:1},8,["modelValue"]),H("ul",Qe,[O(f)?(P(),S("li",Xe,"当前版本为Tomcat"+E(O(f))+" ,若您需要其它版本,请到软件商店- 所有软件 中切换；",1)):q("",!0),n[4]||(n[4]=H("li",null,"部署顺序: 安装Tomcat >> 创建站点 >> 上传并配置项目 >> 启用Tomcat",-1)),n[5]||(n[5]=H("li",null,"若您的tomcat应用中有php脚本,访问时请添加.php扩展名",-1)),n[6]||(n[6]=H("li",null,"开启成功后,大概需要1-5分钟时间生效!",-1))])])])),[[o,O(i)]])}}}),Ze=le().siteInfo,et=x(),tt=x(!1),nt=x(!1),rt=x(!0),at=V({status:!1,gzip_types:"",comp_level:1,min_length:1,unit:"k"}),lt=[{label:"k",value:"k"},{label:"m",value:"m"}],ot=[{content:"用于对 HTTP 响应的内容进行压缩，以减少数据传输量，提高网站性能和加载速度"},{content:"压缩级别1-9，越高压缩率越高，但也更消耗CPU"},{content:"如果开启gzip后影响网站正常访问，请关闭此功能 和请求参数组成"}],ut={gzip_types:[{required:!0,message:"请输入压缩类型",trigger:["blur","change"]}],min_length:[{required:!0,message:"请输入正确的压缩最小长度",trigger:"blur",validator:function(e,t,n){t?isNaN(Number(t))?n(new Error("请输入数字")):Number(t)<1?n(new Error("请输入正确数字")):n():n(new Error("压缩最小长度不能为空"))}},{}]},it=function(){var e=l(n().m(function e(){var t,r,a,l,u;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,et.value.validate();case 1:return t=at.gzip_types,r=at.comp_level,a=at.min_length,l=at.unit,u={site_name:Ze.value.name,gzip_types:t,comp_level:r,min_length:"".concat(a).concat(l)},e.n=2,o({loading:nt,request:ge(u),message:!0});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ct=function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:if(at.status){e.n=2;break}return e.n=1,o({loading:nt,request:ye({site_name:Ze.value.name})});case 1:return e.a(2,e.v);case 2:st();case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),st=function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,o({loading:nt,request:be({site_name:Ze.value.name}),success:function(e){var t=e.data,n=t.gzip_types,r=t.comp_level,a=t.min_length;Object.assign(at,{gzip_types:n,comp_level:r,min_length:a.slice(0,-1),unit:a.slice(-1)}),rt.value&&(at.status=e.data.status,rt.value=!1)}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),pt={class:"p-[20px]"},ft={class:"mt-[1.6rem]"},dt={class:"flex items-center"},mt={class:"ml-[20px]"},vt=w({__name:"index",setup:function(t){return j(function(){st()}),K(function(){rt.value=!0}),function(t,n){var r=X,a=M,l=i,o=R,u=F,c=D,s=L,p=f,d=W("bt-loading");return P(),S("div",pt,[J((P(),T(s,{ref_key:"compressFormRef",ref:et,class:"h-[38rem]",model:O(at),rules:O(ut),"label-width":"100px",disabled:O(nt)},{default:N(function(){return[z(a,{label:"内容压缩",prop:"status"},{default:N(function(){return[z(r,{modelValue:O(at).status,"onUpdate:modelValue":n[0]||(n[0]=function(e){return O(at).status=e}),onChange:O(ct)},null,8,["modelValue","onChange"])]}),_:1}),J(H("div",ft,[z(a,{label:"压缩类型",prop:"gzip_types"},{default:N(function(){return[z(l,{modelValue:O(at).gzip_types,"onUpdate:modelValue":n[1]||(n[1]=function(e){return O(at).gzip_types=e}),type:"textarea",width:"42rem",rows:6,resize:"none"},null,8,["modelValue"])]}),_:1}),z(a,{label:"压缩级别",prop:"comp_level"},{default:N(function(){return[z(u,{class:"!w-[42rem]",modelValue:O(at).comp_level,"onUpdate:modelValue":n[2]||(n[2]=function(e){return O(at).comp_level=e})},{default:N(function(){return[(P(),S(A,null,I(9,function(e){return z(o,{key:e,label:e,value:String(e)},null,8,["label","value"])}),64))]}),_:1},8,["modelValue"])]}),_:1}),z(a,{label:"压缩最小长度",prop:"min_length"},{default:N(function(){return[H("div",dt,[z(l,{modelValue:O(at).min_length,"onUpdate:modelValue":n[3]||(n[3]=function(e){return O(at).min_length=e})},null,8,["modelValue"]),z(a,{prop:"unit"},{default:N(function(){return[z(u,{class:"ml-[1rem] !w-[8rem]",modelValue:O(at).unit,"onUpdate:modelValue":n[4]||(n[4]=function(e){return O(at).unit=e}),placeholder:"请选择"},{default:N(function(){return[(P(!0),S(A,null,I(O(lt),function(e){return P(),T(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"])]}),_:1})])]}),_:1})],512),[[Q,O(at).status]]),J(z(a,{label:" ",class:"mt-[1.6rem]"},{default:N(function(){return[z(c,{type:"primary",onClick:O(it)},{default:N(function(){return e(n[5]||(n[5]=[U("保存",-1)]))}),_:1},8,["onClick"])]}),_:1},512),[[Q,O(at).status]])]}),_:1},8,["model","rules","disabled"])),[[d,O(tt)]]),H("div",mt,[z(p,{options:O(ot)},null,8,["options"])])])}}}),_t={class:"px-2rem"},ht={class:"ml-[8px]"},gt=w({__name:"index",setup:function(e,t){var n=t.expose,r=le().siteInfo,a=x(!1),l=x([{help:"阻止浏览器上下文中执行恶意JavaScript代码",value:!1,field:"x_xss_protection"},{help:"阻止浏览器的内容嗅探",value:!1,field:"x_content_type_options"},{help:"让浏览器跳转时不携带referrer",value:!1,field:"referrer_policy"},{help:"让浏览器加载内容时只加载自己网站的内容",value:!1,field:"content_security_policy"},{help:"防止浏览器进行用户行为跟踪",value:!1,field:"permissions_policy"}]),u=function(){var e={};l.value.forEach(function(t){e[t.field]=t.value});var t={site_name:r.value.name,security_info:JSON.stringify(e)};o({loading:"正在设置，请稍后...",request:we(t),message:!0,success:function(e){e.status&&i()}})},i=function(){o({loading:a,request:xe({site_name:r.value.name}),success:function(e){l.value.forEach(function(t){e.data[t.field]&&(t.value=e.data[t.field])})}})};return j(i),n({init:i}),function(e,t){var n=X,r=W("bt-loading");return J((P(),S("div",_t,[(P(!0),S(A,null,I(O(l),function(e,t){return P(),S("div",{key:t,class:"flex items-center mb-[12px]"},[z(n,{modelValue:e.value,"onUpdate:modelValue":function(t){return e.value=t},onChange:u},null,8,["modelValue","onUpdate:modelValue"]),H("span",ht,E(e.help),1)])}),128))])),[[r,O(a)]])}}}),yt=Z("CROSS-ORIGIN-ACCESS-STORE",function(){var e=x({status:!1,siteName:null,project_type:null,allowed_origin:null,allowed_methods:null,allowed_headers:null,exposed_headers:null,allow_credentials:!1});return{formData:e,reset:function(){e.value.status=!1,e.value.siteName=null,e.value.project_type=null,e.value.allowed_origin=null,e.value.allowed_methods=null,e.value.allowed_headers=null,e.value.exposed_headers=null,e.value.allow_credentials=!1}}}),bt=function(){return Y(yt())},wt=bt().formData,xt=function(){var e=l(n().m(function e(t){return n().w(function(e){for(;;)switch(e.n){case 0:o({request:Ve({siteName:t.siteName,project_type:t.project_type}),loading:"正在获取跨域访问配置...",success:function(e){var n=e.data;wt.value.siteName=t.siteName,wt.value.project_type=t.project_type,wt.value.status=n.status,wt.value.allowed_origin=n.allowed_origins,wt.value.allowed_methods=n.allow_methods,wt.value.allowed_headers=n.allow_headers,wt.value.exposed_headers=n.expose_headers,wt.value.allow_credentials=n.allow_credentials}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Vt=function(){var e=l(n().m(function e(t){return n().w(function(e){for(;;)switch(e.n){case 0:o({request:ke(t),loading:"正在设置跨域访问配置...",message:!0,success:function(e){e.status&&xt({siteName:t.siteName,project_type:t.project_type})}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),kt=function(){var e=l(n().m(function e(t){return n().w(function(e){for(;;)switch(e.n){case 0:o({request:je({siteName:t.siteName,project_type:t.project_type}),loading:"正在删除跨域访问配置...",message:!0,success:function(e){e.status&&xt({siteName:t.siteName,project_type:t.project_type})}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),jt=function(){var e=l(n().m(function e(t){return n().w(function(e){for(;;)switch(e.n){case 0:wt.value.status?Vt(t):kt(t);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Ct={class:"w-full"},Pt=w({__name:"index",setup:function(t){var r,a=le().siteInfo,o=bt().formData,u=x(!1),i=yt().reset,c=d({data:function(){return o.value},options:function(t){return ee(function(){return[Ne("状态",function(){return z("div",{class:"flex items-center"},[z(X,{modelValue:t.value.status,"onUpdate:modelValue":function(e){return t.value.status=e},onChange:function(e){var t;e||(null===(t=m.value)||void 0===t||t.clearValidate(["allowed_origin"]))}},null),null!=t&&t.value.status?z("span",{class:"ml-[2rem] text-[12px] text-[#606266]"},[U("当允许行跨域访问")]):null])},"status",{labelWidth:"140px"})].concat(e(null!=t&&t.value.status?[Ne("允许访问的域名",function(){return z("div",{class:"flex items-center w-full"},[z("div",null,[z(te,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{default:function(){return z("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[U("使用*代表所有域名都可以跨域访问"),z("br",null,null),U("多个域名用 , 分隔")])},reference:function(){return z(ne,{type:"textarea",rows:4,class:"!w-[32rem]",placeholder:"使用*代表所有域名都可以跨域访问，多个域名用,分隔",modelValue:t.value.allowed_origin,"onUpdate:modelValue":function(e){return t.value.allowed_origin=e}},null)}})])])},"allowed_origin",{rules:[{required:!0,message:"请输入允许访问的域名",trigger:"blur",validator:function(e,n,r){var a;null!=t&&null!==(a=t.value)&&void 0!==a&&a.status?n?r():r(new Error("请输入允许访问的域名")):r()}}],labelWidth:"140px"}),{type:"slots",key:"custom"}]:[]),[Ne(" ",function(){return z("div",{class:"flex items-center w-full ml-[6rem]"},[z(D,{type:"primary",onClick:function(){return p()}},{default:function(){return[U("保存")]}})])})])})},submit:(r=l(n().m(function e(t,r){return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,r();case 1:return jt(t.value),e.a(2,!0);case 2:return e.p=2,e.v,e.a(2,!1)}},e,null,[[0,2]])})),function(e,t){return r.apply(this,arguments)})}),s=c.BtForm,p=c.submit,f=c.param,m=c.ref;return j(l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:return i(),u.value=!0,e.n=1,xt({siteName:a.value.name,project_type:a.value.project_type});case 1:u.value=!1;case 2:return e.a(2)}},e)}))),function(t,n){var r=X,a=te,l=M,o=ne,i=Te,c=re;return J((P(),S("div",Ct,[z(O(s),null,{custom:N(function(){return[z(i,null,{config:N(function(){return[z(l,{"label-width":"140px",label:"允许跨域携带cookie",prop:"allow_credentials"},{default:N(function(){return[z(r,{modelValue:O(f).allow_credentials,"onUpdate:modelValue":n[0]||(n[0]=function(e){return O(f).allow_credentials=e})},null,8,["modelValue"]),z(a,{placement:"top-start",width:"auto",trigger:"hover","popper-class":"green-tips-popover !p-0 !border-none"},{reference:N(function(){return e(n[4]||(n[4]=[H("span",{class:"ml-[8px] bt-ico-ask"},"?",-1)]))}),default:N(function(){return[n[5]||(n[5]=H("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[U(" Access-Control-Allow-Credentials 允许/拒绝浏览器发送凭据（如Cookie）。 "),H("br"),U(" 设为 true 时，请求携带的凭据将被服务器接受，但需同时指定具体源（不能使用 *）。 ")],-1))]}),_:1})]}),_:1}),z(l,{"label-width":"140px",label:"允许跨域的请求方法",prop:"allowed_methods"},{default:N(function(){return[z(a,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{reference:N(function(){return[z(o,{type:"textarea",rows:4,class:"!w-[32rem]",modelValue:O(f).allowed_methods,"onUpdate:modelValue":n[1]||(n[1]=function(e){return O(f).allowed_methods=e}),placeholder:"允许跨域的请求方法，例如: GET, POST"},null,8,["modelValue"])]}),default:N(function(){return[n[6]||(n[6]=H("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[U(" Access-Control-Allow-Methods 指定允许的HTTP方法（如 GET, POST, OPTIONS）， "),H("br"),U(" 用于预检请求（OPTIONS）时告知客户端可支持的方法列表。 ")],-1))]}),_:1})]}),_:1}),z(l,{"label-width":"140px",label:"允许跨域携带的请求头",prop:"allowed_headers"},{default:N(function(){return[z(a,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{reference:N(function(){return[z(o,{type:"textarea",rows:4,class:"!w-[32rem]",modelValue:O(f).allowed_headers,"onUpdate:modelValue":n[2]||(n[2]=function(e){return O(f).allowed_headers=e}),placeholder:"允许跨域携带的请求头"},null,8,["modelValue"])]}),default:N(function(){return[n[7]||(n[7]=H("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[U(" Access-Control-Allow-Headers 在预检请求中定义允许携带的自定义请求头（如 Content-Type）， "),H("br"),U(" 告知客户端哪些头可安全用于实际请求。 ")],-1))]}),_:1})]}),_:1}),z(l,{"label-width":"140px",label:"允许浏览器访问的响应头",prop:"exposed_headers"},{default:N(function(){return[z(a,{placement:"top-start",width:"auto",trigger:"click","popper-class":"green-tips-popover !p-0 !border-none"},{reference:N(function(){return[z(o,{type:"textarea",rows:4,class:"!w-[32rem]",modelValue:O(f).exposed_headers,"onUpdate:modelValue":n[3]||(n[3]=function(e){return O(f).exposed_headers=e}),placeholder:"允许跨域浏览器访问的响应头"},null,8,["modelValue"])]}),default:N(function(){return[n[8]||(n[8]=H("div",{class:"!p-[12px] bg-[#20a53a] text-white leading-[2.4rem]"},[U(" Access-Control-Expose-Headers 暴露给浏览器脚本的响应头列表， "),H("br"),U(" 客户端只能访问在此列表中声明的头（如 Content-Range）。 ")],-1))]}),_:1})]}),_:1})]}),_:1})]}),_:1})])),[[c,O(u)]])}}}),St=w({__name:"index",setup:function(t,a){var i=a.expose,c=le().siteInfo,s=x(),p=x([]),f=x(!1),d=m({options:[{label:"添加计划任务",type:"button",active:!0,onClick:function(){return w()}}]}).BtOperation,y=function(){var e=l(n().m(function e(t,r,a,o){var u,i,c,s;return n().w(function(e){for(;;)switch(e.n){case 0:return u=o.label,i=o.value,c=new Map([["stark","即将批量执行选中的计划任务"],["start","即将批量开启选中任务"],["stop","即将批量停止选中任务"],["delete","即将批量删除选中任务"]]),s=function(){var e=l(n().m(function e(t,r){var a,l,o,u;return n().w(function(e){for(;;)switch(e.n){case 0:a=new Map([["stark",Se],["start",Pe],["stop",Pe],["delete",Oe]]),l=t.id,o=a.get(i),u=i,e.n="stark"===u?1:"start"===u||"stop"===u?3:"delete"===u?5:7;break;case 1:if(!o){e.n=2;break}return e.a(2,o({id:l}));case 2:case 4:case 6:return e.a(3,7);case 3:if(!o){e.n=4;break}return e.a(2,o({id:l,status:"start"===i?1:0}));case 5:if(!o){e.n=6;break}return e.a(2,o({id:l}));case 7:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),e.n=1,t({title:"批量".concat(u),content:"".concat(c.get(i),"，是否继续操作？"),column:[{label:"项目名称",prop:"name"},Ie()],onConfirm:function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r(s);case 1:return S(),e.a(2,!1)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),b=function(){var e=l(n().m(function e(t){return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({title:t.status?"停用计划任务":"启用计划任务",content:t.status?"计划任务暂停后将无法继续运行，您真的要停用这个计划任务吗？":"该计划任务已停用，是否要启用这个计划任务？",icon:"question-filled"});case 1:return e.n=2,o({loading:"正在设置计划任务状态，请稍候...",request:Pe({id:t.id}),message:!0,success:S});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),w=function(e){v({isAsync:!0,title:"".concat(e?"编辑":"添加","计划任务").concat(e?"【"+e.name+"】":""),area:74,component:function(){return _(function(){return r.import("./add-crontab-legacy.js?v=1756369731")},void 0,r.meta.url)},compData:{row:e||!1,sitename:c.value.name,refreshEvent:S},showFooter:!0})},V=function(e){v({isAsync:!0,title:"查看【"+(e.rname||e.name)+"】日志",area:80,compData:{id:e.id},component:function(){return _(function(){return r.import("./log-detail-legacy2.js?v=1756369731")},void 0,r.meta.url)}})},k=function(){var e=l(n().m(function e(t){return n().w(function(e){for(;;)switch(e.n){case 0:o({loading:"正在执行计划任务，请稍后...",request:Se({id:t.id}),message:!0,success:function(){V(t)}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=l(n().m(function e(t){var r,a;return n().w(function(e){for(;;)switch(e.n){case 0:return r=t.id,a=t.name,e.n=1,u({title:"删除计划任务",content:"您确定要删除计划任务【".concat(a,"】，是否继续？"),icon:"warning-filled"});case 1:o({loading:"正在删除计划任务，请稍后...",request:Oe({id:r}),message:!0,success:S});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:o({loading:f,request:Ce({sitename:c.value.name}),data:{data:[Array,p]}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),U=ae([He(),{label:"计划任务",prop:"rname",render:function(e){return e.rname||e.name}},ze({event:function(e){b(e)},data:["停用","正常"]}),{label:"执行周期",prop:"cycle"},{label:"上次执行时间",prop:"addtime"},Ae([{onClick:k,title:"执行"},{onClick:function(e){w(e)},title:"编辑"},{onClick:function(e){V(e)},title:"日志"},{onClick:C,title:"删除"}])]),q=[{label:"执行任务",value:"stark",event:y},{label:"启动任务",value:"start",event:y},{label:"停止任务",value:"stop",event:y},{label:"删除任务",value:"delete",event:y}];return j(S),i({init:S}),function(t,n){var r=h,a=g,l=qe,o=W("bt-loading");return P(),T(l,null,{"header-left":N(function(){return[z(O(d))]}),"header-right":N(function(){return e(n[0]||(n[0]=[]))}),content:N(function(){return[J(z(r,{ref_key:"cronTableRef",ref:s,"max-height":560,column:O(U),data:O(p)},null,8,["column","data"]),[[o,"正在加载计划任务列表，请稍后...","title"],[o,O(f)]])]}),"footer-left":N(function(){return[z(a,{"table-ref":O(s),options:O(q)},null,8,["table-ref","options"])]}),_:1})}}}),Ot=w({__name:"index",setup:function(e,t){var n,r,a,l=t.expose,o=le().siteInfo,u=null===(n=o.value)||void 0===n?void 0:n.project_type,i=x(null!==(r=o.value)&&void 0!==r&&r.otherName?null===(a=o.value)||void 0===a?void 0:a.otherName:"phpasync"!==u?"composer":"nginx"),c="phpasync"===u,s=x([{label:"Composer",name:"composer",lazy:!0,isHide:c,render:$e},{label:"Tomcat",name:"tomcat",lazy:!0,isHide:c,render:Ye},{label:"Gzip压缩",name:"gzip",lazy:!0,isHide:c,render:vt},{label:"Nginx安全请求头",name:"nginx",lazy:!0,render:gt},{label:"跨域访问CORS配置",name:"cors",isHide:c,lazy:!0,render:Pt},{label:"默认文档",name:"defalut",isHide:!c,lazy:!0,render:Ue},{label:"计划任务",name:"crontab",isHide:!c,lazy:!0,render:St},{label:"网站告警",name:"siteAlarm",isHide:!c,lazy:!0,render:Ee}]),p=y({type:"card",value:i,options:s}).BtTabs,f=function(){s.value=s.value.filter(function(e){return!0!==e.isHide})};return j(f),l({init:f}),function(e,t){return P(),T(O(p))}}});t("default",b(Ot,[["__scopeId","data-v-2e6c9bcf"]]))}}})}();
