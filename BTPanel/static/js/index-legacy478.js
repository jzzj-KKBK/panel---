!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",l=o.toStringTag||"@@toStringTag";function i(t,o,a,l){var i=o&&o.prototype instanceof c?o:c,s=Object.create(i.prototype);return r(s,"_invoke",function(t,r,o){var a,l,i,c=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return a=n,l=0,i=e,d.n=t,u}};function m(t,r){for(l=t,i=r,n=0;!f&&c&&!o&&n<s.length;n++){var o,a=s[n],m=d.p,p=a[2];t>3?(o=p===r)&&(i=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=t<2&&m<a[1])?(l=0,d.v=r,d.n=a[1]):m<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,d.n=p,l=0))}if(o||t>1)return u;throw f=!0,r}return function(o,s,p){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&m(s,p),l=s,i=p;(n=l<2?e:i)||!f;){a||(l?l<3?(l>1&&(d.n=-1),m(l,i)):d.n=i:d.v=i);try{if(c=2,a){if(l||(o="next"),n=a[o]){if(!(n=n.call(a,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,l<2&&(l=0)}else 1===l&&(n=a.return)&&n.call(a),l<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((n=(f=d.n<0)?i:t.call(r,d))!==u)break}catch(n){a=e,l=1,i=n}finally{c=1}}return{value:n,done:f}}}(t,a,l),!0),s}var u={};function c(){}function s(){}function f(){}n=Object.getPrototypeOf;var d=[][a]?n(n([][a]())):(r(n={},a,function(){return this}),n),m=f.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,l,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=f,r(m,"constructor",f),r(f,"constructor",s),s.displayName="GeneratorFunction",r(f,l,"GeneratorFunction"),r(m),r(m,l,"Generator"),r(m,a,function(){return this}),r(m,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:p}})()}function r(e,n,t,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,n,t,o){function l(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(l("next",0),l("throw",1),l("return",2))},r(e,n,t,o)}function o(e,n,t,r,o,a,l){try{var i=e[a](l),u=i.value}catch(e){return void t(e)}i.done?n(u):Promise.resolve(u).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var l=e.apply(n,t);function i(e){o(l,r,a,i,u,"next",e)}function u(e){o(l,r,a,i,u,"throw",e)}i(void 0)})}}System.register(["./index-legacy116.js?v=1756369731","./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./column-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731"],function(n,r){"use strict";var o,l,i,u,c,s,f,d,m,p,v,y,g,b,_,h,w,k,C,j,x,S,V,E,O,A,q,G,I,P,T,U,F,L,B,H,z,J,M,N,R,D,K;return{setters:[function(e){o=e._},function(e){l=e.K,i=e.b,u=e.o,c=e.W,s=e.j,f=e.ag,d=e.h,m=e.A,p=e.e},function(e){v=e.r,y=e.k,g=e.c,b=e.p,_=e.G,h=e.H,w=e.x,k=e.q,C=e.v,j=e.e,x=e.A,S=e.B,V=e.y,E=e.F,O=e.a_,A=e.Q,q=e.J,G=e.z,I=e.I,P=e.P,T=e.D,U=e.a9,F=e.a7,L=e.C,B=e.M},function(e){H=e.B},function(e){z=e.getServiceLog,J=e.modifyService,M=e.addService,N=e.getServicesInfo,R=e.delService,D=e.handleService},function(e){K=e.u},null,null],execute:function(){var r=i(),Q=K().siteInfo,W=v([]),$=v(!1),X=v(),Y=v(!1),Z=y({name:"",command:"",sid:"",level:11,log_type:"append",isEdit:!1}),ee=v(!1),ne=v(!1),te=v([{label:"追加记录",value:"append"},{label:"启动时清空",value:"cover"}]),re=v(!1),oe=y({logContent:"",logLoading:!1,title:"",sid:""}),ae=y({name:[{required:!0,message:"请输入服务名称",trigger:"blur"}],command:[{required:!0,message:"请输入启动命令",trigger:"blur"}],level:[{required:!0,message:"请输入优先级",trigger:"blur"}]}),le=v([{content:"协同服务用于管理那些与web服务同时运行的，用于处理一些事务的服务，如：任务队列、定时队列等，例如：celery等。"},{content:"当前工作方式为启动项目时检测这些服务，若未启动则执行启动，若已启动则不进行操作；停止项目时执行所有服务的停止操作"}]),ie=function(e){Z.log_type=e},ue=function(){ye(),$.value=!0},ce=function(e){Z.name=e.name,Z.command=e.command,Z.sid=e.sid,Z.level=e.level,Z.log_type=e.log_type,Z.isEdit=!0,$.value=!0},se=function(){var e=a(t().m(function e(n){var o,a;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,!n&&(oe.logLoading=!0),e.n=1,z({project_name:Q.value.name,sid:oe.sid});case 1:o=e.v,a=o.data,oe.logContent=a.data,oe.logLoading=!1,n&&r.success("刷新成功"),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),fe=function(e){oe.sid=e.sid,oe.title="main"===e.sid?"项目主服务":e.name,re.value=!0,se(!1)},de=function(){var e=a(t().m(function e(n){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({icon:"warning-filled",title:"删除服务【".concat(n.name,"】"),content:"删除服务【".concat(n.name,"】后，将无法管理该服务，是否继续？")});case 1:return e.n=2,l({loading:"正在删除服务，请稍后...",request:R({project_name:Q.value.name,sid:n.sid}),message:!0});case 2:e.v.status&&ge();case 3:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),me=function(){var e=a(t().m(function e(n,r){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:"正在修改服务状态，请稍后...",request:D({project_name:Q.value.name,sid:r.sid,option:n}),message:!0});case 1:e.v.status&&ge();case 2:return e.a(2)}},e)}));return function(n,t){return e.apply(this,arguments)}}(),pe=function(){$.value=!1,ye()},ve=function(){var e=a(t().m(function e(){var n,r;return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,X.value.validate();case 1:return n={project_name:Q.value.name,service_conf:JSON.stringify({name:Z.name,command:Z.command,level:Z.level,log_type:Z.log_type})},Z.isEdit&&(n.sid=Z.sid),r=Z.isEdit?J:M,e.n=2,l({loading:Y,request:r(n),message:!0});case 2:e.v.status&&($.value=!1,ye(),ge());case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ye=function(){Z.name="",Z.command="",Z.sid="",Z.level=11,Z.log_type="append",Z.isEdit=!1},ge=function(){var e=a(t().m(function e(){var n,r=arguments;return t().w(function(e){for(;;)switch(e.n){case 0:return(n=r.length>0&&void 0!==r[0]&&r[0])&&(ne.value=!0),e.n=1,l({request:N({project_name:Q.value.name}),data:{data:[Array,W]}});case 1:n&&(ne.value=!1);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),be={class:"overflow-auto mt-1rem max-h-[61rem]"},_e={class:"flex flex-col p-[16px]"},he={class:"service-info"},we={class:"item-info"},ke={class:"flex items-center"},Ce={class:"item-info"},je={key:0},xe={key:1},Se={key:0,class:"item-info"},Ve={class:"!w-[100%]"},Ee=["onClick"],Oe={class:"flex items-center mt-[16px]"},Ae={class:"p-2rem"},qe={class:"ml-[1rem] text-[#20a53a] w-[16rem] select-none"},Ge={class:"py-[2rem] pt-[0]"},Ie={class:"p-2rem flex flex-col"},Pe=g({__name:"index",setup:function(n){return b(function(){ge(!0)}),function(n,t){var r=T,a=c,l=s,i=U,u=f,p=F,v=d,y=o,g=_("bt-loading");return h((k(),C("div",null,[j(r,{type:"primary",onClick:w(ue)},{default:x(function(){return e(t[9]||(t[9]=[S("添加服务",-1)]))}),_:1},8,["onClick"]),V("div",be,[(k(!0),C(E,null,O(w(W),function(n,o){return k(),C("div",{class:"border rounded-[2px] border-[#EBEEF5] mb-[16px]",key:o},[V("div",_e,[V("div",he,[V("div",we,[V("div",null,"服务："+G(n.name),1),V("div",ke,[t[10]||(t[10]=S("状态：",-1)),j(w(H),{modelValue:!!n.pid},null,8,["modelValue"])])]),V("div",Ce,[n.pid?(k(),C("div",je,"pid："+G(n.pid),1)):L("",!0),n.ports.length?(k(),C("div",xe,"端口："+G(n.ports.join(", ")),1)):L("",!0)]),n.sid&&"main"!==n.sid?(k(),C("div",Se,[V("div",Ve,[S(" 启动命令："+G(n.command)+" ",1),V("i",{class:"svgtofont-el-document-copy cursor-pointer text-[#333] text-[1.5rem] copy ml-[4px]",title:"复制启动命令",onClick:function(){return w(m)({value:n.command})}},null,8,Ee)])])):L("",!0)]),V("div",Oe,[n.pid?(k(),B(r,{key:1,type:"default",onClick:function(e){return w(me)("stop",n)}},{default:x(function(){return e(t[12]||(t[12]=[S("停止",-1)]))}),_:2},1032,["onClick"])):(k(),B(r,{key:0,type:"default",onClick:function(e){return w(me)("start",n)}},{default:x(function(){return e(t[11]||(t[11]=[S("启动",-1)]))}),_:2},1032,["onClick"])),j(r,{type:"default",onClick:function(e){return w(me)("restart",n)}},{default:x(function(){return e(t[13]||(t[13]=[S("重启",-1)]))}),_:2},1032,["onClick"]),"main"!==n.sid?(k(),C(E,{key:2},[j(r,{type:"default",onClick:function(e){return w(ce)(n)}},{default:x(function(){return e(t[14]||(t[14]=[S("编辑",-1)]))}),_:2},1032,["onClick"]),j(r,{type:"default",onClick:function(e){return w(fe)(n)}},{default:x(function(){return e(t[15]||(t[15]=[S("日志",-1)]))}),_:2},1032,["onClick"]),j(r,{type:"default",onClick:function(e){return w(de)(n)}},{default:x(function(){return e(t[16]||(t[16]=[S("删除",-1)]))}),_:2},1032,["onClick"])],64)):L("",!0)])])])}),128))]),j(a,{options:w(le)},null,8,["options"]),j(v,{title:"".concat(w(Z).isEdit?"编辑":"添加","服务"),modelValue:w($),"onUpdate:modelValue":t[6]||(t[6]=function(e){return P($)?$.value=e:null}),area:50,"show-footer":!0,onConfirm:w(ve),onCancel:w(pe)},{default:x(function(){return[V("div",Ae,[j(p,{rules:w(ae),"label-width":"90px",model:w(Z),ref_key:"servicesFormRef",ref:X,disabled:w(Y),size:"small",onSubmit:t[5]||(t[5]=A(function(){},["prevent"]))},{default:x(function(){return[j(i,{label:"名称",prop:"name"},{default:x(function(){return[j(l,{modelValue:w(Z).name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return w(Z).name=e}),name:"name",width:"32rem"},null,8,["modelValue"])]}),_:1}),j(i,{label:"启动命令",prop:"command"},{default:x(function(){return[j(l,{modelValue:w(Z).command,"onUpdate:modelValue":t[1]||(t[1]=function(e){return w(Z).command=e}),name:"command",width:"32rem"},null,8,["modelValue"])]}),_:1}),V("div",{class:"more flex items-center cursor-pointer pl-[10rem] my-[2rem] px-[2rem]",onClick:t[2]||(t[2]=function(e){return ee.value=!w(ee)})},[V("i",{class:q(w(ee)?"svgtofont-el-arrow-down":"svgtofont-el-arrow-right")},null,2),V("div",qe,G("更多设置，".concat(w(ee)?"点击收回":"点击查看")),1)]),h(V("div",Ge,[j(i,{label:"优先级",prop:"level"},{default:x(function(){return[j(l,{modelValue:w(Z).level,"onUpdate:modelValue":t[3]||(t[3]=function(e){return w(Z).level=e}),type:"number",name:"level",width:"32rem"},null,8,["modelValue"])]}),_:1}),j(i,{label:"日志管理",prop:"log_type"},{default:x(function(){return[j(u,{modelValue:w(Z).log_type,"onUpdate:modelValue":t[4]||(t[4]=function(e){return w(Z).log_type=e}),options:w(te),onChange:w(ie),class:"!w-32rem"},null,8,["modelValue","options","onChange"])]}),_:1})],512),[[I,w(ee)]])]}),_:1},8,["rules","model","disabled"]),h(j(a,{class:"pl-4rem",options:[{content:"【优先级】执行项目启动时，会按照优先级从高到低一次启动服务，主服务的优先级为10"}]},null,512),[[I,w(ee)]])])]}),_:1},8,["title","modelValue","onConfirm","onCancel"]),j(v,{title:"【".concat(w(oe).title,"】服务日志"),modelValue:w(re),"onUpdate:modelValue":t[8]||(t[8]=function(e){return P(re)?re.value=e:null}),area:70},{default:x(function(){return[h((k(),C("div",Ie,[V("div",null,[j(r,{onClick:t[7]||(t[7]=function(e){return w(se)(!0)}),type:"default",class:"!mb-1rem"},{default:x(function(){return e(t[17]||(t[17]=[S("刷新日志",-1)]))}),_:1})]),j(y,{content:w(oe).logContent,isHtml:!0,class:"h-41rem","full-screen":{title:"全屏查看【".concat(w(oe).title,"】服务日志"),onRefresh:function(){return w(se)}}},null,8,["content","full-screen"])])),[[g,w(oe).logLoading]])]}),_:1},8,["title","modelValue"])])),[[g,w(ne)]])}}});n("default",p(Pe,[["__scopeId","data-v-a6a782c4"]]))}}})}();
