!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function l(n,a,c,s){var l=a&&a.prototype instanceof i?a:i,u=Object.create(l.prototype);return r(u,"_invoke",function(n,r,a){var c,s,l,i=0,u=a||[],f=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return c=t,s=0,l=e,m.n=n,o}};function d(n,r){for(s=n,l=r,t=0;!f&&i&&!a&&t<u.length;t++){var a,c=u[t],d=m.p,p=c[2];n>3?(a=p===r)&&(l=c[(s=c[4])?5:(s=3,3)],c[4]=c[5]=e):c[0]<=d&&((a=n<2&&d<c[1])?(s=0,m.v=r,m.n=c[1]):d<p&&(a=n<3||c[0]>r||r>p)&&(c[4]=n,c[5]=r,m.n=p,s=0))}if(a||n>1)return o;throw f=!0,r}return function(a,u,p){if(i>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),s=u,l=p;(t=s<2?e:l)||!f;){c||(s?s<3?(s>1&&(m.n=-1),d(s,l)):m.n=l:m.v=l);try{if(i=2,c){if(s||(a="next"),t=c[a]){if(!(t=t.call(c,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=c.return)&&t.call(c),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);c=e}else if((t=(f=m.n<0)?l:n.call(r,m))!==o)break}catch(t){c=e,s=1,l=t}finally{i=1}}return{value:t,done:f}}}(n,c,s),!0),u}var o={};function i(){}function u(){}function f(){}t=Object.getPrototypeOf;var m=[][c]?t(t([][c]())):(r(t={},c,function(){return this}),t),d=f.prototype=i.prototype=Object.create(m);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,s,"GeneratorFunction")),e.prototype=Object.create(d),e}return u.prototype=f,r(d,"constructor",f),r(f,"constructor",u),u.displayName="GeneratorFunction",r(f,s,"GeneratorFunction"),r(d),r(d,s,"Generator"),r(d,c,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(n=function(){return{w:l,m:p}})()}function r(e,t,n,a){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}r=function(e,t,n,a){function s(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?c?c(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(s("next",0),s("throw",1),s("return",2))},r(e,t,n,a)}function a(e,t,n,r,a,c,s){try{var l=e[c](s),o=l.value}catch(e){return void n(e)}l.done?t(o):Promise.resolve(o).then(r,a)}System.register(["./utils-lib-legacy.js?v=1756369731","./base-lib-legacy.js?v=1756369731","./firewall-legacy.js?v=1756369731","./useController-legacy5.js?v=1756369731","./validator-legacy.js?v=1756369731","./__commonjsHelpers__-legacy.js?v=1756369731","./site-legacy.js?v=1756369731","./column-legacy.js?v=1756369731","./index-legacy104.js?v=1756369731","./useStore-legacy4.js?v=1756369731","./useController-legacy6.js?v=1756369731","./useMethod-legacy5.js?v=1756369731"],function(t,r){"use strict";var c,s,l,o,i,u,f,m,d,p,v,b,y,h,g,w,S,x,_,j,k,C,M,T,O,P,D,B,A,z,H,E,F,G,I,L,Z,q;return{setters:[function(e){c=e.u,s=e.K,l=e.R,o=e.L,i=e.l,u=e._,f=e.c,m=e.d,d=e.e},function(e){p=e.c,v=e.s,b=e.t,y=e.r,h=e.U,g=e.q,w=e.v,S=e.y,x=e.x,_=e.C,j=e.e,k=e.M,C=e.z,M=e.A,T=e.B,O=e.K,P=e.J,D=e.b7,B=e.F,A=e.a_,z=e.P,H=e.D,E=e.a$,F=e.bw,G=e.ba,I=e.bv},function(e){L=e.p},function(e){Z=e.S},function(e){q=e.p},null,null,null,null,null,null,null],execute:function(){var K={class:"p-[2rem]"},N={class:"head mb-[4rem]"},U={class:"scan-header flex flex-row flex-wrap items-center justify-between"},V={class:"flex flex-row flex-wrap justify-center items-center"},W={key:0,class:"relative scan-header-cont"},$={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"},J={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},R=["innerHTML"],X={class:"scan-subtitle text-[1.6rem] mt-[1.2rem]"},Y={class:"scan-header-cont justify-end relative"},Q={class:"text-[1.5rem]"},ee={class:"content"},te={key:0,class:"info"},ne={class:"webedit-con flex items-center justify-center"},re={class:"thumbnail-introduce mt-[0rem]"},ae={key:1,class:"scan"},ce={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[49rem] border-[#e8e8e8] flex items-center justify-center"},se={class:"flex flex-column items-center"},le={key:1,class:"scan-dangerous"},oe={class:"flex items-center"},ie={class:"w-[26rem] flex items-center justify-start"},ue={class:"ml-[1.2rem]"},fe={class:"flex items-center justify-between w-full"},me={class:"flex items-center ml-[1.2rem]"},de={class:"text-[#999] ml-[1.2rem]"},pe={class:"bg-[#f6f6f6] text-[#999] p-[2rem] ml-[1.2rem]"},ve={class:"mt-[1.2rem] ml-[2rem]"},be={class:"flex items-center"},ye=p({__name:"index",props:{compData:{default:function(){return{isSiteModule:!1}}}},setup:function(t){var d,p,ye,he,ge=t,we=v(Z()).scanData,Se=c().payment,xe=b(Se.value).authType,_e=y(!0),je=y(!1),ke=y({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),Ce=y(["1"]),Me=h([]),Te={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},Oe=y("success"),Pe=y(!1),De=function(){var e,t=(e=n().m(function e(){var t,a,c,i,u,f;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if("ltd"===xe.value){e.n=1;break}return e.a(2,q({sourceId:19}));case 1:return Oe.value="loading",ke.value.scanTitle="正在扫描中，请稍后...",e.p=2,e.n=3,s({request:L(),loading:Pe});case 3:if(t=e.v,a=t.data,ke.value.scanTitle="扫描完成",ke.value.scanTime="扫描时间：".concat(l(a.time)),ke.value.scanCheckButton="重新检测",_e.value=!1,a.info.length?(je.value=!1,Me.value=a.info,Oe.value="danger",ke.value.scanCheckButton="重新检测",ke.value.scanTitle="全部【".concat(a.site_num,"个】网站存在风险项<span class='text-danger'>").concat(a.loophole_num,"</span>个")):(je.value=!0,ke.value.scanTitle="当前网站没有风险项"),!1===(null==a?void 0:a.status)){e.n=6;break}e.n=!0===ge.compData.isSiteModule?4:6;break;case 4:return e.n=5,o(function(){return r.import("./useController-legacy5.js?v=1756369731").then(function(e){return e.w})},void 0,r.meta.url);case 5:return c=e.v,i=c.useSitePhpStore,u=i(),f=u.scanData,Object.assign(f.value,a),e.a(3,6);case 6:e.n=8;break;case 7:e.p=7,e.v,Oe.value="success";case 8:return e.p=8,e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}),function(){var t=this,n=arguments;return new Promise(function(r,c){var s=e.apply(t,n);function l(e){a(s,r,c,l,o,"next",e)}function o(e){a(s,r,c,l,o,"throw",e)}l(void 0)})});return function(){return t.apply(this,arguments)}}(),Be=function(){return i({title:"设置自动扫描",area:54,component:function(){return o(function(){return r.import("./index-legacy457.js?v=1756369731")},void 0,r.meta.url)},showFooter:!0})};return d=we.value,p=d.loophole_num,ye=d.site_num,he=d.time,ge.compData.isSiteModule&&(we.value.loophole_num>0?(Oe.value="danger",ke.value.scanTitle="<span class='text-danger'>".concat(p,"</span>个高危网站漏洞待处理！ 总扫描网站数量").concat(ye,"个"),ke.value.scanTime="上一次扫描时间:".concat(l(he)),ke.value.scanCheckButton="立即查看"):(ke.value.scanTitle="未扫描到网站漏洞，总扫描网站数量".concat(ye,"个"),ke.value.scanTime="上一次扫描时间:".concat(l(he)),ke.value.scanCheckButton="重新检测",Oe.value="success")),function(t,n){var r=u,a=f,c=H,s=E,l=m,o=G,i=I,d=F;return g(),w("div",K,[S("div",N,[S("div",U,[S("div",V,["loading"==x(Oe)?(g(),w("div",W,[x(Pe)?(g(),w("div",$)):_("",!0),j(r,{icon:"scanning-scan",size:60,color:"#20a53a"})])):_("",!0),"success"==x(Oe)?(g(),k(r,{key:1,icon:"scanning-success",size:80,color:"#20a53a"})):_("",!0),"danger"==x(Oe)?(g(),k(r,{key:2,icon:"scanning-danger",size:80,color:"#ef0808"})):_("",!0),S("div",J,[S("div",{class:"scan-title text-[2rem] font-bold",innerHTML:x(ke).scanTitle},null,8,R),S("div",X,C(x(ke).scanTime),1)])]),S("div",Y,[j(a,{class:"btlink setScanAlarm absolute top-[6rem] right-1rem",onClick:Be},{default:M(function(){return e(n[1]||(n[1]=[T(" 自动扫描>> ",-1)]))}),_:1}),j(c,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==x(Oe)?"default":"primary",size:"large",onClick:De},{default:M(function(){return[S("span",Q,C(x(ke).scanCheckButton),1)]}),_:1},8,["type"])])])]),j(s,{class:"!mt-0"}),S("div",ee,[x(_e)?(g(),w("div",te,[S("div",ne,[j(l,{style:O(t.compData.isSiteModule?"width:40rem":""),src:t.compData.isSiteModule?"/preview/site_scanning.png":"/firewall/safe_detect_scanning.png",class:P(t.compData.isSiteModule?"!w-[34rem] mr-[4rem]":"max-w-[90rem] mr-[4rem]")},null,8,["style","src","class"]),S("div",re,[n[3]||(n[3]=S("span",{class:"text-[1.8rem] font-bold"},"漏洞扫描工具介绍：",-1)),S("ul",{class:P(["block leading-[3rem] mx-[2rem] list-square mt-[2rem]",t.compData.isSiteModule?"text-[1.2rem]":"text-[1.6rem]"])},e(n[2]||(n[2]=[D("<li data-v-fb3e28ca> 可识别多款开源CMS程序，支持如下： <br data-v-fb3e28ca> 迅睿CMS、pbootcms、苹果CMS、eyoucms、 <br data-v-fb3e28ca> 海洋CMS、ThinkCMF、zfaka、dedecms、 <br data-v-fb3e28ca> MetInfo、emlog、帝国CMS、discuz、 <br data-v-fb3e28ca> Thinkphp、Wordpress、Z-Blog、极致CMS、 <br data-v-fb3e28ca> ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-fb3e28ca> phpcms、likeshop、iCMS、WellCMS、 <br data-v-fb3e28ca> chanzhiEPS、PHPOK、LaySNS、骑士CMS、 <br data-v-fb3e28ca> openSNS、齐博CMS、ZZZCMS、prestashop、 <br data-v-fb3e28ca> ThinkphpSHOP、DouPHP、cmseasy、 <br data-v-fb3e28ca> piwigo、phpwind、行云海CMS </li><li data-v-fb3e28ca>可扫描网站中存在的漏洞</li><li data-v-fb3e28ca>提供修复/提供付费解决方案</li>",3)])),2)])])])):(g(),w("div",ae,[x(je)?(g(),w("div",ce,[S("div",se,[j(l,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),n[4]||(n[4]=S("span",{class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(g(),w("div",le,[n[7]||(n[7]=S("div",{class:"flex items-center mb-[2rem] text-[#333]"},[S("span",{class:"w-[26rem]"},"网站"),S("span",null,"类型")],-1)),S("div",{class:P(t.compData.isSiteModule?"overflow-auto h-[42rem]":"")},[j(d,{modelValue:x(Ce),"onUpdate:modelValue":n[0]||(n[0]=function(e){return z(Ce)?Ce.value=e:null}),accordion:""},{default:M(function(){return[(g(!0),w(B,null,A(x(Me),function(t,r){return g(),k(i,{key:r},{title:M(function(){return[S("div",oe,[S("div",ie,[j(o,{type:t.cms.length>0?"warning":"success",effect:"dark"},{default:M(function(){return[T(C(t.cms.length)+"项 ",1)]}),_:2},1032,["type"]),S("span",ue,C(t.name),1)]),S("span",null,C(t.cms_name+"--"+t.version_info),1),n[5]||(n[5]=S("div",{class:"text-[#666] text-[1.2rem] ml-[6rem]"},"无法自动修复,请在网站后台更新该软件版本。",-1))])]}),default:M(function(){return[j(d,{accordion:""},{default:M(function(){return[(g(!0),w(B,null,A(t.cms,function(t,r){return g(),k(i,{key:r},{title:M(function(){return[S("div",fe,[S("div",me,[j(o,{type:Te[t.dangerous][0]},{default:M(function(){return[T(C(Te[t.dangerous][1]),1)]}),_:2},1032,["type"]),S("span",de,C(t.ps),1)]),j(a,{class:"mb-[.2rem] mr-[1.6rem]"},{default:M(function(){return e(n[6]||(n[6]=[T("详情",-1)]))}),_:1})])]}),default:M(function(){return[S("div",pe,"修复建议："+C(t.repair),1)]}),_:2},1024)}),128))]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1},8,["modelValue"])],2)]))])),S("div",ve,[S("div",be,[n[9]||(n[9]=T(" 如需支持其他cms程序，请发帖反馈： ",-1)),j(a,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:M(function(){return e(n[8]||(n[8]=[T(" https://www.bt.cn/bbs/thread-89149-1-1.html ",-1)]))}),_:1})])])])])}}});t("default",d(ye,[["__scopeId","data-v-fb3e28ca"]]))}}})}();
