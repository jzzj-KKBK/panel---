!function(){function t(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e,i){return e=o(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,n()?Reflect.construct(e,i||[],o(t).constructor):e.apply(t,i))}function n(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(n=function(){return!!t})()}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,i,r,s,a=[],c=!0,l=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(a.push(o.value),a.length!==e);c=!0);}catch(t){l=!0,i=t}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw i}}return a}}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return c(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function r(n,o,i,r){var c=o&&o.prototype instanceof a?o:a,l=Object.create(c.prototype);return u(l,"_invoke",function(n,o,i){var r,a,c,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return r=e,a=0,c=t,f.n=n,s}};function v(n,o){for(a=n,c=o,e=0;!d&&l&&!i&&e<u.length;e++){var i,r=u[e],v=f.p,p=r[2];n>3?(i=p===o)&&(c=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=t):r[0]<=v&&((i=n<2&&v<r[1])?(a=0,f.v=o,f.n=r[1]):v<p&&(i=n<3||r[0]>o||o>p)&&(r[4]=n,r[5]=o,f.n=p,a=0))}if(i||n>1)return s;throw d=!0,o}return function(i,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,p),a=u,c=p;(e=a<2?t:c)||!d;){r||(a?a<3?(a>1&&(f.n=-1),v(a,c)):f.n=c:f.v=c);try{if(l=2,r){if(a||(i="next"),e=r[i]){if(!(e=e.call(r,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=r.return)&&e.call(r),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);r=t}else if((e=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(e){r=t,a=1,c=e}finally{l=1}}return{value:e,done:d}}}(n,i,r),!0),l}var s={};function a(){}function c(){}function d(){}e=Object.getPrototypeOf;var f=[][o]?e(e([][o]())):(u(e={},o,function(){return this}),e),v=d.prototype=a.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,i,"GeneratorFunction")),t.prototype=Object.create(v),t}return c.prototype=d,u(v,"constructor",d),u(d,"constructor",c),c.displayName="GeneratorFunction",u(d,i,"GeneratorFunction"),u(v),u(v,i,"Generator"),u(v,o,function(){return this}),u(v,"toString",function(){return"[object Generator]"}),(l=function(){return{w:r,m:p}})()}function u(t,e,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}u=function(t,e,n,o){function r(e,n){u(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(r("next",0),r("throw",1),r("return",2))},u(t,e,n,o)}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach(function(e){b(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function v(t,e,n,o,i,r,s){try{var a=t[r](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(o,i)}function p(t){return function(){var e=this,n=arguments;return new Promise(function(o,i){var r=t.apply(e,n);function s(t){v(r,o,i,s,a,"next",t)}function a(t){v(r,o,i,s,a,"throw",t)}s(void 0)})}}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,w(o.key),o)}}function y(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function b(t,e,n){return(e=w(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=m(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}System.register([],function(n,o){"use strict";return{execute:function(){var n,o=function(){function t(){h(this,t),b(this,"autoLoginParams",{password:"",username:""})}return y(t,[{key:"checkAutoLogin",value:function(){var t=this;return new Promise(function(e,n){var o=new URL(window.location.href);""!==o.search&&(new URLSearchParams(o.search).forEach(function(e,n){t.autoLoginParams[n]=e}),t.autoLoginParams.username&&t.autoLoginParams.password&&e(t.autoLoginParams))})}},{key:"bindEvent",value:function(t,e,n){t&&t.addEventListener?t.addEventListener(e,n,!1):t&&t.attachEvent?t.attachEvent("on".concat(e),n||null):t["on".concat(e)]=n||null}},{key:"delegateEvent",value:function(t,e,n,o){"string"==typeof n&&t?t.addEventListener(e,function(t){var e=t.target.closest(n);this.contains(e)&&o&&o.call(e,t)},!1):"string"!=typeof n&&this.bindEvent(t,e,n)}},{key:"convertType",value:function(t,e){if(m(t)===e)return t;if("string"===e)return String(t);if("number"===e)return Number(t);throw new Error("Unsupported target type: ".concat(e))}},{key:"renderSelect",value:function(t){var e=this,n=t.el,o=t.options,i=t.active,r=t.change,s=t.size,a=document.createElement("div"),c=document.createElement("div");if(n.classList.add("form-select-module"),n.innerHTML="",s&&n.classList.add(s),c.classList.add("select-list"),o.length>0){var l=i;void 0===i&&(l=o[0].key);for(var u=0;u<o.length;u++){var d=document.createElement("div");d.classList.add("select-item"),"boolean"==typeof o[u].disabled&&o[u].disabled&&d.classList.add("disabled"),d.innerText=o[u].label,d.dataset.key=o[u].key,d.dataset.disabled="".concat(Number(o[u].disabled)),o[u].key===l&&(d.classList.add("active"),a.innerText=o[u].label),c.appendChild(d)}}a.classList.add("select-display"),n.appendChild(a),n.appendChild(c);var f=function(t){t.target.classList.contains("disabled")&&t.target.classList.contains("select-item")?e.message({message:"当前选项不可选",type:"error",time:2e3}):(n.classList.remove("active"),window.removeEventListener("click",f))};return this.delegateEvent(a,"click",function(t){t.stopPropagation(),n.classList.toggle("active"),n.classList.contains("active")?window.addEventListener("click",f):window.removeEventListener("click",f)}),this.delegateEvent(c,"click",".select-item",function(t){var i=t.target,s=i.dataset,l=s.key,u=s.disabled,d=i.innerText;if(Number(u))return!1;var f=o.findIndex(function(t){return t.key===e.convertType(l,m(t.key))});c.querySelectorAll(".select-item").forEach(function(t,e){f===e?t.classList.add("active"):t.classList.remove("active")}),a.innerText=d,n.classList.remove("active"),n.dataset.key=l,r&&r(l,f)}),window.removeEventListener("click",f),n.dataset.key}},{key:"validateForm",value:function(t){var e=this,n=t.rules,o={},i={},r=function(t){if(Object.prototype.hasOwnProperty.call(n,t)){i[t]=document.querySelector('[name="'.concat(t,'"]'));var r=n[t];r.trigger&&r.trigger.forEach(function(s){var a=!1;o[t]=function(t){var e=i[t];return r.validator(e.value.trim(),function(t){try{throw new Error(t)}catch(s){var n,o;a=!1;var i,r=s.message.replace("Error: ","");if(null===(n=e.parentElement)||void 0===n||null===(n=n.querySelector(".error-tips"))||void 0===n||n.remove(),null===(o=e.parentElement)||void 0===o||o.classList.remove("error"),r)a=!0,null===(i=e.parentElement)||void 0===i||i.classList.add("error"),e.insertAdjacentHTML("afterend",'<div class="error-tips">'.concat(r,"</div>"))}}),!a||new Error("".concat(t,":").concat(i[t].vlaue))},e.bindEvent(i[t],s,function(){if("isShow"in n[t]&&!n[t].isShow())return!0;var e=this.getAttribute("name");o[e](e)})})}};for(var s in n)r(s);return function(t){var e=0;for(var r in o)if(Object.prototype.hasOwnProperty.call(o,r)){var s=o[r];try{if("isShow"in n[r]&&!n[r].isShow())continue;var a=s(r);if("object"===m(a))throw a}catch(a){return e++,i[r].focus(),!1}}if(!e){var c={};for(var l in i)if(Object.prototype.hasOwnProperty.call(i,l)){var u=i[l].value;c[l]=u.trim()}t(c)}}}},{key:"handleTransformRequest",value:function(t){var e="";for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=t[n];e+="".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(o),"&")}return e=e.slice(0,-1)}},{key:"request",value:(o=p(l().m(function t(){var e,n,o,i,r=this,s=arguments;return l().w(function(t){for(;;)if(0===t.n)return n=(e=s.length>0&&void 0!==s[0]?s[0]:{method:"post",data:{},url:""}).url,o=e.data,i=e.method,t.a(2,new Promise(function(t,e){var s=new XMLHttpRequest;s.open(i,n,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.timeout=25e4,s.onreadystatechange=function(){if(4===s.readyState)if(s.status>=200&&s.status<300)try{t(f(f({},s),{},{data:JSON.parse(s.responseText)}))}catch(n){t(f(f({},s),{},{data:s.responseText,error:n}))}else e(new Error(s.statusText))},s.ontimeout=function(){return e(new Error("Request timed out"))},s.onerror=function(){return e(new Error("Network error"))},s.send(r.handleTransformRequest(o))}))},t)})),function(){return o.apply(this,arguments)})},{key:"rsaEncrypt",value:(n=p(l().m(function t(e){var n,o,i,r;return l().w(function(t){for(;;)switch(t.n){case 0:if(n=window,o=n.JSEncrypt,!((i=window.vite_public_encryption).length<10)){t.n=1;break}return t.a(2,e);case 1:return(r=new o).setPublicKey(i),t.a(2,r.encrypt(e))}},t)})),function(t){return n.apply(this,arguments)})},{key:"encryptionData",value:(e=p(l().m(function t(e){var n,o;return l().w(function(t){for(;;)switch(t.n){case 0:return n=window,o=n.md5,t.n=1,this.rsaEncrypt(o(o(e.username+window.vite_public_login_token)));case 1:return e.username=t.v,t.n=2,this.rsaEncrypt(o("".concat(o(e.password),"_bt.cn")));case 2:return e.password=t.v,t.a(2,e)}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"removeEmpty",value:function(t){return Object.entries(t).reduce(function(t,e){var n=s(e,2),o=n[0],i=n[1];return null!=i&&""!==i&&(t[o]=i),t},{})}},{key:"loading",value:function(e){var n='<div id="full-loading" class="el-loading-mask login-loading" style="background-color: rgba(0, 0, 0, 0.3); z-index: 3006;">\n\t\t\t<div class="el-loading-spinner">\n\t\t\t\t<i class="svgtofont-loading">'.concat(t.svgLogin,'</i>\n\t\t\t\t<p class="el-loading-text">').concat(e,"</p>\n\t\t\t</div>\n\t\t</div>");return window.document.body.insertAdjacentHTML("beforeend",n),{close:function(){var t=document.getElementById("full-loading");t&&t.remove()}}}},{key:"message",value:function(t){var e,n=t.message,o=t.type,i=t.time,r=void 0===i?3e3:i,s=t.close,a=void 0!==s&&s;null===(e=document.getElementById("el-message"))||void 0===e||e.remove();var c="success"===o?"circle-check-filled":"circle-close-filled",l='<div id="el-message" class="el-message el-message--'.concat(o,'" style="z-index: 4001;">\n\t\t\t\t').concat(a?'<div class="el-dialog-close"></div>':"",'\n\t\t\t\t<div class="el-message__icon loading-icon svgtofont-el-').concat(c,'"></div>\n\t\t\t\t<div class="el-message__content">').concat(n||"","</div>\n\t\t\t</div>");window.document.body.insertAdjacentHTML("beforeend",l),r&&setTimeout(function(){var t=document.getElementById("el-message");t&&t.remove()},r),a&&this.bindEvent(document.querySelector(".el-dialog-close"),"click",function(){var t;null===(t=document.getElementById("el-message"))||void 0===t||t.remove()})}},{key:"tooltip",value:function(t){var e,n=t.el,o=t.text;null===(e=document.getElementById("el-tooltip"))||void 0===e||e.remove();var i='<div  id="el-tooltip" x-placement="top" class="el-tooltip__popper is-dark el-tooltip-white overview-popover w-[40rem] custom-login-popover" style="transform-origin: center bottom; z-index: 3009; display: none;">\n\t\t\t\t<div class="leading-8 p-[8px]">'.concat(o,'</div>\n\t\t\t\t<div class="popper__arrow" style="left: 154px;"></div>\n\t\t</div>');window.document.body.insertAdjacentHTML("beforeend",i);var r=document.getElementById("el-tooltip"),s=0;this.bindEvent(n,"mouseenter",function(t){clearTimeout(s),r.style.display="block",r.style.left="".concat(t.clientX-t.offsetX-150,"px"),r.style.top="".concat(t.clientY-t.offsetY-r.clientHeight-10,"px")}),this.bindEvent(n,"mouseleave",function(){clearTimeout(s),s=setTimeout(function(){r.style.display="none"},100)}),this.bindEvent(r,"mouseenter",function(){clearTimeout(s),r.style.display="block"}),this.bindEvent(r,"mouseleave",function(){clearTimeout(s),s=setTimeout(function(){r.style.display="none"},100)}),r.style.left="calc(50% - ".concat(r.offsetWidth/2,"px)"),r.style.top="calc(50% - ".concat(r.offsetHeight/2,"px)")}}]);var e,n,o}();b(o,"svgLogin",'<img src="'.concat((null===(n=window.vite_public_icon_info)||void 0===n?void 0:n.login_logo)||"/static/icons/logo-green.svg",'" alt="logo" />'));var r=function(n){function o(t){var n;return h(this,o),b(n=e(this,o),"el",void 0),b(n,"formData",void 0),b(n,"formVerify",void 0),b(n,"node",void 0),b(n,"codeCheck",void 0),b(n,"hostCheck",void 0),b(n,"googleCheck",void 0),b(n,"loginErrorTimer",void 0),b(n,"timer",void 0),b(n,"submitError",void 0),n.initData(t),n.nodeMout(),n.render(),n.event(),n}return i(o,n),y(o,[{key:"initData",value:function(t){var e=localStorage.getItem("safeMode");this.el="string"==typeof t?document.querySelector(null==t?void 0:t.el):t,this.formData={},this.node={},this.formData.safe_mode=Number(e||1),this.el.innerHTML=o.template(),this.codeCheck=window.vite_public_login_check,this.formVerify={form:null,vcode:null}}},{key:"nodeMout",value:function(){this.node={loginForm:this.el.querySelector(".login-form"),inputUsername:this.el.querySelector('[name="username"]'),inputPassword:this.el.querySelector('[name="password"]'),codeView:this.el.querySelector(".login-code-view"),inputCode:this.el.querySelector('[name="code"]'),cutCode:this.el.querySelector(".cut-login-code"),formSafeMode:this.el.querySelector(".login-safe-mode"),formSubmit:this.el.querySelector(".login-submit"),formGoogleVerifySubmit:this.el.querySelector(".login-google-verify-submit"),closePopupBtn:this.el.querySelector(".close-popup-btn"),formGoogleVerifyView:this.el.querySelector(".google-verify-view"),formGoogleVerifyInput:this.el.querySelector('[name="vcode"]'),formCdnAccelerate:this.el.querySelector(".login-cdn-accelerate"),formTipsQuestion:this.el.querySelector(".svgtofont-el-question-filled")}}},{key:"render",value:function(){var t=this,e=this.node.formSafeMode;this.renderSelect({el:e,options:[{key:1,label:"安全登录模式(推荐)"},{key:0,label:"普通登录模式(不推荐)"}],active:this.formData.safeMode,change:function(e){t.formData.safe_mode=Number(e)}}),this.renderHostsList(),this.codeVerify(this.codeCheck),this.cutCheckCode()}},{key:"event",value:function(){var t=this,e=this.node,n=e.cutCode,o=e.formSubmit,i=e.inputPassword,r=e.inputUsername,s=e.formGoogleVerifyInput,a=e.formGoogleVerifySubmit,c=e.formTipsQuestion,l=e.inputCode;this.formVerify.form=this.validateForm({el:this.node.loginForm,rules:{username:{validator:function(t,e){""===t?e(new Error("账号不能为空")):t.length<3?e(new Error("账号长度必须大于等于3位")):e()},trigger:["input","blur"]},password:{validator:function(t,e){""===t?e(new Error("密码不能为空")):e()},trigger:["input","blur"]},code:{isShow:function(){return t.codeCheck},validator:function(t,e){""===t?e(new Error("验证码不能为空")):4!==t.length?e(new Error("验证码长度错误，必须为4位")):e()},trigger:["input","blur"]}}}),this.formVerify.vcode=this.validateForm({el:this.node.formGoogleVerifyView,rules:{vcode:{validator:function(t,e){""===t?e(new Error("动态口令不能为空")):t.length<6?e(new Error("动态口令长度必须为6位")):e()},trigger:["input","blur"]}}}),this.bindEvent(n,"click",this.cutCheckCode.bind(this)),this.bindEvent(this.node.closePopupBtn,"click",function(){t.googleVerify(!1)}),this.bindEvent(o,"click",this.submitLoginInfo.bind(this,"form")),this.bindEvent(r,"keyup",function(t){13===t.keyCode&&(o.focus(),o.click())}),this.bindEvent(i,"keyup",function(t){13===t.keyCode&&(o.focus(),o.click())}),this.bindEvent(l,"keyup",function(t){13===t.keyCode&&(o.focus(),o.click())}),this.bindEvent(a,"click",this.submitLoginInfo.bind(this,"vcode")),this.bindEvent(s,"keyup",function(t){13===t.keyCode&&a.click()}),this.tooltip({el:c,text:'\n\t\t\t\t<div class="mb-[.8rem]">\n\t\t\t\t\t<div class="font-bold">安全登录模式（推荐）</div>\n\t\t\t\t\t<div>在安全模式下，将加强登录会话的安全性，防止“重放攻击”风险，强烈建议使用安全模式登录面板。</div>\n\t\t\t\t\t<div class="text-danger"> 注意：在安全模式下，极少数网络环境可能出现无限退出的情况。 </div>\n\t\t\t\t</div>\n\t\t\t\t<div class="font-bold">普通登录模式（不推荐）</div>\n\t\t\t\t<div>兼容性好，但存在“重放攻击”的风险，建议在开启面板SSL的情况下再使用普通模式。</div>'}),this.checkAutoLogin(),this.node.inputUsername.value=this.autoLoginParams.username,this.node.inputPassword.value=this.autoLoginParams.password,this.autoLoginParams.username&&this.autoLoginParams.password&&this.node.formSubmit.click()}},{key:"renderHostsList",value:(c=p(l().m(function t(){var e,n,o,i,r,s;return l().w(function(t){for(;;)switch(t.n){case 0:if(e=this.node.formCdnAccelerate,n=window.vite_public_hosts_list||[],this.hostCheck=n.length>0,e.classList[this.hostCheck?"remove":"add"]("!hidden"),document.querySelector(".cdn-node").classList[this.hostCheck?"remove":"add"]("!hidden"),this.hostCheck&&(document.querySelector(".noreferrer_tips").innerText="联系客服"),this.hostCheck){t.n=1;break}return t.a(2,!1);case 1:for(o=[],i=[],r=0;r<n.length;r++)s=n[r],o.push({key:s.url,label:s.name}),i.push(this.getHostDelay(s.url));this.monitorHostSpeed(o,i);case 2:return t.a(2)}},t,this)})),function(){return c.apply(this,arguments)})},{key:"monitorHostSpeed",value:(a=p(l().m(function t(e,n){var o;return l().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Promise.all(n);case 1:o=t.v,e=e.map(function(t,e){return{key:t.key,label:"".concat(t.label).concat(o[e]?"(".concat(o[e],"ms)"):""),state:o[e],disabled:!o[e]}}).sort(function(t,e){return!1===t.state?1:t.state-e.state}),this.createHostSelect(e);case 2:return t.a(2)}},t,this)})),function(t,e){return a.apply(this,arguments)})},{key:"createHostSelect",value:function(e){var n=this,o=this.node.formCdnAccelerate;e&&(this.formData.cdn_url=e[0].key),this.renderSelect({el:o,size:"small",options:[{key:"",label:"不使用加速"}].concat(t(e)),active:e[0].key,change:function(t){n.formData.cdn_url=t}})}},{key:"getHostDelay",value:(s=p(l().m(function t(e){var n,o;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,n=(new Date).getTime(),t.n=1,this.request({method:"get",url:"https://".concat(e,"/test.txt"),data:{time:n}});case 1:if("boolean"!=typeof t.v.data){t.n=2;break}return o=(new Date).getTime(),t.a(2,Promise.resolve(o-n));case 2:return t.a(2,Promise.resolve(!1));case 3:return t.p=3,t.v,t.a(2,Promise.resolve(!1))}},t,this,[[0,3]])})),function(t){return s.apply(this,arguments)})},{key:"getUrlInfo",value:function(){var t=this.node,e=t.formSubmit,n=t.inputUsername,o=t.inputPassword,i=window.location.href.split("?")[1],r=new URLSearchParams("?".concat(i)),s=r.get("username"),a=r.get("password");s&&a&&(n.value=s,o.value=a,e.click())}},{key:"cutCheckCode",value:function(){this.node.cutCode.querySelector("img").src="/code?t=".concat((new Date).getTime())}},{key:"googleVerify",value:function(t){var e=this.node,n=e.formGoogleVerifyView,o=e.formGoogleVerifyInput;this.googleCheck=t,this.formData.vcode="",o.value="",t?(n.classList.remove("!hidden"),o.focus()):n.classList.add("!hidden")}},{key:"codeVerify",value:function(t){var e=this.node,n=e.inputCode,o=e.codeView;this.codeCheck=t,this.formData.code="",o.classList[t?"remove":"add"]("!hidden"),n.value=""}},{key:"setFormSubmitError",value:function(t){var e,n,o=this.node.formSubmit;return null===(e=o.parentElement)||void 0===e||null===(e=e.querySelector(".error-tips"))||void 0===e||e.remove(),null===(n=o.parentElement)||void 0===n||n.classList.add("error"),o.insertAdjacentHTML("afterend",'<div class="error-tips">'.concat(t,"</div>")),{close:function(){var t,e;null===(t=o.parentElement)||void 0===t||t.classList.remove("error"),null===(e=o.parentElement)||void 0===e||null===(e=e.querySelector(".error-tips"))||void 0===e||e.remove()}}}},{key:"submitLoginInfo",value:(r=p(l().m(function t(e){var n,o=this;return l().w(function(t){for(;;)switch(t.n){case 0:n=this.node.inputPassword,this.formVerify[e](function(){var t=p(l().m(function t(i){var r,s,a,c,u,d,v,p;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:return r=o.loading("正在登录面板，请稍候..."),s=f(f({},o.formData),i),o.formData=f({},s),"string"==typeof e&&"vcode"===e&&(s.vcode=i.vcode),t.n=1,o.encryptionData(s);case 1:return a=t.v,o.hostCheck&&(a.cdn_url=o.formData.cdn_url),o.googleCheck&&(a.vcode=o.formData.vcode),o.codeCheck&&(a.code=o.formData.code),a=o.removeEmpty(a),t.p=2,sessionStorage.setItem("sendXhr","1"),t.n=3,o.request({method:"post",url:"/login",data:a});case 3:c=t.v,u=c.data,r.close(),o.submitError&&o.submitError.close(),o.loginErrorTimer=!1,"number"==typeof u&&1===u?o.googleVerify(!0):"object"===m(u)?(d=u.status,v=u.msg,d?(o.message({type:"success",message:v}),sessionStorage.setItem("loginInfo",JSON.stringify(u)),setTimeout(function(){window.location.href="/"},500)):(o.message({type:"error",message:v}),"vcode"===e?o.googleVerify(!0):(n.value="",o.googleVerify(!1),o.codeVerify(!0),o.cutCheckCode(),-1!==v.indexOf("验证码错误")&&o.cutCheckCode(),o.countdownInfo(v)))):o.message({message:u,type:"error",time:0,close:!0}),t.n=5;break;case 4:t.p=4,p=t.v,o.message({type:"error",message:p,close:!0}),r.close();case 5:return t.a(2)}},t,null,[[2,4]])}));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}},t,this)})),function(t){return r.apply(this,arguments)})},{key:"countdownInfo",value:function(t){var e=this,n=0;if(t.indexOf("多次登录失败")>-1){var o=t.match(/\d+/g);o?(this.loginErrorTimer=!0,n=o[0],this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){n--,e.submitError=e.setFormSubmitError(t.replace(/\d+/g,n.toString())),(n<=0||!e.loginErrorTimer)&&(clearInterval(e.timer),e.submitError.close(),n=0)},1e3)):setTimeout(function(){e.submitError.close()},3e3)}}}],[{key:"template",value:function(){return'<div class="w-full">\n\t\t\t<div class="login-title"><span class="title-text" title="'.concat(window.vite_public_title,'">').concat(window.vite_public_title,'</span></div>\n\t\t\t<div class="login-form">\n\t\t\t\t<div class="login-form-item">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<input class="login-form-input" name="username" autocomplete="off" type="text" autofocus placeholder="账号" />\n\t\t\t\t\t\t<div class="input-action-icon"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="login-form-item">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<input class="login-form-input" name="password" autocomplete="off" type="password" placeholder="密码" />\n\t\t\t\t\t\t<div class="input-action-icon"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="login-form-item">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<div class="login-safe-mode !w-[230px]"></div>\n\t\t\t\t\t\t<div class="loading-icon svgtofont-el-question-filled cursor-pointer !text-warning h-[20px] ml-[15px] text-[20px]"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="login-form-item flex login-code-view !hidden"> \n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<input class="login-form-input !w-[230px] mr-[15px]" name="code" type="code" placeholder="验证码" />\n\t\t\t\t\t\t<div class="input-action-icon"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="cut-login-code"><img title="点击切换验证码" class="w-[100%] h-[40px]" /></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="login-form-item">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<button class="login-form-button login-submit">登录</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="login-form-footer">\n\t\t\t\t\t<div class="flex">\n\t\t\t\t\t\t<div class="cdn-node"> 加速节点 </div>\n\t\t\t\t\t\t<div class="login-cdn-accelerate"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<a class="bt-link noreferrer_tips" href="https://www.bt.cn/new/wechat_customer" target="_blank" rel="noreferrer noopener">无法登录？联系客服</a>\n\t\t\t\t\t\t<div class="el-divider el-divider--vertical"></div>\n\t\t\t\t\t\t<a class="bt-link" href="https://www.bt.cn/bbs/thread-1172-1-1.html" target="_blank" rel="noreferrer noopener">忘记密码</a>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="login-form google-verify-view !hidden">\n\t\t\t\t\t<div class="login-google-verify">\n\t\t\t\t\t\t<div class="close-popup-btn -right-[15px] -top-[15px]"></div>\n\t\t\t\t\t\t<div class="login-title !mt-0">动态口令认证</div>\n\t\t\t\t\t\t<div class="login-form-item">\n\t\t\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t\t\t<input class="login-form-input" name="vcode" type="text" placeholder="请输入动态口令" />\n\t\t\t\t\t\t\t\t<div class="input-action-icon"></div>\n\t\t\t\t\t\t\t</div>\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="login-form-item">\n\t\t\t\t\t\t\t<button class="login-form-button login-google-verify-submit">验证并登录</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ul class="mt-4x leading-8 text-[1.2rem]">\n\t\t\t\t\t\t\t<li>请使用宝塔APP或谷歌认证器获取验证代码</li>\n\t\t\t\t\t\t\t<li><a href="https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=105839" target="_blank" rel="noreferrer noopener" class="bt-link" ><span class="el-link--inner"> 无法验证，点击帮助 </span></a></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="google-verify-shade"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>')}}]);var r,s,a,c}(o),a=function(t){function n(t){var o;return h(this,n),b(o=e(this,n),"el",void 0),b(o,"node",void 0),b(o,"pollingQuery",!0),o.el="string"==typeof t?document.querySelector(t.el):t,o.node={cutTips:null,loginAccount:null,loginScan:null},o.render(),o}return i(n,t),y(n,[{key:"template",value:function(){return'<div class="login-scan-view">\n\t\t\t<div class="login-scan-success">\n\t\t\t\t<div class="login-title">堡塔APP扫码登录</div>\n\t\t\t\t<div id="canvas" class="login-scan-canvas"></div>\n\t\t\t\t<div class="">\n\t\t\t\t\t<span><a href="https://www.bt.cn/bbs/thread-47408-1-1.html" target="_blank" title="点击查看链接信息" class="bt-link text-middle login-scan-tips">关于堡塔APP</a></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="login-scan-error !hidden">\n\t\t\t\t<span class="title">当前面板未绑定扫描登录，请按照以下顺序检查：</span>\n\t\t\t\t<span class="line ">1、检查堡塔APP插件(面板插件)是否安装，是否绑定</span>\n\t\t\t\t<span class="line">2、打开<a class="bt-link text-middle" rel="noreferrer noopener" href="https://www.bt.cn/bbs/thread-47408-1-1.html">堡塔APP(手机APP)</a>查看绑定情况</span>\n\t\t\t\t<span class="line">3、如果以上操作均无法解决问题，请<a target="_block" rel="noreferrer noopener" class="bt-link text-middle" href="https://www.bt.cn/new/wechat_customer">联系客服</a>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>'}},{key:"render",value:function(){this.el.innerHTML=this.template(),this.getSacnLoginInfo()}},{key:"qrCodeRender",value:(a=p(l().m(function t(e){return l().w(function(t){for(;;)switch(t.n){case 0:new window.QRCode(document.getElementById("canvas"),{text:e,width:140,height:140});case 1:return t.a(2)}},t)})),function(t){return a.apply(this,arguments)})},{key:"getSacnLoginInfo",value:(s=p(l().m(function t(){var e,n,o,i,r,s,a,c;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.request({method:"post",url:"/public?name=app&fun=login_qrcode"});case 1:e=t.v,"object"===m(n=e.data)&&(o=n.status,i=n.msg,o?(this.qrCodeRender(o?i:"https://www.bt.cn/download/app.html"),this.pollingQuerySacnInfo(),null===(r=document.querySelector(".login-scan-success"))||void 0===r||r.classList.remove("!hidden"),null===(s=document.querySelector(".login-scan-error"))||void 0===s||s.classList.add("!hidden")):(null===(a=document.querySelector(".login-scan-success"))||void 0===a||a.classList.add("!hidden"),null===(c=document.querySelector(".login-scan-error"))||void 0===c||c.classList.remove("!hidden"))),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return s.apply(this,arguments)})},{key:"pollingQuerySacnInfo",value:(r=p(l().m(function t(){var e,n,o,i,r=this;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,this.pollingQuery){t.n=1;break}return t.a(2,!1);case 1:return t.n=2,this.request({method:"post",url:"/public?name=app&fun=is_scan_ok"});case 2:e=t.v,n=e.data,o=n.status,i=n.msg,"object"===m(n)&&o?this.loginAdmin(i):setTimeout(function(){r.pollingQuerySacnInfo()},2500),t.n=4;break;case 3:t.p=3,t.v;case 4:return t.a(2)}},t,this,[[0,3]])})),function(){return r.apply(this,arguments)})},{key:"loginAdmin",value:(o=p(l().m(function t(e){var n,o,i;return l().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.request({method:"post",url:"/public?name=app&fun=set_login",data:{secret_key:e}});case 1:n=t.v,o=n.data,i=o.status,"object"===m(o)&&i&&(this.message({type:"success",message:"登录成功,正在跳转中"}),window.location.href="/"),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,this,[[0,2]])})),function(t){return o.apply(this,arguments)})}]);var o,r,s,a}(o);new(function(t){function n(t){var o;return h(this,n),b(o=e(this,n),"loginType",void 0),b(o,"el",void 0),b(o,"node",void 0),b(o,"autoLoginParams",void 0),o.loginType=localStorage.getItem("loginType")||"account",o.el=document.querySelector(t.el),o.node={cutTips:null,loginAccount:null,loginScan:null},o.autoLoginParams={password:"",username:""},o.render(),o}return i(n,t),y(n,[{key:"template",value:function(){var t,e,n=null===(t=window.vite_public_icon_info)||void 0===t?void 0:t.show_login_bg_images,i=null===(e=window.vite_public_icon_info)||void 0===e?void 0:e.show_login_logo,r=window.vite_public_icon_info,s=r.login_bg_images,a=r.login_bg_images_opacity,c=n?"background-image: url('".concat(s,"');opacity:").concat(a/100):"";return'<div class="login-bg" >\n\t\t'.concat(n?'<div class="login-images" style="'.concat(c,'"></div>'):"",'\n\t\t<div class="login-main">\n\t\t\t<aside class="login-svg ').concat(i?"":"!hidden",'">').concat(o.svgLogin,'</aside>\n\t\t\t<aside class="cut-login-type ').concat(this.loginType,'" style="top:').concat(i?"120px":"20px",'">\n\t\t\t\t<div class="tips">\n\t\t\t\t\t<span class="account"></span>\n\t\t\t\t\t<span class="tips-text">切换扫码登录</span>\n\t\t\t\t</div>\n\t\t\t</aside>\n\t\t\t<aside class="login-account !hidden"></aside>\n\t\t\t<aside class="login-scan !hidden"></aside>\n\t\t</div>')}},{key:"domMount",value:function(){this.node.cutTips=this.el.querySelector(".tips-text"),this.node.cutLoginType=this.el.querySelector(".cut-login-type"),this.node.loginAccount=this.el.querySelector(".login-account"),this.node.loginScan=this.el.querySelector(".login-scan")}},{key:"eventMount",value:function(){var t=this,e=this.node,n=e.cutLoginType,o=e.cutTips;this.bindEvent(n,"click",function(){n.classList.add("account"===t.loginType?"scan":"account"),n.classList.remove("account"===t.loginType?"account":"scan"),"account"===t.loginType?(t.setLoginScan(),o.innerText="切换账号登录",localStorage.setItem("loginType","scan")):(t.setLoginAccount(),o.innerText="切换扫码登录",localStorage.setItem("loginType","account"))})}},{key:"setLoginScan",value:function(){var t=this.node,e=t.loginScan,n=t.loginAccount;this.loginType="scan",e.classList.remove("!hidden"),n.classList.add("!hidden"),new a(this.node.loginScan)}},{key:"setLoginAccount",value:function(){var t=this.node,e=t.loginScan,n=t.loginAccount;this.loginType="account",e.classList.add("!hidden"),n.classList.remove("!hidden"),new r(this.node.loginAccount)}},{key:"render",value:function(){this.el.innerHTML=this.template(),this.loginType=localStorage.getItem("loginType")||"account",this.domMount(),this.eventMount(),"account"===this.loginType?this.setLoginAccount():this.setLoginScan()}}])}(o))({el:"#app"})}}})}();
